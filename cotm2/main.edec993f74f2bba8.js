(self.webpackChunkcotm_front=self.webpackChunkcotm_front||[]).push([[179],{747:function(u8,C8){!function(C3){"use strict";function k2(v){return(k2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(C){return typeof C}:function(C){return C&&"function"==typeof Symbol&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(v)}function B(v,C){if(!(v instanceof C))throw new TypeError("Cannot call a class as a function")}function S6(v,C){for(var u=0;u<C.length;u++){var c=C[u];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(v,c.key,c)}}function W(v,C,u){return C&&S6(v.prototype,C),u&&S6(v,u),Object.defineProperty(v,"prototype",{writable:!1}),v}function Q(v,C){if("function"!=typeof C&&null!==C)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(C&&C.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),Object.defineProperty(v,"prototype",{writable:!1}),C&&qe(v,C)}function I2(v){return(I2=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)})(v)}function qe(v,C){return(qe=Object.setPrototypeOf||function(u,c){return u.__proto__=c,u})(v,C)}function P5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function w4(v,C,u){return(w4=P5()?Reflect.construct:function(c,i,h){var d=[null];d.push.apply(d,i);var g=new(Function.bind.apply(c,d));return h&&qe(g,h.prototype),g}).apply(null,arguments)}function G4(v){var C="function"==typeof Map?new Map:void 0;return(G4=function(u){if(null===u||-1===Function.toString.call(u).indexOf("[native code]"))return u;if("function"!=typeof u)throw new TypeError("Super expression must either be null or a function");if(void 0!==C){if(C.has(u))return C.get(u);C.set(u,i)}function i(){return w4(u,arguments,I2(this).constructor)}return i.prototype=Object.create(u.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),qe(i,u)})(v)}function H1(v){if(void 0===v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}function ye(v,C){if(C&&("object"==typeof C||"function"==typeof C))return C;if(void 0!==C)throw new TypeError("Derived constructors may only return object or undefined");return H1(v)}function a2(v){var C=P5();return function(){var u,c=I2(v);if(C){var i=I2(this).constructor;u=Reflect.construct(c,arguments,i)}else u=c.apply(this,arguments);return ye(this,u)}}function K0(v,C){for(;!Object.prototype.hasOwnProperty.call(v,C)&&null!==(v=I2(v)););return v}function J2(){return(J2=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(v,C,u){var c=K0(v,C);if(c){var i=Object.getOwnPropertyDescriptor(c,C);return i.get?i.get.call(arguments.length<3?v:u):i.value}}).apply(this,arguments)}function y2(v,C){return function(u){if(Array.isArray(u))return u}(v)||function(u,c){var i=null==u?null:typeof Symbol<"u"&&u[Symbol.iterator]||u["@@iterator"];if(null!=i){var h,d,g=[],M=!0,H=!1;try{for(i=i.call(u);!(M=(h=i.next()).done)&&(g.push(h.value),!c||g.length!==c);M=!0);}catch(m){H=!0,d=m}finally{try{M||null==i.return||i.return()}finally{if(H)throw d}}return g}}(v,C)||Me(v,C)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p1(v){return function(C){if(Array.isArray(C))return I5(C)}(v)||function(C){if(typeof Symbol<"u"&&null!=C[Symbol.iterator]||null!=C["@@iterator"])return Array.from(C)}(v)||Me(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Me(v,C){if(v){if("string"==typeof v)return I5(v,C);var u=Object.prototype.toString.call(v).slice(8,-1);return"Object"===u&&v.constructor&&(u=v.constructor.name),"Map"===u||"Set"===u?Array.from(v):"Arguments"===u||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u)?I5(v,C):void 0}}function I5(v,C){(null==C||C>v.length)&&(C=v.length);for(var u=0,c=new Array(C);u<C;u++)c[u]=v[u];return c}function N(v,C){var u=typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(!u){if(Array.isArray(v)||(u=Me(v))||C&&v&&"number"==typeof v.length){u&&(v=u);var c=0,i=function(){};return{s:i,n:function(){return c>=v.length?{done:!0}:{done:!1,value:v[c++]}},e:function(M){throw M},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var h,d=!0,g=!1;return{s:function(){u=u.call(v)},n:function(){var M=u.next();return d=M.done,M},e:function(M){g=!0,h=M},f:function(){try{d||null==u.return||u.return()}finally{if(g)throw h}}}}var S3,v,b6=W(function v(){var C=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;B(this,v),this.sourceFilename=C,this.pluginNames=u,this.countAllVisits=c,this.errorHandler=i,this.fileHandler=h}),Q0=W(function v(C,u,c){B(this,v),this.length=C,this.debugMetadata=u,this.text=c});(v=S3||(S3={}))[v.Author=0]="Author",v[v.Warning=1]="Warning",v[v.Error=2]="Error";var $e=W(function v(){var C=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;B(this,v),this.identifier=C,this.isByReference=u,this.isDivertTarget=c});function P(v,C){return v instanceof C?w6(v):null}function U2(v,C){if(v instanceof C)return w6(v);throw new Error("".concat(v," is not of type ").concat(C))}function Le(v){return v.hasValidName&&v.name?v:null}function F5(v){return void 0===v?null:v}function z6(v){return"object"===k2(v)&&"function"==typeof v.Equals}function w6(v,C){return v}function f8(v){return null!=v}var K3,E2=function(){function v(){var C=this;B(this,v),this._alreadyHadError=!1,this._alreadyHadWarning=!1,this._debugMetadata=null,this._runtimeObject=null,this.content=[],this.parent=null,this.GetType=function(){return C.typeName},this.AddContent=function(u){null===C.content&&(C.content=[]);var c,i=N(Array.isArray(u)?u:[u]);try{for(i.s();!(c=i.n()).done;){var h=c.value;h.hasOwnProperty("parent")&&(h.parent=C),C.content.push(h)}}catch(d){i.e(d)}finally{i.f()}return Array.isArray(u)?void 0:u},this.InsertContent=function(u,c){return null===C.content&&(C.content=[]),c.parent=C,C.content.splice(u,0,c),c},this.Find=function(u){return function(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=P(C,u);if(null!==i&&(null===c||!0===c(i)))return i;if(null===C.content)return null;var h,d=N(C.content);try{for(d.s();!(h=d.n()).done;){var g=h.value,M=g.Find&&g.Find(u)(c);if(M)return M}}catch(H){d.e(H)}finally{d.f()}return null}},this.FindAll=function(u){return function(c,i){var h=Array.isArray(i)?i:[],d=P(C,u);if(null===d||c&&!0!==c(d)||h.push(d),null===C.content)return[];var g,M=N(C.content);try{for(M.s();!(g=M.n()).done;){var H=g.value;H.FindAll&&H.FindAll(u)(c,h)}}catch(m){M.e(m)}finally{M.f()}return h}},this.Warning=function(u){C.Error(u,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,!0)}}return W(v,[{key:"debugMetadata",get:function(){return null===this._debugMetadata&&this.parent?this.parent.debugMetadata:this._debugMetadata},set:function(C){this._debugMetadata=C}},{key:"hasOwnDebugMetadata",get:function(){return Boolean(this.debugMetadata)}},{key:"typeName",get:function(){return"ParsedObject"}},{key:"story",get:function(){for(var C=this;C.parent;)C=C.parent;return C}},{key:"runtimeObject",get:function(){return this._runtimeObject||(this._runtimeObject=this.GenerateRuntimeObject(),this._runtimeObject&&(this._runtimeObject.debugMetadata=this.debugMetadata)),this._runtimeObject},set:function(C){this._runtimeObject=C}},{key:"runtimePath",get:function(){if(!this.runtimeObject.path)throw new Error;return this.runtimeObject.path}},{key:"containerForCounting",get:function(){return this.runtimeObject}},{key:"ancestry",get:function(){for(var C=[],u=this.parent;u;)C.push(u),u=u.parent;return C.reverse()}},{key:"ResolveReferences",value:function(C){if(null!==this.content){var u,c=N(this.content);try{for(c.s();!(u=c.n()).done;)u.value.ResolveReferences(C)}catch(i){c.e(i)}finally{c.f()}}}},{key:"Error",value:function(C){function u(c){return C.apply(this,arguments)}return u.toString=function(){return C.toString()},u}(function(C){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===u&&(u=this),!(u._alreadyHadError&&!c||u._alreadyHadWarning&&c)){if(!this.parent)throw new Error("No parent object to send error to: ".concat(C));this.parent.Error(C,u,c),c?u._alreadyHadWarning=!0:u._alreadyHadError=!0}})}]),v}(),Ke=function(v){Q(u,v);var C=a2(u);function u(c){var i;return B(this,u),(i=C.call(this)).warningMessage=c,i.GenerateRuntimeObject=function(){return i.Warning(i.warningMessage),null},i}return W(u,[{key:"typeName",get:function(){return"AuthorWarning"}}]),u}(E2),Z2=function(){function v(){if(B(this,v),this._components=[],this._componentsString=null,this._isRelative=!1,"string"==typeof arguments[0])this.componentsString=arguments[0];else if(arguments[0]instanceof v.Component&&arguments[1]instanceof v){var c=arguments[1];this._components.push(arguments[0]),this._components=this._components.concat(c._components)}else if(arguments[0]instanceof Array){var h=!!arguments[1];this._components=this._components.concat(arguments[0]),this._isRelative=h}}return W(v,[{key:"isRelative",get:function(){return this._isRelative}},{key:"componentCount",get:function(){return this._components.length}},{key:"head",get:function(){return this._components.length>0?this._components[0]:null}},{key:"tail",get:function(){return this._components.length>=2?new v(this._components.slice(1,this._components.length)):v.self}},{key:"length",get:function(){return this._components.length}},{key:"lastComponent",get:function(){var C=this._components.length-1;return C>=0?this._components[C]:null}},{key:"containsNamedComponent",get:function(){for(var C=0,u=this._components.length;C<u;C++)if(!this._components[C].isIndex)return!0;return!1}},{key:"GetComponent",value:function(C){return this._components[C]}},{key:"PathByAppendingPath",value:function(C){for(var u=new v,c=0,i=0;i<C._components.length&&C._components[i].isParent;++i)c++;for(var h=0;h<this._components.length-c;++h)u._components.push(this._components[h]);for(var d=c;d<C._components.length;++d)u._components.push(C._components[d]);return u}},{key:"componentsString",get:function(){return null==this._componentsString&&(this._componentsString=this._components.join("."),this.isRelative&&(this._componentsString="."+this._componentsString)),this._componentsString},set:function(C){if(this._components.length=0,this._componentsString=C,null!=this._componentsString&&""!=this._componentsString){"."==this._componentsString[0]&&(this._isRelative=!0,this._componentsString=this._componentsString.substring(1));var u,c=N(this._componentsString.split("."));try{for(c.s();!(u=c.n()).done;){var i=u.value;/^(\-|\+)?([0-9]+|Infinity)$/.test(i)?this._components.push(new v.Component(parseInt(i))):this._components.push(new v.Component(i))}}catch(h){c.e(h)}finally{c.f()}}}},{key:"toString",value:function(){return this.componentsString}},{key:"Equals",value:function(C){if(null==C||C._components.length!=this._components.length||C.isRelative!=this.isRelative)return!1;for(var u=0,c=C._components.length;u<c;u++)if(!C._components[u].Equals(this._components[u]))return!1;return!0}},{key:"PathByAppendingComponent",value:function(C){var u,c=new v;return(u=c._components).push.apply(u,p1(this._components)),c._components.push(C),c}}],[{key:"self",get:function(){var C=new v;return C._isRelative=!0,C}}]),v}();Z2.parentId="^",function(v){var C=function(){function u(c){B(this,u),this.index=-1,this.name=null,"string"==typeof c?this.name=c:this.index=c}return W(u,[{key:"isIndex",get:function(){return this.index>=0}},{key:"isParent",get:function(){return this.name==v.parentId}},{key:"toString",value:function(){return this.isIndex?this.index.toString():this.name}},{key:"Equals",value:function(c){return null!=c&&c.isIndex==this.isIndex&&(this.isIndex?this.index==c.index:this.name==c.name)}}],[{key:"ToParent",value:function(){return new u(v.parentId)}}]),u}();v.Component=C}(Z2||(Z2={})),function(v){function C(u,c){if(!u)throw void 0!==c&&console.warn(c),console.trace&&console.trace(),new Error("")}v.AssertType=function(u,c,i){C(u instanceof c,i)},v.Assert=C}(K3||(K3={}));var Y0=function(v){Q(u,v);var C=a2(u);function u(){return B(this,u),C.apply(this,arguments)}return W(u)}(G4(Error));function O(v){throw new Y0("".concat(v," is null or undefined"))}var e1=function(){function v(){B(this,v),this.parent=null,this._debugMetadata=null,this._path=null}return W(v,[{key:"debugMetadata",get:function(){return null===this._debugMetadata&&this.parent?this.parent.debugMetadata:this._debugMetadata},set:function(C){this._debugMetadata=C}},{key:"ownDebugMetadata",get:function(){return this._debugMetadata}},{key:"DebugLineNumberOfPath",value:function(C){if(null===C)return null;var u=this.rootContentContainer;if(u){var c=u.ContentAtPath(C).obj;if(c){var i=c.debugMetadata;if(null!==i)return i.startLineNumber}}return null}},{key:"path",get:function(){if(null==this._path)if(null==this.parent)this._path=new Z2;else{for(var C=[],u=this,c=P(u.parent,C2);null!==c;){var i=Le(u);if(null!=i&&i.hasValidName){if(null===i.name)return O("namedChild.name");C.unshift(new Z2.Component(i.name))}else C.unshift(new Z2.Component(c.content.indexOf(u)));u=c,c=P(c.parent,C2)}this._path=new Z2(C)}return this._path}},{key:"ResolvePath",value:function(C){if(null===C)return O("path");if(C.isRelative){var u=P(this,C2);return null===u&&(K3.Assert(null!==this.parent,"Can't resolve relative path because we don't have a parent"),u=P(this.parent,C2),K3.Assert(null!==u,"Expected parent to be a container"),K3.Assert(C.GetComponent(0).isParent),C=C.tail),null===u?O("nearestContainer"):u.ContentAtPath(C)}var c=this.rootContentContainer;return null===c?O("contentContainer"):c.ContentAtPath(C)}},{key:"ConvertPathToRelative",value:function(C){for(var u=this.path,c=Math.min(C.length,u.length),i=-1,h=0;h<c;++h){var d=u.GetComponent(h),g=C.GetComponent(h);if(!d.Equals(g))break;i=h}if(-1==i)return C;for(var M=u.componentCount-1-i,H=[],m=0;m<M;++m)H.push(Z2.Component.ToParent());for(var L=i+1;L<C.componentCount;++L)H.push(C.GetComponent(L));return new Z2(H,!0)}},{key:"CompactPathString",value:function(C){var u=null,c=null;return C.isRelative?(c=C.componentsString,u=this.path.PathByAppendingPath(C).componentsString):(c=this.ConvertPathToRelative(C).componentsString,u=C.componentsString),c.length<u.length?c:u}},{key:"rootContentContainer",get:function(){for(var C=this;C.parent;)C=C.parent;return P(C,C2)}},{key:"Copy",value:function(){throw Error("Not Implemented: Doesn't support copying")}},{key:"SetChild",value:function(C,u,c){C[u]&&(C[u]=null),C[u]=c,C[u]&&(C[u].parent=this)}},{key:"Equals",value:function(C){return C===this}}]),v}(),f3=function(){function v(C){B(this,v),C=void 0!==C?C.toString():"",this.string=C}return W(v,[{key:"Length",get:function(){return this.string.length}},{key:"Append",value:function(C){null!==C&&(this.string+=C)}},{key:"AppendLine",value:function(C){void 0!==C&&this.Append(C),this.string+="\n"}},{key:"AppendFormat",value:function(C){for(var u=arguments.length,c=new Array(u>1?u-1:0),i=1;i<u;i++)c[i-1]=arguments[i];this.string+=C.replace(/{(\d+)}/g,function(h,d){return void 0!==c[d]?c[d]:h})}},{key:"toString",value:function(){return this.string}}]),v}(),t1=function(){function v(){if(B(this,v),this.originName=null,this.itemName=null,void 0!==arguments[1]){var u=arguments[1];this.originName=arguments[0],this.itemName=u}else if(arguments[0]){var i=arguments[0].toString().split(".");this.originName=i[0],this.itemName=i[1]}}return W(v,[{key:"isNull",get:function(){return null==this.originName&&null==this.itemName}},{key:"fullName",get:function(){return(null!==this.originName?this.originName:"?")+"."+this.itemName}},{key:"toString",value:function(){return this.fullName}},{key:"Equals",value:function(C){return C instanceof v&&C.itemName==this.itemName&&C.originName==this.originName}},{key:"copy",value:function(){return new v(this.originName,this.itemName)}},{key:"serialized",value:function(){return JSON.stringify({originName:this.originName,itemName:this.itemName})}}],[{key:"Null",get:function(){return new v(null,null)}},{key:"fromSerializedKey",value:function(C){var u=JSON.parse(C);return v.isLikeInkListItem(u)?new v(u.originName,u.itemName):v.Null}},{key:"isLikeInkListItem",value:function(C){return!("object"!==k2(C)||!C.hasOwnProperty("originName")||!C.hasOwnProperty("itemName")||"string"!=typeof C.originName&&null!==typeof C.originName||"string"!=typeof C.itemName&&null!==typeof C.itemName)}}]),v}(),s1=function(v){Q(u,v);var C=a2(u);function u(){var c,i=arguments;if(B(this,u),(c=C.call(this,i[0]instanceof u?i[0]:[])).origins=null,c._originNames=[],arguments[0]instanceof u){var h=arguments[0];c._originNames=h.originNames,null!==h.origins&&(c.origins=h.origins.slice())}else if("string"==typeof arguments[0]){var d=arguments[0],g=arguments[1];if(c.SetInitialOriginName(d),null===g.listDefinitions)return ye(c,O("originStory.listDefinitions"));var M=g.listDefinitions.TryListGetDefinition(d,null);if(!M.exists)throw new Error("InkList origin could not be found in story when constructing new list: "+d);if(null===M.result)return ye(c,O("def.result"));c.origins=[M.result]}else if("object"===k2(arguments[0])&&arguments[0].hasOwnProperty("Key")&&arguments[0].hasOwnProperty("Value")){var H=arguments[0];c.Add(H.Key,H.Value)}return c}return W(u,[{key:"AddItem",value:function(c){if(c instanceof t1){var i=c;if(null==i.originName)return void this.AddItem(i.itemName);if(null===this.origins)return O("this.origins");var h,d=N(this.origins);try{for(d.s();!(h=d.n()).done;){var g=h.value;if(g.name==i.originName){var M=g.TryGetValueForItem(i,0);if(M.exists)return void this.Add(i,M.result);throw new Error("Could not add the item "+i+" to this list because it doesn't exist in the original list definition in ink.")}}}catch(A){d.e(A)}finally{d.f()}throw new Error("Failed to add item to list because the item was from a new list definition that wasn't previously known to this list. Only items from previously known lists can be used, so that the int value can be found.")}var H=c,m=null;if(null===this.origins)return O("this.origins");var L,S=N(this.origins);try{for(S.s();!(L=S.n()).done;){var z=L.value;if(null===H)return O("itemName");if(z.ContainsItemWithName(H)){if(null!=m)throw new Error("Could not add the item "+H+" to this list because it could come from either "+z.name+" or "+m.name);m=z}}}catch(A){S.e(A)}finally{S.f()}if(null==m)throw new Error("Could not add the item "+H+" to this list because it isn't known to any list definitions previously associated with this list.");var _=new t1(m.name,H),E=m.ValueForItem(_);this.Add(_,E)}},{key:"ContainsItemNamed",value:function(c){var i,h=N(this);try{for(h.s();!(i=h.n()).done;){var d=y2(i.value,1)[0];if(t1.fromSerializedKey(d).itemName==c)return!0}}catch(g){h.e(g)}finally{h.f()}return!1}},{key:"ContainsKey",value:function(c){return this.has(c.serialized())}},{key:"Add",value:function(c,i){var h=c.serialized();if(this.has(h))throw new Error("The Map already contains an entry for ".concat(c));this.set(h,i)}},{key:"Remove",value:function(c){return this.delete(c.serialized())}},{key:"Count",get:function(){return this.size}},{key:"originOfMaxItem",get:function(){if(null==this.origins)return null;var c=this.maxItem.Key.originName,i=null;return this.origins.every(function(h){return h.name!=c||(i=h,!1)}),i}},{key:"originNames",get:function(){if(this.Count>0){null==this._originNames&&this.Count>0?this._originNames=[]:(this._originNames||(this._originNames=[]),this._originNames.length=0);var c,i=N(this);try{for(i.s();!(c=i.n()).done;){var h=y2(c.value,1)[0],d=t1.fromSerializedKey(h);if(null===d.originName)return O("item.originName");this._originNames.push(d.originName)}}catch(g){i.e(g)}finally{i.f()}}return this._originNames}},{key:"SetInitialOriginName",value:function(c){this._originNames=[c]}},{key:"SetInitialOriginNames",value:function(c){this._originNames=null==c?null:c.slice()}},{key:"maxItem",get:function(){var c,i={Key:t1.Null,Value:0},h=N(this);try{for(h.s();!(c=h.n()).done;){var d=y2(c.value,2),M=d[1],H=t1.fromSerializedKey(d[0]);(i.Key.isNull||M>i.Value)&&(i={Key:H,Value:M})}}catch(m){h.e(m)}finally{h.f()}return i}},{key:"minItem",get:function(){var c,i={Key:t1.Null,Value:0},h=N(this);try{for(h.s();!(c=h.n()).done;){var d=y2(c.value,2),M=d[1],H=t1.fromSerializedKey(d[0]);(i.Key.isNull||M<i.Value)&&(i={Key:H,Value:M})}}catch(m){h.e(m)}finally{h.f()}return i}},{key:"inverse",get:function(){var c=new u;if(null!=this.origins){var i,h=N(this.origins);try{for(h.s();!(i=h.n()).done;){var d,g=N(i.value.items);try{for(g.s();!(d=g.n()).done;){var M=y2(d.value,2),m=M[1],L=t1.fromSerializedKey(M[0]);this.ContainsKey(L)||c.Add(L,m)}}catch(S){g.e(S)}finally{g.f()}}}catch(S){h.e(S)}finally{h.f()}}return c}},{key:"all",get:function(){var c=new u;if(null!=this.origins){var i,h=N(this.origins);try{for(h.s();!(i=h.n()).done;){var d,g=N(i.value.items);try{for(g.s();!(d=g.n()).done;){var M=y2(d.value,2),m=M[1],L=t1.fromSerializedKey(M[0]);c.set(L.serialized(),m)}}catch(S){g.e(S)}finally{g.f()}}}catch(S){h.e(S)}finally{h.f()}}return c}},{key:"Union",value:function(c){var i,h=new u(this),d=N(c);try{for(d.s();!(i=d.n()).done;){var g=y2(i.value,2);h.set(g[0],g[1])}}catch(m){d.e(m)}finally{d.f()}return h}},{key:"Intersect",value:function(c){var i,h=new u,d=N(this);try{for(d.s();!(i=d.n()).done;){var g=y2(i.value,2),M=g[0],H=g[1];c.has(M)&&h.set(M,H)}}catch(m){d.e(m)}finally{d.f()}return h}},{key:"Without",value:function(c){var i,h=new u(this),d=N(c);try{for(d.s();!(i=d.n()).done;){var g=y2(i.value,1)[0];h.delete(g)}}catch(M){d.e(M)}finally{d.f()}return h}},{key:"Contains",value:function(c){var i,h=N(c);try{for(h.s();!(i=h.n()).done;){var d=y2(i.value,1)[0];if(!this.has(d))return!1}}catch(g){h.e(g)}finally{h.f()}return!0}},{key:"GreaterThan",value:function(c){return 0!=this.Count&&(0==c.Count||this.minItem.Value>c.maxItem.Value)}},{key:"GreaterThanOrEquals",value:function(c){return 0!=this.Count&&(0==c.Count||this.minItem.Value>=c.minItem.Value&&this.maxItem.Value>=c.maxItem.Value)}},{key:"LessThan",value:function(c){return 0!=c.Count&&(0==this.Count||this.maxItem.Value<c.minItem.Value)}},{key:"LessThanOrEquals",value:function(c){return 0!=c.Count&&(0==this.Count||this.maxItem.Value<=c.maxItem.Value&&this.minItem.Value<=c.minItem.Value)}},{key:"MaxAsList",value:function(){return this.Count>0?new u(this.maxItem):new u}},{key:"MinAsList",value:function(){return this.Count>0?new u(this.minItem):new u}},{key:"ListWithSubRange",value:function(c,i){if(0==this.Count)return new u;var h=this.orderedItems,d=0,g=Number.MAX_SAFE_INTEGER;Number.isInteger(c)?d=c:c instanceof u&&c.Count>0&&(d=c.minItem.Value),Number.isInteger(i)?g=i:c instanceof u&&c.Count>0&&(g=i.maxItem.Value);var M=new u;M.SetInitialOriginNames(this.originNames);var H,m=N(h);try{for(m.s();!(H=m.n()).done;){var L=H.value;L.Value>=d&&L.Value<=g&&M.Add(L.Key,L.Value)}}catch(S){m.e(S)}finally{m.f()}return M}},{key:"Equals",value:function(c){if(!(c instanceof u)||c.Count!=this.Count)return!1;var i,h=N(this);try{for(h.s();!(i=h.n()).done;){var d=y2(i.value,1)[0];if(!c.has(d))return!1}}catch(g){h.e(g)}finally{h.f()}return!0}},{key:"orderedItems",get:function(){var c,i=new Array,h=N(this);try{for(h.s();!(c=h.n()).done;){var d=y2(c.value,2),M=d[1],H=t1.fromSerializedKey(d[0]);i.push({Key:H,Value:M})}}catch(m){h.e(m)}finally{h.f()}return i.sort(function(m,L){return null===m.Key.originName?O("x.Key.originName"):null===L.Key.originName?O("y.Key.originName"):m.Value==L.Value?m.Key.originName.localeCompare(L.Key.originName):m.Value<L.Value?-1:m.Value>L.Value?1:0}),i}},{key:"toString",value:function(){for(var c=this.orderedItems,i=new f3,h=0;h<c.length;h++){h>0&&i.Append(", ");var d=c[h].Key;if(null===d.itemName)return O("item.itemName");i.Append(d.itemName)}return i.toString()}},{key:"valueOf",value:function(){return NaN}}],[{key:"FromString",value:function(c,i){var h,d=null===(h=i.listDefinitions)||void 0===h?void 0:h.FindSingleItemListWithName(c);if(d)return null===d.value?O("listValue.value"):new u(d.value);throw new Error("Could not find the InkListItem from the string '"+c+"' to create an InkList because it doesn't exist in the original list definition in ink.")}}]),u}(G4(Map)),c1=function(v){Q(u,v);var C=a2(u);function u(c){var i;return B(this,u),(i=C.call(this,c)).useEndLineNumber=!1,i.message=c,i.name="StoryException",i}return W(u)}(G4(Error));function h3(v,C,u){if(null===v)return{result:u,exists:!1};var c=v.get(C);return void 0===c?{result:u,exists:!1}:{result:c,exists:!0}}var o2,j2=function(v){Q(u,v);var C=a2(u);function u(c){var i;return B(this,u),(i=C.call(this)).value=c,i}return W(u,[{key:"valueObject",get:function(){return this.value}},{key:"toString",value:function(){return null===this.value?O("Value.value"):this.value.toString()}}]),u}(function(v){Q(u,v);var C=a2(u);function u(){return B(this,u),C.apply(this,arguments)}return W(u,[{key:"Copy",value:function(){return U2(u.Create(this.valueObject),e1)}},{key:"BadCastException",value:function(c){return new c1("Can't cast "+this.valueObject+" from "+this.valueType+" to "+c)}}],[{key:"Create",value:function(c,i){if(i){if(i===o2.Int&&Number.isInteger(Number(c)))return new w2(Number(c));if(i===o2.Float&&!isNaN(c))return new Q3(Number(c))}return"boolean"==typeof c?new q4(Boolean(c)):"string"==typeof c?new G2(String(c)):Number.isInteger(Number(c))?new w2(Number(c)):isNaN(c)?c instanceof Z2?new b3(U2(c,Z2)):c instanceof s1?new l1(U2(c,s1)):null:new Q3(Number(c))}}]),u}(e1)),q4=function(v){Q(u,v);var C=a2(u);function u(c){return B(this,u),C.call(this,c||!1)}return W(u,[{key:"isTruthy",get:function(){return Boolean(this.value)}},{key:"valueType",get:function(){return o2.Bool}},{key:"Cast",value:function(c){if(null===this.value)return O("Value.value");if(c==this.valueType)return this;if(c==o2.Int)return new w2(this.value?1:0);if(c==o2.Float)return new Q3(this.value?1:0);if(c==o2.String)return new G2(this.value?"true":"false");throw this.BadCastException(c)}},{key:"toString",value:function(){return this.value?"true":"false"}}]),u}(j2),w2=function(v){Q(u,v);var C=a2(u);function u(c){return B(this,u),C.call(this,c||0)}return W(u,[{key:"isTruthy",get:function(){return 0!=this.value}},{key:"valueType",get:function(){return o2.Int}},{key:"Cast",value:function(c){if(null===this.value)return O("Value.value");if(c==this.valueType)return this;if(c==o2.Bool)return new q4(0!==this.value);if(c==o2.Float)return new Q3(this.value);if(c==o2.String)return new G2(""+this.value);throw this.BadCastException(c)}}]),u}(j2),Q3=function(v){Q(u,v);var C=a2(u);function u(c){return B(this,u),C.call(this,c||0)}return W(u,[{key:"isTruthy",get:function(){return 0!=this.value}},{key:"valueType",get:function(){return o2.Float}},{key:"Cast",value:function(c){if(null===this.value)return O("Value.value");if(c==this.valueType)return this;if(c==o2.Bool)return new q4(0!==this.value);if(c==o2.Int)return new w2(this.value);if(c==o2.String)return new G2(""+this.value);throw this.BadCastException(c)}}]),u}(j2),G2=function(v){Q(u,v);var C=a2(u);function u(c){var i;return B(this,u),(i=C.call(this,c||""))._isNewline="\n"==i.value,i._isInlineWhitespace=!0,null===i.value?ye(i,O("Value.value")):(i.value.length>0&&i.value.split("").every(function(h){return" "==h||"\t"==h||(i._isInlineWhitespace=!1,!1)}),i)}return W(u,[{key:"valueType",get:function(){return o2.String}},{key:"isTruthy",get:function(){return null===this.value?O("Value.value"):this.value.length>0}},{key:"isNewline",get:function(){return this._isNewline}},{key:"isInlineWhitespace",get:function(){return this._isInlineWhitespace}},{key:"isNonWhitespace",get:function(){return!this.isNewline&&!this.isInlineWhitespace}},{key:"Cast",value:function(c){if(c==this.valueType)return this;if(c==o2.Int){var i=function(d){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,M=parseInt(d);return Number.isNaN(M)?{result:g,exists:!1}:{result:M,exists:!0}}(this.value);if(i.exists)return new w2(i.result);throw this.BadCastException(c)}if(c==o2.Float){var h=function(d){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,M=parseFloat(d);return Number.isNaN(M)?{result:g,exists:!1}:{result:M,exists:!0}}(this.value);if(h.exists)return new Q3(h.result);throw this.BadCastException(c)}throw this.BadCastException(c)}}]),u}(j2),b3=function(v){Q(u,v);var C=a2(u);function u(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return B(this,u),C.call(this,c)}return W(u,[{key:"valueType",get:function(){return o2.DivertTarget}},{key:"targetPath",get:function(){return null===this.value?O("Value.value"):this.value},set:function(c){this.value=c}},{key:"isTruthy",get:function(){throw new Error("Shouldn't be checking the truthiness of a divert target")}},{key:"Cast",value:function(c){if(c==this.valueType)return this;throw this.BadCastException(c)}},{key:"toString",value:function(){return"DivertTargetValue("+this.targetPath+")"}}]),u}(j2),l4=function(v){Q(u,v);var C=a2(u);function u(c){var i,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return B(this,u),(i=C.call(this,c))._contextIndex=h,i}return W(u,[{key:"contextIndex",get:function(){return this._contextIndex},set:function(c){this._contextIndex=c}},{key:"variableName",get:function(){return null===this.value?O("Value.value"):this.value},set:function(c){this.value=c}},{key:"valueType",get:function(){return o2.VariablePointer}},{key:"isTruthy",get:function(){throw new Error("Shouldn't be checking the truthiness of a variable pointer")}},{key:"Cast",value:function(c){if(c==this.valueType)return this;throw this.BadCastException(c)}},{key:"toString",value:function(){return"VariablePointerValue("+this.variableName+")"}},{key:"Copy",value:function(){return new u(this.variableName,this.contextIndex)}}]),u}(j2),l1=function(v){Q(u,v);var C=a2(u);function u(c,i){var h;return B(this,u),h=C.call(this,null),c||i?c instanceof s1?h.value=new s1(c):c instanceof t1&&"number"==typeof i&&(h.value=new s1({Key:c,Value:i})):h.value=new s1,h}return W(u,[{key:"isTruthy",get:function(){return null===this.value?O("this.value"):this.value.Count>0}},{key:"valueType",get:function(){return o2.List}},{key:"Cast",value:function(c){if(null===this.value)return O("Value.value");if(c==o2.Int){var i=this.value.maxItem;return new w2(i.Key.isNull?0:i.Value)}if(c==o2.Float){var h=this.value.maxItem;return new Q3(h.Key.isNull?0:h.Value)}if(c==o2.String){var d=this.value.maxItem;return new G2(d.Key.isNull?"":d.Key.toString())}if(c==this.valueType)return this;throw this.BadCastException(c)}}],[{key:"RetainListOriginsForAssignment",value:function(c,i){var h=P(c,u),d=P(i,u);return d&&null===d.value?O("newList.value"):h&&null===h.value?O("oldList.value"):void(h&&d&&0==d.value.Count&&d.value.SetInitialOriginNames(h.value.originNames))}}]),u}(j2);!function(v){v[v.Bool=-1]="Bool",v[v.Int=0]="Int",v[v.Float=1]="Float",v[v.List=2]="List",v[v.String=3]="String",v[v.DivertTarget=4]="DivertTarget",v[v.VariablePointer=5]="VariablePointer"}(o2||(o2={}));var eo=function(){function v(){B(this,v),this.obj=null,this.approximate=!1}return W(v,[{key:"correctObj",get:function(){return this.approximate?null:this.obj}},{key:"container",get:function(){return this.obj instanceof C2?this.obj:null}},{key:"copy",value:function(){var C=new v;return C.obj=this.obj,C.approximate=this.approximate,C}}]),v}(),C2=function(v){Q(u,v);var C=a2(u);function u(){var c;return B(this,u),(c=C.apply(this,arguments)).name=null,c._content=[],c.namedContent=new Map,c.visitsShouldBeCounted=!1,c.turnIndexShouldBeCounted=!1,c.countingAtStartOnly=!1,c._pathToFirstLeafContent=null,c}return W(u,[{key:"hasValidName",get:function(){return null!=this.name&&this.name.length>0}},{key:"content",get:function(){return this._content},set:function(c){this.AddContent(c)}},{key:"namedOnlyContent",get:function(){var c,i=new Map,h=N(this.namedContent);try{for(h.s();!(c=h.n()).done;){var d=y2(c.value,2),g=d[0],M=U2(d[1],e1);i.set(g,M)}}catch(S){h.e(S)}finally{h.f()}var H,m=N(this.content);try{for(m.s();!(H=m.n()).done;){var L=Le(H.value);null!=L&&L.hasValidName&&i.delete(L.name)}}catch(S){m.e(S)}finally{m.f()}return 0==i.size&&(i=null),i},set:function(c){var i=this.namedOnlyContent;if(null!=i){var h,d=N(i);try{for(d.s();!(h=d.n()).done;){var g=y2(h.value,1)[0];this.namedContent.delete(g)}}catch(L){d.e(L)}finally{d.f()}}if(null!=c){var M,H=N(c);try{for(H.s();!(M=H.n()).done;){var m=Le(y2(M.value,2)[1]);null!=m&&this.AddToNamedContentOnly(m)}}catch(L){H.e(L)}finally{H.f()}}}},{key:"countFlags",get:function(){var c=0;return this.visitsShouldBeCounted&&(c|=u.CountFlags.Visits),this.turnIndexShouldBeCounted&&(c|=u.CountFlags.Turns),this.countingAtStartOnly&&(c|=u.CountFlags.CountStartOnly),c==u.CountFlags.CountStartOnly&&(c=0),c},set:function(c){var i=c;(i&u.CountFlags.Visits)>0&&(this.visitsShouldBeCounted=!0),(i&u.CountFlags.Turns)>0&&(this.turnIndexShouldBeCounted=!0),(i&u.CountFlags.CountStartOnly)>0&&(this.countingAtStartOnly=!0)}},{key:"pathToFirstLeafContent",get:function(){return null==this._pathToFirstLeafContent&&(this._pathToFirstLeafContent=this.path.PathByAppendingPath(this.internalPathToFirstLeafContent)),this._pathToFirstLeafContent}},{key:"internalPathToFirstLeafContent",get:function(){for(var c=[],i=this;i instanceof u;)i.content.length>0&&(c.push(new Z2.Component(0)),i=i.content[0]);return new Z2(c)}},{key:"AddContent",value:function(c){if(c instanceof Array){var i,h=N(c);try{for(h.s();!(i=h.n()).done;)this.AddContent(i.value)}catch(M){h.e(M)}finally{h.f()}}else{var g=c;if(this._content.push(g),g.parent)throw new Error("content is already in "+g.parent);g.parent=this,this.TryAddNamedContent(g)}}},{key:"TryAddNamedContent",value:function(c){var i=Le(c);null!=i&&i.hasValidName&&this.AddToNamedContentOnly(i)}},{key:"AddToNamedContentOnly",value:function(c){if(K3.AssertType(c,e1,"Can only add Runtime.Objects to a Runtime.Container"),U2(c,e1).parent=this,null===c.name)return O("namedContentObj.name");this.namedContent.set(c.name,c)}},{key:"ContentAtPath",value:function(c){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;-1==h&&(h=c.length);var d=new eo;d.approximate=!1;for(var g=this,M=this,H=i;H<h;++H){var m=c.GetComponent(H);if(null==g){d.approximate=!0;break}var L=g.ContentWithPathComponent(m);if(null==L){d.approximate=!0;break}M=L,g=P(L,u)}return d.obj=M,d}},{key:"InsertContent",value:function(c,i){if(this.content.splice(i,0,c),c.parent)throw new Error("content is already in "+c.parent);c.parent=this,this.TryAddNamedContent(c)}},{key:"AddContentsOfContainer",value:function(c){var i;(i=this.content).push.apply(i,p1(c.content));var h,d=N(c.content);try{for(d.s();!(h=d.n()).done;){var g=h.value;g.parent=this,this.TryAddNamedContent(g)}}catch(M){d.e(M)}finally{d.f()}}},{key:"ContentWithPathComponent",value:function(c){if(c.isIndex)return c.index>=0&&c.index<this.content.length?this.content[c.index]:null;if(c.isParent)return this.parent;if(null===c.name)return O("component.name");var i=h3(this.namedContent,c.name,null);return i.exists?U2(i.result,e1):null}},{key:"BuildStringOfHierarchy",value:function(){var c;if(0==arguments.length)return c=new f3,this.BuildStringOfHierarchy(c,0,null),c.toString();c=arguments[0];var i=arguments[1],h=arguments[2];function d(){for(var m2=0;m2<4*i;++m2)c.Append(" ")}d(),c.Append("["),this.hasValidName&&c.AppendFormat(" ({0})",this.name),this==h&&c.Append("  <---"),c.AppendLine(),i++;for(var g=0;g<this.content.length;++g){var M=this.content[g];M instanceof u?M.BuildStringOfHierarchy(c,i,h):(d(),M instanceof G2?(c.Append('"'),c.Append(M.toString().replace("\n","\\n")),c.Append('"')):c.Append(M.toString())),g!=this.content.length-1&&c.Append(","),M instanceof u||M!=h||c.Append("  <---"),c.AppendLine()}var m,L=new Map,S=N(this.namedContent);try{for(S.s();!(m=S.n()).done;){var z=y2(m.value,2),_=z[0],E=z[1];this.content.indexOf(U2(E,e1))>=0||L.set(_,E)}}catch(m2){S.e(m2)}finally{S.f()}if(L.size>0){d(),c.AppendLine("-- named: --");var A,R=N(L);try{for(R.s();!(A=R.n()).done;){var u2=y2(A.value,2)[1];K3.AssertType(u2,u,"Can only print out named Containers"),u2.BuildStringOfHierarchy(c,i,h),c.AppendLine()}}catch(m2){R.e(m2)}finally{R.f()}}i--,d(),c.Append("]")}}]),u}(e1);!function(v){var C;(C=v.CountFlags||(v.CountFlags={}))[C.Visits=1]="Visits",C[C.Turns=2]="Turns",C[C.CountStartOnly=4]="CountStartOnly"}(C2||(C2={}));var I=function(v){Q(u,v);var C=a2(u);function u(){var c,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.CommandType.NotSet;return B(this,u),(c=C.call(this))._commandType=i,c}return W(u,[{key:"commandType",get:function(){return this._commandType}},{key:"Copy",value:function(){return new u(this.commandType)}},{key:"toString",value:function(){return this.commandType.toString()}}],[{key:"EvalStart",value:function(){return new u(u.CommandType.EvalStart)}},{key:"EvalOutput",value:function(){return new u(u.CommandType.EvalOutput)}},{key:"EvalEnd",value:function(){return new u(u.CommandType.EvalEnd)}},{key:"Duplicate",value:function(){return new u(u.CommandType.Duplicate)}},{key:"PopEvaluatedValue",value:function(){return new u(u.CommandType.PopEvaluatedValue)}},{key:"PopFunction",value:function(){return new u(u.CommandType.PopFunction)}},{key:"PopTunnel",value:function(){return new u(u.CommandType.PopTunnel)}},{key:"BeginString",value:function(){return new u(u.CommandType.BeginString)}},{key:"EndString",value:function(){return new u(u.CommandType.EndString)}},{key:"NoOp",value:function(){return new u(u.CommandType.NoOp)}},{key:"ChoiceCount",value:function(){return new u(u.CommandType.ChoiceCount)}},{key:"Turns",value:function(){return new u(u.CommandType.Turns)}},{key:"TurnsSince",value:function(){return new u(u.CommandType.TurnsSince)}},{key:"ReadCount",value:function(){return new u(u.CommandType.ReadCount)}},{key:"Random",value:function(){return new u(u.CommandType.Random)}},{key:"SeedRandom",value:function(){return new u(u.CommandType.SeedRandom)}},{key:"VisitIndex",value:function(){return new u(u.CommandType.VisitIndex)}},{key:"SequenceShuffleIndex",value:function(){return new u(u.CommandType.SequenceShuffleIndex)}},{key:"StartThread",value:function(){return new u(u.CommandType.StartThread)}},{key:"Done",value:function(){return new u(u.CommandType.Done)}},{key:"End",value:function(){return new u(u.CommandType.End)}},{key:"ListFromInt",value:function(){return new u(u.CommandType.ListFromInt)}},{key:"ListRange",value:function(){return new u(u.CommandType.ListRange)}},{key:"ListRandom",value:function(){return new u(u.CommandType.ListRandom)}}]),u}(e1);!function(v){var C;(C=v.CommandType||(v.CommandType={}))[C.NotSet=-1]="NotSet",C[C.EvalStart=0]="EvalStart",C[C.EvalOutput=1]="EvalOutput",C[C.EvalEnd=2]="EvalEnd",C[C.Duplicate=3]="Duplicate",C[C.PopEvaluatedValue=4]="PopEvaluatedValue",C[C.PopFunction=5]="PopFunction",C[C.PopTunnel=6]="PopTunnel",C[C.BeginString=7]="BeginString",C[C.EndString=8]="EndString",C[C.NoOp=9]="NoOp",C[C.ChoiceCount=10]="ChoiceCount",C[C.Turns=11]="Turns",C[C.TurnsSince=12]="TurnsSince",C[C.Random=13]="Random",C[C.SeedRandom=14]="SeedRandom",C[C.VisitIndex=15]="VisitIndex",C[C.SequenceShuffleIndex=16]="SequenceShuffleIndex",C[C.StartThread=17]="StartThread",C[C.Done=18]="Done",C[C.End=19]="End",C[C.ListFromInt=20]="ListFromInt",C[C.ListRange=21]="ListRange",C[C.ListRandom=22]="ListRandom",C[C.ReadCount=23]="ReadCount",C[C.TOTAL_VALUES=24]="TOTAL_VALUES"}(I||(I={}));var Y1=function(v){Q(u,v);var C=a2(u);function u(){var c;return B(this,u),(c=C.apply(this,arguments))._prototypeRuntimeConstantExpression=null,c.outputWhenComplete=!1,c.GenerateRuntimeObject=function(){var i=new C2;return i.AddContent(I.EvalStart()),c.GenerateIntoContainer(i),c.outputWhenComplete&&i.AddContent(I.EvalOutput()),i.AddContent(I.EvalEnd()),i},c.GenerateConstantIntoContainer=function(i){null===c._prototypeRuntimeConstantExpression&&(c._prototypeRuntimeConstantExpression=new C2,c.GenerateIntoContainer(c._prototypeRuntimeConstantExpression));var h,d=N(c._prototypeRuntimeConstantExpression.content);try{for(d.s();!(h=d.n()).done;){var g=h.value.Copy();g&&i.AddContent(g)}}catch(M){d.e(M)}finally{d.f()}},c.toString=function(){return"No string value in JavaScript."},c}return W(u,[{key:"typeName",get:function(){return"Expression"}},{key:"Equals",value:function(c){return!1}}]),u}(E2),E3=function(v){Q(u,v);var C=a2(u);function u(){return B(this,u),C.apply(this,arguments)}return W(u)}(e1),v2=function(v){Q(u,v);var C=a2(u);function u(){var c;if(B(this,u),(c=C.call(this))._name=null,c._numberOfParameters=0,c._prototype=null,c._isPrototype=!1,c._operationFuncs=null,0===arguments.length)u.GenerateNativeFunctionsIfNecessary();else if(1===arguments.length){var i=arguments[0];u.GenerateNativeFunctionsIfNecessary(),c.name=i}else if(2===arguments.length){var h=arguments[0],d=arguments[1];c._isPrototype=!0,c.name=h,c.numberOfParameters=d}return c}return W(u,[{key:"name",get:function(){return null===this._name?O("NativeFunctionCall._name"):this._name},set:function(c){this._name=c,this._isPrototype||(null===u._nativeFunctions?O("NativeFunctionCall._nativeFunctions"):this._prototype=u._nativeFunctions.get(this._name)||null)}},{key:"numberOfParameters",get:function(){return this._prototype?this._prototype.numberOfParameters:this._numberOfParameters},set:function(c){this._numberOfParameters=c}},{key:"Call",value:function(c){if(this._prototype)return this._prototype.Call(c);if(this.numberOfParameters!=c.length)throw new Error("Unexpected number of parameters");var i,h=!1,d=N(c);try{for(d.s();!(i=d.n()).done;){var g=i.value;if(g instanceof E3)throw new c1('Attempting to perform operation on a void value. Did you forget to "return" a value from a function you called here?');g instanceof l1&&(h=!0)}}catch(m){d.e(m)}finally{d.f()}if(2==c.length&&h)return this.CallBinaryListOperation(c);var M=this.CoerceValuesToSingleType(c),H=M[0].valueType;return H==o2.Int||H==o2.Float||H==o2.String||H==o2.DivertTarget||H==o2.List?this.CallType(M):null}},{key:"CallType",value:function(c){var i=U2(c[0],j2),h=i.valueType,d=i,g=c.length;if(2==g||1==g){if(null===this._operationFuncs)return O("NativeFunctionCall._operationFuncs");var M=this._operationFuncs.get(h);if(!M)throw new c1("Cannot perform operation "+this.name+" on "+o2[h]);if(2==g){var m=U2(c[1],j2),L=M;if(null===d.value||null===m.value)return O("NativeFunctionCall.Call BinaryOp values");var S=L(d.value,m.value);return j2.Create(S)}var z=M;if(null===d.value)return O("NativeFunctionCall.Call UnaryOp value");var _=z(d.value);return j2.Create(_,this.name===u.Int?o2.Int:this.name===u.Float?o2.Float:i.valueType)}throw new Error("Unexpected number of parameters to NativeFunctionCall: "+c.length)}},{key:"CallBinaryListOperation",value:function(c){if(("+"==this.name||"-"==this.name)&&c[0]instanceof l1&&c[1]instanceof w2)return this.CallListIncrementOperation(c);var i=U2(c[0],j2),h=U2(c[1],j2);if(!("&&"!=this.name&&"||"!=this.name||i.valueType==o2.List&&h.valueType==o2.List)){if(null===this._operationFuncs)return O("NativeFunctionCall._operationFuncs");var d=this._operationFuncs.get(o2.Int);if(null===d)return O("NativeFunctionCall.CallBinaryListOperation op");var g=function(M){if("boolean"==typeof M)return M;throw new Error("".concat(M," is not a boolean"))}(d(i.isTruthy?1:0,h.isTruthy?1:0));return new q4(g)}if(i.valueType==o2.List&&h.valueType==o2.List)return this.CallType([i,h]);throw new c1("Can not call use "+this.name+" operation on "+o2[i.valueType]+" and "+o2[h.valueType])}},{key:"CallListIncrementOperation",value:function(c){var i=U2(c[0],l1),h=U2(c[1],w2),d=new s1;if(null===i.value)return O("NativeFunctionCall.CallListIncrementOperation listVal.value");var g,M=N(i.value);try{for(M.s();!(g=M.n()).done;){var H=y2(g.value,2),L=H[1],S=t1.fromSerializedKey(H[0]);if(null===this._operationFuncs)return O("NativeFunctionCall._operationFuncs");var z=this._operationFuncs.get(o2.Int);if(null===h.value)return O("NativeFunctionCall.CallListIncrementOperation intVal.value");var _=z(L,h.value),E=null;if(null===i.value.origins)return O("NativeFunctionCall.CallListIncrementOperation listVal.value.origins");var A,R=N(i.value.origins);try{for(R.s();!(A=R.n()).done;){var K=A.value;if(K.name==S.originName){E=K;break}}}catch(f2){R.e(f2)}finally{R.f()}if(null!=E){var u2=E.TryGetItemWithValue(_,t1.Null);u2.exists&&d.Add(u2.result,_)}}}catch(f2){M.e(f2)}finally{M.f()}return new l1(d)}},{key:"CoerceValuesToSingleType",value:function(c){var i,h=o2.Int,d=null,g=N(c);try{for(g.s();!(i=g.n()).done;){var M=U2(i.value,j2);M.valueType>h&&(h=M.valueType),M.valueType==o2.List&&(d=P(M,l1))}}catch(m2){g.e(m2)}finally{g.f()}var H=[];if(o2[h]==o2[o2.List]){var m,L=N(c);try{for(L.s();!(m=L.n()).done;){var S=U2(m.value,j2);if(S.valueType==o2.List)H.push(S);else{if(S.valueType!=o2.Int)throw new c1("Cannot mix Lists and "+o2[S.valueType]+" values in this operation");var _=parseInt(S.valueObject);if(null===(d=U2(d,l1)).value)return O("NativeFunctionCall.CoerceValuesToSingleType specialCaseList.value");var E=d.value.originOfMaxItem;if(null===E)return O("NativeFunctionCall.CoerceValuesToSingleType list");var A=E.TryGetItemWithValue(_,t1.Null);if(!A.exists)throw new c1("Could not find List item with the value "+_+" in "+E.name);var R=new l1(A.result,_);H.push(R)}}}catch(m2){L.e(m2)}finally{L.f()}}else{var K,u2=N(c);try{for(u2.s();!(K=u2.n()).done;){var f2=U2(K.value,j2).Cast(h);H.push(f2)}}catch(m2){u2.e(m2)}finally{u2.f()}}return H}},{key:"AddOpFuncForType",value:function(c,i){null==this._operationFuncs&&(this._operationFuncs=new Map),this._operationFuncs.set(c,i)}},{key:"toString",value:function(){return'Native "'+this.name+'"'}}],[{key:"CallWithName",value:function(c){return new u(c)}},{key:"CallExistsWithName",value:function(c){return this.GenerateNativeFunctionsIfNecessary(),this._nativeFunctions.get(c)}},{key:"Identity",value:function(c){return c}},{key:"GenerateNativeFunctionsIfNecessary",value:function(){null==this._nativeFunctions&&(this._nativeFunctions=new Map,this.AddIntBinaryOp(this.Add,function(c,i){return c+i}),this.AddIntBinaryOp(this.Subtract,function(c,i){return c-i}),this.AddIntBinaryOp(this.Multiply,function(c,i){return c*i}),this.AddIntBinaryOp(this.Divide,function(c,i){return Math.floor(c/i)}),this.AddIntBinaryOp(this.Mod,function(c,i){return c%i}),this.AddIntUnaryOp(this.Negate,function(c){return-c}),this.AddIntBinaryOp(this.Equal,function(c,i){return c==i}),this.AddIntBinaryOp(this.Greater,function(c,i){return c>i}),this.AddIntBinaryOp(this.Less,function(c,i){return c<i}),this.AddIntBinaryOp(this.GreaterThanOrEquals,function(c,i){return c>=i}),this.AddIntBinaryOp(this.LessThanOrEquals,function(c,i){return c<=i}),this.AddIntBinaryOp(this.NotEquals,function(c,i){return c!=i}),this.AddIntUnaryOp(this.Not,function(c){return 0==c}),this.AddIntBinaryOp(this.And,function(c,i){return 0!=c&&0!=i}),this.AddIntBinaryOp(this.Or,function(c,i){return 0!=c||0!=i}),this.AddIntBinaryOp(this.Max,function(c,i){return Math.max(c,i)}),this.AddIntBinaryOp(this.Min,function(c,i){return Math.min(c,i)}),this.AddIntBinaryOp(this.Pow,function(c,i){return Math.pow(c,i)}),this.AddIntUnaryOp(this.Floor,u.Identity),this.AddIntUnaryOp(this.Ceiling,u.Identity),this.AddIntUnaryOp(this.Int,u.Identity),this.AddIntUnaryOp(this.Float,function(c){return c}),this.AddFloatBinaryOp(this.Add,function(c,i){return c+i}),this.AddFloatBinaryOp(this.Subtract,function(c,i){return c-i}),this.AddFloatBinaryOp(this.Multiply,function(c,i){return c*i}),this.AddFloatBinaryOp(this.Divide,function(c,i){return c/i}),this.AddFloatBinaryOp(this.Mod,function(c,i){return c%i}),this.AddFloatUnaryOp(this.Negate,function(c){return-c}),this.AddFloatBinaryOp(this.Equal,function(c,i){return c==i}),this.AddFloatBinaryOp(this.Greater,function(c,i){return c>i}),this.AddFloatBinaryOp(this.Less,function(c,i){return c<i}),this.AddFloatBinaryOp(this.GreaterThanOrEquals,function(c,i){return c>=i}),this.AddFloatBinaryOp(this.LessThanOrEquals,function(c,i){return c<=i}),this.AddFloatBinaryOp(this.NotEquals,function(c,i){return c!=i}),this.AddFloatUnaryOp(this.Not,function(c){return 0==c}),this.AddFloatBinaryOp(this.And,function(c,i){return 0!=c&&0!=i}),this.AddFloatBinaryOp(this.Or,function(c,i){return 0!=c||0!=i}),this.AddFloatBinaryOp(this.Max,function(c,i){return Math.max(c,i)}),this.AddFloatBinaryOp(this.Min,function(c,i){return Math.min(c,i)}),this.AddFloatBinaryOp(this.Pow,function(c,i){return Math.pow(c,i)}),this.AddFloatUnaryOp(this.Floor,function(c){return Math.floor(c)}),this.AddFloatUnaryOp(this.Ceiling,function(c){return Math.ceil(c)}),this.AddFloatUnaryOp(this.Int,function(c){return Math.floor(c)}),this.AddFloatUnaryOp(this.Float,u.Identity),this.AddStringBinaryOp(this.Add,function(c,i){return c+i}),this.AddStringBinaryOp(this.Equal,function(c,i){return c===i}),this.AddStringBinaryOp(this.NotEquals,function(c,i){return c!==i}),this.AddStringBinaryOp(this.Has,function(c,i){return c.includes(i)}),this.AddStringBinaryOp(this.Hasnt,function(c,i){return!c.includes(i)}),this.AddListBinaryOp(this.Add,function(c,i){return c.Union(i)}),this.AddListBinaryOp(this.Subtract,function(c,i){return c.Without(i)}),this.AddListBinaryOp(this.Has,function(c,i){return c.Contains(i)}),this.AddListBinaryOp(this.Hasnt,function(c,i){return!c.Contains(i)}),this.AddListBinaryOp(this.Intersect,function(c,i){return c.Intersect(i)}),this.AddListBinaryOp(this.Equal,function(c,i){return c.Equals(i)}),this.AddListBinaryOp(this.Greater,function(c,i){return c.GreaterThan(i)}),this.AddListBinaryOp(this.Less,function(c,i){return c.LessThan(i)}),this.AddListBinaryOp(this.GreaterThanOrEquals,function(c,i){return c.GreaterThanOrEquals(i)}),this.AddListBinaryOp(this.LessThanOrEquals,function(c,i){return c.LessThanOrEquals(i)}),this.AddListBinaryOp(this.NotEquals,function(c,i){return!c.Equals(i)}),this.AddListBinaryOp(this.And,function(c,i){return c.Count>0&&i.Count>0}),this.AddListBinaryOp(this.Or,function(c,i){return c.Count>0||i.Count>0}),this.AddListUnaryOp(this.Not,function(c){return 0==c.Count?1:0}),this.AddListUnaryOp(this.Invert,function(c){return c.inverse}),this.AddListUnaryOp(this.All,function(c){return c.all}),this.AddListUnaryOp(this.ListMin,function(c){return c.MinAsList()}),this.AddListUnaryOp(this.ListMax,function(c){return c.MaxAsList()}),this.AddListUnaryOp(this.Count,function(c){return c.Count}),this.AddListUnaryOp(this.ValueOfList,function(c){return c.maxItem.Value}),this.AddOpToNativeFunc(this.Equal,2,o2.DivertTarget,function(c,i){return c.Equals(i)}),this.AddOpToNativeFunc(this.NotEquals,2,o2.DivertTarget,function(c,i){return!c.Equals(i)}))}},{key:"AddOpToNativeFunc",value:function(c,i,h,d){if(null===this._nativeFunctions)return O("NativeFunctionCall._nativeFunctions");var g=this._nativeFunctions.get(c);g||(g=new u(c,i),this._nativeFunctions.set(c,g)),g.AddOpFuncForType(h,d)}},{key:"AddIntBinaryOp",value:function(c,i){this.AddOpToNativeFunc(c,2,o2.Int,i)}},{key:"AddIntUnaryOp",value:function(c,i){this.AddOpToNativeFunc(c,1,o2.Int,i)}},{key:"AddFloatBinaryOp",value:function(c,i){this.AddOpToNativeFunc(c,2,o2.Float,i)}},{key:"AddFloatUnaryOp",value:function(c,i){this.AddOpToNativeFunc(c,1,o2.Float,i)}},{key:"AddStringBinaryOp",value:function(c,i){this.AddOpToNativeFunc(c,2,o2.String,i)}},{key:"AddListBinaryOp",value:function(c,i){this.AddOpToNativeFunc(c,2,o2.List,i)}},{key:"AddListUnaryOp",value:function(c,i){this.AddOpToNativeFunc(c,1,o2.List,i)}}]),u}(e1);v2.Add="+",v2.Subtract="-",v2.Divide="/",v2.Multiply="*",v2.Mod="%",v2.Negate="_",v2.Equal="==",v2.Greater=">",v2.Less="<",v2.GreaterThanOrEquals=">=",v2.LessThanOrEquals="<=",v2.NotEquals="!=",v2.Not="!",v2.And="&&",v2.Or="||",v2.Min="MIN",v2.Max="MAX",v2.Pow="POW",v2.Floor="FLOOR",v2.Ceiling="CEILING",v2.Int="INT",v2.Float="FLOAT",v2.Has="?",v2.Hasnt="!?",v2.Intersect="^",v2.ListMin="LIST_MIN",v2.ListMax="LIST_MAX",v2.All="LIST_ALL",v2.Count="LIST_COUNT",v2.ValueOfList="LIST_VALUE",v2.Invert="LIST_INVERT",v2._nativeFunctions=null;var d3=function(v){Q(u,v);var C=a2(u);function u(c,i){var h;if(B(this,u),(h=C.call(this)).isInt=function(){return"int"==h.subtype},h.isFloat=function(){return"float"==h.subtype},h.isBool=function(){return"bool"==h.subtype},h.GenerateIntoContainer=function(d){h.isInt()?d.AddContent(new w2(h.value)):h.isFloat()?d.AddContent(new Q3(h.value)):h.isBool()&&d.AddContent(new q4(h.value))},h.toString=function(){return String(h.value)},("number"!=typeof c||Number.isNaN(c))&&"boolean"!=typeof c)throw new Error("Unexpected object type in NumberExpression.");return h.value=c,h.subtype=i,h}return W(u,[{key:"typeName",get:function(){return"Number"}},{key:"Equals",value:function(c){var i=P(c,u);return!!i&&i.subtype==this.subtype&&i.value==this.value}}]),u}(Y1),O5=function(v){Q(u,v);var C=a2(u);function u(c,i){var h;return B(this,u),(h=C.call(this)).op=i,h.GenerateIntoContainer=function(d){h.innerExpression.GenerateIntoContainer(d),d.AddContent(v2.CallWithName(h.nativeNameForOp))},h.toString=function(){return h.nativeNameForOp+h.innerExpression},h.innerExpression=h.AddContent(c),h}return W(u,[{key:"nativeNameForOp",get:function(){return"-"===this.op?"_":"not"===this.op?"!":this.op}},{key:"typeName",get:function(){return"UnaryExpression"}}]),u}(Y1);O5.WithInner=function(v,C){var u=P(v,d3);if(u){if("-"===C){if(u.isInt())return new d3(-u.value,"int");if(u.isFloat())return new d3(-u.value,"float")}else if("!"==C||"not"==C){if(u.isInt())return new d3(0==u.value,"bool");if(u.isFloat())return new d3(0==u.value,"bool");if(u.isBool())return new d3(!u.value,"bool")}throw new Error("Unexpected operation or number type")}return new O5(v,C)};var _4=function(v){Q(u,v);var C=a2(u);function u(c,i,h){var d;return B(this,u),(d=C.call(this)).opName=h,d.GenerateIntoContainer=function(g){d.leftExpression.GenerateIntoContainer(g),d.rightExpression.GenerateIntoContainer(g),d.opName=d.NativeNameForOp(d.opName),g.AddContent(v2.CallWithName(d.opName))},d.NativeNameForOp=function(g){return"and"===g?"&&":"or"===g?"||":"mod"===g?"%":"has"===g?"?":"hasnt"===g?"!?":g},d.toString=function(){return"(".concat(d.leftExpression," ").concat(d.opName," ").concat(d.rightExpression,")")},d.leftExpression=d.AddContent(c),d.rightExpression=d.AddContent(i),d.opName=h,d}return W(u,[{key:"typeName",get:function(){return"BinaryExpression"}},{key:"ResolveReferences",value:function(c){if(J2(I2(u.prototype),"ResolveReferences",this).call(this,c),"?"===this.NativeNameForOp(this.opName)){var i=P(this.leftExpression,O5);null===i||"not"!==i.op&&"!"!==i.op||this.Error("Using 'not' or '!' here negates '".concat(i.innerExpression,"' rather than the result of the '?' or 'has' operator. You need to add parentheses around the (A ? B) expression."))}}}]),u}(Y1),n1=W(function v(C){var u=this;B(this,v),this.set=new Set,this.Add=function(c){return u.set.add(c)},this.AddRange=function(c,i){for(var h=c.charCodeAt(0);h<=i.charCodeAt(0);++h)u.Add(String.fromCharCode(h));return u},this.AddCharacters=function(c){if("string"==typeof c||Array.isArray(c)){var i,h=N(c);try{for(h.s();!(i=h.n()).done;)u.Add(i.value)}catch(m){h.e(m)}finally{h.f()}}else{var g,M=N(c.set);try{for(M.s();!(g=M.n()).done;)u.Add(g.value)}catch(m){M.e(m)}finally{M.f()}}return u},C&&this.AddCharacters(C)});n1.FromRange=function(v,C){return(new n1).AddRange(v,C)};var Y3=function(){function v(C,u){var c=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(B(this,v),this._start=C,this._end=u,this._correspondingCharSet=new n1,this._excludes=new Set,this.ToCharacterSet=function(){if(0===c._correspondingCharSet.set.size)for(var M=c.start.charCodeAt(0),H=String.fromCharCode(M);M<=c.end.charCodeAt(0);M+=1)c._excludes.has(H)||c._correspondingCharSet.AddCharacters(H);return c._correspondingCharSet},i instanceof n1)this._excludes=i.set;else{var h,d=N(i);try{for(d.s();!(h=d.n()).done;)this._excludes.add(h.value)}catch(M){d.e(M)}finally{d.f()}}}return W(v,[{key:"start",get:function(){return this._start}},{key:"end",get:function(){return this._end}}]),v}();Y3.Define=function(v,C){return new Y3(v,C,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[])};var F2,R5=function(v){Q(u,v);var C=a2(u);function u(){var c,i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return B(this,u),(c=C.call(this))._pathOnChoice=null,c.hasCondition=!1,c.hasStartContent=!1,c.hasChoiceOnlyContent=!1,c.isInvisibleDefault=!1,c.onceOnly=!0,c.onceOnly=i,c}return W(u,[{key:"pathOnChoice",get:function(){if(null!=this._pathOnChoice&&this._pathOnChoice.isRelative){var c=this.choiceTarget;c&&(this._pathOnChoice=c.path)}return this._pathOnChoice},set:function(c){this._pathOnChoice=c}},{key:"choiceTarget",get:function(){return null===this._pathOnChoice?O("ChoicePoint._pathOnChoice"):this.ResolvePath(this._pathOnChoice).container}},{key:"pathStringOnChoice",get:function(){return null===this.pathOnChoice?O("ChoicePoint.pathOnChoice"):this.CompactPathString(this.pathOnChoice)},set:function(c){this.pathOnChoice=new Z2(c)}},{key:"flags",get:function(){var c=0;return this.hasCondition&&(c|=1),this.hasStartContent&&(c|=2),this.hasChoiceOnlyContent&&(c|=4),this.isInvisibleDefault&&(c|=8),this.onceOnly&&(c|=16),c},set:function(c){this.hasCondition=(1&c)>0,this.hasStartContent=(2&c)>0,this.hasChoiceOnlyContent=(4&c)>0,this.isInvisibleDefault=(8&c)>0,this.onceOnly=(16&c)>0}},{key:"toString",value:function(){return null===this.pathOnChoice?O("ChoicePoint.pathOnChoice"):"Choice: -> "+this.pathOnChoice.toString()}}]),u}(e1);!function(v){v[v.Tunnel=0]="Tunnel",v[v.Function=1]="Function",v[v.FunctionEvaluationFromGame=2]="FunctionEvaluationFromGame"}(F2||(F2={}));var x1,y1=function(){function v(){B(this,v),this.container=null,this.index=-1,2===arguments.length&&(this.container=arguments[0],this.index=arguments[1])}return W(v,[{key:"Resolve",value:function(){return this.index<0?this.container:null==this.container?null:0==this.container.content.length?this.container:this.index>=this.container.content.length?null:this.container.content[this.index]}},{key:"isNull",get:function(){return null==this.container}},{key:"path",get:function(){return this.isNull?null:this.index>=0?this.container.path.PathByAppendingComponent(new Z2.Component(this.index)):this.container.path}},{key:"toString",value:function(){return this.container?"Ink Pointer -> "+this.container.path.toString()+" -- index "+this.index:"Ink Pointer (null)"}},{key:"copy",value:function(){return new v(this.container,this.index)}}],[{key:"StartOf",value:function(C){return new v(C,0)}},{key:"Null",get:function(){return new v(null,-1)}}]),v}(),e3=function(v){Q(u,v);var C=a2(u);function u(c){var i;return B(this,u),(i=C.call(this))._targetPath=null,i._targetPointer=y1.Null,i.variableDivertName=null,i.pushesToStack=!1,i.stackPushType=0,i.isExternal=!1,i.externalArgs=0,i.isConditional=!1,i.pushesToStack=!1,void 0!==c&&(i.pushesToStack=!0,i.stackPushType=c),i}return W(u,[{key:"targetPath",get:function(){if(null!=this._targetPath&&this._targetPath.isRelative){var c=this.targetPointer.Resolve();c&&(this._targetPath=c.path)}return this._targetPath},set:function(c){this._targetPath=c,this._targetPointer=y1.Null}},{key:"targetPointer",get:function(){if(this._targetPointer.isNull){var c=this.ResolvePath(this._targetPath).obj;if(null===this._targetPath)return O("this._targetPath");if(null===this._targetPath.lastComponent)return O("this._targetPath.lastComponent");if(this._targetPath.lastComponent.isIndex){if(null===c)return O("targetObj");this._targetPointer.container=c.parent instanceof C2?c.parent:null,this._targetPointer.index=this._targetPath.lastComponent.index}else this._targetPointer=y1.StartOf(c instanceof C2?c:null)}return this._targetPointer.copy()}},{key:"targetPathString",get:function(){return null==this.targetPath?null:this.CompactPathString(this.targetPath)},set:function(c){this.targetPath=null==c?null:new Z2(c)}},{key:"hasVariableTarget",get:function(){return null!=this.variableDivertName}},{key:"Equals",value:function(c){var i=c;return i instanceof u&&this.hasVariableTarget==i.hasVariableTarget&&(this.hasVariableTarget?this.variableDivertName==i.variableDivertName:null===this.targetPath?O("this.targetPath"):this.targetPath.Equals(i.targetPath))}},{key:"toString",value:function(){if(this.hasVariableTarget)return"Divert(variable: "+this.variableDivertName+")";if(null==this.targetPath)return"Divert(null)";var c=new f3,i=this.targetPath.toString();return c.Append("Divert"),this.isConditional&&c.Append("?"),this.pushesToStack&&c.Append(this.stackPushType==F2.Function?" function":" tunnel"),c.Append(" -> "),c.Append(this.targetPathString),c.Append(" ("),c.Append(i),c.Append(")"),c.toString()}}]),u}(e1);!function(v){v[v.Knot=0]="Knot",v[v.List=1]="List",v[v.ListItem=2]="ListItem",v[v.Var=3]="Var",v[v.SubFlowAndWeave=4]="SubFlowAndWeave",v[v.Arg=5]="Arg",v[v.Temp=6]="Temp"}(x1||(x1={}));var x4=function(v){Q(u,v);var C=a2(u);function u(c,i){var h;return B(this,u),(h=C.call(this)).variableName=c||null,h.isNewDeclaration=!!i,h.isGlobal=!1,h}return W(u,[{key:"toString",value:function(){return"VarAssign to "+this.variableName}}]),u}(e1),t3=function(v){Q(u,v);var C=a2(u);function u(c,i,h){var d;return B(this,u),(d=C.call(this))._condition=null,d._innerContentContainer=null,d._outerContainer=null,d._runtimeChoice=null,d._returnToR1=null,d._returnToR2=null,d._r1Label=null,d._r2Label=null,d._divertToStartContentOuter=null,d._divertToStartContentInner=null,d._startContentRuntimeContainer=null,d.isInvisibleDefault=!1,d.hasWeaveStyleInlineBrackets=!1,d.GenerateRuntimeObject=function(){if(d._outerContainer=new C2,d._runtimeChoice=new R5(d.onceOnly),d._runtimeChoice.isInvisibleDefault=d.isInvisibleDefault,(d.startContent||d.choiceOnlyContent||d.condition)&&d._outerContainer.AddContent(I.EvalStart()),d.startContent){d._returnToR1=new b3,d._outerContainer.AddContent(d._returnToR1);var g=new x4("$r",!0);d._outerContainer.AddContent(g),d._outerContainer.AddContent(I.BeginString()),d._divertToStartContentOuter=new e3,d._outerContainer.AddContent(d._divertToStartContentOuter),d._startContentRuntimeContainer=d.startContent.GenerateRuntimeObject(),d._startContentRuntimeContainer.name="s";var M=new e3;M.variableDivertName="$r",d._startContentRuntimeContainer.AddContent(M),d._outerContainer.AddToNamedContentOnly(d._startContentRuntimeContainer),d._r1Label=new C2,d._r1Label.name="$r1",d._outerContainer.AddContent(d._r1Label),d._outerContainer.AddContent(I.EndString()),d._runtimeChoice.hasStartContent=!0}if(d.choiceOnlyContent){d._outerContainer.AddContent(I.BeginString());var H=d.choiceOnlyContent.GenerateRuntimeObject();d._outerContainer.AddContentsOfContainer(H),d._outerContainer.AddContent(I.EndString()),d._runtimeChoice.hasChoiceOnlyContent=!0}if(d.condition&&(d.condition.GenerateIntoContainer(d._outerContainer),d._runtimeChoice.hasCondition=!0),(d.startContent||d.choiceOnlyContent||d.condition)&&d._outerContainer.AddContent(I.EvalEnd()),d._outerContainer.AddContent(d._runtimeChoice),d._innerContentContainer=new C2,d.startContent){d._returnToR2=new b3,d._innerContentContainer.AddContent(I.EvalStart()),d._innerContentContainer.AddContent(d._returnToR2),d._innerContentContainer.AddContent(I.EvalEnd());var m=new x4("$r",!0);d._innerContentContainer.AddContent(m),d._divertToStartContentInner=new e3,d._innerContentContainer.AddContent(d._divertToStartContentInner),d._r2Label=new C2,d._r2Label.name="$r2",d._innerContentContainer.AddContent(d._r2Label)}if(d.innerContent){var L=d.innerContent.GenerateRuntimeObject();d._innerContentContainer.AddContentsOfContainer(L)}return d.story.countAllVisits&&(d._innerContentContainer.visitsShouldBeCounted=!0),d._innerContentContainer.countingAtStartOnly=!0,d._outerContainer},d.toString=function(){return null!==d.choiceOnlyContent?"* ".concat(d.startContent,"[").concat(d.choiceOnlyContent,"]..."):"* ".concat(d.startContent,"...")},d.startContent=c,d.choiceOnlyContent=i,d.innerContent=h,d.indentationDepth=1,c&&d.AddContent(d.startContent),i&&d.AddContent(d.choiceOnlyContent),h&&d.AddContent(d.innerContent),d.onceOnly=!0,d}return W(u,[{key:"runtimeChoice",get:function(){if(!this._runtimeChoice)throw new Error;return this._runtimeChoice}},{key:"name",get:function(){var c;return(null===(c=this.identifier)||void 0===c?void 0:c.name)||null}},{key:"condition",get:function(){return this._condition},set:function(c){this._condition=c,c&&this.AddContent(c)}},{key:"runtimeContainer",get:function(){return this._innerContentContainer}},{key:"innerContentContainer",get:function(){return this._innerContentContainer}},{key:"containerForCounting",get:function(){return this._innerContentContainer}},{key:"runtimePath",get:function(){if(!this.innerContentContainer||!this.innerContentContainer.path)throw new Error;return this.innerContentContainer.path}},{key:"typeName",get:function(){return"Choice"}},{key:"ResolveReferences",value:function(c){var i;if(this._innerContentContainer&&(this.runtimeChoice.pathOnChoice=this._innerContentContainer.path,this.onceOnly&&(this._innerContentContainer.visitsShouldBeCounted=!0)),this._returnToR1){if(!this._r1Label)throw new Error;this._returnToR1.targetPath=this._r1Label.path}if(this._returnToR2){if(!this._r2Label)throw new Error;this._returnToR2.targetPath=this._r2Label.path}if(this._divertToStartContentOuter){if(!this._startContentRuntimeContainer)throw new Error;this._divertToStartContentOuter.targetPath=this._startContentRuntimeContainer.path}if(this._divertToStartContentInner){if(!this._startContentRuntimeContainer)throw new Error;this._divertToStartContentInner.targetPath=this._startContentRuntimeContainer.path}J2(I2(u.prototype),"ResolveReferences",this).call(this,c),this.identifier&&((null===(i=this.identifier)||void 0===i?void 0:i.name)||"").length>0&&c.CheckForNamingCollisions(this,this.identifier,x1.SubFlowAndWeave)}}]),u}(E2),h8=W(function v(){var C=this;B(this,v),this.characterIndex=0,this.characterInLineIndex=0,this.lineIndex=0,this.reportedErrorInScope=!1,this.uniqueId=0,this.customFlags=0,this.CopyFrom=function(u){v._uniqueIdCounter++,C.uniqueId=v._uniqueIdCounter,C.characterIndex=u.characterIndex,C.characterInLineIndex=u.characterInLineIndex,C.lineIndex=u.lineIndex,C.customFlags=u.customFlags,C.reportedErrorInScope=!1},this.SquashFrom=function(u){C.characterIndex=u.characterIndex,C.characterInLineIndex=u.characterInLineIndex,C.lineIndex=u.lineIndex,C.reportedErrorInScope=u.reportedErrorInScope}});h8._uniqueIdCounter=1e3;var B5=function(){function v(){var C=this;B(this,v),this._stack=[],this._numElements=0,this.StringParserState=function(){C._stack=new Array(200);for(var c=0;c<200;++c)C._stack[c]=new h8;C._numElements=1},this.Push=function(){if(C._numElements>=C._stack.length&&C._numElements>0)throw new Error("Stack overflow in parser state.");var c=C._stack[C._numElements-1],i=C._stack[C._numElements];return C._numElements++,i.CopyFrom(c),i.uniqueId},this.Pop=function(c){if(1==C._numElements)throw new Error("Attempting to remove final stack element is illegal! Mismatched Begin/Succceed/Fail?");if(C.currentElement.uniqueId!=c)throw new Error("Mismatched rule IDs while Poping - do you have mismatched Begin/Succeed/Fail?");C._numElements-=1},this.Peek=function(c){if(C.currentElement.uniqueId!=c)throw new Error("Mismatched rule IDs while Peeking - do you have mismatched Begin/Succeed/Fail?");return C._stack[C._numElements-1]},this.PeekPenultimate=function(){return C._numElements>=2?C._stack[C._numElements-2]:null},this.Squash=function(){if(C._numElements<2)throw new Error("Attempting to remove final stack element is illegal! Mismatched Begin/Succceed/Fail?");C._stack[C._numElements-2].SquashFrom(C._stack[C._numElements-1]),C._numElements-=1},this.NoteErrorReported=function(){var c,i=N(C._stack);try{for(i.s();!(c=i.n()).done;)c.value.reportedErrorInScope=!0}catch(h){i.e(h)}finally{i.f()}};for(var u=0;u<200;u++)this._stack[u]=new h8;this._numElements=1}return W(v,[{key:"currentElement",get:function(){return this._stack[this._numElements-1]}},{key:"lineIndex",get:function(){return this.currentElement.lineIndex},set:function(C){this.currentElement.lineIndex=C}},{key:"characterIndex",get:function(){return this.currentElement.characterIndex},set:function(C){this.currentElement.characterIndex=C}},{key:"characterInLineIndex",get:function(){return this.currentElement.characterInLineIndex},set:function(C){this.currentElement.characterInLineIndex=C}},{key:"customFlags",get:function(){return this.currentElement.customFlags},set:function(C){this.currentElement.customFlags=C}},{key:"errorReportedAlreadyInScope",get:function(){return this.currentElement.reportedErrorInScope}},{key:"stackHeight",get:function(){return this._numElements}}]),v}(),J3=Symbol("ParseSuccessStruct"),Qe=function(){function v(C){var u=this;B(this,v),this.ParseRule=null,this.errorHandler=null,this.hadError=!1,this.BeginRule=function(){return u.state.Push()},this.FailRule=function(i){return u.state.Pop(i),null},this.CancelRule=function(i){u.state.Pop(i)},this.SucceedRule=function(i){var h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=u.state.Peek(i),g=u.state.PeekPenultimate();u.RuleDidSucceed&&u.RuleDidSucceed(h,g,d),u.state.Squash();var M=h;return null===M&&(M=v.ParseSuccess),M},this.Expect=function(i){var h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,g=u.ParseObject(i);if(null===g){var M;null===h&&(h=i.name);var H=u.LineRemainder();M=null===H||0===H.length?"end of line":"'".concat(H,"'"),u.Error("Expected ".concat(h," but saw ").concat(M)),null!==d&&(g=d())}return g},this.Error=function(i){u.ErrorOnLine(i,u.lineIndex+1,arguments.length>1&&void 0!==arguments[1]&&arguments[1])},this.ErrorWithParsedObject=function(i,h){u.ErrorOnLine(i,h.debugMetadata?h.debugMetadata.startLineNumber:-1,arguments.length>2&&void 0!==arguments[2]&&arguments[2])},this.ErrorOnLine=function(i,h,d){if(!u.state.errorReportedAlreadyInScope){if(!u.errorHandler)throw new Error("".concat(d?"Warning":"Error"," on line ").concat(h,": ").concat(i));u.errorHandler(i,u.index,h-1,d),u.state.NoteErrorReported()}d||(u.hadError=!0)},this.Warning=function(i){return u.Error(i,!0)},this.LineRemainder=function(){return u.Peek(function(){return u.ParseUntilCharactersFromString("\n\r")})},this.SetFlag=function(i,h){h?u.state.customFlags|=i:u.state.customFlags&=~i},this.GetFlag=function(i){return Boolean(u.state.customFlags&i)},this.ParseObject=function(i){var h=u.BeginRule(),d=u.state.stackHeight,g=i();if(d!==u.state.stackHeight)throw new Error("Mismatched Begin/Fail/Succeed rules");return null===g?u.FailRule(h):(u.SucceedRule(h,g),g)},this.Parse=function(i){var h=u.BeginRule(),d=i();return null===d?(u.FailRule(h),null):(u.SucceedRule(h,d),d)},this.OneOf=function(i){var h,d=N(i);try{for(d.s();!(h=d.n()).done;){var M=u.ParseObject(h.value);if(null!==M)return M}}catch(H){d.e(H)}finally{d.f()}return null},this.OneOrMore=function(i){var h=[],d=null;do{null!==(d=u.ParseObject(i))&&h.push(d)}while(null!==d);return h.length>0?h:null},this.Optional=function(i){return function(){var h=u.ParseObject(i);return null===h?v.ParseSuccess:h}},this.Exclude=function(i){return function(){return u.ParseObject(i)&&v.ParseSuccess}},this.OptionalExclude=function(i){return function(){return u.ParseObject(i),v.ParseSuccess}},this.String=function(i){return function(){return u.ParseString(i)}},this.TryAddResultToList=function(i,h){if(i!==v.ParseSuccess){if((!(arguments.length>2&&void 0!==arguments[2])||arguments[2])&&Array.isArray(i)&&null!==i){var M,H=N(i);try{for(H.s();!(M=H.n()).done;)h.push(M.value)}catch(L){H.e(L)}finally{H.f()}return}h.push(i)}},this.Interleave=function(i,h){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,g=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],M=u.BeginRule(),H=[],m=u.ParseObject(i);if(null===m)return u.FailRule(M);u.TryAddResultToList(m,H,g);var L=null,S=null;do{if(null!==d&&null!==u.Peek(d)||null===(L=u.ParseObject(h)))break;if(u.TryAddResultToList(L,H,g),S=null,null!==L){if(null===(S=u.ParseObject(i)))break;u.TryAddResultToList(S,H,g)}}while((null!==L||null!==S)&&(L!==v.ParseSuccess||S!=v.ParseSuccess)&&u.remainingLength>0);return 0===H.length?u.FailRule(M):u.SucceedRule(M,H)},this.ParseString=function(i){if(i.length>u.remainingLength)return null;for(var h=u.BeginRule(),d=u.index,g=u.characterInLineIndex,M=u.lineIndex,H=!0,m=0;m<i.length;m+=1){var L=i[m];if(u._chars[d]!==L){H=!1;break}"\n"===L&&(M++,g=-1),d++,g++}return u.index=d,u.characterInLineIndex=g,u.lineIndex=M,H?u.SucceedRule(h,i):u.FailRule(h)},this.ParseSingleCharacter=function(){if(u.remainingLength>0){var i=u._chars[u.index];return"\n"===i&&(u.lineIndex+=1,u.characterInLineIndex=-1),u.index+=1,u.characterInLineIndex+=1,i}return"0"},this.ParseUntilCharactersFromString=function(i){return u.ParseCharactersFromString(i,!1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)},this.ParseUntilCharactersFromCharSet=function(i){return u.ParseCharactersFromCharSet(i,!1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)},this.ParseCharactersFromString=function(i){var h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,g=new n1(i);return"number"==typeof h?u.ParseCharactersFromCharSet(g,!0,h):u.ParseCharactersFromCharSet(g,h,d)},this.ParseCharactersFromCharSet=function(i){var h=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;-1===d&&(d=Number.MAX_SAFE_INTEGER);for(var g=u.index,M=u.index,H=u.characterInLineIndex,m=u.lineIndex,L=0;M<u._chars.length&&i.set.has(u._chars[M])===h&&L<d;)"\n"===u._chars[M]&&(m+=1,H=-1),M+=1,H+=1,L+=1;return u.index=M,u.characterInLineIndex=H,u.lineIndex=m,u.index>g?u._chars.slice(g,u.index).join(""):null},this.Peek=function(i){var h=u.BeginRule(),d=i();return u.CancelRule(h),d},this.ParseInt=function(){var i=u.index,h=u.characterInLineIndex,d=null!==u.ParseString("-");u.ParseCharactersFromString(" \t");var g,M=u.ParseCharactersFromCharSet(v.numbersCharacterSet);return null===M?(u.index=i,u.characterInLineIndex=h,null):Number.isNaN(Number(M))?(u.Error("Failed to read integer value: "+M+". Perhaps it's out of the range of acceptable numbers ink supports? ("+Number.MIN_SAFE_INTEGER+" to "+Number.MAX_SAFE_INTEGER+")"),null):(g=Number(M),d?-g:g)},this.ParseFloat=function(){var i=u.index,h=u.characterInLineIndex,d=u.ParseInt();if(null!==d&&null!==u.ParseString(".")){var g=u.ParseCharactersFromCharSet(v.numbersCharacterSet);return Number("".concat(d,".").concat(g))}return u.index=i,u.characterInLineIndex=h,null},this.ParseNewline=function(){var i=u.BeginRule();return u.ParseString("\r"),null===u.ParseString("\n")?u.FailRule(i):u.SucceedRule(i,"\n")};var c=this.PreProcessInputString(C);this.state=new B5,this._chars=C?c.split(""):[],this.inputString=c}return W(v,[{key:"currentCharacter",get:function(){return this.index>=0&&this.remainingLength>0?this._chars[this.index]:"0"}},{key:"PreProcessInputString",value:function(C){return C}},{key:"endOfInput",get:function(){return this.index>=this._chars.length}},{key:"remainingString",get:function(){return this._chars.slice(this.index,this.index+this.remainingLength).join("")}},{key:"remainingLength",get:function(){return this._chars.length-this.index}},{key:"lineIndex",get:function(){return this.state.lineIndex},set:function(C){this.state.lineIndex=C}},{key:"characterInLineIndex",get:function(){return this.state.characterInLineIndex},set:function(C){this.state.characterInLineIndex=C}},{key:"index",get:function(){return this.state.characterIndex},set:function(C){this.state.characterIndex=C}},{key:"ParseUntil",value:function(C){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.BeginRule(),h=new n1;null!==u&&(h.set=new Set([].concat(p1(h.set.values()),p1(u.set.values())))),null!==c&&(h.set=new Set([].concat(p1(h.set.values()),p1(c.set.values()))));for(var d="";;){var g=this.ParseUntilCharactersFromCharSet(h);if(g&&(d+=g),null!==this.Peek(C)||this.endOfInput)break;var M=this.currentCharacter;if(null===u||!u.set.has(M))break;d+=M,"\n"===M&&(this.lineIndex+=1,this.characterInLineIndex=-1),this.index+=1,this.characterInLineIndex+=1}return d.length>0?this.SucceedRule(i,String(d)):this.FailRule(i)}}]),v}();Qe.ParseSuccess=J3,Qe.numbersCharacterSet=new n1("0123456789");var u1,d8=function(v){Q(u,v);var C=a2(u);function u(){var c;return B(this,u),(c=C.apply(this,arguments))._commentOrNewlineStartCharacter=new n1("/\r\n"),c._commentBlockEndCharacter=new n1("*"),c._newlineCharacters=new n1("\n\r"),c.Process=function(){var i=c.Interleave(c.Optional(c.CommentsAndNewlines),c.Optional(c.MainInk));return null!==i?i.join(""):""},c.MainInk=function(){return c.ParseUntil(c.CommentsAndNewlines,c._commentOrNewlineStartCharacter,null)},c.CommentsAndNewlines=function(){var i=c.Interleave(c.Optional(c.ParseNewline),c.Optional(c.ParseSingleComment));return null!==i?i.join(""):null},c.ParseSingleComment=function(){return c.OneOf([c.EndOfLineComment,c.BlockComment])},c.EndOfLineComment=function(){return null===c.ParseString("//")?null:(c.ParseUntilCharactersFromCharSet(c._newlineCharacters),"")},c.BlockComment=function(){if(null===c.ParseString("/*"))return null;var i=c.lineIndex,h=c.ParseUntil(c.String("*/"),c._commentBlockEndCharacter,null);return c.endOfInput||c.ParseString("*/"),null!=h?"\n".repeat(c.lineIndex-i):null},c}return W(u,[{key:"PreProcessInputString",value:function(c){return c}}]),u}(Qe),Ve=function(v){Q(u,v);var C=a2(u);function u(c,i){var h;return B(this,u),(h=C.call(this)).initialCondition=c,h.branches=i,h._reJoinTarget=null,h.GenerateRuntimeObject=function(){var d=new C2;h.initialCondition&&d.AddContent(h.initialCondition.runtimeObject);var g,M=N(h.branches);try{for(M.s();!(g=M.n()).done;)d.AddContent(g.value.runtimeObject)}catch(m){M.e(m)}finally{M.f()}return null===h.initialCondition||null===h.branches[0].ownExpression||h.branches[h.branches.length-1].isElse||d.AddContent(I.PopEvaluatedValue()),h._reJoinTarget=I.NoOp(),d.AddContent(h._reJoinTarget),d},h.initialCondition&&h.AddContent(h.initialCondition),null!==h.branches&&h.AddContent(h.branches),h}return W(u,[{key:"typeName",get:function(){return"Conditional"}},{key:"ResolveReferences",value:function(c){var i,h=this._reJoinTarget.path,d=N(this.branches);try{for(d.s();!(i=d.n()).done;){var g=i.value;if(!g.returnDivert)throw new Error;g.returnDivert.targetPath=h}}catch(M){d.e(M)}finally{d.f()}J2(I2(u.prototype),"ResolveReferences",this).call(this,c)}}]),u}(E2),J1=function(v){Q(u,v);var C=a2(u);function u(c){var i;return B(this,u),(i=C.call(this)).text=c,i.GenerateRuntimeObject=function(){return new G2(i.text)},i.toString=function(){return i.text},i}return W(u,[{key:"typeName",get:function(){return"Text"}}]),u}(E2),_6=function(v){Q(u,v);var C=a2(u);function u(c,i){var h;return B(this,u),(h=C.call(this))._expression=null,h.GenerateRuntimeObject=function(){return null},h.constantIdentifier=c,i&&(h._expression=h.AddContent(i)),h}return W(u,[{key:"constantName",get:function(){var c;return null===(c=this.constantIdentifier)||void 0===c?void 0:c.name}},{key:"expression",get:function(){if(!this._expression)throw new Error;return this._expression}},{key:"typeName",get:function(){return"CONST"}},{key:"ResolveReferences",value:function(c){J2(I2(u.prototype),"ResolveReferences",this).call(this,c),c.CheckForNamingCollisions(this,this.constantIdentifier,x1.Var)}}]),u}(E2);!function(v){v[v.Story=0]="Story",v[v.Knot=1]="Knot",v[v.Stitch=2]="Stitch",v[v.WeavePoint=3]="WeavePoint"}(u1||(u1={}));var p3=function(v){Q(u,v);var C=a2(u);function u(c,i){var h;return B(this,u),(h=C.call(this)).indentationDepth=i,h.GenerateRuntimeObject=function(){var d=new C2;if(d.name=h.name,h.story.countAllVisits&&(d.visitsShouldBeCounted=!0),d.countingAtStartOnly=!0,h.content){var g,M=N(h.content);try{for(M.s();!(g=M.n()).done;)d.AddContent(g.value.runtimeObject)}catch(m){M.e(m)}finally{M.f()}}return d},h.toString=function(){var d,g;return"- ".concat(null!==(d=h.identifier)&&void 0!==d&&d.name?"("+(null===(g=h.identifier)||void 0===g?void 0:g.name)+")":"gather")},c&&(h.identifier=c),h}return W(u,[{key:"name",get:function(){var c;return(null===(c=this.identifier)||void 0===c?void 0:c.name)||null}},{key:"runtimeContainer",get:function(){return this.runtimeObject}},{key:"typeName",get:function(){return"Gather"}},{key:"ResolveReferences",value:function(c){J2(I2(u.prototype),"ResolveReferences",this).call(this,c),this.identifier&&(this.identifier.name||"").length>0&&c.CheckForNamingCollisions(this,this.identifier,x1.SubFlowAndWeave)}}]),u}(E2),D4=function(){function v(C,u){var c=this;B(this,v),this._dotSeparatedComponents=null,this.toString=function(){return null===c.components||0===c.components.length?c.baseTargetLevel===u1.WeavePoint?"-> <next gather point>":"<invalid Path>":"-> ".concat(c.dotSeparatedComponents)},this.ResolveFromContext=function(i){if(null==c.components||0==c.components.length)return null;var h=c.ResolveBaseTarget(i);return null===h?null:c.components.length>1?c.ResolveTailComponents(h):h},this.ResolveBaseTarget=function(i){for(var h=c.firstComponent,d=i;d;){var M=c.GetChildFromContext(d,h,null,d===i);if(M)return M;d=d.parent}return null},this.ResolveTailComponents=function(i){var h=i;if(!c.components)return null;for(var d=1;d<c.components.length;++d){var g=c.components[d].name,H=P(h,U1);if(null===(h=c.GetChildFromContext(h,g,null!==H?H.flowLevel+1:u1.WeavePoint)))break}return h},this.GetChildFromContext=function(i,h,d){var g=arguments.length>3&&void 0!==arguments[3]&&arguments[3],M=null===d,H=P(i,Q4);if(h&&null!==H&&(M||d===u1.WeavePoint))return H.WeavePointNamed(h);var m=P(i,U1);return h&&null!==m?m.ContentWithNameAtLevel(h,d,g||m.flowLevel===u1.Knot):null},Object.values(u1).includes(C)?(this._baseTargetLevel=C,this.components=u||[]):Array.isArray(C)?(this._baseTargetLevel=null,this.components=C||[]):(this._baseTargetLevel=null,this.components=[C])}return W(v,[{key:"baseTargetLevel",get:function(){return this.baseLevelIsAmbiguous?u1.Story:this._baseTargetLevel}},{key:"baseLevelIsAmbiguous",get:function(){return!this._baseTargetLevel}},{key:"firstComponent",get:function(){return null!=this.components&&this.components.length?this.components[0].name:null}},{key:"numberOfComponents",get:function(){return this.components?this.components.length:0}},{key:"dotSeparatedComponents",get:function(){return null==this._dotSeparatedComponents&&(this._dotSeparatedComponents=(this.components?this.components:[]).map(function(C){return C.name}).filter(f8).join(".")),this._dotSeparatedComponents}},{key:"typeName",get:function(){return"Path"}}]),v}(),z3=function(v){Q(u,v);var C=a2(u);function u(){var c,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return B(this,u),(c=C.call(this)).returnedExpression=null,c.GenerateRuntimeObject=function(){var h=new C2;return c.returnedExpression?h.AddContent(c.returnedExpression.runtimeObject):(h.AddContent(I.EvalStart()),h.AddContent(new E3),h.AddContent(I.EvalEnd())),h.AddContent(I.PopFunction()),h},i&&(c.returnedExpression=c.AddContent(i)),c}return W(u,[{key:"typeName",get:function(){return"ReturnType"}}]),u}(E2);function x6(v){for(var C=v.parent;C;){if(C.hasOwnProperty("iamFlowbase")&&C.iamFlowbase())return C;C=C.parent}return null}var $4=function(){function v(C){var u=this;B(this,v),this.debugMetadata=null,this.toString=function(){return u.name||"undefined identifer"},this.name=C}return W(v,[{key:"typeName",get:function(){return"Identifier"}}],[{key:"Done",value:function(){return new v("DONE")}}]),v}(),U1=function(v){Q(u,v);var C=a2(u);function u(c){var i,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,g=arguments.length>3&&void 0!==arguments[3]&&arguments[3],M=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return B(this,u),(i=C.call(this)).isFunction=g,i._rootWeave=null,i._subFlowsByName=new Map,i._startingSubFlowDivert=null,i._startingSubFlowRuntime=null,i._firstChildFlow=null,i.variableDeclarations=new Map,i.identifier=null,i.args=null,i.iamFlowbase=function(){return!0},i.SplitWeaveAndSubFlowContent=function(H,m){var L,S,z=[],_=[];i._subFlowsByName=new Map;var E,A=N(H);try{for(A.s();!(E=A.n()).done;){var R=E.value,K=P(R,u);K?(null===i._firstChildFlow&&(i._firstChildFlow=K),_.push(R),null!==(L=K.identifier)&&void 0!==L&&L.name&&i._subFlowsByName.set(null===(S=K.identifier)||void 0===S?void 0:S.name,K)):z.push(R)}}catch(f2){A.e(f2)}finally{A.f()}m&&z.push(new p3(null,1),new X1(new D4($4.Done())));var u2=[];return z.length>0&&(i._rootWeave=new Q4(z,0),u2.push(i._rootWeave)),_.length>0&&u2.push.apply(u2,_),u2},i.ResolveVariableWithName=function(H,m){var L,S={},z=null===m?H1(i):x6(m);if(z){if(null!==z.args){var _,E=N(z.args);try{for(E.s();!(_=E.n()).done;)if((null===(L=_.value.identifier)||void 0===L?void 0:L.name)===H)return S.found=!0,S.isArgument=!0,S.ownerFlow=z,S}catch(A){E.e(A)}finally{E.f()}}if(z!==i.story&&z.variableDeclarations.has(H))return S.found=!0,S.ownerFlow=z,S.isTemporary=!0,S}return i.story.variableDeclarations.has(H)?(S.found=!0,S.ownerFlow=i.story,S.isGlobal=!0,S):(S.found=!1,S)},i.AddNewVariableDeclaration=function(H){var m=H.variableName;if(i.variableDeclarations.has(m)){var L=i.variableDeclarations.get(m),S="";return L.debugMetadata&&(S=" (".concat(L.debugMetadata,")")),void i.Error("found declaration variable '".concat(m,"' that was already declared").concat(S),H,!1)}i.variableDeclarations.set(H.variableName,H)},i.ResolveWeavePointNaming=function(){i._rootWeave&&i._rootWeave.ResolveWeavePointNaming();var H,m=N(i._subFlowsByName);try{for(m.s();!(H=m.n()).done;){var L=y2(H.value,2)[1];L.hasOwnProperty("ResolveWeavePointNaming")&&L.ResolveWeavePointNaming()}}catch(S){m.e(S)}finally{m.f()}},i.GenerateRuntimeObject=function(){var H,m=null;i.isFunction?i.CheckForDisallowedFunctionFlowControl():i.flowLevel!==u1.Knot&&i.flowLevel!==u1.Stitch||null!==(m=i.Find(z3)())&&i.Error("Return statements can only be used in knots that are declared as functions: == function ".concat(i.identifier," =="),m);var L=new C2;L.name=null===(H=i.identifier)||void 0===H?void 0:H.name,i.story.countAllVisits&&(L.visitsShouldBeCounted=!0),i.GenerateArgumentVariableAssignments(L);for(var S=0;null!==i.content&&S<i.content.length;){var z=i.content[S];if(z instanceof u){var _=z,E=_.runtimeObject;0!==S||_.hasParameters||i.flowLevel!==u1.Knot||(i._startingSubFlowDivert=new e3,L.AddContent(i._startingSubFlowDivert),i._startingSubFlowRuntime=E);var A=E,R=L.namedContent.get(A.name)||null;if(R){var K="".concat(i.GetType()," already contains flow named '").concat(A.name,"' (at ").concat(R.debugMetadata,")");i.Error(K,_)}L.AddToNamedContentOnly(A)}else z&&L.AddContent(z.runtimeObject);S+=1}return i.flowLevel===u1.Story||i.isFunction||null===i._rootWeave||null!==m||i._rootWeave.ValidateTermination(i.WarningInTermination),L},i.GenerateArgumentVariableAssignments=function(H){var m;if(null!==i.args&&0!==i.args.length)for(var L=i.args.length-1;L>=0;--L){var S=(null===(m=i.args[L].identifier)||void 0===m?void 0:m.name)||null,z=new x4(S,!0);H.AddContent(z)}},i.ContentWithNameAtLevel=function(H){var m,L=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,S=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((L===i.flowLevel||null===L)&&H===(null===(m=i.identifier)||void 0===m?void 0:m.name))return H1(i);if(L===u1.WeavePoint||null===L){var z=null;if(i._rootWeave&&(z=i._rootWeave.WeavePointNamed(H)))return z;if(L===u1.WeavePoint)return S?i.DeepSearchForAnyLevelContent(H):null}if(null!==L&&L<i.flowLevel)return null;var _=i._subFlowsByName.get(H)||null;return!_||null!==L&&L!==_.flowLevel?S?i.DeepSearchForAnyLevelContent(H):null:_},i.DeepSearchForAnyLevelContent=function(H){var m=i.ContentWithNameAtLevel(H,u1.WeavePoint,!1);if(m)return m;var L,S=N(i._subFlowsByName);try{for(S.s();!(L=S.n()).done;){var z=y2(L.value,2)[1].ContentWithNameAtLevel(H,null,!0);if(z)return z}}catch(_){S.e(_)}finally{S.f()}return null},i.CheckForDisallowedFunctionFlowControl=function(){i.flowLevel!==u1.Knot&&i.Error("Functions cannot be stitches - i.e. they should be defined as '== function myFunc ==' rather than internal to another knot.");var H,m=N(i._subFlowsByName);try{for(m.s();!(H=m.n()).done;){var L=y2(H.value,2),z=L[1];i.Error("Functions may not contain stitches, but saw '".concat(L[0],"' within the function '").concat(i.identifier,"'"),z)}}catch(f2){m.e(f2)}finally{m.f()}if(!i._rootWeave)throw new Error;var _,E=N(i._rootWeave.FindAll(X1)());try{for(E.s();!(_=E.n()).done;){var A=_.value;A.isFunctionCall||A.parent instanceof N3||i.Error("Functions may not contain diverts, but saw '".concat(A,"'"),A)}}catch(f2){E.e(f2)}finally{E.f()}var R,K=N(i._rootWeave.FindAll(t3)());try{for(K.s();!(R=K.n()).done;){var u2=R.value;i.Error("Functions may not contain choices, but saw '".concat(u2,"'"),u2)}}catch(f2){K.e(f2)}finally{K.f()}},i.WarningInTermination=function(H){var m="Apparent loose end exists where the flow runs out. Do you need a '-> DONE' statement, choice or divert?";H.parent===i._rootWeave&&i._firstChildFlow&&(m="".concat(m," Note that if you intend to enter '").concat(i._firstChildFlow.identifier,"' next, you need to divert to it explicitly."));var L=P(H,X1);L&&L.isTunnel&&(m+=" When final tunnel to '".concat(L.target," ->' returns it won't have anywhere to go.")),i.Warning(m,H)},i.toString=function(){return"".concat(i.typeName," '").concat(i.identifier,"'")},i.identifier=c,i.args=d,null===h&&(h=[]),i.PreProcessTopLevelObjects(h),h=i.SplitWeaveAndSubFlowContent(h,"Story"==i.GetType()&&!M),i.AddContent(h),i}return W(u,[{key:"hasParameters",get:function(){return null!==this.args&&this.args.length>0}},{key:"subFlowsByName",get:function(){return this._subFlowsByName}},{key:"typeName",get:function(){return this.isFunction?"Function":String(this.flowLevel)}},{key:"name",get:function(){var c;return(null===(c=this.identifier)||void 0===c?void 0:c.name)||null}},{key:"PreProcessTopLevelObjects",value:function(c){}},{key:"ResolveReferences",value:function(c){var i,h;if(this._startingSubFlowDivert){if(!this._startingSubFlowRuntime)throw new Error;this._startingSubFlowDivert.targetPath=this._startingSubFlowRuntime.path}if(J2(I2(u.prototype),"ResolveReferences",this).call(this,c),null!==this.args){var d,g=N(this.args);try{for(g.s();!(d=g.n()).done;)c.CheckForNamingCollisions(this,d.value.identifier,x1.Arg,"argument")}catch(S){g.e(S)}finally{g.f()}for(var H=0;H<this.args.length;H+=1)for(var m=H+1;m<this.args.length;m+=1)(null===(i=this.args[H].identifier)||void 0===i?void 0:i.name)==(null===(h=this.args[m].identifier)||void 0===h?void 0:h.name)&&this.Error("Multiple arguments with the same name: '".concat(this.args[H].identifier,"'"))}this.flowLevel!==u1.Story&&c.CheckForNamingCollisions(this,this.identifier,this.flowLevel===u1.Knot?x1.Knot:x1.SubFlowAndWeave)}}]),u}(E2),n3=function(v){Q(u,v);var C=a2(u);function u(c){var i;B(this,u),(i=C.call(this)).dontFlatten=!1,i.TrimTrailingWhitespace=function(){for(var M=i.content.length-1;M>=0;--M){var H=P(i.content[M],J1);if(null===H||(H.text=H.text.replace(new RegExp(/[ \t]/g),""),0!==H.text.length))break;i.content.splice(M,1)}},i.GenerateRuntimeObject=function(){var M=new C2;if(null!==i.content){var H,m=N(i.content);try{for(m.s();!(H=m.n()).done;){var L=H.value.runtimeObject;L&&M.AddContent(L)}}catch(S){m.e(S)}finally{m.f()}}return i.dontFlatten&&i.story.DontFlattenContainer(M),M},i.toString=function(){return"ContentList(".concat(i.content.join(", "),")")},c&&i.AddContent(c);for(var h=arguments.length,d=new Array(h>1?h-1:0),g=1;g<h;g++)d[g-1]=arguments[g];return d&&i.AddContent(d),i}return W(u,[{key:"runtimeContainer",get:function(){return this.runtimeObject}},{key:"typeName",get:function(){return"ContentList"}}]),u}(E2),K4=function(v){Q(u,v);var C=a2(u);function u(){var c,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return B(this,u),(c=C.call(this)).pathForCount=null,c.name=i,c}return W(u,[{key:"containerForCount",get:function(){return null===this.pathForCount?null:this.ResolvePath(this.pathForCount).container}},{key:"pathStringForCount",get:function(){return null===this.pathForCount?null:this.CompactPathString(this.pathForCount)},set:function(c){this.pathForCount=null===c?null:new Z2(c)}},{key:"toString",value:function(){return null!=this.name?"var("+this.name+")":"read_count("+this.pathStringForCount+")"}}]),u}(e1),u4=function(v){Q(u,v);var C=a2(u);function u(c){var i;return B(this,u),(i=C.call(this)).pathIdentifiers=c,i._runtimeVarRef=null,i.isConstantReference=!1,i.isListItemReference=!1,i.GenerateIntoContainer=function(h){var d=i.story.constants.get(i.name);if(d)return d.GenerateConstantIntoContainer(h),void(i.isConstantReference=!0);if(i._runtimeVarRef=new K4(i.name),1===i.path.length||2===i.path.length){var g="",M="";1===i.path.length?g=i.path[0]:(M=i.path[0],g=i.path[1]),i.story.ResolveListItem(M,g,H1(i))&&(i.isListItemReference=!0)}h.AddContent(i._runtimeVarRef)},i.toString=function(){return"{".concat(i.path.join("."),"}")},i}return W(u,[{key:"name",get:function(){return this.path.join(".")}},{key:"path",get:function(){return this.pathIdentifiers.map(function(c){return c.name}).filter(f8)}},{key:"identifier",get:function(){if(!this.pathIdentifiers||0==this.pathIdentifiers.length)return null;var c=this.path.join(".");return new $4(c)}},{key:"runtimeVarRef",get:function(){return this._runtimeVarRef}},{key:"typeName",get:function(){return"ref"}},{key:"ResolveReferences",value:function(c){if(J2(I2(u.prototype),"ResolveReferences",this).call(this,c),!this.isConstantReference&&!this.isListItemReference){var i=new D4(this.pathIdentifiers),h=i.ResolveFromContext(this);if(h){if(!h.containerForCounting)throw new Error;if(h.containerForCounting.visitsShouldBeCounted=!0,null===this._runtimeVarRef)return;this._runtimeVarRef.pathForCount=h.runtimePath,this._runtimeVarRef.name=null;var d=P(h,U1);d&&d.isFunction&&(this.parent instanceof Q4||this.parent instanceof n3||this.parent instanceof U1)&&this.Warning("'".concat(d.identifier,"' being used as read count rather than being called as function. Perhaps you intended to write ").concat(d.identifier,"()"))}else{if(this.path.length>1){var g="Could not find target for read count: ".concat(i);return this.path.length<=2&&(g+=", or couldn't find list item with the name ".concat(this.path.join(","))),void this.Error(g)}c.ResolveVariableWithName(this.name,this).found||this.Error("Unresolved variable: ".concat(this.name),this)}}}}]),u}(Y1),C4=function(v){Q(u,v);var C=a2(u);function u(c,i){var h;return B(this,u),(h=C.call(this))._divertTargetToCount=null,h._variableReferenceToCount=null,h.shouldPopReturnedValue=!1,h.GenerateIntoContainer=function(d){var g=h.story.ResolveList(h.name),M=!1;if(h.isChoiceCount)h.args.length>0&&h.Error("The CHOICE_COUNT() function shouldn't take any arguments"),d.AddContent(I.ChoiceCount());else if(h.isTurns)h.args.length>0&&h.Error("The TURNS() function shouldn't take any arguments"),d.AddContent(I.Turns());else if(h.isTurnsSince||h.isReadCount){var H=P(h.args[0],N3),m=P(h.args[0],u4);if(1!==h.args.length||null===H&&null===m)return void h.Error("The ".concat(h.name,"() function should take one argument: a divert target to the target knot, stitch, gather or choice you want to check. e.g. TURNS_SINCE(-> myKnot)"));H?(h._divertTargetToCount=H,h.AddContent(h._divertTargetToCount),h._divertTargetToCount.GenerateIntoContainer(d)):m&&(h._variableReferenceToCount=m,h.AddContent(h._variableReferenceToCount),h._variableReferenceToCount.GenerateIntoContainer(d)),d.AddContent(h.isTurnsSince?I.TurnsSince():I.ReadCount())}else if(h.isRandom){2!==h.args.length&&h.Error("RANDOM should take 2 parameters: a minimum and a maximum integer");for(var L=0;L<h.args.length;L+=1){var S=P(h.args[L],d3);S&&!S.isInt()&&h.Error("RANDOM's ".concat(0===L?"minimum":"maximum"," parameter should be an integer")),h.args[L].GenerateIntoContainer(d)}d.AddContent(I.Random())}else if(h.isSeedRandom){1!==h.args.length&&h.Error("SEED_RANDOM should take 1 parameter - an integer seed");var _=P(h.args[0],d3);_&&!_.isInt()&&h.Error("SEED_RANDOM's parameter should be an integer seed"),h.args[0].GenerateIntoContainer(d),d.AddContent(I.SeedRandom())}else if(h.isListRange){3!==h.args.length&&h.Error("LIST_RANGE should take 3 parameters - a list, a min and a max");for(var E=0;E<h.args.length;E+=1)h.args[E].GenerateIntoContainer(d);d.AddContent(I.ListRange())}else if(h.isListRandom)1!==h.args.length&&h.Error("LIST_RANDOM should take 1 parameter - a list"),h.args[0].GenerateIntoContainer(d),d.AddContent(I.ListRandom());else if(v2.CallExistsWithName(h.name)){var A=v2.CallWithName(h.name);if(A.numberOfParameters!==h.args.length){var R="".concat(name," should take ").concat(A.numberOfParameters," parameter");A.numberOfParameters>1&&(R+="s"),h.Error(R)}for(var K=0;K<h.args.length;K+=1)h.args[K].GenerateIntoContainer(d);d.AddContent(v2.CallWithName(h.name))}else if(null!==g)if(h.args.length>1&&h.Error("Can currently only construct a list from one integer (or an empty list from a given list definition)"),1===h.args.length)d.AddContent(new G2(h.name)),h.args[0].GenerateIntoContainer(d),d.AddContent(I.ListFromInt());else{var u2=new s1;u2.SetInitialOriginName(h.name),d.AddContent(new l1(u2))}else d.AddContent(h._proxyDivert.runtimeObject),M=!0;M||h.content.splice(h.content.indexOf(h._proxyDivert),1),h.shouldPopReturnedValue&&d.AddContent(I.PopEvaluatedValue())},h.toString=function(){var d=h.args.join(", ");return"".concat(h.name,"(").concat(d,")")},h._proxyDivert=new X1(new D4(c),i),h._proxyDivert.isFunctionCall=!0,h.AddContent(h._proxyDivert),h}return W(u,[{key:"proxyDivert",get:function(){return this._proxyDivert}},{key:"name",get:function(){return this._proxyDivert.target.firstComponent||""}},{key:"args",get:function(){return this._proxyDivert.args}},{key:"runtimeDivert",get:function(){return this._proxyDivert.runtimeDivert}},{key:"isChoiceCount",get:function(){return"CHOICE_COUNT"===this.name}},{key:"isTurns",get:function(){return"TURNS"===this.name}},{key:"isTurnsSince",get:function(){return"TURNS_SINCE"===this.name}},{key:"isRandom",get:function(){return"RANDOM"===this.name}},{key:"isSeedRandom",get:function(){return"SEED_RANDOM"===this.name}},{key:"isListRange",get:function(){return"LIST_RANGE"===this.name}},{key:"isListRandom",get:function(){return"LIST_RANDOM"===this.name}},{key:"isReadCount",get:function(){return"READ_COUNT"===this.name}},{key:"typeName",get:function(){return"FunctionCall"}},{key:"ResolveReferences",value:function(c){if(J2(I2(u.prototype),"ResolveReferences",this).call(this,c),!this.content.includes(this._proxyDivert)&&null!==this.args){var i,h=N(this.args);try{for(h.s();!(i=h.n()).done;)i.value.ResolveReferences(c)}catch(m){h.e(m)}finally{h.f()}}if(this._divertTargetToCount){var d=this._divertTargetToCount.divert,g=null!=d.runtimeDivert.variableDivertName;if(g)return void this.Error("When getting the TURNS_SINCE() of a variable target, remove the '->' - i.e. it should just be TURNS_SINCE(".concat(d.runtimeDivert.variableDivertName,")"));var M=d.targetContent;if(null===M)g||this.Error("Failed to find target for TURNS_SINCE: '".concat(d.target,"'"));else{if(!M.containerForCounting)throw new Error;M.containerForCounting.turnIndexShouldBeCounted=!0}}else if(this._variableReferenceToCount){var H=this._variableReferenceToCount.runtimeVarRef;if(!H)throw new Error;null!==H.pathForCount&&this.Error("Should be '".concat(name,"'(-> '").concat(this._variableReferenceToCount.name,"). Usage without the '->' only makes sense for variable targets."))}}}]),u}(Y1);C4.IsBuiltIn=function(v){return!!v2.CallExistsWithName(v)||"CHOICE_COUNT"===v||"TURNS_SINCE"===v||"TURNS"===v||"RANDOM"===v||"SEED_RANDOM"===v||"LIST_VALUE"===v||"LIST_RANDOM"===v||"READ_COUNT"===v};var $2,p8=function(v){Q(u,v);var C=a2(u);function u(c){var i;return B(this,u),(i=C.call(this)).GenerateIntoContainer=function(h){var d,g=!0,M=N(i.subExpressions);try{for(M.s();!(d=M.n()).done;)d.value.GenerateIntoContainer(h),g||h.AddContent(v2.CallWithName("&&")),g=!1}catch(H){M.e(H)}finally{M.f()}},i.AddContent(c),i}return W(u,[{key:"subExpressions",get:function(){return this.content}},{key:"typeName",get:function(){return"MultipleConditionExpression"}}]),u}(Y1),N3=function(v){Q(u,v);var C=a2(u);function u(c){var i;return B(this,u),(i=C.call(this))._runtimeDivert=null,i._runtimeDivertTargetValue=null,i.GenerateIntoContainer=function(h){i.divert.GenerateRuntimeObject(),i._runtimeDivert=i.divert.runtimeDivert,i._runtimeDivertTargetValue=new b3,h.AddContent(i.runtimeDivertTargetValue)},i.Equals=function(h){var d=P(h,u);return!!(d&&i.divert.target&&d.divert.target)&&i.divert.target.dotSeparatedComponents===d.divert.target.dotSeparatedComponents},i.divert=i.AddContent(c),i}return W(u,[{key:"runtimeDivert",get:function(){if(!this._runtimeDivert)throw new Error;return this._runtimeDivert}},{key:"runtimeDivertTargetValue",get:function(){if(!this._runtimeDivertTargetValue)throw new Error;return this._runtimeDivertTargetValue}},{key:"typeName",get:function(){return"DivertTarget"}},{key:"ResolveReferences",value:function(c){if(J2(I2(u.prototype),"ResolveReferences",this).call(this,c),this.divert.isDone||this.divert.isEnd)this.Error("Can't use -> DONE or -> END as variable divert targets",this);else{for(var i=this;i&&i instanceof Y1;){var h=!1,d=!1,g=i.parent;if(g instanceof _4?("=="!==g.opName&&"!="!==g.opName?h=!0:(g.leftExpression instanceof u||g.leftExpression instanceof u4)&&(g.rightExpression instanceof u||g.rightExpression instanceof u4)||(h=!0),d=!0):g instanceof C4?(g.isTurnsSince||g.isReadCount||(h=!0),d=!0):(g instanceof Y1||g instanceof p8||g instanceof t3&&g.condition===i||g instanceof Ve||g instanceof Y4)&&(h=!0,d=!0),h&&this.Error("Can't use a divert target like that. Did you intend to call '".concat(this.divert.target,"' as a function: likeThis(), or check the read count: likeThis, with no arrows?"),this),d)break;i=g}if(this.runtimeDivert.hasVariableTarget){if(!this.divert.target)throw new Error;this.Error("Since '".concat(this.divert.target.dotSeparatedComponents,"' is a variable, it shouldn't be preceded by '->' here."))}this.runtimeDivert.targetPath&&(this.runtimeDivertTargetValue.targetPath=this.runtimeDivert.targetPath);var m=this.divert.targetContent;if(null!==m){var L=m.containerForCounting;if(null!==L){var S=P(this.parent,C4);S&&S.isTurnsSince||(L.visitsShouldBeCounted=!0),L.turnIndexShouldBeCounted=!0}var z=P(m,U1);if(null!=z&&null!==z.args){var _,E=N(z.args);try{for(E.s();!(_=E.n()).done;){var A=_.value;A.isByReference&&this.Error("Can't store a divert target to a knot or function that has by-reference arguments ('".concat(z.identifier,"' has 'ref ").concat(A.identifier,"')."))}}catch(R){E.e(R)}finally{E.f()}}}}}}]),u}(Y1),X1=function(v){Q(u,v);var C=a2(u);function u(c,i){var h;return B(this,u),(h=C.call(this)).args=[],h.target=null,h.targetContent=null,h._runtimeDivert=null,h.isFunctionCall=!1,h.isEmpty=!1,h.isTunnel=!1,h.isThread=!1,h.GenerateRuntimeObject=function(){if(h.isEnd)return I.End();if(h.isDone)return I.Done();h.runtimeDivert=new e3,h.ResolveTargetContent(),h.CheckArgumentValidity();var d=null!==h.args&&h.args.length>0;if(d||h.isFunctionCall||h.isTunnel||h.isThread){var g=new C2;if(d){h.isFunctionCall||g.AddContent(I.EvalStart());var M=null;h.targetContent&&(M=h.targetContent.args);for(var H=0;H<h.args.length;++H){var m=h.args[H],L=null;if(M&&H<M.length&&(L=M[H]),L&&L.isByReference){var S=P(m,u4);if(!S){h.Error("Expected variable name to pass by reference to 'ref ".concat(L.identifier,"' but saw ").concat(m));break}var z=new D4(S.pathIdentifiers);if(z.ResolveFromContext(H1(h))){h.Error("can't pass a read count by reference. '".concat(z.dotSeparatedComponents,"' is a knot/stitch/label, but '").concat(h.target.dotSeparatedComponents,"' requires the name of a VAR to be passed."));break}var _=new l4(S.name);g.AddContent(_)}else m.GenerateIntoContainer(g)}h.isFunctionCall||g.AddContent(I.EvalEnd())}return h.isThread?g.AddContent(I.StartThread()):(h.isFunctionCall||h.isTunnel)&&(h.runtimeDivert.pushesToStack=!0,h.runtimeDivert.stackPushType=h.isFunctionCall?F2.Function:F2.Tunnel),g.AddContent(h.runtimeDivert),g}return h.runtimeDivert},h.PathAsVariableName=function(){return h.target?h.target.firstComponent:null},h.ResolveTargetContent=function(){if(!h.isEmpty&&!h.isEnd&&null===h.targetContent){var d=h.PathAsVariableName();if(null!==d){var g=P(x6(H1(h)),U1);if(g){var M=g.ResolveVariableWithName(d,H1(h));if(M.found){if(M.isArgument&&M.ownerFlow&&M.ownerFlow.args){var H=M.ownerFlow.args.find(function(m){var L;return(null===(L=m.identifier)||void 0===L?void 0:L.name)==d});H&&!H.isDivertTarget&&h.Error("Since '".concat(H.identifier,"' is used as a variable divert target (on ").concat(h.debugMetadata,"), it should be marked as: -> ").concat(H.identifier),M.ownerFlow)}return void(h.runtimeDivert.variableDivertName=d)}}}if(!h.target)throw new Error;h.targetContent=h.target.ResolveFromContext(H1(h))}},h.CheckArgumentValidity=function(){if(!h.isEmpty){var d=0;if(null!==h.args&&h.args.length>0&&(d=h.args.length),null!==h.targetContent){var g=P(h.targetContent,U1);if(0!==d||null!==g&&g.hasParameters)if(null===g&&d>0)h.Error("target needs to be a knot or stitch in order to pass arguments");else if(null!==g&&(null===g.args||!g.args&&d>0))h.Error("target (".concat(g.name,") doesn't take parameters"));else if(h.parent instanceof N3)d>0&&h.Error("can't store arguments in a divert target variable");else{var M,H=g.args.length;if(H!==d)return M=0===d?"but there weren't any passed to it":d<H?"but only got ".concat(d):"but got ".concat(d),void h.Error("to '".concat(g.identifier,"' requires ").concat(H," arguments, ").concat(M));for(var m=0;m<H;++m){var L=g.args[m],S=h.args[m];if(L.isDivertTarget){var z=P(S,u4);if(S instanceof N3||null!==z){if(z){var _=new D4(z.pathIdentifiers);_.ResolveFromContext(z)&&h.Error("Passing read count of '".concat(_.dotSeparatedComponents,"' instead of a divert target. You probably meant '").concat(_,"'"))}}else h.Error("Target '".concat(g.identifier,"' expects a divert target for the parameter named -> ").concat(L.identifier," but saw ").concat(S),S)}}null!==g||h.Error("Can't call as a function or with arguments unless it's a knot or stitch")}}}},h.CheckExternalArgumentValidity=function(d){var g=h.target?h.target.firstComponent:null,M=d.externals.get(g);if(!M)throw new Error("external not found");var H=M.argumentNames.length,m=0;h.args&&(m=h.args.length),m!==H&&h.Error("incorrect number of arguments sent to external function '".concat(g,"'. Expected ").concat(H," but got ").concat(m))},h.toString=function(){var d="";return null===h.target?"-> <empty divert>":(d+=h.target.toString(),h.isTunnel&&(d+=" ->"),h.isFunctionCall&&(d+=" ()"),d)},c&&(h.target=c),i&&(h.args=i,h.AddContent(i)),h}return W(u,[{key:"runtimeDivert",get:function(){if(!this._runtimeDivert)throw new Error;return this._runtimeDivert},set:function(c){this._runtimeDivert=c}},{key:"isEnd",get:function(){return Boolean(this.target&&"END"===this.target.dotSeparatedComponents)}},{key:"isDone",get:function(){return Boolean(this.target&&"DONE"===this.target.dotSeparatedComponents)}},{key:"typeName",get:function(){return"Divert"}},{key:"ResolveReferences",value:function(c){if(!(this.isEmpty||this.isEnd||this.isDone)){if(!this.runtimeDivert)throw new Error;this.targetContent&&(this.runtimeDivert.targetPath=this.targetContent.runtimePath),J2(I2(u.prototype),"ResolveReferences",this).call(this,c);var i=P(this.targetContent,U1);i&&(!i.isFunction&&this.isFunctionCall?J2(I2(u.prototype),"Error",this).call(this,"".concat(i.identifier," hasn't been marked as a function, but it's being called as one. Do you need to delcare the knot as '== function ").concat(i.identifier," =='?")):!i.isFunction||this.isFunctionCall||this.parent instanceof N3||J2(I2(u.prototype),"Error",this).call(this,i.identifier+" can't be diverted to. It can only be called as a function since it's been marked as such: '"+i.identifier+"(...)'"));var h=null!==this.targetContent,d=!1,g=!1;if(!this.target)throw new Error;if(1===this.target.numberOfComponents){if(!this.target.firstComponent)throw new Error;if(d=C4.IsBuiltIn(this.target.firstComponent),g=c.IsExternal(this.target.firstComponent),d||g)return this.isFunctionCall||J2(I2(u.prototype),"Error",this).call(this,"".concat(this.target.firstComponent," must be called as a function: ~ ").concat(this.target.firstComponent,"()")),void(g&&(this.runtimeDivert.isExternal=!0,null!==this.args&&(this.runtimeDivert.externalArgs=this.args.length),this.runtimeDivert.pushesToStack=!1,this.runtimeDivert.targetPath=new Z2(this.target.firstComponent),this.CheckExternalArgumentValidity(c)))}null==this.runtimeDivert.variableDivertName&&(h||d||g||this.Error("target not found: '".concat(this.target,"'")))}}},{key:"Error",value:function(c){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,h=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i!==this&&i?J2(I2(u.prototype),"Error",this).call(this,c,i):this.isFunctionCall?J2(I2(u.prototype),"Error",this).call(this,"Function call ".concat(c),i,h):J2(I2(u.prototype),"Error",this).call(this,"Divert ".concat(c),i,h)}}]),u}(E2),W5=W(function v(C,u){B(this,v),this.divert=C,this.targetRuntimeObj=u}),to=W(function v(C,u){B(this,v),this.divert=C,this.targetContent=u});!function(v){v[v.Stopping=1]="Stopping",v[v.Cycle=2]="Cycle",v[v.Shuffle=4]="Shuffle",v[v.Once=8]="Once"}($2||($2={}));var D6,Ye=function(v){Q(u,v);var C=a2(u);function u(c,i){var h;B(this,u),(h=C.call(this)).sequenceType=i,h._sequenceDivertsToResolve=[],h.GenerateRuntimeObject=function(){var L=new C2;L.visitsShouldBeCounted=!0,L.countingAtStartOnly=!0,h._sequenceDivertsToResolve=[],L.AddContent(I.EvalStart()),L.AddContent(I.VisitIndex());var S=(h.sequenceType&$2.Once)>0,z=(h.sequenceType&$2.Cycle)>0,_=(h.sequenceType&$2.Stopping)>0,E=(h.sequenceType&$2.Shuffle)>0,A=h.sequenceElements.length;if(S&&(A+=1),_||S?(L.AddContent(new w2(A-1)),L.AddContent(v2.CallWithName("MIN"))):z&&(L.AddContent(new w2(h.sequenceElements.length)),L.AddContent(v2.CallWithName("%"))),E){var R=I.NoOp();if(S||_){var K=_?h.sequenceElements.length-1:h.sequenceElements.length;L.AddContent(I.Duplicate()),L.AddContent(new w2(K)),L.AddContent(v2.CallWithName("=="));var u2=new e3;u2.isConditional=!0,L.AddContent(u2),h.AddDivertToResolve(u2,R)}var f2=h.sequenceElements.length;_&&(f2-=1),L.AddContent(new w2(f2)),L.AddContent(I.SequenceShuffleIndex()),(S||_)&&L.AddContent(R)}L.AddContent(I.EvalEnd());for(var m2=I.NoOp(),R2=0;R2<A;R2+=1){L.AddContent(I.EvalStart()),L.AddContent(I.Duplicate()),L.AddContent(new w2(R2)),L.AddContent(v2.CallWithName("==")),L.AddContent(I.EvalEnd());var o1=new e3;o1.isConditional=!0,L.AddContent(o1);var A2=void 0;(A2=R2<h.sequenceElements.length?h.sequenceElements[R2].runtimeObject:new C2).name="s".concat(R2),A2.InsertContent(I.PopEvaluatedValue(),0);var Y=new e3;A2.AddContent(Y),L.AddToNamedContentOnly(A2),h.AddDivertToResolve(o1,A2),h.AddDivertToResolve(Y,m2)}return L.AddContent(m2),L},h.AddDivertToResolve=function(L,S){h._sequenceDivertsToResolve.push(new to(L,S))},h.sequenceType=i,h.sequenceElements=[];var d,g=N(c);try{for(g.s();!(d=g.n()).done;){var m,M=d.value,H=M.content;m=null===H||0===H.length?M:new Q4(H),h.sequenceElements.push(m),h.AddContent(m)}}catch(L){g.e(L)}finally{g.f()}return h}return W(u,[{key:"typeName",get:function(){return"Sequence"}},{key:"ResolveReferences",value:function(c){J2(I2(u.prototype),"ResolveReferences",this).call(this,c);var i,h=N(this._sequenceDivertsToResolve);try{for(h.s();!(i=h.n()).done;){var d=i.value;d.divert.targetPath=d.targetContent.path}}catch(g){h.e(g)}finally{h.f()}}}]),u}(E2),Je=function(v){Q(u,v);var C=a2(u);function u(){var c;return B(this,u),(c=C.apply(this,arguments))._overrideDivertTarget=null,c._divertAfter=null,c.GenerateRuntimeObject=function(){var i=new C2;if(i.AddContent(I.EvalStart()),c.divertAfter){var h=c.divertAfter.GenerateRuntimeObject();if(h){var d=c.divertAfter.args;if(null!==d&&d.length>0){for(var g=-1,M=-1,H=0;H<h.content.length;H+=1){var m=h.content[H];m&&(-1==g&&m.commandType===I.CommandType.EvalStart?g=H:m.commandType===I.CommandType.EvalEnd&&(M=H))}for(var L=g+1;L<M;L+=1)h.content[L].parent=null,i.AddContent(h.content[L])}}c._overrideDivertTarget=new b3,i.AddContent(c._overrideDivertTarget)}else i.AddContent(new E3);return i.AddContent(I.EvalEnd()),i.AddContent(I.PopTunnel()),i},c.toString=function(){return" -> ".concat(c._divertAfter)},c}return W(u,[{key:"divertAfter",get:function(){return this._divertAfter},set:function(c){this._divertAfter=c,this._divertAfter&&this.AddContent(this._divertAfter)}},{key:"typeName",get:function(){return"TunnelOnwards"}},{key:"ResolveReferences",value:function(c){J2(I2(u.prototype),"ResolveReferences",this).call(this,c),this.divertAfter&&this.divertAfter.targetContent&&(this._overrideDivertTarget.targetPath=this.divertAfter.targetContent.runtimePath)}}]),u}(E2),J0=function(){function v(C,u){B(this,v),this._name=C||"",this._items=null,this._itemNameToValues=u||new Map}return W(v,[{key:"name",get:function(){return this._name}},{key:"items",get:function(){if(null==this._items){this._items=new Map;var C,u=N(this._itemNameToValues);try{for(u.s();!(C=u.n()).done;){var c=y2(C.value,2),h=c[1],d=new t1(this.name,c[0]);this._items.set(d.serialized(),h)}}catch(g){u.e(g)}finally{u.f()}}return this._items}},{key:"ValueForItem",value:function(C){if(!C.itemName)return 0;var u=this._itemNameToValues.get(C.itemName);return void 0!==u?u:0}},{key:"ContainsItem",value:function(C){return!!C.itemName&&C.originName==this.name&&this._itemNameToValues.has(C.itemName)}},{key:"ContainsItemWithName",value:function(C){return this._itemNameToValues.has(C)}},{key:"TryGetItemWithValue",value:function(C,u){var c,i=N(this._itemNameToValues);try{for(i.s();!(c=i.n()).done;){var h=y2(c.value,2);if(h[1]==C)return{result:new t1(this.name,h[0]),exists:!0}}}catch(g){i.e(g)}finally{i.f()}return{result:t1.Null,exists:!1}}},{key:"TryGetValueForItem",value:function(C,u){if(!C.itemName)return{result:0,exists:!1};var c=this._itemNameToValues.get(C.itemName);return c?{result:c,exists:!0}:{result:0,exists:!1}}}]),v}(),E6=function(v){Q(u,v);var C=a2(u);function u(c){var i;B(this,u),(i=C.call(this)).itemDefinitions=c,i.identifier=null,i.variableAssignment=null,i._elementsByName=null,i.ItemNamed=function(H){if(null===i._elementsByName){i._elementsByName=new Map;var m,L=N(i.itemDefinitions);try{for(L.s();!(m=L.n()).done;){var S=m.value;i._elementsByName.set(S.name,S)}}catch(z){L.e(z)}finally{L.f()}}return i._elementsByName.get(H)||null},i.GenerateRuntimeObject=function(){var H,m,L,S=new s1,z=N(i.itemDefinitions);try{for(z.s();!(L=z.n()).done;){var _=L.value;if(_.inInitialList){var E=new t1((null===(H=i.identifier)||void 0===H?void 0:H.name)||null,_.name||null);S.Add(E,_.seriesValue)}}}catch(A){z.e(A)}finally{z.f()}return S.SetInitialOriginName((null===(m=i.identifier)||void 0===m?void 0:m.name)||""),new l1(S)};var h,d=1,g=N(i.itemDefinitions);try{for(g.s();!(h=g.n()).done;){var M=h.value;null!==M.explicitValue&&(d=M.explicitValue),M.seriesValue=d,d+=1}}catch(H){g.e(H)}finally{g.f()}return i.AddContent(c),i}return W(u,[{key:"typeName",get:function(){return"ListDefinition"}},{key:"runtimeListDefinition",get:function(){var c,i,h=new Map,d=N(this.itemDefinitions);try{for(d.s();!(i=d.n()).done;){var g=i.value;h.has(g.name)?this.Error("List '".concat(this.identifier,"' contains duplicate items called '").concat(g.name,"'")):h.set(g.name,g.seriesValue)}}catch(M){d.e(M)}finally{d.f()}return new J0((null===(c=this.identifier)||void 0===c?void 0:c.name)||"",h)}},{key:"ResolveReferences",value:function(c){J2(I2(u.prototype),"ResolveReferences",this).call(this,c),c.CheckForNamingCollisions(this,this.identifier,x1.List)}}]),u}(E2),N6=function(v){Q(u,v);var C=a2(u);function u(c){var i,h=c.assignedExpression,d=c.isGlobalDeclaration,g=c.isTemporaryNewDeclaration,M=c.listDef,H=c.variableIdentifier;return B(this,u),(i=C.call(this))._runtimeAssignment=null,i.expression=null,i.listDefinition=null,i.GenerateRuntimeObject=function(){var m=null;if(i.isGlobalDeclaration?m=i.story:i.isNewTemporaryDeclaration&&(m=x6(H1(i))),m&&m.AddNewVariableDeclaration(H1(i)),i.isGlobalDeclaration)return null;var L=new C2;return i.expression?L.AddContent(i.expression.runtimeObject):i.listDefinition&&L.AddContent(i.listDefinition.runtimeObject),i._runtimeAssignment=new x4(i.variableName,i.isNewTemporaryDeclaration),L.AddContent(i._runtimeAssignment),L},i.toString=function(){return"".concat(i.isGlobalDeclaration?"VAR":i.isNewTemporaryDeclaration?"~ temp":""," ").concat(i.variableName)},i.variableIdentifier=H,i.isGlobalDeclaration=Boolean(d),i.isNewTemporaryDeclaration=Boolean(g),M instanceof E6?(i.listDefinition=i.AddContent(M),i.listDefinition.variableAssignment=H1(i),i.isGlobalDeclaration=!0):h&&(i.expression=i.AddContent(h)),i}return W(u,[{key:"variableName",get:function(){return this.variableIdentifier.name}},{key:"typeName",get:function(){return this.isNewTemporaryDeclaration?"temp":this.isGlobalDeclaration?null!==this.listDefinition?"LIST":"VAR":"variable assignment"}},{key:"isDeclaration",get:function(){return this.isGlobalDeclaration||this.isNewTemporaryDeclaration}},{key:"ResolveReferences",value:function(c){if(J2(I2(u.prototype),"ResolveReferences",this).call(this,c),this.isDeclaration&&null===this.listDefinition&&c.CheckForNamingCollisions(this,this.variableIdentifier,this.isGlobalDeclaration?x1.Var:x1.Temp),this.isGlobalDeclaration){var i=P(this.expression,u4);!i||i.isConstantReference||i.isListItemReference||this.Error("global variable assignments cannot refer to other variables, only literal values, constants and list items")}if(!this.isNewTemporaryDeclaration){var h=c.ResolveVariableWithName(this.variableName,this);h.found||this.Error(this.variableName in this.story.constants?"Can't re-assign to a constant (do you need to use VAR when declaring '".concat(this.variableName,"'?)"):"Variable could not be found to assign to: '".concat(this.variableName,"'"),this),this._runtimeAssignment&&(this._runtimeAssignment.isGlobal=h.isGlobal)}}}]),u}(E2),Q4=function(v){Q(u,v);var C=a2(u);function u(c){var i,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return B(this,u),(i=C.call(this)).previousWeavePoint=null,i.addContentToPreviousWeavePoint=!1,i.hasSeenChoiceInSection=!1,i.currentContainer=null,i._unnamedGatherCount=0,i._choiceCount=0,i._rootContainer=null,i._namedWeavePoints=new Map,i.looseEnds=[],i.gatherPointsToResolve=[],i.ResolveWeavePointNaming=function(){var d,g,M,H=[].concat(p1(i.FindAll(p3)(function(A){return!(null==A.name)})),p1(i.FindAll(t3)(function(A){return!(null==A.name)})));i._namedWeavePoints=new Map;var m,L=N(H);try{for(L.s();!(m=L.n()).done;){var S=m.value,z=i.namedWeavePoints.get((null===(d=S.identifier)||void 0===d?void 0:d.name)||"");if(z){var E=z;i.Error("A ".concat(z instanceof p3?"gather":"choice"," with the same label name '").concat(S.name,"' already exists in this context on line ").concat(E.debugMetadata?E.debugMetadata.startLineNumber:"NO DEBUG METADATA AVAILABLE"),S)}null!==(g=S.identifier)&&void 0!==g&&g.name&&i.namedWeavePoints.set(null===(M=S.identifier)||void 0===M?void 0:M.name,S)}}catch(A){L.e(A)}finally{L.f()}},i.ConstructWeaveHierarchyFromIndentation=function(){for(var d=0;d<i.content.length;){var g=i.content[d];if(g instanceof t3||g instanceof p3){var M=g.indentationDepth-1;if(M>i.baseIndentIndex){for(var H=d;d<i.content.length;){var m=P(i.content[d],t3)||P(i.content[d],p3);if(null!==m&&m.indentationDepth-1<=i.baseIndentIndex)break;d+=1}var L=d-H,S=i.content.slice(H,H+L);i.content.splice(H,L);var z=new u(S,M);i.InsertContent(H,z),d=H}}d+=1}},i.DetermineBaseIndentationFromContent=function(d){var g,M=N(d);try{for(M.s();!(g=M.n()).done;){var H=g.value;if(H instanceof t3||H instanceof p3)return H.indentationDepth-1}}catch(m){M.e(m)}finally{M.f()}return 0},i.GenerateRuntimeObject=function(){i._rootContainer=new C2,i.currentContainer=i._rootContainer,i.looseEnds=[],i.gatherPointsToResolve=[];var d,g=N(i.content);try{for(g.s();!(d=g.n()).done;){var M=d.value;if(M instanceof t3||M instanceof p3)i.AddRuntimeForWeavePoint(M);else if(M instanceof u){var H,m=M;i.AddRuntimeForNestedWeave(m),(H=i.gatherPointsToResolve).splice.apply(H,[0,0].concat(p1(m.gatherPointsToResolve)))}else i.AddGeneralRuntimeContent(M.runtimeObject)}}catch(L){g.e(L)}finally{g.f()}return i.PassLooseEndsToAncestors(),i._rootContainer},i.AddRuntimeForGather=function(d){var g=!i.hasSeenChoiceInSection;i.hasSeenChoiceInSection=!1;var M=d.runtimeContainer;if(d.name||(M.name="g-".concat(i._unnamedGatherCount),i._unnamedGatherCount+=1),g){if(!i.currentContainer)throw new Error;i.currentContainer.AddContent(M)}else i.rootContainer.AddToNamedContentOnly(M);var H,m=N(i.looseEnds);try{for(m.s();!(H=m.n()).done;){var L=H.value;if(!(L instanceof p3&&L.indentationDepth==d.indentationDepth)){var S=null;if(L instanceof X1)S=L.runtimeObject;else{S=new e3;var z=L;if(!z.runtimeContainer)throw new Error;z.runtimeContainer.AddContent(S)}i.gatherPointsToResolve.push(new W5(S,M))}}}catch(_){m.e(_)}finally{m.f()}i.looseEnds=[],i.currentContainer=M},i.AddRuntimeForWeavePoint=function(d){if(d instanceof p3)i.AddRuntimeForGather(d);else if(d instanceof t3){if(!i.currentContainer)throw new Error;i.previousWeavePoint instanceof p3&&i.looseEnds.splice(i.looseEnds.indexOf(i.previousWeavePoint),1);var g=d;if(i.currentContainer.AddContent(g.runtimeObject),!g.innerContentContainer)throw new Error;g.innerContentContainer.name="c-".concat(i._choiceCount),i.currentContainer.AddToNamedContentOnly(g.innerContentContainer),i._choiceCount+=1,i.hasSeenChoiceInSection=!0}i.addContentToPreviousWeavePoint=!1,i.WeavePointHasLooseEnd(d)&&(i.looseEnds.push(d),P(d,t3)&&(i.addContentToPreviousWeavePoint=!0)),i.previousWeavePoint=d},i.AddRuntimeForNestedWeave=function(d){i.AddGeneralRuntimeContent(d.rootContainer),null!==i.previousWeavePoint&&(i.looseEnds.splice(i.looseEnds.indexOf(i.previousWeavePoint),1),i.addContentToPreviousWeavePoint=!1)},i.AddGeneralRuntimeContent=function(d){if(null!==d)if(i.addContentToPreviousWeavePoint){if(!i.previousWeavePoint||!i.previousWeavePoint.runtimeContainer)throw new Error;i.previousWeavePoint.runtimeContainer.AddContent(d)}else{if(!i.currentContainer)throw new Error;i.currentContainer.AddContent(d)}},i.PassLooseEndsToAncestors=function(){if(0!==i.looseEnds.length){for(var d=null,g=null,M=!1,H=i.parent;null!==H;H=H.parent){var m=P(H,u);m&&(M||null!==d||(d=m),M&&null===g&&(g=m)),(H instanceof Ye||H instanceof Ve)&&(M=!0)}if(null!==d||null!==g)for(var L=i.looseEnds.length-1;L>=0;L-=1){var S=i.looseEnds[L],z=!1;if(M){if(S instanceof t3&&null!==d)d.ReceiveLooseEnd(S),z=!0;else if(!(S instanceof t3)){var _=d||g;null!==_&&(_.ReceiveLooseEnd(S),z=!0)}}else d?.hasOwnProperty("ReceiveLooseEnd")&&d.ReceiveLooseEnd(S),z=!0;z&&i.looseEnds.splice(L,1)}}},i.ReceiveLooseEnd=function(d){i.looseEnds.push(d)},i.WeavePointNamed=function(d){return i.namedWeavePoints&&i.namedWeavePoints.get(d)||null},i.IsGlobalDeclaration=function(d){var g=P(d,N6);return!!(g&&g.isGlobalDeclaration&&g.isDeclaration)||!!P(d,_6)},i.ContentThatFollowsWeavePoint=function(d){var g=[],M=d;if(null!==M.content){var H,m=N(M.content);try{for(m.s();!(H=m.n()).done;){var L=H.value;i.IsGlobalDeclaration(L)||g.push(L)}}catch(E){m.e(E)}finally{m.f()}}var S=P(M.parent,u);if(null===S)throw new Error("Expected weave point parent to be weave?");for(var z=S.content.indexOf(M)+1;z<S.content.length;z+=1){var _=S.content[z];if(!i.IsGlobalDeclaration(_)){if(_ instanceof t3||_ instanceof p3||_ instanceof u)break;g.push(_)}}return g},i.ValidateTermination=function(d){if(!(i.lastParsedSignificantObject instanceof Ke))if(null!==i.looseEnds&&i.looseEnds.length>0){var g,M=N(i.looseEnds);try{for(M.s();!(g=M.n()).done;){var H=g.value,m=i.ContentThatFollowsWeavePoint(H);i.ValidateFlowOfObjectsTerminates(m,H,d)}}catch(_){M.e(_)}finally{M.f()}}else{var L,S=N(i.content);try{for(S.s();!(L=S.n()).done;){var z=L.value;if(z instanceof t3||z instanceof X1)return}}catch(_){S.e(_)}finally{S.f()}i.ValidateFlowOfObjectsTerminates(i.content,H1(i),d)}},i.BadNestedTerminationHandler=function(d){for(var g=null,M=d.parent;null!==M;M=M.parent)if(M instanceof Ye||M instanceof Ve){g=P(M,Ve);break}var H="Choices nested in conditionals or sequences need to explicitly divert afterwards.";null!==g&&1===g.FindAll(t3)().length&&(H="Choices with conditions should be written: '* {condition} choice'. Otherwise, ".concat(H.toLowerCase())),i.Error(H,d)},i.ValidateFlowOfObjectsTerminates=function(d,g,M){var H,m=!1,L=g,S=N(d);try{for(S.s();!(H=S.n()).done;){var z=H.value;if(null!==z.Find(X1)(function(_){return!(_.isThread||_.isTunnel||_.isFunctionCall||_.parent instanceof N3)})&&(m=!0),null!=z.Find(Je)()){m=!0;break}L=z}}catch(_){S.e(_)}finally{S.f()}if(!m){if(L instanceof Ke)return;M(L)}},i.WeavePointHasLooseEnd=function(d){if(null===d.content)return!0;for(var g=d.content.length-1;g>=0;--g){var M=P(d.content[g],X1);if(M&&!(M.isThread||M.isTunnel||M.isFunctionCall))return!1}return!0},i.CheckForWeavePointNamingCollisions=function(){if(i.namedWeavePoints){var d,g=[],M=N(i.ancestry);try{for(M.s();!(d=M.n()).done;){var H=P(d.value,U1);if(!H)break;g.push(H)}}catch(u2){M.e(u2)}finally{M.f()}var m,L=N(i.namedWeavePoints);try{for(L.s();!(m=L.n()).done;){var S,z=y2(m.value,2),_=z[0],E=z[1],A=N(g);try{for(A.s();!(S=A.n()).done;){var R=S.value.ContentWithNameAtLevel(_);if(R&&R!==E){var K="".concat(E.GetType()," '").concat(_,"' has the same label name as a ").concat(R.GetType()," (on ").concat(R.debugMetadata,")");i.Error(K,E)}}}catch(u2){A.e(u2)}finally{A.f()}}}catch(u2){L.e(u2)}finally{L.f()}}},i.baseIndentIndex=-1==h?i.DetermineBaseIndentationFromContent(c):h,i.AddContent(c),i.ConstructWeaveHierarchyFromIndentation(),i}return W(u,[{key:"rootContainer",get:function(){return this._rootContainer||(this._rootContainer=this.GenerateRuntimeObject()),this._rootContainer}},{key:"namedWeavePoints",get:function(){return this._namedWeavePoints}},{key:"lastParsedSignificantObject",get:function(){if(0===this.content.length)return null;for(var c=null,i=this.content.length-1;i>=0;--i){var h=P(c=this.content[i],J1);if(!(h&&"\n"===h.text||this.IsGlobalDeclaration(c)))break}var d=P(c,u);return d&&(c=d.lastParsedSignificantObject),c}},{key:"typeName",get:function(){return"Weave"}},{key:"ResolveReferences",value:function(c){if(J2(I2(u.prototype),"ResolveReferences",this).call(this,c),null!==this.looseEnds&&this.looseEnds.length>0){for(var i=!1,h=this.parent;null!==h;h=h.parent)if(h instanceof Ye||h instanceof Ve){i=!0;break}i&&this.ValidateTermination(this.BadNestedTerminationHandler)}var d,g=N(this.gatherPointsToResolve);try{for(g.s();!(d=g.n()).done;){var M=d.value;M.divert.targetPath=M.targetRuntimeObj.path}}catch(H){g.e(H)}finally{g.f()}this.CheckForWeavePointNamingCollisions()}}]),u}(E2),Y4=function(v){Q(u,v);var C=a2(u);function u(c){var i;return B(this,u),(i=C.call(this))._contentContainer=null,i._conditionalDivert=null,i._ownExpression=null,i._innerWeave=null,i.isTrueBranch=!1,i.matchingEquality=!1,i.isElse=!1,i.isInline=!1,i.returnDivert=null,i.GenerateRuntimeObject=function(){if(i._innerWeave){var h,d=N(i._innerWeave.content);try{for(d.s();!(h=d.n()).done;){var g=P(h.value,J1);g&&g.text.startsWith("else:")&&i.Warning("Saw the text 'else:' which is being treated as content. Did you mean '- else:'?",g)}}catch(L){d.e(L)}finally{d.f()}}var M=new C2,H=i.matchingEquality&&!i.isElse;if(H&&M.AddContent(I.Duplicate()),i._conditionalDivert=new e3,i._conditionalDivert.isConditional=!i.isElse,!i.isTrueBranch&&!i.isElse){var m=null!==i.ownExpression;m&&M.AddContent(I.EvalStart()),i.ownExpression&&i.ownExpression.GenerateIntoContainer(M),i.matchingEquality&&M.AddContent(v2.CallWithName("==")),m&&M.AddContent(I.EvalEnd())}return M.AddContent(i._conditionalDivert),i._contentContainer=i.GenerateRuntimeForContent(),i._contentContainer.name="b",i.isInline||i._contentContainer.InsertContent(new G2("\n"),0),(H||i.isElse&&i.matchingEquality)&&i._contentContainer.InsertContent(I.PopEvaluatedValue(),0),M.AddToNamedContentOnly(i._contentContainer),i.returnDivert=new e3,i._contentContainer.AddContent(i.returnDivert),M},i.GenerateRuntimeForContent=function(){return null===i._innerWeave?new C2:i._innerWeave.rootContainer},c&&(i._innerWeave=new Q4(c),i.AddContent(i._innerWeave)),i}return W(u,[{key:"ownExpression",get:function(){return this._ownExpression},set:function(c){this._ownExpression=c,this._ownExpression&&this.AddContent(this._ownExpression)}},{key:"typeName",get:function(){return"ConditionalSingleBranch"}},{key:"ResolveReferences",value:function(c){if(!this._conditionalDivert||!this._contentContainer)throw new Error;this._conditionalDivert.targetPath=this._contentContainer.path,J2(I2(u.prototype),"ResolveReferences",this).call(this,c)}}]),u}(E2);!function(v){v[v.ParsingString=1]="ParsingString"}(D6||(D6={}));var P1,X0=function(){function v(){B(this,v),this.startLineNumber=0,this.endLineNumber=0,this.startCharacterNumber=0,this.endCharacterNumber=0,this.fileName=null,this.sourceName=null}return W(v,[{key:"Merge",value:function(C){var u=new v;return u.fileName=this.fileName,u.sourceName=this.sourceName,this.startLineNumber<C.startLineNumber?(u.startLineNumber=this.startLineNumber,u.startCharacterNumber=this.startCharacterNumber):this.startLineNumber>C.startLineNumber?(u.startLineNumber=C.startLineNumber,u.startCharacterNumber=C.startCharacterNumber):(u.startLineNumber=this.startLineNumber,u.startCharacterNumber=Math.min(this.startCharacterNumber,C.startCharacterNumber)),this.endLineNumber>C.endLineNumber?(u.endLineNumber=this.endLineNumber,u.endCharacterNumber=this.endCharacterNumber):this.endLineNumber<C.endLineNumber?(u.endLineNumber=C.endLineNumber,u.endCharacterNumber=C.endCharacterNumber):(u.endLineNumber=this.endLineNumber,u.endCharacterNumber=Math.max(this.endCharacterNumber,C.endCharacterNumber)),u}},{key:"toString",value:function(){return null!==this.fileName?"line ".concat(this.startLineNumber," of ").concat(this.fileName,'"'):"line "+this.startLineNumber}}]),v}(),Z0=function(v){Q(u,v);var C=a2(u);function u(c,i){var h;return B(this,u),(h=C.call(this)).identifier=c,h.argumentNames=i,h.GenerateRuntimeObject=function(){return h.story.AddExternal(H1(h)),null},h}return W(u,[{key:"name",get:function(){var c;return(null===(c=this.identifier)||void 0===c?void 0:c.name)||null}},{key:"typeName",get:function(){return"EXTERNAL"}},{key:"toString",value:function(){var c;return"EXTERNAL ".concat(null===(c=this.identifier)||void 0===c?void 0:c.name)}}]),u}(E2),m8=W(function v(C,u,c){B(this,v),this.name=C,this.args=u,this.isFunction=c}),j5=function(v){Q(u,v);var C=a2(u);function u(c){var i;return B(this,u),(i=C.call(this))._objToWrap=c,i.GenerateRuntimeObject=function(){return i._objToWrap},i}return W(u)}(E2),er=function(v){Q(u,v);var C=a2(u);function u(c){return B(this,u),C.call(this,c)}return W(u,[{key:"typeName",get:function(){return"Glue"}}]),u}(j5),He=function(v){Q(u,v);var C=a2(u);function u(){return B(this,u),C.apply(this,arguments)}return W(u,[{key:"toString",value:function(){return"Glue"}}]),u}(e1),Se=function(v){Q(u,v);var C=a2(u);function u(c,i,h){var d;return B(this,u),(d=C.call(this)).varIdentifier=c,d._runtimeAssignment=null,d.expression=null,d.GenerateIntoContainer=function(g){var M,H;g.AddContent(new K4((null===(M=d.varIdentifier)||void 0===M?void 0:M.name)||null)),d.expression?d.expression.GenerateIntoContainer(g):g.AddContent(new w2(1)),g.AddContent(v2.CallWithName(d.isInc?"+":"-")),d._runtimeAssignment=new x4((null===(H=d.varIdentifier)||void 0===H?void 0:H.name)||null,!1),g.AddContent(d._runtimeAssignment)},d.toString=function(){var g,M;return d.expression?"".concat(null===(g=d.varIdentifier)||void 0===g?void 0:g.name).concat(d.isInc?" += ":" -= ").concat(d.expression):"".concat(null===(M=d.varIdentifier)||void 0===M?void 0:M.name)+(d.isInc?"++":"--")},i instanceof Y1?(d.expression=i,d.AddContent(d.expression),d.isInc=Boolean(h)):d.isInc=i,d}return W(u,[{key:"typeName",get:function(){return"IncDecExpression"}},{key:"ResolveReferences",value:function(c){var i;J2(I2(u.prototype),"ResolveReferences",this).call(this,c);var h=c.ResolveVariableWithName((null===(i=this.varIdentifier)||void 0===i?void 0:i.name)||"",this);if(h.found||this.Error("variable for ".concat(this.incrementDecrementWord," could not be found: '").concat(this.varIdentifier,"' after searching: {this.descriptionOfScope}")),!this._runtimeAssignment)throw new Error;this._runtimeAssignment.isGlobal=h.isGlobal,this.parent instanceof Q4||this.parent instanceof U1||this.parent instanceof n3||this.Error("Can't use ".concat(this.incrementDecrementWord," as sub-expression"))}},{key:"incrementDecrementWord",get:function(){return this.isInc?"increment":"decrement"}}]),u}(Y1),Xe=function(v){Q(u,v);var C=a2(u);function u(c){var i;return B(this,u),(i=C.call(this)).includedStory=c,i.GenerateRuntimeObject=function(){return null},i}return W(u)}(E2),tr=W(function v(C,u,c){var i=this;B(this,v),this.type=C,this.precedence=u,this.requireWhitespace=c,this.toString=function(){return i.type}}),U5=function(v){Q(u,v);var C=a2(u);function u(c,i,h,d){return B(this,u),C.call(this,c,i,h,d)}return W(u,[{key:"flowLevel",get:function(){return u1.Knot}},{key:"typeName",get:function(){return this.isFunction?"Function":"Knot"}},{key:"ResolveReferences",value:function(c){J2(I2(u.prototype),"ResolveReferences",this).call(this,c);var i=this.story;for(var h in this.subFlowsByName){var d=i.ContentWithNameAtLevel(h,u1.Knot,!1);if(d){var g=this.subFlowsByName.get(h),M="Stitch '".concat(g?g.name:"NO STITCH FOUND","' has the same name as a knot (on ").concat(d.debugMetadata,")");this.Error(M,g)}}}}]),u}(U1),X2=function(v){Q(u,v);var C=a2(u);function u(c){var i;return B(this,u),(i=C.call(this)).itemIdentifierList=c,i.GenerateIntoContainer=function(h){var d,g,M=new s1;if(null!=i.itemIdentifierList){var H,m=N(i.itemIdentifierList);try{for(m.s();!(H=m.n()).done;){var L=H.value,S=(null===(d=L?.name)||void 0===d?void 0:d.split("."))||[],z=null,_="";S.length>1?(z=S[0],_=S[1]):_=S[0];var E=i.story.ResolveListItem(z,_,H1(i));if(null===E)i.Error(null===z?"Could not find list definition that contains item '".concat(L,"'"):"Could not find list item ".concat(L));else{if(null==E.parent)return void i.Error("Could not find list definition for item ".concat(L));z||(z=(null===(g=E.parent.identifier)||void 0===g?void 0:g.name)||null);var A=new t1(z,E.name||null);M.has(A.serialized())?i.Warning("Duplicate of item '".concat(L,"' in list.")):M.Add(A,E.seriesValue)}}}catch(R){m.e(R)}finally{m.f()}}h.AddContent(new l1(M))},i}return W(u,[{key:"typeName",get:function(){return"List"}}]),u}(Y1),k6=function(v){Q(u,v);var C=a2(u);function u(c,i){var h,d,g=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return B(this,u),(d=C.call(this)).indentifier=c,d.inInitialList=i,d.explicitValue=g,d.seriesValue=0,d.parent=null,d.GenerateRuntimeObject=function(){throw new Error("Not implemented.")},d.toString=function(){return d.fullName},d.parent=J2((h=H1(d),I2(u.prototype)),"parent",h),d}return W(u,[{key:"fullName",get:function(){var c,i=this.parent;if(null===i)throw new Error("Can't get full name without a parent list.");return"".concat(null===(c=i.identifier)||void 0===c?void 0:c.name,".").concat(this.name)}},{key:"typeName",get:function(){return"ListElement"}},{key:"name",get:function(){var c;return(null===(c=this.indentifier)||void 0===c?void 0:c.name)||null}},{key:"ResolveReferences",value:function(c){J2(I2(u.prototype),"ResolveReferences",this).call(this,c),c.CheckForNamingCollisions(this,this.indentifier,x1.ListItem)}}]),u}(E2);!function(v){v[v.InnerBlock=0]="InnerBlock",v[v.Stitch=1]="Stitch",v[v.Knot=2]="Knot",v[v.Top=3]="Top"}(P1||(P1={}));var r1=function(v){Q(u,v);var C=a2(u);function u(c,i,h,d){var g,M;return B(this,u),(M=C.call(this,c,i,h,d)).toString=function(){return"".concat(null!==M.parent?M.parent+" > ":"").concat(J2((g=H1(M),I2(u.prototype)),"toString",g).call(g))},M}return W(u,[{key:"flowLevel",get:function(){return u1.Stitch}},{key:"typeName",get:function(){return"Stitch"}}]),u}(U1),J4=function(v){Q(u,v);var C=a2(u);function u(c){var i;return B(this,u),(i=C.call(this)).text=c.toString()||"",i}return W(u,[{key:"toString",value:function(){return"# "+this.text}}]),u}(e1),G5=function(v){Q(u,v);var C=a2(u);function u(){var c;return B(this,u),(c=C.apply(this,arguments)).text="",c.index=0,c.threadAtGeneration=null,c.sourcePath="",c.targetPath=null,c.isInvisibleDefault=!1,c.originalThreadIndex=0,c}return W(u,[{key:"pathStringOnChoice",get:function(){return null===this.targetPath?O("Choice.targetPath"):this.targetPath.toString()},set:function(c){this.targetPath=new Z2(c)}}]),u}(e1),T6=function(){function v(C){B(this,v),this._lists=new Map,this._allUnambiguousListValueCache=new Map;var u,c=N(C);try{for(c.s();!(u=c.n()).done;){var i=u.value;this._lists.set(i.name,i);var h,d=N(i.items);try{for(d.s();!(h=d.n()).done;){var g=y2(h.value,2),H=g[1],m=t1.fromSerializedKey(g[0]),L=new l1(m,H);if(!m.itemName)throw new Error("item.itemName is null or undefined.");this._allUnambiguousListValueCache.set(m.itemName,L),this._allUnambiguousListValueCache.set(m.fullName,L)}}catch(S){d.e(S)}finally{d.f()}}}catch(S){c.e(S)}finally{c.f()}}return W(v,[{key:"lists",get:function(){var C,u=[],c=N(this._lists);try{for(c.s();!(C=c.n()).done;){var i=y2(C.value,2)[1];u.push(i)}}catch(h){c.e(h)}finally{c.f()}return u}},{key:"TryListGetDefinition",value:function(C,u){if(null===C)return{result:u,exists:!1};var c=this._lists.get(C);return c?{result:c,exists:!0}:{result:u,exists:!1}}},{key:"FindSingleItemListWithName",value:function(C){if(null===C)return O("name");var u=this._allUnambiguousListValueCache.get(C);return void 0!==u?u:null}}]),v}(),e2=function(){function v(){B(this,v)}return W(v,null,[{key:"JArrayToRuntimeObjList",value:function(C){var c=C.length;arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&c--;for(var i=[],h=0;h<c;h++){var g=this.JTokenToRuntimeObject(C[h]);if(null===g)return O("runtimeObj");i.push(g)}return i}},{key:"WriteDictionaryRuntimeObjs",value:function(C,u){C.WriteObjectStart();var c,i=N(u);try{for(i.s();!(c=i.n()).done;){var h=y2(c.value,2),g=h[1];C.WritePropertyStart(h[0]),this.WriteRuntimeObject(C,g),C.WritePropertyEnd()}}catch(M){i.e(M)}finally{i.f()}C.WriteObjectEnd()}},{key:"WriteListRuntimeObjs",value:function(C,u){C.WriteArrayStart();var c,i=N(u);try{for(i.s();!(c=i.n()).done;)this.WriteRuntimeObject(C,c.value)}catch(d){i.e(d)}finally{i.f()}C.WriteArrayEnd()}},{key:"WriteIntDictionary",value:function(C,u){C.WriteObjectStart();var c,i=N(u);try{for(i.s();!(c=i.n()).done;){var h=y2(c.value,2);C.WriteIntProperty(h[0],h[1])}}catch(M){i.e(M)}finally{i.f()}C.WriteObjectEnd()}},{key:"WriteRuntimeObject",value:function(C,u){var c=P(u,C2);if(c)this.WriteRuntimeContainer(C,c);else{var i=P(u,e3);if(i){var h,d="->";return i.isExternal?d="x()":i.pushesToStack&&(i.stackPushType==F2.Function?d="f()":i.stackPushType==F2.Tunnel&&(d="->t->")),h=i.hasVariableTarget?i.variableDivertName:i.targetPathString,C.WriteObjectStart(),C.WriteProperty(d,h),i.hasVariableTarget&&C.WriteProperty("var",!0),i.isConditional&&C.WriteProperty("c",!0),i.externalArgs>0&&C.WriteIntProperty("exArgs",i.externalArgs),void C.WriteObjectEnd()}var g=P(u,R5);if(g)return C.WriteObjectStart(),C.WriteProperty("*",g.pathStringOnChoice),C.WriteIntProperty("flg",g.flags),void C.WriteObjectEnd();var M=P(u,q4);if(M)C.WriteBool(M.value);else{var H=P(u,w2);if(H)C.WriteInt(H.value);else{var m=P(u,Q3);if(m)C.WriteFloat(m.value);else{var L=P(u,G2);if(L)L.isNewline?C.Write("\n",!1):(C.WriteStringStart(),C.WriteStringInner("^"),C.WriteStringInner(L.value),C.WriteStringEnd());else{var S=P(u,l1);if(S)this.WriteInkList(C,S);else{var z=P(u,b3);if(z)return C.WriteObjectStart(),null===z.value?O("divTargetVal.value"):(C.WriteProperty("^->",z.value.componentsString),void C.WriteObjectEnd());var _=P(u,l4);if(_)return C.WriteObjectStart(),C.WriteProperty("^var",_.value),C.WriteIntProperty("ci",_.contextIndex),void C.WriteObjectEnd();if(P(u,He))C.Write("<>");else{var E=P(u,I);if(E)C.Write(v._controlCommandNames[E.commandType]);else{var A=P(u,v2);if(A){var R=A.name;return"^"==R&&(R="L^"),void C.Write(R)}var K=P(u,K4);if(K){C.WriteObjectStart();var u2=K.pathStringForCount;return null!=u2?C.WriteProperty("CNT?",u2):C.WriteProperty("VAR?",K.name),void C.WriteObjectEnd()}var f2=P(u,x4);if(f2)return C.WriteObjectStart(),C.WriteProperty(f2.isGlobal?"VAR=":"temp=",f2.variableName),f2.isNewDeclaration||C.WriteProperty("re",!0),void C.WriteObjectEnd();if(P(u,E3))C.Write("void");else{var R2=P(u,J4);if(R2)return C.WriteObjectStart(),C.WriteProperty("#",R2.text),void C.WriteObjectEnd();var o1=P(u,G5);if(!o1)throw new Error("Failed to convert runtime object to Json token: "+u);this.WriteChoice(C,o1)}}}}}}}}}}},{key:"JObjectToDictionaryRuntimeObjs",value:function(C){var u=new Map;for(var c in C)if(C.hasOwnProperty(c)){var i=this.JTokenToRuntimeObject(C[c]);if(null===i)return O("inkObject");u.set(c,i)}return u}},{key:"JObjectToIntDictionary",value:function(C){var u=new Map;for(var c in C)C.hasOwnProperty(c)&&u.set(c,parseInt(C[c]));return u}},{key:"JTokenToRuntimeObject",value:function(C){if("number"==typeof C&&!isNaN(C)||"boolean"==typeof C)return j2.Create(C);if("string"==typeof C){var u=C.toString(),c=u[0];if("^"==c)return new G2(u.substring(1));if("\n"==c&&1==u.length)return new G2("\n");if("<>"==u)return new He;for(var i=0;i<v._controlCommandNames.length;++i)if(u==v._controlCommandNames[i])return new I(i);if("L^"==u&&(u="^"),v2.CallExistsWithName(u))return v2.CallWithName(u);if("->->"==u)return I.PopTunnel();if("~ret"==u)return I.PopFunction();if("void"==u)return new E3}if("object"===k2(C)&&!Array.isArray(C)){var h,d=C;if(d["^->"])return new b3(new Z2((h=d["^->"]).toString()));if(d["^var"]){var g=new l4((h=d["^var"]).toString());return"ci"in d&&(h=d.ci,g.contextIndex=parseInt(h)),g}var M=!1,H=!1,m=F2.Function,L=!1;if((h=d["->"])?M=!0:(h=d["f()"])?(M=!0,H=!0,m=F2.Function):(h=d["->t->"])?(M=!0,H=!0,m=F2.Tunnel):(h=d["x()"])&&(M=!0,L=!0,H=!1,m=F2.Function),M){var S=new e3;S.pushesToStack=H,S.stackPushType=m,S.isExternal=L;var z=h.toString();return(h=d.var)?S.variableDivertName=z:S.targetPathString=z,S.isConditional=!!d.c,L&&(h=d.exArgs)&&(S.externalArgs=parseInt(h)),S}if(h=d["*"]){var _=new R5;return _.pathStringOnChoice=h.toString(),(h=d.flg)&&(_.flags=parseInt(h)),_}if(h=d["VAR?"])return new K4(h.toString());if(h=d["CNT?"]){var E=new K4;return E.pathStringForCount=h.toString(),E}var A=!1,R=!1;if((h=d["VAR="])?(A=!0,R=!0):(h=d["temp="])&&(A=!0,R=!1),A){var K=h.toString(),f2=new x4(K,!d.re);return f2.isGlobal=R,f2}if(void 0!==d["#"])return new J4((h=d["#"]).toString());if(h=d.list){var m2=h,R2=new s1;for(var A2 in(h=d.origins)&&R2.SetInitialOriginNames(h),m2)if(m2.hasOwnProperty(A2)){var Y=m2[A2],w1=new t1(A2),m1=parseInt(Y);R2.Add(w1,m1)}return new l1(R2)}if(null!=d.originalChoicePath)return this.JObjectToChoice(d)}if(Array.isArray(C))return this.JArrayToContainer(C);if(null==C)return null;throw new Error("Failed to convert token to runtime object: "+this.toJson(C,["parent"]))}},{key:"toJson",value:function(C,u,c){return JSON.stringify(C,function(i,h){return u?.some(function(d){return d===i})?void 0:h},c)}},{key:"WriteRuntimeContainer",value:function(C,u){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(C.WriteArrayStart(),null===u)return O("container");var i,h=N(u.content);try{for(h.s();!(i=h.n()).done;)this.WriteRuntimeObject(C,i.value)}catch(K){h.e(K)}finally{h.f()}var g=u.namedOnlyContent,M=u.countFlags,H=null!=u.name&&!c,m=null!=g||M>0||H;if(m&&C.WriteObjectStart(),null!=g){var L,S=N(g);try{for(S.s();!(L=S.n()).done;){var z=y2(L.value,2),A=z[0],R=P(z[1],C2);C.WritePropertyStart(A),this.WriteRuntimeContainer(C,R,!0),C.WritePropertyEnd()}}catch(K){S.e(K)}finally{S.f()}}M>0&&C.WriteIntProperty("#f",M),H&&C.WriteProperty("#n",u.name),m?C.WriteObjectEnd():C.WriteNull(),C.WriteArrayEnd()}},{key:"JArrayToContainer",value:function(C){var u=new C2;u.content=this.JArrayToRuntimeObjList(C,!0);var c=C[C.length-1];if(null!=c){var i=new Map;for(var h in c)if("#f"==h)u.countFlags=parseInt(c[h]);else if("#n"==h)u.name=c[h].toString();else{var d=this.JTokenToRuntimeObject(c[h]),g=P(d,C2);g&&(g.name=h),i.set(h,d)}u.namedOnlyContent=i}return u}},{key:"JObjectToChoice",value:function(C){var u=new G5;return u.text=C.text.toString(),u.index=parseInt(C.index),u.sourcePath=C.originalChoicePath.toString(),u.originalThreadIndex=parseInt(C.originalThreadIndex),u.pathStringOnChoice=C.targetPath.toString(),u}},{key:"WriteChoice",value:function(C,u){C.WriteObjectStart(),C.WriteProperty("text",u.text),C.WriteIntProperty("index",u.index),C.WriteProperty("originalChoicePath",u.sourcePath),C.WriteIntProperty("originalThreadIndex",u.originalThreadIndex),C.WriteProperty("targetPath",u.pathStringOnChoice),C.WriteObjectEnd()}},{key:"WriteInkList",value:function(C,u){var c=u.value;if(null===c)return O("rawList");C.WriteObjectStart(),C.WritePropertyStart("list"),C.WriteObjectStart();var i,h=N(c);try{for(h.s();!(i=h.n()).done;){var d=y2(i.value,2),M=d[1],H=t1.fromSerializedKey(d[0]),m=M;if(null===H.itemName)return O("item.itemName");C.WritePropertyNameStart(),C.WritePropertyNameInner(H.originName?H.originName:"?"),C.WritePropertyNameInner("."),C.WritePropertyNameInner(H.itemName),C.WritePropertyNameEnd(),C.Write(m),C.WritePropertyEnd()}}catch(_){h.e(_)}finally{h.f()}if(C.WriteObjectEnd(),C.WritePropertyEnd(),0==c.Count&&null!=c.originNames&&c.originNames.length>0){C.WritePropertyStart("origins"),C.WriteArrayStart();var L,S=N(c.originNames);try{for(S.s();!(L=S.n()).done;)C.Write(L.value)}catch(_){S.e(_)}finally{S.f()}C.WriteArrayEnd(),C.WritePropertyEnd()}C.WriteObjectEnd()}},{key:"ListDefinitionsToJToken",value:function(C){var u,c={},i=N(C.lists);try{for(i.s();!(u=i.n()).done;){var h,d=u.value,g={},M=N(d.items);try{for(M.s();!(h=M.n()).done;){var H=y2(h.value,2),L=H[1],S=t1.fromSerializedKey(H[0]);if(null===S.itemName)return O("item.itemName");g[S.itemName]=L}}catch(z){M.e(z)}finally{M.f()}c[d.name]=g}}catch(z){i.e(z)}finally{i.f()}return c}},{key:"JTokenToListDefinitions",value:function(C){var u=C,c=[];for(var i in u)if(u.hasOwnProperty(i)){var h=i.toString(),d=u[i],g=new Map;for(var M in d)u.hasOwnProperty(i)&&g.set(M,parseInt(d[M]));var m=new J0(h,g);c.push(m)}return new T6(c)}}]),v}();e2._controlCommandNames=function(){var v=[];v[I.CommandType.EvalStart]="ev",v[I.CommandType.EvalOutput]="out",v[I.CommandType.EvalEnd]="/ev",v[I.CommandType.Duplicate]="du",v[I.CommandType.PopEvaluatedValue]="pop",v[I.CommandType.PopFunction]="~ret",v[I.CommandType.PopTunnel]="->->",v[I.CommandType.BeginString]="str",v[I.CommandType.EndString]="/str",v[I.CommandType.NoOp]="nop",v[I.CommandType.ChoiceCount]="choiceCnt",v[I.CommandType.Turns]="turn",v[I.CommandType.TurnsSince]="turns",v[I.CommandType.ReadCount]="readc",v[I.CommandType.Random]="rnd",v[I.CommandType.SeedRandom]="srnd",v[I.CommandType.VisitIndex]="visit",v[I.CommandType.SequenceShuffleIndex]="seq",v[I.CommandType.StartThread]="thread",v[I.CommandType.Done]="done",v[I.CommandType.End]="end",v[I.CommandType.ListFromInt]="listInt",v[I.CommandType.ListRange]="range",v[I.CommandType.ListRandom]="lrnd";for(var C=0;C<I.CommandType.TOTAL_VALUES;++C)if(null==v[C])throw new Error("Control command not accounted for in serialisation");return v}();var X4=function(){function v(){if(B(this,v),this._threadCounter=0,this._startOfRoot=y1.Null,arguments[0]instanceof C3.Story)this._startOfRoot=y1.StartOf(arguments[0].rootContentContainer),this.Reset();else{var u=arguments[0];this._threads=[];var c,i=N(u._threads);try{for(i.s();!(c=i.n()).done;)this._threads.push(c.value.Copy())}catch(d){i.e(d)}finally{i.f()}this._threadCounter=u._threadCounter,this._startOfRoot=u._startOfRoot.copy()}}return W(v,[{key:"elements",get:function(){return this.callStack}},{key:"depth",get:function(){return this.elements.length}},{key:"currentElement",get:function(){var C=this._threads[this._threads.length-1].callstack;return C[C.length-1]}},{key:"currentElementIndex",get:function(){return this.callStack.length-1}},{key:"currentThread",get:function(){return this._threads[this._threads.length-1]},set:function(C){K3.Assert(1==this._threads.length,"Shouldn't be directly setting the current thread when we have a stack of them"),this._threads.length=0,this._threads.push(C)}},{key:"canPop",get:function(){return this.callStack.length>1}},{key:"Reset",value:function(){this._threads=[],this._threads.push(new v.Thread),this._threads[0].callstack.push(new v.Element(F2.Tunnel,this._startOfRoot))}},{key:"SetJsonToken",value:function(C,u){this._threads.length=0;var c,i=N(C.threads);try{for(i.s();!(c=i.n()).done;){var d=new v.Thread(c.value,u);this._threads.push(d)}}catch(g){i.e(g)}finally{i.f()}this._threadCounter=parseInt(C.threadCounter),this._startOfRoot=y1.StartOf(u.rootContentContainer)}},{key:"WriteJson",value:function(C){var u=this;C.WriteObject(function(c){c.WritePropertyStart("threads"),c.WriteArrayStart();var i,h=N(u._threads);try{for(h.s();!(i=h.n()).done;)i.value.WriteJson(c)}catch(d){h.e(d)}finally{h.f()}c.WriteArrayEnd(),c.WritePropertyEnd(),c.WritePropertyStart("threadCounter"),c.WriteInt(u._threadCounter),c.WritePropertyEnd()})}},{key:"PushThread",value:function(){var C=this.currentThread.Copy();this._threadCounter++,C.threadIndex=this._threadCounter,this._threads.push(C)}},{key:"ForkThread",value:function(){var C=this.currentThread.Copy();return this._threadCounter++,C.threadIndex=this._threadCounter,C}},{key:"PopThread",value:function(){if(!this.canPopThread)throw new Error("Can't pop thread");this._threads.splice(this._threads.indexOf(this.currentThread),1)}},{key:"canPopThread",get:function(){return this._threads.length>1&&!this.elementIsEvaluateFromGame}},{key:"elementIsEvaluateFromGame",get:function(){return this.currentElement.type==F2.FunctionEvaluationFromGame}},{key:"Push",value:function(C){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=new v.Element(C,this.currentElement.currentPointer,!1);i.evaluationStackHeightWhenPushed=u,i.functionStartInOutputStream=c,this.callStack.push(i)}},{key:"CanPop",value:function(){var C=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!!this.canPop&&(null==C||this.currentElement.type==C)}},{key:"Pop",value:function(){if(!this.CanPop(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null))throw new Error("Mismatched push/pop in Callstack");this.callStack.pop()}},{key:"GetTemporaryVariableWithName",value:function(C){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;-1==u&&(u=this.currentElementIndex+1);var i=h3(this.callStack[u-1].temporaryVariables,C,null);return i.exists?i.result:null}},{key:"SetTemporaryVariable",value:function(C,u,c){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;-1==i&&(i=this.currentElementIndex+1);var h=this.callStack[i-1];if(!c&&!h.temporaryVariables.get(C))throw new Error("Could not find temporary variable to set: "+C);var d=h3(h.temporaryVariables,C,null);d.exists&&l1.RetainListOriginsForAssignment(d.result,u),h.temporaryVariables.set(C,u)}},{key:"ContextForVariableNamed",value:function(C){return this.currentElement.temporaryVariables.get(C)?this.currentElementIndex+1:0}},{key:"ThreadWithIndex",value:function(C){var u=this._threads.filter(function(c){if(c.threadIndex==C)return c});return u.length>0?u[0]:null}},{key:"callStack",get:function(){return this.currentThread.callstack}},{key:"callStackTrace",get:function(){for(var C=new f3,u=0;u<this._threads.length;u++){var c=this._threads[u];C.AppendFormat("=== THREAD {0}/{1} {2}===\n",u+1,this._threads.length,u==this._threads.length-1?"(current) ":"");for(var h=0;h<c.callstack.length;h++){C.Append(c.callstack[h].type==F2.Function?"  [FUNCTION] ":"  [TUNNEL] ");var d=c.callstack[h].currentPointer;if(!d.isNull){if(C.Append("<SOMEWHERE IN "),null===d.container)return O("pointer.container");C.Append(d.container.path.toString()),C.AppendLine(">")}}}return C.toString()}}]),v}();!function(v){var C=function(){function c(i,h){var d=arguments.length>2&&void 0!==arguments[2]&&arguments[2];B(this,c),this.evaluationStackHeightWhenPushed=0,this.functionStartInOutputStream=0,this.currentPointer=h.copy(),this.inExpressionEvaluation=d,this.temporaryVariables=new Map,this.type=i}return W(c,[{key:"Copy",value:function(){var i=new c(this.type,this.currentPointer,this.inExpressionEvaluation);return i.temporaryVariables=new Map(this.temporaryVariables),i.evaluationStackHeightWhenPushed=this.evaluationStackHeightWhenPushed,i.functionStartInOutputStream=this.functionStartInOutputStream,i}}]),c}();v.Element=C;var u=function(){function c(){if(B(this,c),this.threadIndex=0,this.previousPointer=y1.Null,this.callstack=[],arguments[0]&&arguments[1]){var i=arguments[0],h=arguments[1];this.threadIndex=parseInt(i.threadIndex);var d,M=N(i.callstack);try{for(M.s();!(d=M.n()).done;){var m=d.value,L=parseInt(m.type),S=y1.Null,z=void 0,_=m.cPath;if(void 0!==_){z=_.toString();var E=h.ContentAtPath(new Z2(z));if(S.container=E.container,S.index=parseInt(m.idx),null==E.obj)throw new Error("When loading state, internal story location couldn't be found: "+z+". Has the story changed since this save data was created?");if(E.approximate){if(null===S.container)return O("pointer.container");h.Warning("When loading state, exact internal story location couldn't be found: '"+z+"', so it was approximated to '"+S.container.path.toString()+"' to recover. Has the story changed since this save data was created?")}}var R=new C(L,S,!!m.exp),K=m.temp;void 0!==K?R.temporaryVariables=e2.JObjectToDictionaryRuntimeObjs(K):R.temporaryVariables.clear(),this.callstack.push(R)}}catch(m2){M.e(m2)}finally{M.f()}var u2=i.previousContentObject;if(void 0!==u2){var f2=new Z2(u2.toString());this.previousPointer=h.PointerAtPath(f2)}}}return W(c,[{key:"Copy",value:function(){var i=new c;i.threadIndex=this.threadIndex;var h,d=N(this.callstack);try{for(d.s();!(h=d.n()).done;)i.callstack.push(h.value.Copy())}catch(M){d.e(M)}finally{d.f()}return i.previousPointer=this.previousPointer.copy(),i}},{key:"WriteJson",value:function(i){i.WriteObjectStart(),i.WritePropertyStart("callstack"),i.WriteArrayStart();var h,d=N(this.callstack);try{for(d.s();!(h=d.n()).done;){var g=h.value;if(i.WriteObjectStart(),!g.currentPointer.isNull){if(null===g.currentPointer.container)return O("el.currentPointer.container");i.WriteProperty("cPath",g.currentPointer.container.path.componentsString),i.WriteIntProperty("idx",g.currentPointer.index)}i.WriteProperty("exp",g.inExpressionEvaluation),i.WriteIntProperty("type",g.type),g.temporaryVariables.size>0&&(i.WritePropertyStart("temp"),e2.WriteDictionaryRuntimeObjs(i,g.temporaryVariables),i.WritePropertyEnd()),i.WriteObjectEnd()}}catch(H){d.e(H)}finally{d.f()}if(i.WriteArrayEnd(),i.WritePropertyEnd(),i.WriteIntProperty("threadIndex",this.threadIndex),!this.previousPointer.isNull){var M=this.previousPointer.Resolve();if(null===M)return O("this.previousPointer.Resolve()");i.WriteProperty("previousContentObject",M.path.toString())}i.WriteObjectEnd()}}]),c}();v.Thread=u}(X4||(X4={}));var nr=function(){function v(C,u){B(this,v),this.variableChangedEventCallbacks=[],this.patch=null,this._batchObservingVariableChanges=!1,this._defaultGlobalVariables=new Map,this._changedVariablesForBatchObs=new Set,this._globalVariables=new Map,this._callStack=C,this._listDefsOrigin=u;try{return new Proxy(this,{get:function(c,i){return i in c?c[i]:c.$(i)},set:function(c,i,h){return i in c?c[i]=h:c.$(i,h),!0}})}catch{}}return W(v,[{key:"variableChangedEvent",value:function(C,u){var c,i=N(this.variableChangedEventCallbacks);try{for(i.s();!(c=i.n()).done;)(0,c.value)(C,u)}catch(h){i.e(h)}finally{i.f()}}},{key:"batchObservingVariableChanges",get:function(){return this._batchObservingVariableChanges},set:function(C){if(this._batchObservingVariableChanges=C,C)this._changedVariablesForBatchObs=new Set;else if(null!=this._changedVariablesForBatchObs){var u,c=N(this._changedVariablesForBatchObs);try{for(c.s();!(u=c.n()).done;){var i=u.value,h=this._globalVariables.get(i);h?this.variableChangedEvent(i,h):O("currentValue")}}catch(d){c.e(d)}finally{c.f()}this._changedVariablesForBatchObs=null}}},{key:"callStack",get:function(){return this._callStack},set:function(C){this._callStack=C}},{key:"$",value:function(C,u){if(void 0===u){var c=null;return null!==this.patch&&(c=this.patch.TryGetGlobal(C,null)).exists?c.result.valueObject:(void 0===(c=this._globalVariables.get(C))&&(c=this._defaultGlobalVariables.get(C)),void 0!==c?c.valueObject:null)}if(void 0===this._defaultGlobalVariables.get(C))throw new c1("Cannot assign to a variable ("+C+") that hasn't been declared in the story");var i=j2.Create(u);if(null==i)throw null==u?new Error("Cannot pass null to VariableState"):new Error("Invalid value passed to VariableState: "+u.toString());this.SetGlobal(C,i)}},{key:"ApplyPatch",value:function(){if(null===this.patch)return O("this.patch");var C,u=N(this.patch.globals);try{for(u.s();!(C=u.n()).done;){var c=y2(C.value,2);this._globalVariables.set(c[0],c[1])}}catch(H){u.e(H)}finally{u.f()}if(null!==this._changedVariablesForBatchObs){var d,g=N(this.patch.changedVariables);try{for(g.s();!(d=g.n()).done;)this._changedVariablesForBatchObs.add(d.value)}catch(H){g.e(H)}finally{g.f()}}this.patch=null}},{key:"SetJsonToken",value:function(C){this._globalVariables.clear();var u,c=N(this._defaultGlobalVariables);try{for(c.s();!(u=c.n()).done;){var i=y2(u.value,2),h=i[0],d=i[1],g=C[h];if(void 0!==g){var M=e2.JTokenToRuntimeObject(g);if(null===M)return O("tokenInkObject");this._globalVariables.set(h,M)}else this._globalVariables.set(h,d)}}catch(H){c.e(H)}finally{c.f()}}},{key:"WriteJson",value:function(C){C.WriteObjectStart();var u,c=N(this._globalVariables);try{for(c.s();!(u=c.n()).done;){var i=y2(u.value,2),g=i[0],M=i[1];if(v.dontSaveDefaultValues&&this._defaultGlobalVariables.has(g)){var H=this._defaultGlobalVariables.get(g);if(this.RuntimeObjectsEqual(M,H))continue}C.WritePropertyStart(g),e2.WriteRuntimeObject(C,M),C.WritePropertyEnd()}}catch(m){c.e(m)}finally{c.f()}C.WriteObjectEnd()}},{key:"RuntimeObjectsEqual",value:function(C,u){if(null===C)return O("obj1");if(null===u)return O("obj2");if(C.constructor!==u.constructor)return!1;var c=P(C,q4);if(null!==c)return c.value===U2(u,q4).value;var i=P(C,w2);if(null!==i)return i.value===U2(u,w2).value;var h=P(C,Q3);if(null!==h)return h.value===U2(u,Q3).value;var d=P(C,j2),g=P(u,j2);if(null!==d&&null!==g)return z6(d.valueObject)&&z6(g.valueObject)?d.valueObject.Equals(g.valueObject):d.valueObject===g.valueObject;throw new Error("FastRoughDefinitelyEquals: Unsupported runtime object type: "+C.constructor.name)}},{key:"GetVariableWithName",value:function(C){var c=this.GetRawVariableWithName(C,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1),i=P(c,l4);return null!==i&&(c=this.ValueAtVariablePointer(i)),c}},{key:"TryGetDefaultVariableValue",value:function(C){var u=h3(this._defaultGlobalVariables,C,null);return u.exists?u.result:null}},{key:"GlobalVariableExistsWithName",value:function(C){return this._globalVariables.has(C)||null!==this._defaultGlobalVariables&&this._defaultGlobalVariables.has(C)}},{key:"GetRawVariableWithName",value:function(C,u){if(0==u||-1==u){var c=null;if(null!==this.patch&&(c=this.patch.TryGetGlobal(C,null)).exists||(c=h3(this._globalVariables,C,null)).exists||null!==this._defaultGlobalVariables&&(c=h3(this._defaultGlobalVariables,C,null)).exists)return c.result;if(null===this._listDefsOrigin)return O("VariablesState._listDefsOrigin");var i=this._listDefsOrigin.FindSingleItemListWithName(C);if(i)return i}return this._callStack.GetTemporaryVariableWithName(C,u)}},{key:"ValueAtVariablePointer",value:function(C){return this.GetVariableWithName(C.variableName,C.contextIndex)}},{key:"Assign",value:function(C,u){var c=C.variableName;if(null===c)return O("name");var i=-1,h=!1;if(h=C.isNewDeclaration?C.isGlobal:this.GlobalVariableExistsWithName(c),C.isNewDeclaration){var d=P(u,l4);null!==d&&(u=this.ResolveVariablePointer(d))}else{var g=null;do{null!=(g=P(this.GetRawVariableWithName(c,i),l4))&&(c=g.variableName,h=0==(i=g.contextIndex))}while(null!=g)}h?this.SetGlobal(c,u):this._callStack.SetTemporaryVariable(c,u,C.isNewDeclaration,i)}},{key:"SnapshotDefaultGlobals",value:function(){this._defaultGlobalVariables=new Map(this._globalVariables)}},{key:"RetainListOriginsForAssignment",value:function(C,u){var c=U2(C,l1),i=U2(u,l1);c.value&&i.value&&0==i.value.Count&&i.value.SetInitialOriginNames(c.value.originNames)}},{key:"SetGlobal",value:function(C,u){var c=null;if(null===this.patch&&(c=h3(this._globalVariables,C,null)),null!==this.patch&&((c=this.patch.TryGetGlobal(C,null)).exists||(c=h3(this._globalVariables,C,null))),l1.RetainListOriginsForAssignment(c.result,u),null===C)return O("variableName");if(null!==this.patch?this.patch.SetGlobal(C,u):this._globalVariables.set(C,u),null!==this.variableChangedEvent&&null!==c&&u!==c.result)if(this.batchObservingVariableChanges){if(null===this._changedVariablesForBatchObs)return O("this._changedVariablesForBatchObs");null!==this.patch?this.patch.AddChangedVariable(C):null!==this._changedVariablesForBatchObs&&this._changedVariablesForBatchObs.add(C)}else this.variableChangedEvent(C,u)}},{key:"ResolveVariablePointer",value:function(C){var u=C.contextIndex;return-1==u&&(u=this.GetContextIndexOfVariableNamed(C.variableName)),P(this.GetRawVariableWithName(C.variableName,u),l4)??new l4(C.variableName,u)}},{key:"GetContextIndexOfVariableNamed",value:function(C){return this.GlobalVariableExistsWithName(C)?0:this._callStack.currentElementIndex}},{key:"ObserveVariableChange",value:function(C){this.variableChangedEventCallbacks.push(C)}}]),v}();nr.dontSaveDefaultValues=!0;var q=function(){function v(C){B(this,v),this.seed=C%2147483647,this.seed<=0&&(this.seed+=2147483646)}return W(v,[{key:"next",value:function(){return this.seed=48271*this.seed%2147483647}},{key:"nextFloat",value:function(){return(this.next()-1)/2147483646}}]),v}(),A6=function(){function v(){if(B(this,v),this._changedVariables=new Set,this._visitCounts=new Map,this._turnIndices=new Map,1===arguments.length&&null!==arguments[0]){var C=arguments[0];this._globals=new Map(C._globals),this._changedVariables=new Set(C._changedVariables),this._visitCounts=new Map(C._visitCounts),this._turnIndices=new Map(C._turnIndices)}else this._globals=new Map,this._changedVariables=new Set,this._visitCounts=new Map,this._turnIndices=new Map}return W(v,[{key:"globals",get:function(){return this._globals}},{key:"changedVariables",get:function(){return this._changedVariables}},{key:"visitCounts",get:function(){return this._visitCounts}},{key:"turnIndices",get:function(){return this._turnIndices}},{key:"TryGetGlobal",value:function(C,u){return null!==C&&this._globals.has(C)?{result:this._globals.get(C),exists:!0}:{result:u,exists:!1}}},{key:"SetGlobal",value:function(C,u){this._globals.set(C,u)}},{key:"AddChangedVariable",value:function(C){return this._changedVariables.add(C)}},{key:"TryGetVisitCount",value:function(C,u){return this._visitCounts.has(C)?{result:this._visitCounts.get(C),exists:!0}:{result:u,exists:!1}}},{key:"SetVisitCount",value:function(C,u){this._visitCounts.set(C,u)}},{key:"SetTurnIndex",value:function(C,u){this._turnIndices.set(C,u)}},{key:"TryGetTurnIndex",value:function(C,u){return this._turnIndices.has(C)?{result:this._turnIndices.get(C),exists:!0}:{result:u,exists:!1}}}]),v}(),p2=function(){function v(){B(this,v)}return W(v,null,[{key:"TextToDictionary",value:function(C){return new v.Reader(C).ToDictionary()}},{key:"TextToArray",value:function(C){return new v.Reader(C).ToArray()}}]),v}();!function(v){var C=function(){function c(i){B(this,c),this._rootObject=JSON.parse(i)}return W(c,[{key:"ToDictionary",value:function(){return this._rootObject}},{key:"ToArray",value:function(){return this._rootObject}}]),c}();v.Reader=C;var u=function(){function c(){B(this,c),this._currentPropertyName=null,this._currentString=null,this._stateStack=[],this._collectionStack=[],this._propertyNameStack=[],this._jsonObject=null}return W(c,[{key:"WriteObject",value:function(i){this.WriteObjectStart(),i(this),this.WriteObjectEnd()}},{key:"WriteObjectStart",value:function(){this.StartNewObject(!0);var i={};if(this.state===v.Writer.State.Property){this.Assert(null!==this.currentCollection),this.Assert(null!==this.currentPropertyName);var h=this._propertyNameStack.pop();this.currentCollection[h]=i,this._collectionStack.push(i)}else this.state===v.Writer.State.Array?(this.Assert(null!==this.currentCollection),this.currentCollection.push(i),this._collectionStack.push(i)):(this.Assert(this.state===v.Writer.State.None),this._jsonObject=i,this._collectionStack.push(i));this._stateStack.push(new v.Writer.StateElement(v.Writer.State.Object))}},{key:"WriteObjectEnd",value:function(){this.Assert(this.state===v.Writer.State.Object),this._collectionStack.pop(),this._stateStack.pop()}},{key:"WriteProperty",value:function(i,h){this.WritePropertyStart(i),arguments[1]instanceof Function?(0,arguments[1])(this):this.Write(arguments[1]),this.WritePropertyEnd()}},{key:"WriteIntProperty",value:function(i,h){this.WritePropertyStart(i),this.WriteInt(h),this.WritePropertyEnd()}},{key:"WriteFloatProperty",value:function(i,h){this.WritePropertyStart(i),this.WriteFloat(h),this.WritePropertyEnd()}},{key:"WritePropertyStart",value:function(i){this.Assert(this.state===v.Writer.State.Object),this._propertyNameStack.push(i),this.IncrementChildCount(),this._stateStack.push(new v.Writer.StateElement(v.Writer.State.Property))}},{key:"WritePropertyEnd",value:function(){this.Assert(this.state===v.Writer.State.Property),this.Assert(1===this.childCount),this._stateStack.pop()}},{key:"WritePropertyNameStart",value:function(){this.Assert(this.state===v.Writer.State.Object),this.IncrementChildCount(),this._currentPropertyName="",this._stateStack.push(new v.Writer.StateElement(v.Writer.State.Property)),this._stateStack.push(new v.Writer.StateElement(v.Writer.State.PropertyName))}},{key:"WritePropertyNameEnd",value:function(){this.Assert(this.state===v.Writer.State.PropertyName),this.Assert(null!==this._currentPropertyName),this._propertyNameStack.push(this._currentPropertyName),this._currentPropertyName=null,this._stateStack.pop()}},{key:"WritePropertyNameInner",value:function(i){this.Assert(this.state===v.Writer.State.PropertyName),this.Assert(null!==this._currentPropertyName),this._currentPropertyName+=i}},{key:"WriteArrayStart",value:function(){this.StartNewObject(!0);var i=[];if(this.state===v.Writer.State.Property){this.Assert(null!==this.currentCollection),this.Assert(null!==this.currentPropertyName);var h=this._propertyNameStack.pop();this.currentCollection[h]=i,this._collectionStack.push(i)}else this.state===v.Writer.State.Array?(this.Assert(null!==this.currentCollection),this.currentCollection.push(i),this._collectionStack.push(i)):(this.Assert(this.state===v.Writer.State.None),this._jsonObject=i,this._collectionStack.push(i));this._stateStack.push(new v.Writer.StateElement(v.Writer.State.Array))}},{key:"WriteArrayEnd",value:function(){this.Assert(this.state===v.Writer.State.Array),this._collectionStack.pop(),this._stateStack.pop()}},{key:"Write",value:function(i){null!==i?(this.StartNewObject(!1),this._addToCurrentObject(i)):console.error("Warning: trying to write a null value")}},{key:"WriteBool",value:function(i){null!==i&&(this.StartNewObject(!1),this._addToCurrentObject(i))}},{key:"WriteInt",value:function(i){null!==i&&(this.StartNewObject(!1),this._addToCurrentObject(Math.floor(i)))}},{key:"WriteFloat",value:function(i){null!==i&&(this.StartNewObject(!1),i==Number.POSITIVE_INFINITY?this._addToCurrentObject(34e37):i==Number.NEGATIVE_INFINITY?this._addToCurrentObject(-34e37):isNaN(i)?this._addToCurrentObject(0):this._addToCurrentObject(i))}},{key:"WriteNull",value:function(){this.StartNewObject(!1),this._addToCurrentObject(null)}},{key:"WriteStringStart",value:function(){this.StartNewObject(!1),this._currentString="",this._stateStack.push(new v.Writer.StateElement(v.Writer.State.String))}},{key:"WriteStringEnd",value:function(){this.Assert(this.state==v.Writer.State.String),this._stateStack.pop(),this._addToCurrentObject(this._currentString),this._currentString=null}},{key:"WriteStringInner",value:function(i){this.Assert(this.state===v.Writer.State.String),null!==i?this._currentString+=i:console.error("Warning: trying to write a null string")}},{key:"toString",value:function(){return null===this._jsonObject?"":JSON.stringify(this._jsonObject)}},{key:"StartNewObject",value:function(i){this.Assert(i?this.state===v.Writer.State.None||this.state===v.Writer.State.Property||this.state===v.Writer.State.Array:this.state===v.Writer.State.Property||this.state===v.Writer.State.Array),this.state===v.Writer.State.Property&&this.Assert(0===this.childCount),this.state!==v.Writer.State.Array&&this.state!==v.Writer.State.Property||this.IncrementChildCount()}},{key:"state",get:function(){return this._stateStack.length>0?this._stateStack[this._stateStack.length-1].type:v.Writer.State.None}},{key:"childCount",get:function(){return this._stateStack.length>0?this._stateStack[this._stateStack.length-1].childCount:0}},{key:"currentCollection",get:function(){return this._collectionStack.length>0?this._collectionStack[this._collectionStack.length-1]:null}},{key:"currentPropertyName",get:function(){return this._propertyNameStack.length>0?this._propertyNameStack[this._propertyNameStack.length-1]:null}},{key:"IncrementChildCount",value:function(){this.Assert(this._stateStack.length>0);var i=this._stateStack.pop();i.childCount++,this._stateStack.push(i)}},{key:"Assert",value:function(i){if(!i)throw Error("Assert failed while writing JSON")}},{key:"_addToCurrentObject",value:function(i){this.Assert(null!==this.currentCollection),this.state===v.Writer.State.Array?(this.Assert(Array.isArray(this.currentCollection)),this.currentCollection.push(i)):this.state===v.Writer.State.Property&&(this.Assert(!Array.isArray(this.currentCollection)),this.Assert(null!==this.currentPropertyName),this.currentCollection[this.currentPropertyName]=i,this._propertyNameStack.pop())}}]),c}();v.Writer=u,function(c){var i;(i=c.State||(c.State={}))[i.None=0]="None",i[i.Object=1]="Object",i[i.Array=2]="Array",i[i.Property=3]="Property",i[i.PropertyName=4]="PropertyName",i[i.String=5]="String";var h=W(function d(g){B(this,d),this.type=v.Writer.State.None,this.childCount=0,this.type=g});c.StateElement=h}(u=v.Writer||(v.Writer={}))}(p2||(p2={}));var O2,P6=function(){function v(){B(this,v);var u=arguments[1];if(this.name=arguments[0],this.callStack=new X4(u),arguments[2]){var c=arguments[2];this.callStack.SetJsonToken(c.callstack,u),this.outputStream=e2.JArrayToRuntimeObjList(c.outputStream),this.currentChoices=e2.JArrayToRuntimeObjList(c.currentChoices);var i=c.choiceThreads;void 0!==i&&this.LoadFlowChoiceThreads(i,u)}else this.outputStream=[],this.currentChoices=[]}return W(v,[{key:"WriteJson",value:function(C){var u=this;C.WriteObjectStart(),C.WriteProperty("callstack",function(g){return u.callStack.WriteJson(g)}),C.WriteProperty("outputStream",function(g){return e2.WriteListRuntimeObjs(g,u.outputStream)});var c,i=!1,h=N(this.currentChoices);try{for(h.s();!(c=h.n()).done;){var d=c.value;if(null===d.threadAtGeneration)return O("c.threadAtGeneration");d.originalThreadIndex=d.threadAtGeneration.threadIndex,null===this.callStack.ThreadWithIndex(d.originalThreadIndex)&&(i||(i=!0,C.WritePropertyStart("choiceThreads"),C.WriteObjectStart()),C.WritePropertyStart(d.originalThreadIndex),d.threadAtGeneration.WriteJson(C),C.WritePropertyEnd())}}catch(g){h.e(g)}finally{h.f()}i&&(C.WriteObjectEnd(),C.WritePropertyEnd()),C.WriteProperty("currentChoices",function(g){g.WriteArrayStart();var M,H=N(u.currentChoices);try{for(H.s();!(M=H.n()).done;)e2.WriteChoice(g,M.value)}catch(L){H.e(L)}finally{H.f()}g.WriteArrayEnd()}),C.WriteObjectEnd()}},{key:"LoadFlowChoiceThreads",value:function(C,u){var c,i=N(this.currentChoices);try{for(i.s();!(c=i.n()).done;){var h=c.value,d=this.callStack.ThreadWithIndex(h.originalThreadIndex);if(null!==d)h.threadAtGeneration=d.Copy();else{var g=C["".concat(h.originalThreadIndex)];h.threadAtGeneration=new X4.Thread(g,u)}}}catch(M){i.e(M)}finally{i.f()}}}]),v}(),no=function(){function v(C){B(this,v),this.kInkSaveStateVersion=9,this.kMinCompatibleLoadVersion=8,this.onDidLoadState=null,this._currentErrors=null,this._currentWarnings=null,this.divertedPointer=y1.Null,this._currentTurnIndex=0,this.storySeed=0,this.previousRandom=0,this.didSafeExit=!1,this._currentText=null,this._currentTags=null,this._outputStreamTextDirty=!0,this._outputStreamTagsDirty=!0,this._patch=null,this._namedFlows=null,this.kDefaultFlowName="DEFAULT_FLOW",this.story=C,this._currentFlow=new P6(this.kDefaultFlowName,C),this.OutputStreamDirty(),this._evaluationStack=[],this._variablesState=new nr(this.callStack,C.listDefinitions),this._visitCounts=new Map,this._turnIndices=new Map,this.currentTurnIndex=-1;var u=(new Date).getTime();this.storySeed=new q(u).next()%100,this.previousRandom=0,this.GoToStart()}return W(v,[{key:"ToJson",value:function(){var C=new p2.Writer;return this.WriteJson(C),C.toString()}},{key:"toJson",value:function(){return this.ToJson(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}},{key:"LoadJson",value:function(C){var u=p2.TextToDictionary(C);this.LoadJsonObj(u),null!==this.onDidLoadState&&this.onDidLoadState()}},{key:"VisitCountAtPathString",value:function(C){var u;if(null!==this._patch){var c=this.story.ContentAtPath(new Z2(C)).container;if(null===c)throw new Error("Content at path not found: "+C);if((u=this._patch.TryGetVisitCount(c,0)).exists)return u.result}return(u=h3(this._visitCounts,C,null)).exists?u.result:0}},{key:"VisitCountForContainer",value:function(C){if(null===C)return O("container");if(!C.visitsShouldBeCounted)return this.story.Error("Read count for target ("+C.name+" - on "+C.debugMetadata+") unknown. The story may need to be compiled with countAllVisits flag (-c)."),0;if(null!==this._patch){var u=this._patch.TryGetVisitCount(C,0);if(u.exists)return u.result}var c=C.path.toString(),i=h3(this._visitCounts,c,null);return i.exists?i.result:0}},{key:"IncrementVisitCountForContainer",value:function(C){if(null!==this._patch){var u=this.VisitCountForContainer(C);return u++,void this._patch.SetVisitCount(C,u)}var c=C.path.toString(),i=h3(this._visitCounts,c,null);this._visitCounts.set(c,i.exists?i.result+1:1)}},{key:"RecordTurnIndexVisitToContainer",value:function(C){if(null===this._patch){var u=C.path.toString();this._turnIndices.set(u,this.currentTurnIndex)}else this._patch.SetTurnIndex(C,this.currentTurnIndex)}},{key:"TurnsSinceForContainer",value:function(C){if(C.turnIndexShouldBeCounted||this.story.Error("TURNS_SINCE() for target ("+C.name+" - on "+C.debugMetadata+") unknown. The story may need to be compiled with countAllVisits flag (-c)."),null!==this._patch){var u=this._patch.TryGetTurnIndex(C,0);if(u.exists)return this.currentTurnIndex-u.result}var c=C.path.toString(),i=h3(this._turnIndices,c,0);return i.exists?this.currentTurnIndex-i.result:-1}},{key:"callstackDepth",get:function(){return this.callStack.depth}},{key:"outputStream",get:function(){return this._currentFlow.outputStream}},{key:"currentChoices",get:function(){return this.canContinue?[]:this._currentFlow.currentChoices}},{key:"generatedChoices",get:function(){return this._currentFlow.currentChoices}},{key:"currentErrors",get:function(){return this._currentErrors}},{key:"currentWarnings",get:function(){return this._currentWarnings}},{key:"variablesState",get:function(){return this._variablesState},set:function(C){this._variablesState=C}},{key:"callStack",get:function(){return this._currentFlow.callStack}},{key:"evaluationStack",get:function(){return this._evaluationStack}},{key:"currentTurnIndex",get:function(){return this._currentTurnIndex},set:function(C){this._currentTurnIndex=C}},{key:"currentPathString",get:function(){var C=this.currentPointer;return C.isNull?null:null===C.path?O("pointer.path"):C.path.toString()}},{key:"currentPointer",get:function(){return this.callStack.currentElement.currentPointer.copy()},set:function(C){this.callStack.currentElement.currentPointer=C.copy()}},{key:"previousPointer",get:function(){return this.callStack.currentThread.previousPointer.copy()},set:function(C){this.callStack.currentThread.previousPointer=C.copy()}},{key:"canContinue",get:function(){return!this.currentPointer.isNull&&!this.hasError}},{key:"hasError",get:function(){return null!=this.currentErrors&&this.currentErrors.length>0}},{key:"hasWarning",get:function(){return null!=this.currentWarnings&&this.currentWarnings.length>0}},{key:"currentText",get:function(){if(this._outputStreamTextDirty){var C,u=new f3,c=N(this.outputStream);try{for(c.s();!(C=c.n()).done;){var i=P(C.value,G2);null!==i&&u.Append(i.value)}}catch(h){c.e(h)}finally{c.f()}this._currentText=this.CleanOutputWhitespace(u.toString()),this._outputStreamTextDirty=!1}return this._currentText}},{key:"CleanOutputWhitespace",value:function(C){for(var u=new f3,c=-1,i=0,h=0;h<C.length;h++){var d=C.charAt(h),g=" "==d||"\t"==d;g&&-1==c&&(c=h),g||("\n"!=d&&c>0&&c!=i&&u.Append(" "),c=-1),"\n"==d&&(i=h+1),g||u.Append(d)}return u.toString()}},{key:"currentTags",get:function(){if(this._outputStreamTagsDirty){this._currentTags=[];var C,u=N(this.outputStream);try{for(u.s();!(C=u.n()).done;){var c=P(C.value,J4);null!==c&&this._currentTags.push(c.text)}}catch(i){u.e(i)}finally{u.f()}this._outputStreamTagsDirty=!1}return this._currentTags}},{key:"currentFlowName",get:function(){return this._currentFlow.name}},{key:"inExpressionEvaluation",get:function(){return this.callStack.currentElement.inExpressionEvaluation},set:function(C){this.callStack.currentElement.inExpressionEvaluation=C}},{key:"GoToStart",value:function(){this.callStack.currentElement.currentPointer=y1.StartOf(this.story.mainContentContainer)}},{key:"SwitchFlow_Internal",value:function(C){if(null===C)throw new Error("Must pass a non-null string to Story.SwitchFlow");if(null===this._namedFlows&&(this._namedFlows=new Map,this._namedFlows.set(this.kDefaultFlowName,this._currentFlow)),C!==this._currentFlow.name){var u,c=h3(this._namedFlows,C,null);c.exists?u=c.result:(u=new P6(C,this.story),this._namedFlows.set(C,u)),this._currentFlow=u,this.variablesState.callStack=this._currentFlow.callStack,this.OutputStreamDirty()}}},{key:"SwitchToDefaultFlow_Internal",value:function(){null!==this._namedFlows&&this.SwitchFlow_Internal(this.kDefaultFlowName)}},{key:"RemoveFlow_Internal",value:function(C){if(null===C)throw new Error("Must pass a non-null string to Story.DestroyFlow");if(C===this.kDefaultFlowName)throw new Error("Cannot destroy default flow");if(this._currentFlow.name===C&&this.SwitchToDefaultFlow_Internal(),null===this._namedFlows)return O("this._namedFlows");this._namedFlows.delete(C)}},{key:"CopyAndStartPatching",value:function(){var C,u,c,i,h,d=new v(this.story);if(d._patch=new A6(this._patch),d._currentFlow.name=this._currentFlow.name,d._currentFlow.callStack=new X4(this._currentFlow.callStack),(C=d._currentFlow.currentChoices).push.apply(C,p1(this._currentFlow.currentChoices)),(u=d._currentFlow.outputStream).push.apply(u,p1(this._currentFlow.outputStream)),d.OutputStreamDirty(),null!==this._namedFlows){d._namedFlows=new Map;var g,M=N(this._namedFlows);try{for(M.s();!(g=M.n()).done;){var H=y2(g.value,2);d._namedFlows.set(H[0],H[1])}}catch(S){M.e(S)}finally{M.f()}d._namedFlows.set(this._currentFlow.name,d._currentFlow)}return this.hasError&&(d._currentErrors=[],(i=d._currentErrors).push.apply(i,p1(this.currentErrors||[]))),this.hasWarning&&(d._currentWarnings=[],(h=d._currentWarnings).push.apply(h,p1(this.currentWarnings||[]))),d.variablesState=this.variablesState,d.variablesState.callStack=d.callStack,d.variablesState.patch=d._patch,(c=d.evaluationStack).push.apply(c,p1(this.evaluationStack)),this.divertedPointer.isNull||(d.divertedPointer=this.divertedPointer.copy()),d.previousPointer=this.previousPointer.copy(),d._visitCounts=this._visitCounts,d._turnIndices=this._turnIndices,d.currentTurnIndex=this.currentTurnIndex,d.storySeed=this.storySeed,d.previousRandom=this.previousRandom,d.didSafeExit=this.didSafeExit,d}},{key:"RestoreAfterPatch",value:function(){this.variablesState.callStack=this.callStack,this.variablesState.patch=this._patch}},{key:"ApplyAnyPatch",value:function(){if(null!==this._patch){this.variablesState.ApplyPatch();var C,u=N(this._patch.visitCounts);try{for(u.s();!(C=u.n()).done;){var c=y2(C.value,2);this.ApplyCountChanges(c[0],c[1],!0)}}catch(L){u.e(L)}finally{u.f()}var d,g=N(this._patch.turnIndices);try{for(g.s();!(d=g.n()).done;){var M=y2(d.value,2);this.ApplyCountChanges(M[0],M[1],!1)}}catch(L){g.e(L)}finally{g.f()}this._patch=null}}},{key:"ApplyCountChanges",value:function(C,u,c){(c?this._visitCounts:this._turnIndices).set(C.path.toString(),u)}},{key:"WriteJson",value:function(C){var u=this;if(C.WriteObjectStart(),C.WritePropertyStart("flows"),C.WriteObjectStart(),null!==this._namedFlows){var c,i=N(this._namedFlows);try{var h=function(){var d=y2(c.value,2),M=d[1];C.WriteProperty(d[0],function(H){return M.WriteJson(H)})};for(i.s();!(c=i.n()).done;)h()}catch(d){i.e(d)}finally{i.f()}}else C.WriteProperty(this._currentFlow.name,function(d){return u._currentFlow.WriteJson(d)});if(C.WriteObjectEnd(),C.WritePropertyEnd(),C.WriteProperty("currentFlowName",this._currentFlow.name),C.WriteProperty("variablesState",function(d){return u.variablesState.WriteJson(d)}),C.WriteProperty("evalStack",function(d){return e2.WriteListRuntimeObjs(d,u.evaluationStack)}),!this.divertedPointer.isNull){if(null===this.divertedPointer.path)return O("divertedPointer");C.WriteProperty("currentDivertTarget",this.divertedPointer.path.componentsString)}C.WriteProperty("visitCounts",function(d){return e2.WriteIntDictionary(d,u._visitCounts)}),C.WriteProperty("turnIndices",function(d){return e2.WriteIntDictionary(d,u._turnIndices)}),C.WriteIntProperty("turnIdx",this.currentTurnIndex),C.WriteIntProperty("storySeed",this.storySeed),C.WriteIntProperty("previousRandom",this.previousRandom),C.WriteIntProperty("inkSaveVersion",this.kInkSaveStateVersion),C.WriteIntProperty("inkFormatVersion",C3.Story.inkVersionCurrent),C.WriteObjectEnd()}},{key:"LoadJsonObj",value:function(C){var u=C,c=u.inkSaveVersion;if(null==c)throw new Error("ink save format incorrect, can't load.");if(parseInt(c)<this.kMinCompatibleLoadVersion)throw new Error("Ink save format isn't compatible with the current version (saw '"+c+"', but minimum is "+this.kMinCompatibleLoadVersion+"), so can't load.");var i=u.flows;if(null!=i){var h=i;1===Object.keys(h).length?this._namedFlows=null:null===this._namedFlows?this._namedFlows=new Map:this._namedFlows.clear();for(var d=0,g=Object.entries(h);d<g.length;d++){var M=y2(g[d],2),H=M[0],m=M[1],L=new P6(H,this.story,m);if(1===Object.keys(h).length)this._currentFlow=new P6(H,this.story,m);else{if(null===this._namedFlows)return O("this._namedFlows");this._namedFlows.set(H,L)}}null!=this._namedFlows&&this._namedFlows.size>1&&(this._currentFlow=this._namedFlows.get(u.currentFlowName))}else this._namedFlows=null,this._currentFlow.name=this.kDefaultFlowName,this._currentFlow.callStack.SetJsonToken(u.callstackThreads,this.story),this._currentFlow.outputStream=e2.JArrayToRuntimeObjList(u.outputStream),this._currentFlow.currentChoices=e2.JArrayToRuntimeObjList(u.currentChoices),this._currentFlow.LoadFlowChoiceThreads(u.choiceThreads,this.story);this.OutputStreamDirty(),this.variablesState.SetJsonToken(u.variablesState),this.variablesState.callStack=this._currentFlow.callStack,this._evaluationStack=e2.JArrayToRuntimeObjList(u.evalStack);var _=u.currentDivertTarget;if(null!=_){var E=new Z2(_.toString());this.divertedPointer=this.story.PointerAtPath(E)}this._visitCounts=e2.JObjectToIntDictionary(u.visitCounts),this._turnIndices=e2.JObjectToIntDictionary(u.turnIndices),this.currentTurnIndex=parseInt(u.turnIdx),this.storySeed=parseInt(u.storySeed),this.previousRandom=parseInt(u.previousRandom)}},{key:"ResetErrors",value:function(){this._currentErrors=null,this._currentWarnings=null}},{key:"ResetOutput",value:function(){var C,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.outputStream.length=0,null!==u&&(C=this.outputStream).push.apply(C,p1(u)),this.OutputStreamDirty()}},{key:"PushToOutputStream",value:function(C){var u=P(C,G2);if(null!==u){var c=this.TrySplittingHeadTailWhitespace(u);if(null!==c){var i,h=N(c);try{for(h.s();!(i=h.n()).done;)this.PushToOutputStreamIndividual(i.value)}catch(g){h.e(g)}finally{h.f()}return void this.OutputStreamDirty()}}this.PushToOutputStreamIndividual(C),this.OutputStreamDirty()}},{key:"PopFromOutputStream",value:function(C){this.outputStream.splice(this.outputStream.length-C,C),this.OutputStreamDirty()}},{key:"TrySplittingHeadTailWhitespace",value:function(C){var u=C.value;if(null===u)return O("single.value");for(var c=-1,i=-1,h=0;h<u.length;h++){var d=u[h];if("\n"!=d){if(" "==d||"\t"==d)continue;break}-1==c&&(c=h),i=h}for(var g=-1,M=-1,H=u.length-1;H>=0;H--){var m=u[H];if("\n"!=m){if(" "==m||"\t"==m)continue;break}-1==g&&(g=H),M=H}if(-1==c&&-1==g)return null;var L=[],S=0,z=u.length;if(-1!=c){if(c>0){var _=new G2(u.substring(0,c));L.push(_)}L.push(new G2("\n")),S=i+1}if(-1!=g&&(z=M),z>S){var E=u.substring(S,z-S);L.push(new G2(E))}if(-1!=g&&M>i&&(L.push(new G2("\n")),g<u.length-1)){var R=new G2(u.substring(g+1,u.length-g-1));L.push(R)}return L}},{key:"PushToOutputStreamIndividual",value:function(C){var u=P(C,He),c=P(C,G2),i=!0;if(u)this.TrimNewlinesFromOutputStream(),i=!0;else if(c){var h=-1,d=this.callStack.currentElement;d.type==F2.Function&&(h=d.functionStartInOutputStream);for(var g=-1,M=this.outputStream.length-1;M>=0;M--){var H=this.outputStream[M],m=H instanceof I?H:null;if(null!=(H instanceof He?H:null)){g=M;break}if(null!=m&&m.commandType==I.CommandType.BeginString){M>=h&&(h=-1);break}}if(-1!=(-1!=g&&-1!=h?Math.min(h,g):-1!=g?g:h)){if(c.isNewline)i=!1;else if(c.isNonWhitespace&&(g>-1&&this.RemoveExistingGlue(),h>-1))for(var L=this.callStack.elements,S=L.length-1;S>=0;S--){var z=L[S];if(z.type!=F2.Function)break;z.functionStartInOutputStream=-1}}else c.isNewline&&(!this.outputStreamEndsInNewline&&this.outputStreamContainsContent||(i=!1))}if(i){if(null===C)return O("obj");this.outputStream.push(C),this.OutputStreamDirty()}}},{key:"TrimNewlinesFromOutputStream",value:function(){for(var C=-1,u=this.outputStream.length-1;u>=0;){var c=this.outputStream[u],i=P(c,I),h=P(c,G2);if(null!=i||null!=h&&h.isNonWhitespace)break;null!=h&&h.isNewline&&(C=u),u--}if(C>=0)for(u=C;u<this.outputStream.length;)P(this.outputStream[u],G2)?this.outputStream.splice(u,1):u++;this.OutputStreamDirty()}},{key:"RemoveExistingGlue",value:function(){for(var C=this.outputStream.length-1;C>=0;C--){var u=this.outputStream[C];if(u instanceof He)this.outputStream.splice(C,1);else if(u instanceof I)break}this.OutputStreamDirty()}},{key:"outputStreamEndsInNewline",get:function(){if(this.outputStream.length>0)for(var C=this.outputStream.length-1;C>=0&&!(this.outputStream[C]instanceof I);C--){var u=this.outputStream[C];if(u instanceof G2){if(u.isNewline)return!0;if(u.isNonWhitespace)break}}return!1}},{key:"outputStreamContainsContent",get:function(){var C,u=N(this.outputStream);try{for(u.s();!(C=u.n()).done;)if(C.value instanceof G2)return!0}catch(c){u.e(c)}finally{u.f()}return!1}},{key:"inStringEvaluation",get:function(){for(var C=this.outputStream.length-1;C>=0;C--){var u=P(this.outputStream[C],I);if(u instanceof I&&u.commandType==I.CommandType.BeginString)return!0}return!1}},{key:"PushEvaluationStack",value:function(C){var u=P(C,l1);if(u){var c=u.value;if(null===c)return O("rawList");if(null!=c.originNames){c.origins||(c.origins=[]),c.origins.length=0;var i,h=N(c.originNames);try{for(h.s();!(i=h.n()).done;){var d=i.value;if(null===this.story.listDefinitions)return O("StoryState.story.listDefinitions");var g=this.story.listDefinitions.TryListGetDefinition(d,null);if(null===g.result)return O("StoryState def.result");c.origins.indexOf(g.result)<0&&c.origins.push(g.result)}}catch(M){h.e(M)}finally{h.f()}}}if(null===C)return O("obj");this.evaluationStack.push(C)}},{key:"PopEvaluationStack",value:function(C){if(void 0===C)return F5(this.evaluationStack.pop());if(C>this.evaluationStack.length)throw new Error("trying to pop too many objects");return F5(this.evaluationStack.splice(this.evaluationStack.length-C,C))}},{key:"PeekEvaluationStack",value:function(){return this.evaluationStack[this.evaluationStack.length-1]}},{key:"ForceEnd",value:function(){this.callStack.Reset(),this._currentFlow.currentChoices.length=0,this.currentPointer=y1.Null,this.previousPointer=y1.Null,this.didSafeExit=!0}},{key:"TrimWhitespaceFromFunctionEnd",value:function(){K3.Assert(this.callStack.currentElement.type==F2.Function);var C=this.callStack.currentElement.functionStartInOutputStream;-1==C&&(C=0);for(var u=this.outputStream.length-1;u>=C;u--){var c=this.outputStream[u],i=P(c,G2),h=P(c,I);if(null!=i){if(h||!i.isNewline&&!i.isInlineWhitespace)break;this.outputStream.splice(u,1),this.OutputStreamDirty()}}}},{key:"PopCallStack",value:function(){var C=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.callStack.currentElement.type==F2.Function&&this.TrimWhitespaceFromFunctionEnd(),this.callStack.Pop(C)}},{key:"SetChosenPath",value:function(C,u){this._currentFlow.currentChoices.length=0;var c=this.story.PointerAtPath(C);c.isNull||-1!=c.index||(c.index=0),this.currentPointer=c,u&&this.currentTurnIndex++}},{key:"StartFunctionEvaluationFromGame",value:function(C,u){this.callStack.Push(F2.FunctionEvaluationFromGame,this.evaluationStack.length),this.callStack.currentElement.currentPointer=y1.StartOf(C),this.PassArgumentsToEvaluationStack(u)}},{key:"PassArgumentsToEvaluationStack",value:function(C){if(null!==C)for(var u=0;u<C.length;u++){if("number"!=typeof C[u]&&"string"!=typeof C[u]||C[u]instanceof s1)throw new Error((F5(arguments[u]),"null"));this.PushEvaluationStack(j2.Create(C[u]))}}},{key:"TryExitFunctionEvaluationFromGame",value:function(){return this.callStack.currentElement.type==F2.FunctionEvaluationFromGame&&(this.currentPointer=y1.Null,this.didSafeExit=!0,!0)}},{key:"CompleteFunctionEvaluationFromGame",value:function(){if(this.callStack.currentElement.type!=F2.FunctionEvaluationFromGame)throw new Error("Expected external function evaluation to be complete. Stack trace: "+this.callStack.callStackTrace);for(var C=this.callStack.currentElement.evaluationStackHeightWhenPushed,u=null;this.evaluationStack.length>C;){var c=this.PopEvaluationStack();null===u&&(u=c)}if(this.PopCallStack(F2.FunctionEvaluationFromGame),u){if(u instanceof E3)return null;var i=U2(u,j2);return i.valueType==o2.DivertTarget?i.valueObject.toString():i.valueObject}return null}},{key:"AddError",value:function(C,u){u?(null==this._currentWarnings&&(this._currentWarnings=[]),this._currentWarnings.push(C)):(null==this._currentErrors&&(this._currentErrors=[]),this._currentErrors.push(C))}},{key:"OutputStreamDirty",value:function(){this._outputStreamTextDirty=!0,this._outputStreamTagsDirty=!0}}]),v}(),rr=function(){function v(){B(this,v),this.startTime=void 0}return W(v,[{key:"ElapsedMilliseconds",get:function(){return void 0===this.startTime?0:(new Date).getTime()-this.startTime}},{key:"Start",value:function(){this.startTime=(new Date).getTime()}},{key:"Stop",value:function(){this.startTime=void 0}}]),v}();(function(v){v[v.Author=0]="Author",v[v.Warning=1]="Warning",v[v.Error=2]="Error"})(O2||(O2={})),Number.isInteger||(Number.isInteger=function(v){return"number"==typeof v&&isFinite(v)&&v>-9007199254740992&&v<9007199254740992&&Math.floor(v)===v}),C3.Story=function(v){Q(u,v);var C=a2(u);function u(){var c;B(this,u),(c=C.call(this)).inkVersionMinimumCompatible=18,c.onError=null,c.onDidContinue=null,c.onMakeChoice=null,c.onEvaluateFunction=null,c.onCompleteEvaluateFunction=null,c.onChoosePathString=null,c._prevContainers=[],c.allowExternalFunctionFallbacks=!1,c._listDefinitions=null,c._variableObservers=null,c._hasValidatedExternals=!1,c._temporaryEvaluationContainer=null,c._asyncContinueActive=!1,c._stateSnapshotAtLastNewline=null,c._sawLookaheadUnsafeFunctionAfterNewline=!1,c._recursiveContinueCount=0,c._asyncSaving=!1,c._profiler=null;var h=null,d=null;if(arguments[0]instanceof C2?(void 0!==arguments[1]&&(h=arguments[1]),c._mainContentContainer=arguments[0]):d="string"==typeof arguments[0]?p2.TextToDictionary(arguments[0]):arguments[0],null!=h&&(c._listDefinitions=new T6(h)),c._externals=new Map,null!==d){var M=d,H=M.inkVersion;if(null==H)throw new Error("ink version number not found. Are you sure it's a valid .ink.json file?");var m=parseInt(H);if(m>u.inkVersionCurrent)throw new Error("Version of ink used to build story was newer than the current version of the engine");if(m<c.inkVersionMinimumCompatible)throw new Error("Version of ink used to build story is too old to be loaded by this version of the engine");m!=u.inkVersionCurrent&&console.warn("WARNING: Version of ink used to build story doesn't match current version of engine. Non-critical, but recommend synchronising.");var L,S=M.root;if(null==S)throw new Error("Root node for ink not found. Are you sure it's a valid .ink.json file?");(L=M.listDefs)&&(c._listDefinitions=e2.JTokenToListDefinitions(L)),c._mainContentContainer=U2(e2.JTokenToRuntimeObject(S),C2),c.ResetState()}return c}return W(u,[{key:"currentChoices",get:function(){var c=[];if(null===this._state)return O("this._state");var i,h=N(this._state.currentChoices);try{for(h.s();!(i=h.n()).done;){var d=i.value;d.isInvisibleDefault||(d.index=c.length,c.push(d))}}catch(g){h.e(g)}finally{h.f()}return c}},{key:"currentText",get:function(){return this.IfAsyncWeCant("call currentText since it's a work in progress"),this.state.currentText}},{key:"currentTags",get:function(){return this.IfAsyncWeCant("call currentTags since it's a work in progress"),this.state.currentTags}},{key:"currentErrors",get:function(){return this.state.currentErrors}},{key:"currentWarnings",get:function(){return this.state.currentWarnings}},{key:"currentFlowName",get:function(){return this.state.currentFlowName}},{key:"hasError",get:function(){return this.state.hasError}},{key:"hasWarning",get:function(){return this.state.hasWarning}},{key:"variablesState",get:function(){return this.state.variablesState}},{key:"listDefinitions",get:function(){return this._listDefinitions}},{key:"state",get:function(){return this._state}},{key:"StartProfiling",value:function(){}},{key:"EndProfiling",value:function(){}},{key:"ToJson",value:function(c){var i=this,h=!1;if(c||(h=!0,c=new p2.Writer),c.WriteObjectStart(),c.WriteIntProperty("inkVersion",u.inkVersionCurrent),c.WriteProperty("root",function(A){return e2.WriteRuntimeContainer(A,i._mainContentContainer)}),null!=this._listDefinitions){c.WritePropertyStart("listDefs"),c.WriteObjectStart();var d,g=N(this._listDefinitions.lists);try{for(g.s();!(d=g.n()).done;){var M=d.value;c.WritePropertyStart(M.name),c.WriteObjectStart();var H,m=N(M.items);try{for(m.s();!(H=m.n()).done;){var L=y2(H.value,2),z=L[1],_=t1.fromSerializedKey(L[0]);c.WriteIntProperty(_.itemName,z)}}catch(A){m.e(A)}finally{m.f()}c.WriteObjectEnd(),c.WritePropertyEnd()}}catch(A){g.e(A)}finally{g.f()}c.WriteObjectEnd(),c.WritePropertyEnd()}if(c.WriteObjectEnd(),h)return c.toString()}},{key:"ResetState",value:function(){this.IfAsyncWeCant("ResetState"),this._state=new no(this),this._state.variablesState.ObserveVariableChange(this.VariableStateDidChangeEvent.bind(this)),this.ResetGlobals()}},{key:"ResetErrors",value:function(){if(null===this._state)return O("this._state");this._state.ResetErrors()}},{key:"ResetCallstack",value:function(){if(this.IfAsyncWeCant("ResetCallstack"),null===this._state)return O("this._state");this._state.ForceEnd()}},{key:"ResetGlobals",value:function(){if(this._mainContentContainer.namedContent.get("global decl")){var c=this.state.currentPointer.copy();this.ChoosePath(new Z2("global decl"),!1),this.ContinueInternal(),this.state.currentPointer=c}this.state.variablesState.SnapshotDefaultGlobals()}},{key:"SwitchFlow",value:function(c){if(this.IfAsyncWeCant("switch flow"),this._asyncSaving)throw new Error("Story is already in background saving mode, can't switch flow to "+c);this.state.SwitchFlow_Internal(c)}},{key:"RemoveFlow",value:function(c){this.state.RemoveFlow_Internal(c)}},{key:"SwitchToDefaultFlow",value:function(){this.state.SwitchToDefaultFlow_Internal()}},{key:"Continue",value:function(){return this.ContinueAsync(0),this.currentText}},{key:"canContinue",get:function(){return this.state.canContinue}},{key:"asyncContinueComplete",get:function(){return!this._asyncContinueActive}},{key:"ContinueAsync",value:function(c){this._hasValidatedExternals||this.ValidateExternalBindings(),this.ContinueInternal(c)}},{key:"ContinueInternal",value:function(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null!=this._profiler&&this._profiler.PreContinue();var i=c>0;if(this._recursiveContinueCount++,!this._asyncContinueActive){if(this._asyncContinueActive=i,!this.canContinue)throw new Error("Can't continue - should check canContinue before calling Continue");this._state.didSafeExit=!1,this._state.ResetOutput(),1==this._recursiveContinueCount&&(this._state.variablesState.batchObservingVariableChanges=!0)}var h=new rr;h.Start();var d=!1;this._sawLookaheadUnsafeFunctionAfterNewline=!1;do{try{d=this.ContinueSingleStep()}catch(_){if(!(_ instanceof c1))throw _;this.AddError(_.message,void 0,_.useEndLineNumber);break}if(d||this._asyncContinueActive&&h.ElapsedMilliseconds>c)break}while(this.canContinue);if(h.Stop(),!d&&this.canContinue||(null!==this._stateSnapshotAtLastNewline&&this.RestoreStateSnapshot(),this.canContinue||(this.state.callStack.canPopThread&&this.AddError("Thread available to pop, threads should always be flat by the end of evaluation?"),0!=this.state.generatedChoices.length||this.state.didSafeExit||null!=this._temporaryEvaluationContainer||(this.state.callStack.CanPop(F2.Tunnel)?this.AddError("unexpectedly reached end of content. Do you need a '->->' to return from a tunnel?"):this.state.callStack.CanPop(F2.Function)?this.AddError("unexpectedly reached end of content. Do you need a '~ return'?"):this.AddError(this.state.callStack.canPop?"unexpectedly reached end of content for unknown reason. Please debug compiler!":"ran out of content. Do you need a '-> DONE' or '-> END'?"))),this.state.didSafeExit=!1,this._sawLookaheadUnsafeFunctionAfterNewline=!1,1==this._recursiveContinueCount&&(this._state.variablesState.batchObservingVariableChanges=!1),this._asyncContinueActive=!1,null!==this.onDidContinue&&this.onDidContinue()),this._recursiveContinueCount--,null!=this._profiler&&this._profiler.PostContinue(),this.state.hasError||this.state.hasWarning){if(null===this.onError){var g=new f3;throw g.Append("Ink had "),this.state.hasError&&(g.Append("".concat(this.state.currentErrors.length)),g.Append(1==this.state.currentErrors.length?" error":"errors"),this.state.hasWarning&&g.Append(" and ")),this.state.hasWarning&&(g.Append("".concat(this.state.currentWarnings.length)),g.Append(1==this.state.currentWarnings.length?" warning":"warnings"),this.state.hasWarning&&g.Append(" and ")),g.Append(". It is strongly suggested that you assign an error handler to story.onError. The first issue was: "),g.Append(this.state.hasError?this.state.currentErrors[0]:this.state.currentWarnings[0]),new c1(g.toString())}if(this.state.hasError){var M,H=N(this.state.currentErrors);try{for(H.s();!(M=H.n()).done;)this.onError(M.value,O2.Error)}catch(_){H.e(_)}finally{H.f()}}if(this.state.hasWarning){var L,S=N(this.state.currentWarnings);try{for(S.s();!(L=S.n()).done;)this.onError(L.value,O2.Warning)}catch(_){S.e(_)}finally{S.f()}}this.ResetErrors()}}},{key:"ContinueSingleStep",value:function(){if(null!=this._profiler&&this._profiler.PreStep(),this.Step(),null!=this._profiler&&this._profiler.PostStep(),this.canContinue||this.state.callStack.elementIsEvaluateFromGame||this.TryFollowDefaultInvisibleChoice(),null!=this._profiler&&this._profiler.PreSnapshot(),!this.state.inStringEvaluation){if(null!==this._stateSnapshotAtLastNewline){if(null===this._stateSnapshotAtLastNewline.currentTags)return O("this._stateAtLastNewline.currentTags");if(null===this.state.currentTags)return O("this.state.currentTags");var c=this.CalculateNewlineOutputStateChange(this._stateSnapshotAtLastNewline.currentText,this.state.currentText,this._stateSnapshotAtLastNewline.currentTags.length,this.state.currentTags.length);if(c==u.OutputStateChange.ExtendedBeyondNewline||this._sawLookaheadUnsafeFunctionAfterNewline)return this.RestoreStateSnapshot(),!0;c==u.OutputStateChange.NewlineRemoved&&this.DiscardSnapshot()}this.state.outputStreamEndsInNewline&&(this.canContinue?null==this._stateSnapshotAtLastNewline&&this.StateSnapshot():this.DiscardSnapshot())}return null!=this._profiler&&this._profiler.PostSnapshot(),!1}},{key:"CalculateNewlineOutputStateChange",value:function(c,i,h,d){if(null===c)return O("prevText");if(null===i)return O("currText");var g=i.length>=c.length&&"\n"==i.charAt(c.length-1);if(h==d&&c.length==i.length&&g)return u.OutputStateChange.NoChange;if(!g)return u.OutputStateChange.NewlineRemoved;if(d>h)return u.OutputStateChange.ExtendedBeyondNewline;for(var M=c.length;M<i.length;M++){var H=i.charAt(M);if(" "!=H&&"\t"!=H)return u.OutputStateChange.ExtendedBeyondNewline}return u.OutputStateChange.NoChange}},{key:"ContinueMaximally",value:function(){this.IfAsyncWeCant("ContinueMaximally");for(var c=new f3;this.canContinue;)c.Append(this.Continue());return c.toString()}},{key:"ContentAtPath",value:function(c){return this.mainContentContainer.ContentAtPath(c)}},{key:"KnotContainerWithName",value:function(c){var i=this.mainContentContainer.namedContent.get(c);return i instanceof C2?i:null}},{key:"PointerAtPath",value:function(c){if(0==c.length)return y1.Null;var i=new y1,h=c.length,d=null;return null===c.lastComponent?O("path.lastComponent"):(c.lastComponent.isIndex?(d=this.mainContentContainer.ContentAtPath(c,void 0,h=c.length-1),i.container=d.container,i.index=c.lastComponent.index):(d=this.mainContentContainer.ContentAtPath(c),i.container=d.container,i.index=-1),null==d.obj||d.obj==this.mainContentContainer&&h>0?this.Error("Failed to find content at path '"+c+"', and no approximation of it was possible."):d.approximate&&this.Warning("Failed to find content at path '"+c+"', so it was approximated to: '"+d.obj.path+"'."),i)}},{key:"StateSnapshot",value:function(){this._stateSnapshotAtLastNewline=this._state,this._state=this._state.CopyAndStartPatching()}},{key:"RestoreStateSnapshot",value:function(){null===this._stateSnapshotAtLastNewline&&O("_stateSnapshotAtLastNewline"),this._stateSnapshotAtLastNewline.RestoreAfterPatch(),this._state=this._stateSnapshotAtLastNewline,this._stateSnapshotAtLastNewline=null,this._asyncSaving||this._state.ApplyAnyPatch()}},{key:"DiscardSnapshot",value:function(){this._asyncSaving||this._state.ApplyAnyPatch(),this._stateSnapshotAtLastNewline=null}},{key:"CopyStateForBackgroundThreadSave",value:function(){if(this.IfAsyncWeCant("start saving on a background thread"),this._asyncSaving)throw new Error("Story is already in background saving mode, can't call CopyStateForBackgroundThreadSave again!");var c=this._state;return this._state=this._state.CopyAndStartPatching(),this._asyncSaving=!0,c}},{key:"BackgroundSaveComplete",value:function(){null===this._stateSnapshotAtLastNewline&&this._state.ApplyAnyPatch(),this._asyncSaving=!1}},{key:"Step",value:function(){var c=!0,i=this.state.currentPointer.copy();if(!i.isNull){for(var h=P(i.Resolve(),C2);h&&(this.VisitContainer(h,!0),0!=h.content.length);)h=P((i=y1.StartOf(h)).Resolve(),C2);this.state.currentPointer=i.copy(),null!=this._profiler&&this._profiler.Step(this.state.callStack);var d=i.Resolve(),g=this.PerformLogicAndFlowControl(d);if(!this.state.currentPointer.isNull){g&&(c=!1);var M=P(d,R5);if(M){var H=this.ProcessChoice(M);H&&this.state.generatedChoices.push(H),d=null,c=!1}if(d instanceof C2&&(c=!1),c){var m=P(d,l4);if(m&&-1==m.contextIndex){var L=this.state.callStack.ContextForVariableNamed(m.variableName);d=new l4(m.variableName,L)}this.state.inExpressionEvaluation?this.state.PushEvaluationStack(d):this.state.PushToOutputStream(d)}this.NextContent();var S=P(d,I);S&&S.commandType==I.CommandType.StartThread&&this.state.callStack.PushThread()}}}},{key:"VisitContainer",value:function(c,i){c.countingAtStartOnly&&!i||(c.visitsShouldBeCounted&&this.state.IncrementVisitCountForContainer(c),c.turnIndexShouldBeCounted&&this.state.RecordTurnIndexVisitToContainer(c))}},{key:"VisitChangedContainersDueToDivert",value:function(){var c=this.state.previousPointer.copy(),i=this.state.currentPointer.copy();if(!i.isNull&&-1!=i.index){if(this._prevContainers.length=0,!c.isNull)for(var h=P(c.Resolve(),C2)||P(c.container,C2);h;)this._prevContainers.push(h),h=P(h.parent,C2);var d=i.Resolve();if(null!=d)for(var g=P(d.parent,C2),M=!0;g&&(this._prevContainers.indexOf(g)<0||g.countingAtStartOnly);){var H=g.content.length>0&&d==g.content[0]&&M;H||(M=!1),this.VisitContainer(g,H),d=g,g=P(g.parent,C2)}}}},{key:"ProcessChoice",value:function(c){var i=!0;if(c.hasCondition){var h=this.state.PopEvaluationStack();this.IsTruthy(h)||(i=!1)}var d="",g="";if(c.hasChoiceOnlyContent&&(g=U2(this.state.PopEvaluationStack(),G2).value||""),c.hasStartContent&&(d=U2(this.state.PopEvaluationStack(),G2).value||""),c.onceOnly&&this.state.VisitCountForContainer(c.choiceTarget)>0&&(i=!1),!i)return null;var M=new G5;return M.targetPath=c.pathOnChoice,M.sourcePath=c.path.toString(),M.isInvisibleDefault=c.isInvisibleDefault,M.threadAtGeneration=this.state.callStack.ForkThread(),M.text=(d+g).replace(/^[ \t]+|[ \t]+$/g,""),M}},{key:"IsTruthy",value:function(c){if(c instanceof j2){var i=c;return i instanceof b3?(this.Error("Shouldn't use a divert target (to "+i.targetPath+") as a conditional value. Did you intend a function call 'likeThis()' or a read count check 'likeThis'? (no arrows)"),!1):i.isTruthy}return!1}},{key:"PerformLogicAndFlowControl",value:function(c){if(null==c)return!1;if(c instanceof e3){var i=c;if(i.isConditional){var h=this.state.PopEvaluationStack();if(!this.IsTruthy(h))return!0}if(i.hasVariableTarget){var d=i.variableDivertName,g=this.state.variablesState.GetVariableWithName(d);if(null==g)this.Error("Tried to divert using a target from a variable that could not be found ("+d+")");else if(!(g instanceof b3)){var M=P(g,w2),H="Tried to divert to a target from a variable, but the variable ("+d+") didn't contain a divert target, it ";this.Error(H+=M instanceof w2&&0==M.value?"was empty/null (the value 0).":"contained '"+g+"'.")}var m=U2(g,b3);this.state.divertedPointer=this.PointerAtPath(m.targetPath)}else{if(i.isExternal)return this.CallExternalFunction(i.targetPathString,i.externalArgs),!0;this.state.divertedPointer=i.targetPointer.copy()}return i.pushesToStack&&this.state.callStack.Push(i.stackPushType,void 0,this.state.outputStream.length),this.state.divertedPointer.isNull&&!i.isExternal&&this.Error(i&&i.debugMetadata&&null!=i.debugMetadata.sourceName?"Divert target doesn't exist: "+i.debugMetadata.sourceName:"Divert resolution failed: "+i),!0}if(c instanceof I){var L=c;switch(L.commandType){case I.CommandType.EvalStart:this.Assert(!1===this.state.inExpressionEvaluation,"Already in expression evaluation?"),this.state.inExpressionEvaluation=!0;break;case I.CommandType.EvalEnd:this.Assert(!0===this.state.inExpressionEvaluation,"Not in expression evaluation mode"),this.state.inExpressionEvaluation=!1;break;case I.CommandType.EvalOutput:if(this.state.evaluationStack.length>0){var S=this.state.PopEvaluationStack();if(!(S instanceof E3)){var z=new G2(S.toString());this.state.PushToOutputStream(z)}}break;case I.CommandType.NoOp:break;case I.CommandType.Duplicate:this.state.PushEvaluationStack(this.state.PeekEvaluationStack());break;case I.CommandType.PopEvaluatedValue:this.state.PopEvaluationStack();break;case I.CommandType.PopFunction:case I.CommandType.PopTunnel:var _=L.commandType==I.CommandType.PopFunction?F2.Function:F2.Tunnel,E=null;if(_==F2.Tunnel){var A=this.state.PopEvaluationStack();null===(E=P(A,b3))&&this.Assert(A instanceof E3,"Expected void if ->-> doesn't override target")}if(this.state.TryExitFunctionEvaluationFromGame())break;if(this.state.callStack.currentElement.type==_&&this.state.callStack.canPop)this.state.PopCallStack(),E&&(this.state.divertedPointer=this.PointerAtPath(E.targetPath));else{var R=new Map;R.set(F2.Function,"function return statement (~ return)"),R.set(F2.Tunnel,"tunnel onwards statement (->->)");var K=R.get(this.state.callStack.currentElement.type);this.state.callStack.canPop||(K="end of flow (-> END or choice)");var u2="Found "+R.get(_)+", when expected "+K;this.Error(u2)}break;case I.CommandType.BeginString:this.state.PushToOutputStream(L),this.Assert(!0===this.state.inExpressionEvaluation,"Expected to be in an expression when evaluating a string"),this.state.inExpressionEvaluation=!1;break;case I.CommandType.EndString:for(var f2=[],m2=0,R2=this.state.outputStream.length-1;R2>=0;--R2){var o1=this.state.outputStream[R2];m2++;var A2=P(o1,I);if(A2&&A2.commandType==I.CommandType.BeginString)break;o1 instanceof G2&&f2.push(o1)}this.state.PopFromOutputStream(m2),f2=f2.reverse();var Y,w1=new f3,m1=N(f2);try{for(m1.s();!(Y=m1.n()).done;)w1.Append(Y.value.toString())}catch(_2){m1.e(_2)}finally{m1.f()}this.state.inExpressionEvaluation=!0,this.state.PushEvaluationStack(new G2(w1.toString()));break;case I.CommandType.ChoiceCount:this.state.PushEvaluationStack(new w2(this.state.generatedChoices.length));break;case I.CommandType.Turns:this.state.PushEvaluationStack(new w2(this.state.currentTurnIndex+1));break;case I.CommandType.TurnsSince:case I.CommandType.ReadCount:var q5=this.state.PopEvaluationStack();if(!(q5 instanceof b3)){var h4="";q5 instanceof w2&&(h4=". Did you accidentally pass a read count ('knot_name') instead of a target ('-> knot_name')?"),this.Error("TURNS_SINCE / READ_COUNT expected a divert target (knot, stitch, label name), but saw "+q5+h4);break}var m3,ir=U2(q5,b3),g8=P(this.ContentAtPath(ir.targetPath).correctObj,C2);null!=g8?m3=L.commandType==I.CommandType.TurnsSince?this.state.TurnsSinceForContainer(g8):this.state.VisitCountForContainer(g8):(m3=L.commandType==I.CommandType.TurnsSince?-1:0,this.Warning("Failed to find container for "+L.toString()+" lookup at "+ir.targetPath.toString())),this.state.PushEvaluationStack(new w2(m3));break;case I.CommandType.Random:var r3=P(this.state.PopEvaluationStack(),w2),B2=P(this.state.PopEvaluationStack(),w2);if(null==B2||!(B2 instanceof w2))return this.Error("Invalid value for minimum parameter of RANDOM(min, max)");if(null==r3||!(B2 instanceof w2))return this.Error("Invalid value for maximum parameter of RANDOM(min, max)");if(null===r3.value)return O("maxInt.value");if(null===B2.value)return O("minInt.value");var I6=r3.value-B2.value+1;(!isFinite(I6)||I6>Number.MAX_SAFE_INTEGER)&&(I6=Number.MAX_SAFE_INTEGER,this.Error("RANDOM was called with a range that exceeds the size that ink numbers can use.")),I6<=0&&this.Error("RANDOM was called with minimum as "+B2.value+" and maximum as "+r3.value+". The maximum must be larger");var Z4=new q(this.state.storySeed+this.state.previousRandom).next();this.state.PushEvaluationStack(new w2(Z4%I6+B2.value)),this.state.previousRandom=Z4;break;case I.CommandType.SeedRandom:var ee=P(this.state.PopEvaluationStack(),w2);if(null==ee||!(ee instanceof w2))return this.Error("Invalid value passed to SEED_RANDOM");if(null===ee.value)return O("minInt.value");this.state.storySeed=ee.value,this.state.previousRandom=0,this.state.PushEvaluationStack(new E3);break;case I.CommandType.VisitIndex:var $5=this.state.VisitCountForContainer(this.state.currentPointer.container)-1;this.state.PushEvaluationStack(new w2($5));break;case I.CommandType.SequenceShuffleIndex:var K5=this.NextSequenceShuffleIndex();this.state.PushEvaluationStack(new w2(K5));break;case I.CommandType.StartThread:break;case I.CommandType.Done:this.state.callStack.canPopThread?this.state.callStack.PopThread():(this.state.didSafeExit=!0,this.state.currentPointer=y1.Null);break;case I.CommandType.End:this.state.ForceEnd();break;case I.CommandType.ListFromInt:var Ze=P(this.state.PopEvaluationStack(),w2),X3=U2(this.state.PopEvaluationStack(),G2);if(null===Ze)throw new c1("Passed non-integer when creating a list element from a numerical value.");var E4=null;if(null===this.listDefinitions)return O("this.listDefinitions");var v8=this.listDefinitions.TryListGetDefinition(X3.value,null);if(!v8.exists)throw new c1("Failed to find LIST called "+X3.value);if(null===Ze.value)return O("minInt.value");var G1=v8.result.TryGetItemWithValue(Ze.value,t1.Null);G1.exists&&(E4=new l1(G1.result,Ze.value)),null==E4&&(E4=new l1),this.state.PushEvaluationStack(E4);break;case I.CommandType.ListRange:var y8=P(this.state.PopEvaluationStack(),j2),Q5=P(this.state.PopEvaluationStack(),j2),F6=P(this.state.PopEvaluationStack(),l1);if(null===F6||null===Q5||null===y8)throw new c1("Expected list, minimum and maximum for LIST_RANGE");if(null===F6.value)return O("targetList.value");var k3=F6.value.ListWithSubRange(Q5.valueObject,y8.valueObject);this.state.PushEvaluationStack(new l1(k3));break;case I.CommandType.ListRandom:var M8=this.state.PopEvaluationStack();if(null===M8)throw new c1("Expected list for LIST_RANDOM");var e6=M8.value,q1=null;if(null===e6)throw O("list");if(0==e6.Count)q1=new s1;else{for(var Y2=new q(this.state.storySeed+this.state.previousRandom).next(),Z1=Y2%e6.Count,$1=e6.entries(),i3=0;i3<=Z1-1;i3++)$1.next();var g3=$1.next().value,$={Key:t1.fromSerializedKey(g3[0]),Value:g3[1]};if(null===$.Key.originName)return O("randomItem.Key.originName");(q1=new s1($.Key.originName,this)).Add($.Key,$.Value),this.state.previousRandom=Y2}this.state.PushEvaluationStack(new l1(q1));break;default:this.Error("unhandled ControlCommand: "+L)}return!0}if(c instanceof x4){var b2=c,C1=this.state.PopEvaluationStack();return this.state.variablesState.Assign(b2,C1),!0}if(c instanceof K4){var K1=c,Z3=null;if(null!=K1.pathForCount){var te=this.state.VisitCountForContainer(K1.containerForCount);Z3=new w2(te)}else null==(Z3=this.state.variablesState.GetVariableWithName(K1.name))&&(this.Warning("Variable not found: '"+K1.name+"'. Using default value of 0 (false). This can happen with temporary variables if the declaration hasn't yet been hit. Globals are always given a default value on load if a value doesn't exist in the save state."),Z3=new w2(0));return this.state.PushEvaluationStack(Z3),!0}if(c instanceof v2){var g1=c,t6=this.state.PopEvaluationStack(g1.numberOfParameters),ze=g1.Call(t6);return this.state.PushEvaluationStack(ze),!0}return!1}},{key:"ChoosePathString",value:function(c){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(this.IfAsyncWeCant("call ChoosePathString right now"),null!==this.onChoosePathString&&this.onChoosePathString(c,h),i)this.ResetCallstack();else if(this.state.callStack.currentElement.type==F2.Function){var d="",g=this.state.callStack.currentElement.currentPointer.container;throw null!=g&&(d="("+g.path.toString()+") "),new Error("Story was running a function "+d+"when you called ChoosePathString("+c+") - this is almost certainly not not what you want! Full stack trace: \n"+this.state.callStack.callStackTrace)}this.state.PassArgumentsToEvaluationStack(h),this.ChoosePath(new Z2(c))}},{key:"IfAsyncWeCant",value:function(c){if(this._asyncContinueActive)throw new Error("Can't "+c+". Story is in the middle of a ContinueAsync(). Make more ContinueAsync() calls or a single Continue() call beforehand.")}},{key:"ChoosePath",value:function(c){this.state.SetChosenPath(c,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),this.VisitChangedContainersDueToDivert()}},{key:"ChooseChoiceIndex",value:function(c){var i=this.currentChoices;this.Assert(c>=0&&c<i.length,"choice out of range");var h=i[c];return null!==this.onMakeChoice&&this.onMakeChoice(h),null===h.threadAtGeneration?O("choiceToChoose.threadAtGeneration"):null===h.targetPath?O("choiceToChoose.targetPath"):(this.state.callStack.currentThread=h.threadAtGeneration,void this.ChoosePath(h.targetPath))}},{key:"HasFunction",value:function(c){try{return null!=this.KnotContainerWithName(c)}catch{return!1}}},{key:"EvaluateFunction",value:function(c){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],h=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null!==this.onEvaluateFunction&&this.onEvaluateFunction(c,i),this.IfAsyncWeCant("evaluate a function"),null==c)throw new Error("Function is null");if(""==c||""==c.trim())throw new Error("Function is empty or white space.");var d=this.KnotContainerWithName(c);if(null==d)throw new Error("Function doesn't exist: '"+c+"'");var g=[];g.push.apply(g,p1(this.state.outputStream)),this._state.ResetOutput(),this.state.StartFunctionEvaluationFromGame(d,i);for(var M=new f3;this.canContinue;)M.Append(this.Continue());var H=M.toString();this._state.ResetOutput(g);var m=this.state.CompleteFunctionEvaluationFromGame();return null!=this.onCompleteEvaluateFunction&&this.onCompleteEvaluateFunction(c,i,H,m),h?{returned:m,output:H}:m}},{key:"EvaluateExpression",value:function(c){var i=this.state.callStack.elements.length;this.state.callStack.Push(F2.Tunnel),this._temporaryEvaluationContainer=c,this.state.GoToStart();var h=this.state.evaluationStack.length;return this.Continue(),this._temporaryEvaluationContainer=null,this.state.callStack.elements.length>i&&this.state.PopCallStack(),this.state.evaluationStack.length>h?this.state.PopEvaluationStack():null}},{key:"CallExternalFunction",value:function(c,i){if(null===c)return O("funcName");var h=this._externals.get(c),d=null,g=void 0!==h;if(!g||h.lookAheadSafe||null===this._stateSnapshotAtLastNewline){if(!g){if(this.allowExternalFunctionFallbacks)return d=this.KnotContainerWithName(c),this.Assert(null!==d,"Trying to call EXTERNAL function '"+c+"' which has not been bound, and fallback ink function could not be found."),this.state.callStack.Push(F2.Function,void 0,this.state.outputStream.length),void(this.state.divertedPointer=y1.StartOf(d));this.Assert(!1,"Trying to call EXTERNAL function '"+c+"' which has not been bound (and ink fallbacks disabled).")}for(var M=[],H=0;H<i;++H){var m=U2(this.state.PopEvaluationStack(),j2).valueObject;M.push(m)}M.reverse();var L=h.function(M),S=null;null!=L?(S=j2.Create(L),this.Assert(null!==S,"Could not create ink value from returned object of type "+k2(L))):S=new E3,this.state.PushEvaluationStack(S)}else this._sawLookaheadUnsafeFunctionAfterNewline=!0}},{key:"BindExternalFunctionGeneral",value:function(c,i,h){this.IfAsyncWeCant("bind an external function"),this.Assert(!this._externals.has(c),"Function '"+c+"' has already been bound."),this._externals.set(c,{function:i,lookAheadSafe:h})}},{key:"TryCoerce",value:function(c){return c}},{key:"BindExternalFunction",value:function(c,i,h){var d=this;this.Assert(null!=i,"Can't bind a null function"),this.BindExternalFunctionGeneral(c,function(g){d.Assert(g.length>=i.length,"External function expected "+i.length+" arguments");for(var M=[],H=0,m=g.length;H<m;H++)M[H]=d.TryCoerce(g[H]);return i.apply(null,M)},h)}},{key:"UnbindExternalFunction",value:function(c){this.IfAsyncWeCant("unbind an external a function"),this.Assert(this._externals.has(c),"Function '"+c+"' has not been bound."),this._externals.delete(c)}},{key:"ValidateExternalBindings",value:function(){var c=null,i=null,h=arguments[1]||new Set;if(arguments[0]instanceof C2&&(c=arguments[0]),arguments[0]instanceof e1&&(i=arguments[0]),null===c&&null===i)if(this.ValidateExternalBindings(this._mainContentContainer,h),this._hasValidatedExternals=!0,0==h.size)this._hasValidatedExternals=!0;else{var d="Error: Missing function binding for external";d+=h.size>1?"s":"",d+=": '",d+=Array.from(h).join("', '"),d+="' ",this.Error(d+=this.allowExternalFunctionFallbacks?", and no fallback ink function found.":" (ink fallbacks disabled)")}else if(null!=c){var g,M=N(c.content);try{for(M.s();!(g=M.n()).done;){var H=g.value;null!=H&&H.hasValidName||this.ValidateExternalBindings(H,h)}}catch(K){M.e(K)}finally{M.f()}var L,S=N(c.namedContent);try{for(S.s();!(L=S.n()).done;){var z=y2(L.value,2);this.ValidateExternalBindings(P(z[1],e1),h)}}catch(K){S.e(K)}finally{S.f()}}else if(null!=i){var E=P(i,e3);if(E&&E.isExternal){var A=E.targetPathString;if(null===A)return O("name");this._externals.has(A)||this.allowExternalFunctionFallbacks&&this.mainContentContainer.namedContent.has(A)||h.add(A)}}}},{key:"ObserveVariable",value:function(c,i){if(this.IfAsyncWeCant("observe a new variable"),null===this._variableObservers&&(this._variableObservers=new Map),!this.state.variablesState.GlobalVariableExistsWithName(c))throw new Error("Cannot observe variable '"+c+"' because it wasn't declared in the ink story.");this._variableObservers.has(c)?this._variableObservers.get(c).push(i):this._variableObservers.set(c,[i])}},{key:"ObserveVariables",value:function(c,i){for(var h=0,d=c.length;h<d;h++)this.ObserveVariable(c[h],i[h])}},{key:"RemoveVariableObserver",value:function(c,i){if(this.IfAsyncWeCant("remove a variable observer"),null!==this._variableObservers)if(null!=i){if(this._variableObservers.has(i))if(null!=c){var h=this._variableObservers.get(i);null!=h&&(h.splice(h.indexOf(c),1),0===h.length&&this._variableObservers.delete(i))}else this._variableObservers.delete(i)}else if(null!=c){var d,g=N(this._variableObservers.keys());try{for(g.s();!(d=g.n()).done;){var M=d.value,H=this._variableObservers.get(M);null!=H&&(H.splice(H.indexOf(c),1),0===H.length&&this._variableObservers.delete(M))}}catch(m){g.e(m)}finally{g.f()}}}},{key:"VariableStateDidChangeEvent",value:function(c,i){if(null!==this._variableObservers){var h=this._variableObservers.get(c);if(void 0!==h){if(!(i instanceof j2))throw new Error("Tried to get the value of a variable that isn't a standard type");var d,g=U2(i,j2),M=N(h);try{for(M.s();!(d=M.n()).done;)(0,d.value)(c,g.valueObject)}catch(H){M.e(H)}finally{M.f()}}}}},{key:"globalTags",get:function(){return this.TagsAtStartOfFlowContainerWithPathString("")}},{key:"TagsForContentAtPath",value:function(c){return this.TagsAtStartOfFlowContainerWithPathString(c)}},{key:"TagsAtStartOfFlowContainerWithPathString",value:function(c){var i=new Z2(c),h=this.ContentAtPath(i).container;if(null===h)return O("flowContainer");for(;;){var d=h.content[0];if(!(d instanceof C2))break;h=d}var g,M=null,H=N(h.content);try{for(H.s();!(g=H.n()).done;){var m=P(g.value,J4);if(!m)break;null==M&&(M=[]),M.push(m.text)}}catch(L){H.e(L)}finally{H.f()}return M}},{key:"BuildStringOfHierarchy",value:function(){var c=new f3;return this.mainContentContainer.BuildStringOfHierarchy(c,0,this.state.currentPointer.Resolve()),c.toString()}},{key:"BuildStringOfContainer",value:function(c){var i=new f3;return c.BuildStringOfHierarchy(i,0,this.state.currentPointer.Resolve()),i.toString()}},{key:"NextContent",value:function(){if(this.state.previousPointer=this.state.currentPointer.copy(),(this.state.divertedPointer.isNull||(this.state.currentPointer=this.state.divertedPointer.copy(),this.state.divertedPointer=y1.Null,this.VisitChangedContainersDueToDivert(),this.state.currentPointer.isNull))&&!this.IncrementContentPointer()){var c=!1;this.state.callStack.CanPop(F2.Function)?(this.state.PopCallStack(F2.Function),this.state.inExpressionEvaluation&&this.state.PushEvaluationStack(new E3),c=!0):this.state.callStack.canPopThread?(this.state.callStack.PopThread(),c=!0):this.state.TryExitFunctionEvaluationFromGame(),c&&!this.state.currentPointer.isNull&&this.NextContent()}}},{key:"IncrementContentPointer",value:function(){var c=!0,i=this.state.callStack.currentElement.currentPointer.copy();if(i.index++,null===i.container)return O("pointer.container");for(;i.index>=i.container.content.length;){c=!1;var h=P(i.container.parent,C2);if(!(h instanceof C2))break;var d=h.content.indexOf(i.container);if(-1==d)break;if((i=new y1(h,d)).index++,c=!0,null===i.container)return O("pointer.container")}return c||(i=y1.Null),this.state.callStack.currentElement.currentPointer=i.copy(),c}},{key:"TryFollowDefaultInvisibleChoice",value:function(){var c=this._state.currentChoices,i=c.filter(function(d){return d.isInvisibleDefault});if(0==i.length||c.length>i.length)return!1;var h=i[0];return null===h.targetPath?O("choice.targetPath"):null===h.threadAtGeneration?O("choice.threadAtGeneration"):(this.state.callStack.currentThread=h.threadAtGeneration,null!==this._stateSnapshotAtLastNewline&&(this.state.callStack.currentThread=this.state.callStack.ForkThread()),this.ChoosePath(h.targetPath,!1),!0)}},{key:"NextSequenceShuffleIndex",value:function(){var c=P(this.state.PopEvaluationStack(),w2);if(!(c instanceof w2))return this.Error("expected number of elements in sequence for shuffle index"),0;var i=this.state.currentPointer.container;if(null===i)return O("seqContainer");if(null===c.value)return O("numElementsIntVal.value");var h=c.value,d=U2(this.state.PopEvaluationStack(),w2).value;if(null===d)return O("seqCount");for(var g=d/h,M=d%h,H=i.path.toString(),m=0,L=0,S=H.length;L<S;L++)m+=H.charCodeAt(L)||0;for(var _=new q(Math.floor(m+g+this.state.storySeed)),E=[],A=0;A<h;++A)E.push(A);for(var R=0;R<=M;++R){var K=_.next()%E.length,u2=E[K];if(E.splice(K,1),R==M)return u2}throw new Error("Should never reach here")}},{key:"Error",value:function(c){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],h=new c1(c);throw h.useEndLineNumber=i,h}},{key:"Warning",value:function(c){this.AddError(c,!0)}},{key:"AddError",value:function(c){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],d=this.currentDebugMetadata,g=i?"WARNING":"ERROR";this.state.AddError(c=null!=d?"RUNTIME "+g+": '"+d.fileName+"' line "+(arguments.length>2&&void 0!==arguments[2]&&arguments[2]?d.endLineNumber:d.startLineNumber)+": "+c:this.state.currentPointer.isNull?"RUNTIME "+g+": "+c:"RUNTIME "+g+": ("+this.state.currentPointer+"): "+c,i),i||this.state.ForceEnd()}},{key:"Assert",value:function(c){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(0==c)throw null==i&&(i="Story assert"),new Error(i+" "+this.currentDebugMetadata)}},{key:"currentDebugMetadata",get:function(){var c,i=this.state.currentPointer;if(!i.isNull&&null!==i.Resolve()&&null!==(c=i.Resolve().debugMetadata))return c;for(var h=this.state.callStack.elements.length-1;h>=0;--h)if(!(i=this.state.callStack.elements[h].currentPointer).isNull&&null!==i.Resolve()&&null!==(c=i.Resolve().debugMetadata))return c;for(var d=this.state.outputStream.length-1;d>=0;--d)if(null!==(c=this.state.outputStream[d].debugMetadata))return c;return null}},{key:"mainContentContainer",get:function(){return this._temporaryEvaluationContainer?this._temporaryEvaluationContainer:this._mainContentContainer}}]),u}(e1),C3.Story.inkVersionCurrent=20,function(v){var C;(C=v.OutputStateChange||(v.OutputStateChange={}))[C.NoChange=0]="NoChange",C[C.ExtendedBeyondNewline=1]="ExtendedBeyondNewline",C[C.NewlineRemoved=2]="NewlineRemoved"}(C3.Story||(C3.Story={}));var be=function(v){Q(u,v);var C=a2(u);function u(c){var i,h=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return B(this,u),(i=C.call(this,null,c,null,!1,h))._errorHandler=null,i._hadError=!1,i._hadWarning=!1,i._dontFlattenContainers=new Set,i._listDefs=new Map,i.constants=new Map,i.externals=new Map,i.countAllVisits=!1,i.ExportRuntime=function(){var d,g;i._errorHandler=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i.constants=new Map;var H,m=N(i.FindAll(_6)());try{for(m.s();!(H=m.n()).done;){var L=H.value,S=i.constants.get(L.constantName);if(S&&!S.Equals(L.expression)){var z="CONST '".concat(L.constantName,"' has been redefined with a different value. Multiple definitions of the same CONST are valid so long as they contain the same value. Initial definition was on ").concat(S.debugMetadata,".");i.Error(z,L,!1)}i.constants.set(L.constantName,L.expression)}}catch(m1){m.e(m1)}finally{m.f()}i._listDefs=new Map;var _,E=N(i.FindAll(E6)());try{for(E.s();!(_=E.n()).done;){var A=_.value;null!==(d=A.identifier)&&void 0!==d&&d.name&&i._listDefs.set(null===(g=A.identifier)||void 0===g?void 0:g.name,A)}}catch(m1){E.e(m1)}finally{E.f()}i.externals=new Map,i.ResolveWeavePointNaming();var R=i.runtimeObject,K=new C2;K.AddContent(I.EvalStart());var u2,f2=[],m2=N(i.variableDeclarations);try{for(m2.s();!(u2=m2.n()).done;){var R2=y2(u2.value,2),o1=R2[0],A2=R2[1];if(A2.isGlobalDeclaration){if(A2.listDefinition)i._listDefs.set(o1,A2.listDefinition),K.AddContent(A2.listDefinition.runtimeObject),f2.push(A2.listDefinition.runtimeListDefinition);else{if(!A2.expression)throw new Error;A2.expression.GenerateIntoContainer(K)}var Y=new x4(o1,!0);Y.isGlobal=!0,K.AddContent(Y)}}}catch(m1){m2.e(m1)}finally{m2.f()}K.AddContent(I.EvalEnd()),K.AddContent(I.End()),i.variableDeclarations.size>0&&(K.name="global decl",R.AddToNamedContentOnly(K)),R.AddContent(I.Done());var w1=new C3.Story(R,f2);return i.runtimeObject=w1,i.hadError?null:(i.FlattenContainersIn(R),i.ResolveReferences(H1(i)),i.hadError?null:(w1.ResetState(),w1))},i.ResolveList=function(d){return i._listDefs.get(d)||null},i.ResolveListItem=function(d,g){var M=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,H=null;if(d)return(H=i._listDefs.get(d))?H.ItemNamed(g):null;var m,L=null,S=null,z=N(i._listDefs.entries());try{for(z.s();!(m=z.n()).done;){var E=y2(m.value,2)[1],A=E.ItemNamed(g);A&&(L?i.Error("Ambiguous item name '".concat(g,"' found in multiple sets, including ").concat(S.identifier," and ").concat(E.identifier),M,!1):(L=A,S=E))}}catch(R){z.e(R)}finally{z.f()}return L},i.FlattenContainersIn=function(d){var g=new Set;if(d.content){var M,H=N(d.content);try{for(H.s();!(M=H.n()).done;){var m=P(M.value,C2);m&&g.add(m)}}catch(R){H.e(R)}finally{H.f()}}if(d.namedContent){var L,S=N(d.namedContent);try{for(S.s();!(L=S.n()).done;){var z=P(y2(L.value,2)[1],C2);z&&g.add(z)}}catch(R){S.e(R)}finally{S.f()}}var _,E=N(g);try{for(E.s();!(_=E.n()).done;){var A=_.value;i.TryFlattenContainer(A),i.FlattenContainersIn(A)}}catch(R){E.e(R)}finally{E.f()}},i.TryFlattenContainer=function(d){if(!(d.namedContent&&d.namedContent.size>0||d.hasValidName||i._dontFlattenContainers.has(d))){var g=P(d.parent,C2);if(g){var M=g.content.indexOf(d);g.content.splice(M,1);var H=d.ownDebugMetadata;if(d.content){var m,L=N(d.content);try{for(L.s();!(m=L.n()).done;){var S=m.value;S.parent=null,null!==H&&null===S.ownDebugMetadata&&(S.debugMetadata=H),g.InsertContent(S,M),M+=1}}catch(z){L.e(z)}finally{L.f()}}}}},i.Error=function(d,g,M){var H=M?S3.Warning:S3.Error,m="";if(g instanceof Ke?(m+="TODO: ",H=S3.Author):m+=M?"WARNING: ":"ERROR: ",g&&null!==g.debugMetadata&&g.debugMetadata.startLineNumber>=1&&(null!=g.debugMetadata.fileName&&(m+="'".concat(g.debugMetadata.fileName,"' ")),m+="line ".concat(g.debugMetadata.startLineNumber,": ")),d=m+=d,null===i._errorHandler)throw new Error(d);i._errorHandler(d,H),i._hadError=H===S3.Error,i._hadWarning=H===S3.Warning},i.ResetError=function(){i._hadError=!1,i._hadWarning=!1},i.IsExternal=function(d){return i.externals.has(d)},i.AddExternal=function(d){i.externals.has(d.name)?i.Error("Duplicate EXTERNAL definition of '".concat(d.name,"'"),d,!1):d.name&&i.externals.set(d.name,d)},i.DontFlattenContainer=function(d){i._dontFlattenContainers.add(d)},i.NameConflictError=function(d,g,M,H){d.Error("".concat(H," '").concat(g,"': name has already been used for a ").concat(M.typeName.toLowerCase()," on ").concat(M.debugMetadata))},i.CheckForNamingCollisions=function(d,g,M){var H,L=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"")||d.typeName;if(u.IsReservedKeyword(g?.name))d.Error("'".concat(g,"' cannot be used for the name of a ").concat(L.toLowerCase()," because it's a reserved keyword"));else if(C4.IsBuiltIn(g?.name||""))d.Error("'".concat(g,"' cannot be used for the name of a ").concat(L.toLowerCase()," because it's a built in function"));else{var z=P(i.ContentWithNameAtLevel(g?.name||"",u1.Knot),U1);if(!z||z===d&&M!==x1.Arg){if(!(M<x1.List)){var _,E=N(i._listDefs);try{for(E.s();!(_=E.n()).done;){var A=y2(_.value,2),K=A[1];if(g?.name===A[0]&&d!==K&&K.variableAssignment!==d&&i.NameConflictError(d,g?.name,K,L),!(d instanceof k6)){var u2,f2=N(K.itemDefinitions);try{for(f2.s();!(u2=f2.n()).done;){var m2=u2.value;g?.name===m2.name&&i.NameConflictError(d,g?.name||"",m2,L)}}catch(w3){f2.e(w3)}finally{f2.f()}}}}catch(w3){E.e(w3)}finally{E.f()}if(!(M<=x1.Var)){var R2=g?.name&&i.variableDeclarations.get(g?.name)||null;if(R2&&R2!==d&&R2.isGlobalDeclaration&&null==R2.listDefinition&&i.NameConflictError(d,g?.name||"",R2,L),!(M<x1.SubFlowAndWeave)){var A2=new D4(g).ResolveFromContext(d);if(A2&&A2!==d)i.NameConflictError(d,g?.name||"",A2,L);else if(!(M<x1.Arg)&&M!==x1.Arg){var Y=P(d,U1);if(Y||(Y=x6(d)),Y&&Y.hasParameters&&Y.args){var w1,m1=N(Y.args);try{for(m1.s();!(w1=m1.n()).done;)if((null===(H=w1.value.identifier)||void 0===H?void 0:H.name)===g?.name)return void d.Error("".concat(L," '").concat(g,"': name has already been used for a argument to ").concat(Y.identifier," on ").concat(Y.debugMetadata))}catch(w3){m1.e(w3)}finally{m1.f()}}}}}}}else i.NameConflictError(d,g?.name||"",z,L)}},i}return W(u,[{key:"flowLevel",get:function(){return u1.Story}},{key:"hadError",get:function(){return this._hadError}},{key:"hadWarning",get:function(){return this._hadWarning}},{key:"typeName",get:function(){return"Story"}},{key:"PreProcessTopLevelObjects",value:function(c){J2(I2(u.prototype),"PreProcessTopLevelObjects",this).call(this,c);var i,h=[],d=N(c);try{for(d.s();!(i=d.n()).done;){var g=i.value;if(g instanceof Xe){var M=g,H=c.indexOf(g);if(c.splice(H,1),M.includedStory){var m=[],L=M.includedStory;if(null!=L.content){var S,z=N(L.content);try{for(z.s();!(S=z.n()).done;){var _=S.value;_ instanceof U1?h.push(_):m.push(_)}}catch(E){z.e(E)}finally{z.f()}m.push(new J1("\n")),c.splice.apply(c,[H,0].concat(m))}}}}}catch(E){d.e(E)}finally{d.f()}c.splice.apply(c,[0,0].concat(h))}}]),u}(U1);be.IsReservedKeyword=function(v){switch(v){case"true":case"false":case"not":case"return":case"else":case"VAR":case"CONST":case"temp":case"LIST":case"function":return!0}return!1};var I1=function(v){Q(u,v);var C=a2(u);function u(c){var i;return B(this,u),(i=C.call(this)).GenerateIntoContainer=function(h){h.AddContent(I.BeginString());var d,g=N(i.content);try{for(g.s();!(d=g.n()).done;)h.AddContent(d.value.runtimeObject)}catch(H){g.e(H)}finally{g.f()}h.AddContent(I.EndString())},i.toString=function(){var h,d="",g=N(i.content);try{for(g.s();!(h=g.n()).done;)d+=h.value}catch(M){g.e(M)}finally{g.f()}return d},i.AddContent(c),i}return W(u,[{key:"isSingleString",get:function(){return 1===this.content.length&&this.content[0]instanceof J1}},{key:"typeName",get:function(){return"String"}},{key:"Equals",value:function(c){var i=P(c,u);return null!==i&&!(!this.isSingleString||!i.isSingleString)&&this.toString()===i.toString()}}]),u}(Y1),ro=function(v){Q(u,v);var C=a2(u);function u(c){return B(this,u),C.call(this,c)}return W(u,[{key:"typeName",get:function(){return"Tag"}}]),u}(j5),ar=W(function v(C){B(this,v),this.rootPath=C,this.ResolveInkFilename=function(){throw Error("Can't resolve filename because no FileHandler was provided when instantiating the parser / compiler.")},this.LoadInkFileContents=function(){throw Error("Can't load ink content because no FileHandler was provided when instantiating the parser / compiler.")}}),z1=function(v){Q(u,v);var C=a2(u);function u(c){var i,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,M=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(B(this,u),(i=C.call(this,c)).ParseStory=function(){var m=i.StatementsAtLevel(P1.Top);return new be(m,i._rootParser!==H1(i))},i.SeparatedList=function(m,L){var S=i.Parse(m);if(null===S)return null;var z=[];for(z.push(S);;){var _=i.BeginRule();if(null===L()){i.FailRule(_);break}var E=i.Parse(m);if(null===E){i.FailRule(_);break}i.SucceedRule(_),z.push(E)}return z},i.CreateDebugMetadata=function(m,L){var S=new X0;return S.startLineNumber=(m?.lineIndex||0)+1,S.endLineNumber=L.lineIndex+1,S.startCharacterNumber=(m?.characterInLineIndex||0)+1,S.endCharacterNumber=L.characterInLineIndex+1,S.fileName=i._filename,S},i.RuleDidSucceed=function(m,L,S){var z=P(m,E2);z&&(z.debugMetadata=i.CreateDebugMetadata(L,S));var _=Array.isArray(m)?m:null;if(null!==_){var E,A=N(_);try{for(A.s();!(E=A.n()).done;){var R=E.value;P(R,E2)&&(R.hasOwnDebugMetadata||(R.debugMetadata=i.CreateDebugMetadata(L,S)))}}catch(u2){A.e(u2)}finally{A.f()}}var K=P(m,$4);null!=K&&(K.debugMetadata=i.CreateDebugMetadata(L,S))},i.OnStringParserError=function(m,L){var S=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,z=arguments.length>3&&void 0!==arguments[3]&&arguments[3],E=z?"WARNING:":"ERROR:";if(null!==i._filename&&(E+=" '".concat(i._filename,"'")),E+=" line ".concat(S+1,": ").concat(m),null===i._externalErrorHandler)throw new Error(E);i._externalErrorHandler(E,z?S3.Warning:S3.Error)},i.AuthorWarning=function(){i.Whitespace();var m=i.Parse(i.IdentifierWithMetadata);if(null===m||"TODO"!==m.name)return null;i.Whitespace(),i.ParseString(":"),i.Whitespace();var L=i.ParseUntilCharactersFromString("\n\r");return L?new Ke(L):null},i.ExtendIdentifierCharacterRanges=function(m){var L,S=N(u.ListAllCharacterRanges());try{for(S.s();!(L=S.n()).done;)m.AddCharacters(L.value.ToCharacterSet())}catch(_){S.e(_)}finally{S.f()}},i._parsingChoice=!1,i.Choice=function(){var m=!0,L=i.Interleave(i.OptionalExclude(i.Whitespace),i.String("*"));if(!L){if(null===(L=i.Interleave(i.OptionalExclude(i.Whitespace),i.String("+"))))return null;m=!1}var S=i.Parse(i.BracketedName);i.Whitespace();var z=i.Parse(i.ChoiceCondition);if(i.Whitespace(),i._parsingChoice)throw new Error("Already parsing a choice - shouldn't have nested choices");i._parsingChoice=!0;var _=null,E=i.Parse(i.MixedTextAndLogic);E&&(_=new n3(E));var A=null,R=null,K=null!==i.ParseString("[");if(K){var u2=i.Parse(i.MixedTextAndLogic);null!==u2&&(A=new n3(u2)),i.Expect(i.String("]"),"closing ']' for weave-style option");var f2=i.Parse(i.MixedTextAndLogic);null!==f2&&(R=new n3(f2))}i.Whitespace();var m2=i.Parse(i.MultiDivert);i._parsingChoice=!1,i.Whitespace();var R2=!_&&!R&&!A;R2&&null===m2&&i.Warning("Choice is completely empty. Interpretting as a default fallback choice. Add a divert arrow to remove this warning: * ->"),_||!K||A||i.Warning("Blank choice - if you intended a default fallback choice, use the `* ->` syntax"),R||(R=new n3);var o1=i.Parse(i.Tags);if(null!==o1&&R.AddContent(o1),null!==m2){var A2,Y=N(m2);try{for(Y.s();!(A2=Y.n()).done;){var w1=A2.value,m1=P(w1,X1);m1&&m1.isEmpty||R.AddContent(w1)}}catch(w3){Y.e(w3)}finally{Y.f()}}R.AddContent(new J1("\n"));var a1=new t3(_,A,R);return S&&(a1.identifier=S),a1.indentationDepth=L.length,a1.hasWeaveStyleInlineBrackets=K,a1.condition=z,a1.onceOnly=m,a1.isInvisibleDefault=R2,a1},i.ChoiceCondition=function(){var m=i.Interleave(i.ChoiceSingleCondition,i.ChoiceConditionsSpace);return null===m?null:1===m.length?m[0]:new p8(m)},i.ChoiceConditionsSpace=function(){return i.Newline(),i.Whitespace(),J3},i.ChoiceSingleCondition=function(){if(null===i.ParseString("{"))return null;var m=i.Expect(i.Expression,"choice condition inside { }");return i.DisallowIncrement(m),i.Expect(i.String("}"),"closing '}' for choice condition"),m},i.Gather=function(){var m=i.Parse(i.GatherDashes);if(null===m)return null;var L=Number(m),S=i.Parse(i.BracketedName),z=new p3(S,L);return i.Newline(),z},i.GatherDashes=function(){i.Whitespace();for(var m=0;null!==i.ParseDashNotArrow();)m+=1,i.Whitespace();return 0===m?null:m},i.ParseDashNotArrow=function(){var m=i.BeginRule();return null===i.ParseString("->")&&"-"===i.ParseSingleCharacter()?i.SucceedRule(m):i.FailRule(m)},i.BracketedName=function(){if(null===i.ParseString("("))return null;i.Whitespace();var m=i.Parse(i.IdentifierWithMetadata);return null===m?null:(i.Whitespace(),i.Expect(i.String(")"),"closing ')' for bracketed name"),m)},i.InnerConditionalContent=function(m){if(void 0===m){var L=i.Parse(i.ConditionExpression),S=i.Parse(function(){return i.InnerConditionalContent(L)});return null===S?null:S}var z,_=null!==m,E=null===i.Parse(i.Newline);if(E&&!_)return null;if(E)z=i.InlineConditionalBranches();else{if(null===(z=i.MultilineConditionalBranches())){if(m){var A=i.StatementsAtLevel(P1.InnerBlock);if(null!==A){z=[new Y4(A)];var R=i.Parse(i.SingleMultilineCondition);R&&(R.isElse||(i.ErrorWithParsedObject("Expected an '- else:' clause here rather than an extra condition",R),R.isElse=!0),z.push(R))}}if(null===z)return null}else if(1===z.length&&z[0].isElse&&m){var K=new Y4(null);K.isTrueBranch=!0,z.unshift(K)}if(m)for(var u2=!1,f2=0;f2<z.length;++f2){var m2=z[f2],R2=f2===z.length-1;m2.ownExpression?(m2.matchingEquality=!0,u2=!0):u2&&R2?(m2.matchingEquality=!0,m2.isElse=!0):!R2&&z.length>2?i.ErrorWithParsedObject("Only final branch can be an 'else'. Did you miss a ':'?",m2):0===f2?m2.isTrueBranch=!0:m2.isElse=!0}else{for(var o1=0;o1<z.length;++o1){var A2=z[o1];if(null===A2.ownExpression)if(o1===z.length-1)A2.isElse=!0;else if(A2.isElse){var w1=z[z.length-1];w1.isElse?i.ErrorWithParsedObject("Multiple 'else' cases. Can have a maximum of one, at the end.",w1):i.ErrorWithParsedObject("'else' case in conditional should always be the final one",A2)}else i.ErrorWithParsedObject("Branch doesn't have condition. Are you missing a ':'? ",A2)}1===z.length&&null===z[0].ownExpression&&i.ErrorWithParsedObject("Condition block with no conditions",z[0])}}if(null===z)return null;var m1,a1=N(z);try{for(a1.s();!(m1=a1.n()).done;)m1.value.isInline=E}catch(w3){a1.e(w3)}finally{a1.f()}return new Ve(m,z)},i.InlineConditionalBranches=function(){var m=i.Interleave(i.MixedTextAndLogic,i.Exclude(i.String("|")),null,!1);if(null===m||0===m.length)return null;var L=[];if(m.length>2)i.Error("Expected one or two alternatives separated by '|' in inline conditional");else{var S=new Y4(m[0]);if(S.isTrueBranch=!0,L.push(S),m.length>1){var z=new Y4(m[1]);z.isElse=!0,L.push(z)}}return L},i.MultilineConditionalBranches=function(){i.MultilineWhitespace();var m=i.OneOrMore(i.SingleMultilineCondition);return null===m?null:(i.MultilineWhitespace(),m)},i.SingleMultilineCondition=function(){if(i.Whitespace(),null!==i.ParseString("->")||null===i.ParseString("-"))return null;i.Whitespace();var m=null,L=null!==i.Parse(i.ElseExpression);L||(m=i.Parse(i.ConditionExpression));var S=i.StatementsAtLevel(P1.InnerBlock);null===m&&null===S&&(i.Error("expected content for the conditional branch following '-'"),S=[new J1("")]),i.MultilineWhitespace();var z=new Y4(S);return z.ownExpression=m,z.isElse=L,z},i.ConditionExpression=function(){var m=i.Parse(i.Expression);return null===m?null:(i.DisallowIncrement(m),i.Whitespace(),null===i.ParseString(":")?null:m)},i.ElseExpression=function(){return null===i.ParseString("else")?null:(i.Whitespace(),null===i.ParseString(":")?null:J3)},i._nonTextPauseCharacters=null,i._nonTextEndCharacters=null,i._notTextEndCharactersChoice=null,i._notTextEndCharactersString=null,i.TrimEndWhitespace=function(m,L){if(m.length>0){var S=m.length-1,z=m[S];if(z instanceof J1){var _=z;_.text=_.text.replace(new RegExp(/[ \t]+$/g),""),L?_.text+=" ":0===_.text.length&&(m.splice(S,1),i.TrimEndWhitespace(m,!1))}}},i.LineOfMixedTextAndLogic=function(){i.Parse(i.Whitespace);var m=i.Parse(i.MixedTextAndLogic),L=!1,S=i.Parse(i.Tags);if(S)if(m){var z,_=N(S);try{for(_.s();!(z=_.n()).done;)m.push(z.value)}catch(R){_.e(R)}finally{_.f()}}else m=S,L=!0;if(!m||!m.length)return null;var A=m[0];return A&&A.text&&A.text.startsWith("return")&&i.Warning("Do you need a '~' before 'return'? If not, perhaps use a glue: <> (since it's lowercase) or rewrite somehow?"),0===m.length?null:(m[m.length-1]instanceof X1||i.TrimEndWhitespace(m,!1),L||m.push(new J1("\n")),i.Expect(i.EndOfLine,"end of line",i.SkipToNextLine),m)},i.MixedTextAndLogic=function(){null!==i.ParseObject(i.Spaced(i.String("~")))&&i.Error("You shouldn't use a '~' here - tildas are for logic that's on its own line. To do inline logic, use { curly braces } instead");var m=i.Interleave(i.Optional(i.ContentText),i.Optional(i.InlineLogicOrGlue));if(!i._parsingChoice){var L,S=i.Parse(i.MultiDivert);null!==S&&(null===m&&(m=[]),i.TrimEndWhitespace(m,!0),(L=m).push.apply(L,p1(S)))}return m||null},i.ContentText=function(){return i.ContentTextAllowingEscapeChar()},i.ContentTextAllowingEscapeChar=function(){for(var m=null;;){var L=i.Parse(i.ContentTextNoEscape),S=null!==i.ParseString("\\");if(!S&&null===L)break;null===m&&(m=""),null!==L&&(m+=String(L)),S&&(m+=i.ParseSingleCharacter())}return null!==m?new J1(m):null},i.ContentTextNoEscape=function(){null===i._nonTextPauseCharacters&&(i._nonTextPauseCharacters=new n1("-<")),null===i._nonTextEndCharacters&&(i._nonTextEndCharacters=new n1("{}|\n\r\\#"),i._notTextEndCharactersChoice=new n1(i._nonTextEndCharacters),i._notTextEndCharactersChoice.AddCharacters("[]"),i._notTextEndCharactersString=new n1(i._nonTextEndCharacters),i._notTextEndCharactersString.AddCharacters('"'));var L=i.ParseUntil(function(){return i.OneOf([i.ParseDivertArrow,i.ParseThreadArrow,i.EndOfLine,i.Glue])},i._nonTextPauseCharacters,i.parsingStringExpression?i._notTextEndCharactersString:i._parsingChoice?i._notTextEndCharactersChoice:i._nonTextEndCharacters);return null!==L?L:null},i.MultiDivert=function(){i.Whitespace();var m=[],L=i.Parse(i.StartThread);if(L)return[L];var S=i.Interleave(i.ParseDivertArrowOrTunnelOnwards,i.DivertIdentifierWithArguments);if(!S)return null;m=[];for(var z=0;z<S.length;++z)if(z%2==0){if("->->"===S[z]){0===z||z===S.length-1||z===S.length-2||i.Error("Tunnel onwards '->->' must only come at the begining or the start of a divert");var _=new Je;if(z<S.length-1){var E=P(S[z+1],X1);_.divertAfter=E}m.push(_);break}}else{var A=S[z];z<S.length-1&&(A.isTunnel=!0),m.push(A)}if(0===m.length&&1===S.length){var R=new X1(null);R.isEmpty=!0,m.push(R),i._parsingChoice||i.Error("Empty diverts (->) are only valid on choices")}return m},i.StartThread=function(){if(i.Whitespace(),null===i.ParseThreadArrow())return null;i.Whitespace();var m=i.Expect(i.DivertIdentifierWithArguments,"target for new thread",function(){return new X1(null)});return m.isThread=!0,m},i.DivertIdentifierWithArguments=function(){i.Whitespace();var m=i.Parse(i.DotSeparatedDivertPathComponents);if(!m)return null;i.Whitespace();var L=i.Parse(i.ExpressionFunctionCallArguments);i.Whitespace();var S=new D4(m);return new X1(S,L)},i.SingleDivert=function(){var m=i.Parse(i.MultiDivert);if(!m||1!==m.length||m[0]instanceof Je)return null;var L=m[0];return L.isTunnel?null:L},i.DotSeparatedDivertPathComponents=function(){return i.Interleave(i.Spaced(i.IdentifierWithMetadata),i.Exclude(i.String(".")))},i.ParseDivertArrowOrTunnelOnwards=function(){for(var m=0;null!==i.ParseString("->");)m+=1;return 0===m?null:1===m?"->":(2===m||i.Error("Unexpected number of arrows in divert. Should only have '->' or '->->'"),"->->")},i.ParseDivertArrow=function(){return i.ParseString("->")},i.ParseThreadArrow=function(){return i.ParseString("<-")},i._binaryOperators=[],i._maxBinaryOpLength=0,i.TempDeclarationOrAssignment=function(){i.Whitespace();var m=i.ParseTempKeyword();i.Whitespace();var L;if(null===(L=m?i.Expect(i.IdentifierWithMetadata,"variable name"):i.Parse(i.IdentifierWithMetadata)))return null;i.Whitespace();var S=null!==i.ParseString("+"),z=null!==i.ParseString("-");if(S&&z&&i.Error("Unexpected sequence '+-'"),null===i.ParseString("="))return m&&i.Error("Expected '='"),null;var _=i.Expect(i.Expression,"value expression to be assigned");return S||z?new Se(L,_,S):new N6({variableIdentifier:L,assignedExpression:_,isTemporaryNewDeclaration:m})},i.DisallowIncrement=function(m){m instanceof Se&&i.Error("Can't use increment/decrement here. It can only be used on a ~ line")},i.ParseTempKeyword=function(){var m=i.BeginRule();return"temp"===i.Parse(i.Identifier)?(i.SucceedRule(m),!0):(i.FailRule(m),!1)},i.ReturnStatement=function(){if(i.Whitespace(),"return"!==i.Parse(i.Identifier))return null;i.Whitespace();var m=i.Parse(i.Expression);return new z3(m)},i.Expression=function(){var m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;i.Whitespace();var L=i.ExpressionUnary();if(null===L)return null;i.Whitespace();for(var S=function(){var _=i.BeginRule(),E=i.ParseInfixOperator();if(null!==E&&E.precedence>m){var A="right side of '".concat(E.type,"' expression"),R=i.Expect(function(){return i.ExpressionInfixRight(L,E)},A);return null===R?(i.FailRule(_),{v:null}):(L=i.SucceedRule(_,R),"continue")}return i.FailRule(_),"break"};;){var z=S();if("continue"!==z){if("break"===z)break;if("object"===k2(z))return z.v}}return i.Whitespace(),L},i.ExpressionUnary=function(){var m=i.Parse(i.ExpressionDivertTarget);if(null!==m)return m;var L=i.OneOf([i.String("-"),i.String("!")]);null===L&&(L=i.Parse(i.ExpressionNot)),i.Whitespace();var S=i.OneOf([i.ExpressionList,i.ExpressionParen,i.ExpressionFunctionCall,i.ExpressionVariableName,i.ExpressionLiteral]);if(null===S&&null!==L&&(S=i.ExpressionUnary()),null===S)return null;null!==L&&(S=O5.WithInner(S,L)),i.Whitespace();var z=i.OneOf([i.String("++"),i.String("--")]);return null!==z&&(S instanceof u4?S=new Se(S.identifier,"++"===z):i.Error("can only increment and decrement variables, but saw '".concat(S,"'."))),S},i.ExpressionNot=function(){var m=i.Identifier();return"not"===m?m:null},i.ExpressionLiteral=function(){return i.OneOf([i.ExpressionFloat,i.ExpressionInt,i.ExpressionBool,i.ExpressionString])},i.ExpressionDivertTarget=function(){i.Whitespace();var m=i.Parse(i.SingleDivert);return!m||m&&m.isThread?null:(i.Whitespace(),new N3(m))},i.ExpressionInt=function(){var m=i.ParseInt();return null===m?null:new d3(m,"int")},i.ExpressionFloat=function(){var m=i.ParseFloat();return null===m?null:new d3(m,"float")},i.ExpressionString=function(){if(null===i.ParseString('"'))return null;i.parsingStringExpression=!0;var m=i.Parse(i.MixedTextAndLogic);return i.Expect(i.String('"'),"close quote for string expression"),i.parsingStringExpression=!1,null===m?m=[new J1("")]:m.find(function(L){return L instanceof X1})&&i.Error("String expressions cannot contain diverts (->)"),new I1(m)},i.ExpressionBool=function(){var m=i.Parse(i.Identifier);return"true"===m?new d3(!0,"bool"):"false"===m?new d3(!1,"bool"):null},i.ExpressionFunctionCall=function(){var m=i.Parse(i.IdentifierWithMetadata);if(null===m)return null;i.Whitespace();var L=i.Parse(i.ExpressionFunctionCallArguments);return null===L?null:new C4(m,L)},i.ExpressionFunctionCallArguments=function(){if(null===i.ParseString("("))return null;var m=i.Exclude(i.String(",")),L=i.Interleave(i.Expression,m);return null===L&&(L=[]),i.Whitespace(),i.Expect(i.String(")"),"closing ')' for function call"),L},i.ExpressionVariableName=function(){var m=i.Interleave(i.IdentifierWithMetadata,i.Exclude(i.Spaced(i.String("."))));return null===m||be.IsReservedKeyword(m[0].name)?null:new u4(m)},i.ExpressionParen=function(){if(null===i.ParseString("("))return null;var m=i.Parse(i.Expression);return null===m?null:(i.Whitespace(),i.Expect(i.String(")"),"closing parenthesis ')' for expression"),m)},i.ExpressionInfixRight=function(m,L){if(!m)return null;i.Whitespace();var S=i.Parse(function(){return i.Expression(L.precedence)});return S?new _4(m,S,L.type):null},i.ParseInfixOperator=function(){var m,L=N(i._binaryOperators);try{for(L.s();!(m=L.n()).done;){var S=m.value,z=i.BeginRule();if(null!==i.ParseString(S.type)){if(S.requireWhitespace&&null===i.Whitespace()){i.FailRule(z);continue}return i.SucceedRule(z,S)}i.FailRule(z)}}catch(_){L.e(_)}finally{L.f()}return null},i.ExpressionList=function(){if(i.Whitespace(),null===i.ParseString("("))return null;i.Whitespace();var m=i.SeparatedList(i.ListMember,i.Spaced(i.String(",")));return i.Whitespace(),null===i.ParseString(")")?null:new X2(m)},i.ListMember=function(){i.Whitespace();var m=i.Parse(i.IdentifierWithMetadata);if(null===m)return null;if(null!==i.ParseString(".")){var L=i.Expect(i.IdentifierWithMetadata,"element name within the set ".concat(m));m.name+=".".concat(L?.name)}return i.Whitespace(),m},i.RegisterExpressionOperators=function(){i.RegisterBinaryOperator("&&",1),i.RegisterBinaryOperator("||",1),i.RegisterBinaryOperator("and",1,!0),i.RegisterBinaryOperator("or",1,!0),i.RegisterBinaryOperator("==",2),i.RegisterBinaryOperator(">=",2),i.RegisterBinaryOperator("<=",2),i.RegisterBinaryOperator("<",2),i.RegisterBinaryOperator(">",2),i.RegisterBinaryOperator("!=",2),i.RegisterBinaryOperator("?",3),i.RegisterBinaryOperator("has",3,!0),i.RegisterBinaryOperator("!?",3),i.RegisterBinaryOperator("hasnt",3,!0),i.RegisterBinaryOperator("^",3),i.RegisterBinaryOperator("+",4),i.RegisterBinaryOperator("-",5),i.RegisterBinaryOperator("*",6),i.RegisterBinaryOperator("/",7),i.RegisterBinaryOperator("%",8),i.RegisterBinaryOperator("mod",8,!0)},i.RegisterBinaryOperator=function(m,L){var z=new tr(m,L,arguments.length>2&&void 0!==arguments[2]&&arguments[2]);i._binaryOperators.push(z),i._maxBinaryOpLength=Math.max(i._maxBinaryOpLength,m.length)},i._openFilenames=[],i.IncludeStatement=function(){if(i.Whitespace(),null===i.ParseString("INCLUDE"))return null;i.Whitespace();var m=i.Expect(function(){return i.ParseUntilCharactersFromString("\n\r")},"filename for include statement");m=m.replace(new RegExp(/[ \t]+$/g),"");var L=i.fileHandler.ResolveInkFilename(m);if(i.FilenameIsAlreadyOpen(L))return i.Error("Recursive INCLUDE detected: '".concat(L,"' is already open.")),i.ParseUntilCharactersFromString("\r\n"),new Xe(null);i.AddOpenFilename(L);var S=null,z="";try{z=i._rootParser.fileHandler.LoadInkFileContents(L)}catch(_){i.Error("Failed to load: '".concat(m,"'.\nError:").concat(_))}return z&&(S=new u(z,m,i._externalErrorHandler,i._rootParser,i.fileHandler).ParseStory()),i.RemoveOpenFilename(L),new Xe(S)},i.FilenameIsAlreadyOpen=function(m){return i._rootParser._openFilenames.includes(m)},i.AddOpenFilename=function(m){i._rootParser._openFilenames.push(m)},i.RemoveOpenFilename=function(m){i._rootParser._openFilenames.splice(i._rootParser._openFilenames.indexOf(m),1)},i.KnotDefinition=function(){var m=i.Parse(i.KnotDeclaration);if(null===m)return null;i.Expect(i.EndOfLine,"end of line after knot name definition",i.SkipToNextLine);var L=i.Expect(function(){return i.StatementsAtLevel(P1.Knot)},"at least one line within the knot",i.KnotStitchNoContentRecoveryRule);return new U5(m.name,L,m.args,m.isFunction)},i.KnotDeclaration=function(){if(i.Whitespace(),null===i.KnotTitleEquals())return null;i.Whitespace();var m,L=i.Parse(i.IdentifierWithMetadata),S="function"===L?.name;S?(i.Expect(i.Whitespace,"whitespace after the 'function' keyword"),m=i.Parse(i.IdentifierWithMetadata)):m=L,null===m&&(i.Error("Expected the name of the ".concat(S?"function":"knot")),m=new $4("")),i.Whitespace();var z=i.Parse(i.BracketedKnotDeclArguments);return i.Whitespace(),i.Parse(i.KnotTitleEquals),new m8(m,z,S)},i.KnotTitleEquals=function(){var m=i.ParseCharactersFromString("=");return null===m||m.length<=1?null:m},i.StitchDefinition=function(){var m=i.Parse(i.StitchDeclaration);if(null===m)return null;i.Expect(i.EndOfLine,"end of line after stitch name",i.SkipToNextLine);var L=i.Expect(function(){return i.StatementsAtLevel(P1.Stitch)},"at least one line within the stitch",i.KnotStitchNoContentRecoveryRule);return new r1(m.name,L,m.args,m.isFunction)},i.StitchDeclaration=function(){if(i.Whitespace(),null===i.ParseString("=")||null!==i.ParseString("="))return null;i.Whitespace();var m=null!==i.ParseString("function");m&&i.Whitespace();var L=i.Parse(i.IdentifierWithMetadata);if(null===L)return null;i.Whitespace();var S=i.Parse(i.BracketedKnotDeclArguments);return i.Whitespace(),new m8(L,S,m)},i.KnotStitchNoContentRecoveryRule=function(){return i.ParseUntil(i.KnotDeclaration,new n1("="),null),[new J1("<ERROR IN FLOW>")]},i.BracketedKnotDeclArguments=function(){if(null===i.ParseString("("))return null;var m=i.Interleave(i.Spaced(i.FlowDeclArgument),i.Exclude(i.String(",")));return i.Expect(i.String(")"),"closing ')' for parameter list"),null===m&&(m=[]),m},i.FlowDeclArgument=function(){var m=i.Parse(i.IdentifierWithMetadata);i.Whitespace();var L=i.ParseDivertArrow();i.Whitespace();var S=i.Parse(i.IdentifierWithMetadata);if(null==m&&null===S)return null;var z=new $e;return null!==L&&(z.isDivertTarget=!0),null!==m&&"ref"===m.name?(null===S&&i.Error("Expected an parameter name after 'ref'"),z.identifier=S,z.isByReference=!0):(z.identifier=z.isDivertTarget?S:m,null===z.identifier&&i.Error("Expected an parameter name"),z.isByReference=!1),z},i.ExternalDeclaration=function(){i.Whitespace();var m=i.Parse(i.IdentifierWithMetadata);if(null===m||"EXTERNAL"!=m.name)return null;i.Whitespace();var L=i.Expect(i.IdentifierWithMetadata,"name of external function")||new $4("");i.Whitespace();var S=i.Expect(i.BracketedKnotDeclArguments,"declaration of arguments for EXTERNAL, even if empty, i.e. 'EXTERNAL ".concat(L,"()'"));null===S&&(S=[]);var z=S.map(function(_){var E;return null===(E=_.identifier)||void 0===E?void 0:E.name}).filter(f8);return new Z0(L,z)},i._identifierCharSet=null,i.LogicLine=function(){if(i.Whitespace(),null===i.ParseString("~"))return null;i.Whitespace();var m=i.Expect(function(){return i.OneOf([i.ReturnStatement,i.TempDeclarationOrAssignment,i.Expression])},"expression after '~'",i.SkipToNextLine);if(null===m)return new n3;m instanceof Y1&&!(m instanceof C4||m instanceof Se)&&i.Error("Logic following a '~' can't be that type of expression. It can only be something like:\n\t~ return\n\t~ var x = blah\n\t~ x++\n\t~ myFunction()");var L=P(m,C4);return L&&(L.shouldPopReturnedValue=!0),null!==m.Find(C4)()&&(m=new n3(m,new J1("\n"))),i.Expect(i.EndOfLine,"end of line",i.SkipToNextLine),m},i.VariableDeclaration=function(){if(i.Whitespace(),"VAR"!==i.Parse(i.Identifier))return null;i.Whitespace();var m=i.Expect(i.IdentifierWithMetadata,"variable name");i.Whitespace(),i.Expect(i.String("="),"the '=' for an assignment of a value, e.g. '= 5' (initial values are mandatory)"),i.Whitespace();var L=i.Expect(i.Expression,"initial value for ");return L?(L instanceof d3||L instanceof I1||L instanceof N3||L instanceof u4||L instanceof X2||i.Error("initial value for a variable must be a number, constant, list or divert target"),null!==i.Parse(i.ListElementDefinitionSeparator)?i.Error("Unexpected ','. If you're trying to declare a new list, use the LIST keyword, not VAR"):L instanceof I1&&(L.isSingleString||i.Error("Constant strings cannot contain any logic.")),new N6({assignedExpression:L,isGlobalDeclaration:!0,variableIdentifier:m})):null},i.ListDeclaration=function(){if(i.Whitespace(),"LIST"!=i.Parse(i.Identifier))return null;i.Whitespace();var m=i.Expect(i.IdentifierWithMetadata,"list name");i.Whitespace(),i.Expect(i.String("="),"the '=' for an assignment of the list definition"),i.Whitespace();var L=i.Expect(i.ListDefinition,"list item names");return L?(L.identifier=new $4(m.name),new N6({variableIdentifier:m,listDef:L})):null},i.ListDefinition=function(){i.AnyWhitespace();var m=i.SeparatedList(i.ListElementDefinition,i.ListElementDefinitionSeparator);return null===m?null:new E6(m)},i.ListElementDefinitionSeparator=function(){return i.AnyWhitespace(),null===i.ParseString(",")?null:(i.AnyWhitespace(),",")},i.ListElementDefinition=function(){var m=null!==i.ParseString("("),L=m;i.Whitespace();var S=i.Parse(i.IdentifierWithMetadata);if(null===S)return null;i.Whitespace(),m&&null!=i.ParseString(")")&&(L=!1,i.Whitespace());var z=null;if(null!==i.ParseString("=")){i.Whitespace();var _=i.Expect(i.ExpressionInt,"value to be assigned to list item");null!==_&&(z=_.value),L&&(i.Whitespace(),null!==i.ParseString(")")&&(L=!1))}return L&&i.Error("Expected closing ')'"),new k6(S,m,z)},i.ConstDeclaration=function(){if(i.Whitespace(),"CONST"!==i.Parse(i.Identifier))return null;i.Whitespace();var m=i.Expect(i.IdentifierWithMetadata,"constant name");i.Whitespace(),i.Expect(i.String("="),"the '=' for an assignment of a value, e.g. '= 5' (initial values are mandatory)"),i.Whitespace();var L=i.Expect(i.Expression,"initial value for ");return L instanceof d3||L instanceof N3||L instanceof I1?L instanceof I1&&(L.isSingleString||i.Error("Constant strings cannot contain any logic.")):i.Error("initial value for a constant must be a number or divert target"),new _6(m,L)},i.InlineLogicOrGlue=function(){return i.OneOf([i.InlineLogic,i.Glue])},i.Glue=function(){return null!==i.ParseString("<>")?new er(new He):null},i.InlineLogic=function(){if(null===i.ParseString("{"))return null;i.Whitespace();var m=i.Expect(i.InnerLogic,"some kind of logic, conditional or sequence within braces: { ... }");if(null===m)return null;i.DisallowIncrement(m);var L=P(m,n3);return L||(L=new n3(m)),i.Whitespace(),i.Expect(i.String("}"),"closing brace '}' for inline logic"),L},i.InnerLogic=function(){i.Whitespace();var m=i.ParseObject(i.SequenceTypeAnnotation);if(null!==m){var L=i.Expect(i.InnerSequenceObjects,"sequence elements (for cycle/stoping etc)");return null===L?null:new Ye(L,m)}var S=i.Parse(i.ConditionExpression);if(S)return i.Expect(function(){return i.InnerConditionalContent(S)},"conditional content following query");for(var z=0,_=[i.InnerConditionalContent,i.InnerSequence,i.InnerExpression];z<_.length;z++){var E=_[z],A=i.BeginRule(),R=i.ParseObject(E);if(R){if(null!==i.Peek(i.Spaced(i.String("}"))))return i.SucceedRule(A,R);i.FailRule(A)}else i.FailRule(A)}return null},i.InnerExpression=function(){var m=i.Parse(i.Expression);return m&&(m.outputWhenComplete=!0),m},i.IdentifierWithMetadata=function(){var m=i.Identifier();return null===m?null:new $4(m)},i.Identifier=function(){var m=i.ParseCharactersFromCharSet(i.identifierCharSet);if(null===m)return null;var L,S=!0,z=N(m);try{for(z.s();!(L=z.n()).done;){var _=L.value;if(!(_>="0"&&_<="9")){S=!1;break}}}catch(E){z.e(E)}finally{z.f()}return S?null:m},i._sequenceTypeSymbols=new n1("!&~$"),i.InnerSequence=function(){i.Whitespace();var m=$2.Stopping,L=i.Parse(i.SequenceTypeAnnotation);null!==L&&(m=L);var S=i.Parse(i.InnerSequenceObjects);return null===S||S.length<=1?null:new Ye(S,m)},i.SequenceTypeAnnotation=function(){var m=i.Parse(i.SequenceTypeSymbolAnnotation);if(null===m&&(m=i.Parse(i.SequenceTypeWordAnnotation)),null===m)return null;switch(m){case $2.Once:case $2.Cycle:case $2.Stopping:case $2.Shuffle:case $2.Shuffle|$2.Stopping:case $2.Shuffle|$2.Once:break;default:return i.Error("Sequence type combination not supported: ".concat(m)),$2.Stopping}return m},i.SequenceTypeSymbolAnnotation=function(){null===i._sequenceTypeSymbols&&(i._sequenceTypeSymbols=new n1("!&~$ "));var m=0,L=i.ParseCharactersFromCharSet(i._sequenceTypeSymbols);if(null===L)return null;var S,z=N(L);try{for(z.s();!(S=z.n()).done;)switch(S.value){case"!":m|=$2.Once;break;case"&":m|=$2.Cycle;break;case"~":m|=$2.Shuffle;break;case"$":m|=$2.Stopping}}catch(_){z.e(_)}finally{z.f()}return 0===m?null:m},i.SequenceTypeWordAnnotation=function(){var m=i.Interleave(i.SequenceTypeSingleWord,i.Exclude(i.Whitespace));if(null===m||0===m.length||null===i.ParseString(":"))return null;var L,S=0,z=N(m);try{for(z.s();!(L=z.n()).done;)S|=L.value}catch(_){z.e(_)}finally{z.f()}return S},i.SequenceTypeSingleWord=function(){var m=null,L=i.Parse(i.IdentifierWithMetadata);if(null!==L)switch(L.name){case"once":m=$2.Once;break;case"cycle":m=$2.Cycle;break;case"shuffle":m=$2.Shuffle;break;case"stopping":m=$2.Stopping}return null===m?null:m},i.InnerSequenceObjects=function(){return null!==i.Parse(i.Newline)?i.Parse(i.InnerMultilineSequenceObjects):i.Parse(i.InnerInlineSequenceObjects)},i.InnerInlineSequenceObjects=function(){var m=i.Interleave(i.Optional(i.MixedTextAndLogic),i.String("|"),null,!1);if(null===m)return null;var L,S=[],z=!1,_=N(m);try{for(_.s();!(L=_.n()).done;){var E=L.value;if("|"===E)z||S.push(new n3),z=!1;else{var A=E;null===A?i.Error("Expected content, but got ".concat(E," (this is an ink compiler bug!)")):S.push(new n3(A)),z=!0}}}catch(R){_.e(R)}finally{_.f()}return z||S.push(new n3),S},i.InnerMultilineSequenceObjects=function(){i.MultilineWhitespace();var m=i.OneOrMore(i.SingleMultilineSequenceElement);return null===m?null:m},i.SingleMultilineSequenceElement=function(){if(i.Whitespace(),null!==i.ParseString("->")||null===i.ParseString("-"))return null;i.Whitespace();var m=i.StatementsAtLevel(P1.InnerBlock);return null===m?i.MultilineWhitespace():m.unshift(new J1("\n")),new n3(m)},i._statementRulesAtLevel=[],i._statementBreakRulesAtLevel=[],i.StatementsAtLevel=function(m){return m===P1.InnerBlock&&null!==i.Parse(i.GatherDashes)&&i.Error("You can't use a gather (the dashes) within the { curly braces } context. For multi-line sequences and conditions, you should only use one dash."),i.Interleave(i.Optional(i.MultilineWhitespace),function(){return i.StatementAtLevel(m)},function(){return i.StatementsBreakForLevel(m)})},i.StatementAtLevel=function(m){var S=i.OneOf(i._statementRulesAtLevel[m]);return m===P1.Top&&S instanceof z3&&i.Error("should not have return statement outside of a knot"),S},i.StatementsBreakForLevel=function(m){i.Whitespace();var S=i.OneOf(i._statementBreakRulesAtLevel[m]);return null===S?null:S},i.GenerateStatementLevelRules=function(){var m=Object.values(P1);i._statementRulesAtLevel="f".repeat(m.length).split("f").map(function(){return[]}),i._statementBreakRulesAtLevel="f".repeat(m.length).split("f").map(function(){return[]});for(var L=0,S=m;L<S.length;L++){var z=S[L],_=[],E=[];_.push(i.Line(i.MultiDivert)),z>=P1.Top&&_.push(i.KnotDefinition),_.push(i.Line(i.Choice)),_.push(i.Line(i.AuthorWarning)),z>P1.InnerBlock&&_.push(i.Gather),z>=P1.Knot&&_.push(i.StitchDefinition),_.push(i.Line(i.ListDeclaration)),_.push(i.Line(i.VariableDeclaration)),_.push(i.Line(i.ConstDeclaration)),_.push(i.Line(i.ExternalDeclaration)),_.push(i.Line(i.IncludeStatement)),_.push(i.LogicLine),_.push(i.LineOfMixedTextAndLogic),z<=P1.Knot&&E.push(i.KnotDeclaration),z<=P1.Stitch&&E.push(i.StitchDeclaration),z<=P1.InnerBlock&&(E.push(i.ParseDashNotArrow),E.push(i.String("}"))),i._statementRulesAtLevel[z]=_,i._statementBreakRulesAtLevel[z]=E}},i.SkipToNextLine=function(){return i.ParseUntilCharactersFromString("\n\r"),i.ParseNewline(),J3},i.Line=function(m){return function(){var L=i.ParseObject(m);return null===L?null:(i.Expect(i.EndOfLine,"end of line",i.SkipToNextLine),L)}},i._endOfTagCharSet=new n1("#\n\r\\"),i.Tag=function(){if(i.Whitespace(),null===i.ParseString("#"))return null;i.Whitespace();for(var m="";m+=i.ParseUntilCharactersFromCharSet(i._endOfTagCharSet)||"",null!==i.ParseString("\\");){var L=i.ParseSingleCharacter();"\0"!==L&&(m+=L)}var S=m.trim();return new ro(new J4(S))},i.Tags=function(){var m=i.OneOrMore(i.Tag);return null===m?null:m},i._inlineWhitespaceChars=new n1(" \t"),i.EndOfLine=function(){return i.OneOf([i.Newline,i.EndOfFile])},i.Newline=function(){return i.Whitespace(),null!==i.ParseNewline()?J3:null},i.EndOfFile=function(){return i.Whitespace(),i.endOfInput?J3:null},i.MultilineWhitespace=function(){var m=i.OneOrMore(i.Newline);return null===m?null:m.length>=1?J3:null},i.Whitespace=function(){return null!==i.ParseCharactersFromCharSet(i._inlineWhitespaceChars)?J3:null},i.Spaced=function(m){return function(){i.Whitespace();var L=i.ParseObject(m);return null===L?null:(i.Whitespace(),L)}},i.AnyWhitespace=function(){for(var m=!1;null!==i.OneOf([i.Whitespace,i.MultilineWhitespace]);)m=!0;return m?J3:null},i.MultiSpaced=function(m){return function(){i.AnyWhitespace();var L=i.ParseObject(m);return null===L?null:(i.AnyWhitespace(),L)}},i._filename=null,i._externalErrorHandler=null,i._fileHandler=null,i._filename=h,i.RegisterExpressionOperators(),i.GenerateStatementLevelRules(),i.errorHandler=i.OnStringParserError,i._externalErrorHandler=d,i._fileHandler=null===M?new ar:M,null===g){if(i._rootParser=H1(i),i._openFilenames=[],null!==i._filename){var H=i.fileHandler.ResolveInkFilename(i._filename);i._openFilenames.push(H)}}else i._rootParser=g;return i}return W(u,[{key:"fileHandler",get:function(){if(!this._fileHandler)throw new Error("No FileHandler defined");return this._fileHandler},set:function(c){this._fileHandler=c}},{key:"PreProcessInputString",value:function(c){return new d8(c).Process()}},{key:"parsingStringExpression",get:function(){return this.GetFlag(Number(D6.ParsingString))},set:function(c){this.SetFlag(Number(D6.ParsingString),c)}},{key:"identifierCharSet",get:function(){return null===this._identifierCharSet&&((this._identifierCharSet=new n1).AddRange("A","Z").AddRange("a","z").AddRange("0","9").Add("_"),this.ExtendIdentifierCharacterRanges(this._identifierCharSet)),this._identifierCharSet}}]),u}(Qe);z1.LatinBasic=Y3.Define("A","z",(new n1).AddRange("[","`")),z1.LatinExtendedA=Y3.Define("\u0100","\u017f"),z1.LatinExtendedB=Y3.Define("\u0180","\u024f"),z1.Greek=Y3.Define("\u0370","\u03ff",(new n1).AddRange("\u0378","\u0385").AddCharacters("\u0374\u0375\u0378\u0387\u038b\u038d\u03a2")),z1.Cyrillic=Y3.Define("\u0400","\u04ff",(new n1).AddRange("\u0482","\u0489")),z1.Armenian=Y3.Define("\u0530","\u058f",(new n1).AddCharacters("\u0530").AddRange("\u0557","\u0560").AddRange("\u0588","\u058e")),z1.Hebrew=Y3.Define("\u0590","\u05ff",new n1),z1.Arabic=Y3.Define("\u0600","\u06ff",new n1),z1.Korean=Y3.Define("\uac00","\ud7af",new n1),z1.ListAllCharacterRanges=function(){return[z1.LatinBasic,z1.LatinExtendedA,z1.LatinExtendedB,z1.Arabic,z1.Armenian,z1.Cyrillic,z1.Greek,z1.Hebrew,z1.Korean]};var f4=function(){function v(C){var u=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;B(this,v),this._errors=[],this._warnings=[],this._authorMessages=[],this._parsedStory=null,this._runtimeStory=null,this._parser=null,this._debugSourceRanges=[],this.Compile=function(){return u._parser=new z1(u.inputString,u.options.sourceFilename||null,u.OnError,null,u.options.fileHandler),u._parsedStory=u.parser.ParseStory(),0===u.errors.length?(u.parsedStory.countAllVisits=u.options.countAllVisits,u._runtimeStory=u.parsedStory.ExportRuntime(u.OnError)):u._runtimeStory=null,u.runtimeStory},this.RetrieveDebugSourceForLatestContent=function(){var i,h,d=N(u.runtimeStory.state.outputStream);try{for(d.s();!(h=d.n()).done;){var g=P(h.value,G2);if(null!==g){var M=new Q0((null===(i=g.value)||void 0===i?void 0:i.length)||0,g.debugMetadata,g.value||"unknown");u.debugSourceRanges.push(M)}}}catch(H){d.e(H)}finally{d.f()}},this.DebugMetadataForContentAtOffset=function(i){var h,d=0,g=null,M=N(u.debugSourceRanges);try{for(M.s();!(h=M.n()).done;){var H=h.value;if(null!==H.debugMetadata&&(g=H.debugMetadata),i>=d&&i<d+H.length)return g;d+=H.length}}catch(m){M.e(m)}finally{M.f()}return null},this.OnError=function(i,h){switch(h){case S3.Author:u._authorMessages.push(i);break;case S3.Warning:u._warnings.push(i);break;case S3.Error:u._errors.push(i)}null!==u.options.errorHandler&&u.options.errorHandler(i,h)},this._inputString=C,this._options=c||new b6}return W(v,[{key:"errors",get:function(){return this._errors}},{key:"warnings",get:function(){return this._warnings}},{key:"authorMessages",get:function(){return this._authorMessages}},{key:"inputString",get:function(){return this._inputString}},{key:"options",get:function(){return this._options}},{key:"parsedStory",get:function(){if(!this._parsedStory)throw new Error;return this._parsedStory}},{key:"runtimeStory",get:function(){if(!this._runtimeStory)throw new Error("Compilation failed.");return this._runtimeStory}},{key:"parser",get:function(){if(!this._parser)throw new Error;return this._parser}},{key:"debugSourceRanges",get:function(){return this._debugSourceRanges}}]),v}();C3.Compiler=f4,C3.CompilerOptions=b6,C3.InkList=s1,Object.defineProperty(C3,"__esModule",{value:!0})}(C8)},881:(u8,C8,C3)=>{"use strict";function k2(e){return"function"==typeof e}function B(e){const n=e(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const S6=B(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,a)=>`${a+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function W(e,t){if(e){const n=e.indexOf(t);0<=n&&e.splice(n,1)}}class Q{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const o of n)o.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(k2(r))try{r()}catch(o){t=o instanceof S6?o.errors:[o]}const{_finalizers:a}=this;if(a){this._finalizers=null;for(const o of a)try{P5(o)}catch(s){t=t??[],s instanceof S6?t=[...t,...s.errors]:t.push(s)}}if(t)throw new S6(t)}}add(t){var n;if(t&&t!==this)if(this.closed)P5(t);else{if(t instanceof Q){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}}_hasParent(t){const{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){const{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&W(n,t)}remove(t){const{_finalizers:n}=this;n&&W(n,t),t instanceof Q&&t._removeParent(this)}}Q.EMPTY=(()=>{const e=new Q;return e.closed=!0,e})();const I2=Q.EMPTY;function qe(e){return e instanceof Q||e&&"closed"in e&&k2(e.remove)&&k2(e.add)&&k2(e.unsubscribe)}function P5(e){k2(e)?e():e.unsubscribe()}const w4={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},G4={setTimeout(e,t,...n){const{delegate:r}=G4;return r?.setTimeout?r.setTimeout(e,t,...n):setTimeout(e,t,...n)},clearTimeout(e){const{delegate:t}=G4;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function H1(e){G4.setTimeout(()=>{const{onUnhandledError:t}=w4;if(!t)throw e;t(e)})}function ye(){}const a2=y2("C",void 0,void 0);function y2(e,t,n){return{kind:e,value:t,error:n}}let p1=null;function Me(e){if(w4.useDeprecatedSynchronousErrorHandling){const t=!p1;if(t&&(p1={errorThrown:!1,error:null}),e(),t){const{errorThrown:n,error:r}=p1;if(p1=null,n)throw r}}else e()}class N extends Q{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,qe(t)&&t.add(this)):this.destination=F5}static create(t,n,r){return new $e(t,n,r)}next(t){this.isStopped?Le(function J2(e){return y2("N",e,void 0)}(t),this):this._next(t)}error(t){this.isStopped?Le(function K0(e){return y2("E",void 0,e)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?Le(a2,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const S3=Function.prototype.bind;function b6(e,t){return S3.call(e,t)}class Q0{constructor(t){this.partialObserver=t}next(t){const{partialObserver:n}=this;if(n.next)try{n.next(t)}catch(r){P(r)}}error(t){const{partialObserver:n}=this;if(n.error)try{n.error(t)}catch(r){P(r)}else P(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(n){P(n)}}}class $e extends N{constructor(t,n,r){let a;if(super(),k2(t)||!t)a={next:t??void 0,error:n??void 0,complete:r??void 0};else{let o;this&&w4.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=()=>this.unsubscribe(),a={next:t.next&&b6(t.next,o),error:t.error&&b6(t.error,o),complete:t.complete&&b6(t.complete,o)}):a=t}this.destination=new Q0(a)}}function P(e){w4.useDeprecatedSynchronousErrorHandling?function I5(e){w4.useDeprecatedSynchronousErrorHandling&&p1&&(p1.errorThrown=!0,p1.error=e)}(e):H1(e)}function Le(e,t){const{onStoppedNotification:n}=w4;n&&G4.setTimeout(()=>n(e,t))}const F5={closed:!0,next:ye,error:function U2(e){throw e},complete:ye},z6="function"==typeof Symbol&&Symbol.observable||"@@observable";function w6(e){return e}let E2=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new e;return r.source=this,r.operator=n,r}subscribe(n,r,a){const o=function Y0(e){return e&&e instanceof N||function Z2(e){return e&&k2(e.next)&&k2(e.error)&&k2(e.complete)}(e)&&qe(e)}(n)?n:new $e(n,r,a);return Me(()=>{const{operator:s,source:l}=this;o.add(s?s.call(o,l):l?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=Ke(r))((a,o)=>{const s=new $e({next:l=>{try{n(l)}catch(f){o(f),s.unsubscribe()}},error:o,complete:a});this.subscribe(s)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[z6](){return this}pipe(...n){return function K3(e){return 0===e.length?w6:1===e.length?e[0]:function(n){return e.reduce((r,a)=>a(r),n)}}(n)(this)}toPromise(n){return new(n=Ke(n))((r,a)=>{let o;this.subscribe(s=>o=s,s=>a(s),()=>r(o))})}}return e.create=t=>new e(t),e})();function Ke(e){var t;return null!==(t=e??w4.Promise)&&void 0!==t?t:Promise}const O=B(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let e1=(()=>{class e extends E2{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new f3(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new O}next(n){Me(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(n)}})}error(n){Me(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Me(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:a,observers:o}=this;return r||a?I2:(this.currentObservers=null,o.push(n),new Q(()=>{this.currentObservers=null,W(o,n)}))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:a,isStopped:o}=this;r?n.error(a):o&&n.complete()}asObservable(){const n=new E2;return n.source=this,n}}return e.create=(t,n)=>new f3(t,n),e})();class f3 extends e1{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,t)}error(t){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,t)}complete(){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===n||n.call(t)}_subscribe(t){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(t))&&void 0!==r?r:I2}}function s1(e){return t=>{if(function t1(e){return k2(e?.lift)}(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function c1(e,t,n,r,a){return new h3(e,t,n,r,a)}class h3 extends N{constructor(t,n,r,a,o,s){super(t),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=n?function(l){try{n(l)}catch(f){t.error(f)}}:super._next,this._error=a?function(l){try{a(l)}catch(f){t.error(f)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(l){t.error(l)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function o2(e,t){return s1((n,r)=>{let a=0;n.subscribe(c1(r,o=>{r.next(e.call(t,o,a++))}))})}function _4(e){return this instanceof _4?(this.v=e,this):new _4(e)}function n1(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,r=n.apply(e,t||[]),o=[];return a={},s("next"),s("throw"),s("return"),a[Symbol.asyncIterator]=function(){return this},a;function s(b){r[b]&&(a[b]=function(w){return new Promise(function(x,D){o.push([b,w,x,D])>1||l(b,w)})})}function l(b,w){try{!function f(b){b.value instanceof _4?Promise.resolve(b.value.v).then(p,y):V(o[0][2],b)}(r[b](w))}catch(x){V(o[0][3],x)}}function p(b){l("next",b)}function y(b){l("throw",b)}function V(b,w){b(w),o.shift(),o.length&&l(o[0][0],o[0][1])}}function F2(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=e[Symbol.asyncIterator];return t?t.call(e):(e=function Y1(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=e[o]&&function(s){return new Promise(function(l,f){!function a(o,s,l,f){Promise.resolve(f).then(function(p){o({value:p,done:l})},s)}(l,f,(s=e[o](s)).done,s.value)})}}}const B5=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function J3(e){return k2(e?.then)}function Qe(e){return k2(e[z6])}function u1(e){return Symbol.asyncIterator&&k2(e?.[Symbol.asyncIterator])}function d8(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const J1=function Ve(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function _6(e){return k2(e?.[J1])}function p3(e){return n1(this,arguments,function*(){const n=e.getReader();try{for(;;){const{value:r,done:a}=yield _4(n.read());if(a)return yield _4(void 0);yield yield _4(r)}}finally{n.releaseLock()}})}function D4(e){return k2(e?.getReader)}function z3(e){if(e instanceof E2)return e;if(null!=e){if(Qe(e))return function x6(e){return new E2(t=>{const n=e[z6]();if(k2(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(B5(e))return function $4(e){return new E2(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(J3(e))return function U1(e){return new E2(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,H1)})}(e);if(u1(e))return K4(e);if(_6(e))return function n3(e){return new E2(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(D4(e))return function u4(e){return K4(p3(e))}(e)}throw d8(e)}function K4(e){return new E2(t=>{(function C4(e,t){var n,r,a,o;return function l1(e,t,n,r){return new(n||(n=Promise))(function(o,s){function l(y){try{p(r.next(y))}catch(V){s(V)}}function f(y){try{p(r.throw(y))}catch(V){s(V)}}function p(y){y.done?o(y.value):function a(o){return o instanceof n?o:new n(function(s){s(o)})}(y.value).then(l,f)}p((r=r.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=F2(e);!(r=yield n.next()).done;)if(t.next(r.value),t.closed)return}catch(s){a={error:s}}finally{try{r&&!r.done&&(o=n.return)&&(yield o.call(n))}finally{if(a)throw a.error}}t.complete()})})(e,t).catch(n=>t.error(n))})}function $2(e,t,n,r=0,a=!1){const o=t.schedule(function(){n(),a?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(o),!a)return o}function N3(e,t,n=1/0){return k2(t)?N3((r,a)=>o2((o,s)=>t(r,o,a,s))(z3(e(r,a))),n):("number"==typeof t&&(n=t),s1((r,a)=>function p8(e,t,n,r,a,o,s,l){const f=[];let p=0,y=0,V=!1;const b=()=>{V&&!f.length&&!p&&t.complete()},w=D=>p<r?x(D):f.push(D),x=D=>{o&&t.next(D),p++;let T=!1;z3(n(D,y++)).subscribe(c1(t,F=>{a?.(F),o?w(F):t.next(F)},()=>{T=!0},void 0,()=>{if(T)try{for(p--;f.length&&p<r;){const F=f.shift();s?$2(t,s,()=>x(F)):x(F)}b()}catch(F){t.error(F)}}))};return e.subscribe(c1(t,w,()=>{V=!0,b()})),()=>{l?.()}}(r,a,e,n)))}const W5=new E2(e=>e.complete());function Je(e){return e[e.length-1]}function E6(e){return function Ye(e){return e&&k2(e.schedule)}(Je(e))?e.pop():void 0}function Q4(e,t=0){return s1((n,r)=>{n.subscribe(c1(r,a=>$2(r,e,()=>r.next(a),t),()=>$2(r,e,()=>r.complete(),t),a=>$2(r,e,()=>r.error(a),t)))})}function Y4(e,t=0){return s1((n,r)=>{r.add(e.schedule(()=>n.subscribe(r),t))})}function j5(e,t){if(!e)throw new Error("Iterable cannot be null");return new E2(n=>{$2(n,t,()=>{const r=e[Symbol.asyncIterator]();$2(n,t,()=>{r.next().then(a=>{a.done?n.complete():n.next(a.value)})},0,!0)})})}function Se(e,t){return t?function He(e,t){if(null!=e){if(Qe(e))return function P1(e,t){return z3(e).pipe(Y4(t),Q4(t))}(e,t);if(B5(e))return function Z0(e,t){return new E2(n=>{let r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(J3(e))return function X0(e,t){return z3(e).pipe(Y4(t),Q4(t))}(e,t);if(u1(e))return j5(e,t);if(_6(e))return function m8(e,t){return new E2(n=>{let r;return $2(n,t,()=>{r=e[J1](),$2(n,t,()=>{let a,o;try{({value:a,done:o}=r.next())}catch(s){return void n.error(s)}o?n.complete():n.next(a)},0,!0)}),()=>k2(r?.return)&&r.return()})}(e,t);if(D4(e))return function er(e,t){return j5(p3(e),t)}(e,t)}throw d8(e)}(e,t):z3(e)}function Xe(...e){const t=E6(e),n=function N6(e,t){return"number"==typeof Je(e)?e.pop():t}(e,1/0),r=e;return r.length?1===r.length?z3(r[0]):function X1(e=1/0){return N3(w6,e)}(n)(Se(r,t)):W5}function U5(e,t,...n){if(!0===t)return void e();if(!1===t)return;const r=new $e({next:()=>{r.unsubscribe(),e()}});return t(...n).subscribe(r)}function X2(e){for(let t in e)if(e[t]===X2)return t;throw Error("Could not find renamed property on target object.")}function k6(e,t){for(const n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function r1(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(r1).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function J4(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const G5=X2({__forward_ref__:X2});function T6(e){return e.__forward_ref__=T6,e.toString=function(){return r1(this())},e}function e2(e){return X4(e)?e():e}function X4(e){return"function"==typeof e&&e.hasOwnProperty(G5)&&e.__forward_ref__===T6}class q extends Error{constructor(t,n){super(function A6(e,t){return`NG0${Math.abs(e)}${t?": "+t.trim():""}`}(t,n)),this.code=t}}function p2(e){return"string"==typeof e?e:null==e?"":String(e)}function be(e,t){throw new q(-201,!1)}function M(e,t){null==e&&function H(e,t,n,r){throw new Error(`ASSERTION ERROR: ${e}`+(null==r?"":` [Expected=> ${n} ${r} ${t} <=Actual]`))}(t,e,null,"!=")}function z(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function E(e){return{providers:e.providers||[],imports:e.imports||[]}}function A(e){return R(e,m2)||R(e,o1)}function R(e,t){return e.hasOwnProperty(t)?e[t]:null}function f2(e){return e&&(e.hasOwnProperty(R2)||e.hasOwnProperty(A2))?e[R2]:null}const m2=X2({\u0275prov:X2}),R2=X2({\u0275inj:X2}),o1=X2({ngInjectableDef:X2}),A2=X2({ngInjectorDef:X2});var Y=(()=>((Y=Y||{})[Y.Default=0]="Default",Y[Y.Host=1]="Host",Y[Y.Self=2]="Self",Y[Y.SkipSelf=4]="SkipSelf",Y[Y.Optional=8]="Optional",Y))();let w1;function a1(e){const t=w1;return w1=e,t}function w3(e,t,n){const r=A(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&Y.Optional?null:void 0!==t?t:void be(r1(e))}function h4(e){return{toString:e}.toString()}var m3=(()=>((m3=m3||{})[m3.OnPush=0]="OnPush",m3[m3.Default=1]="Default",m3))(),r3=(()=>{return(e=r3||(r3={}))[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",r3;var e})();const B2=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Z4={},K2=[],ee=X2({\u0275cmp:X2}),$5=X2({\u0275dir:X2}),K5=X2({\u0275pipe:X2}),Ze=X2({\u0275mod:X2}),X3=X2({\u0275fac:X2}),E4=X2({__NG_ELEMENT_ID__:X2});let v8=0;function G1(e){return h4(()=>{const n=!0===e.standalone,r={},a={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===m3.OnPush,directiveDefs:null,pipeDefs:null,standalone:n,dependencies:n&&e.dependencies||null,getStandaloneInjector:null,selectors:e.selectors||K2,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||r3.Emulated,id:"c"+v8++,styles:e.styles||K2,_:null,setInput:null,schemas:e.schemas||null,tView:null},o=e.dependencies,s=e.features;return a.inputs=e6(e.inputs,r),a.outputs=e6(e.outputs),s&&s.forEach(l=>l(a)),a.directiveDefs=o?()=>("function"==typeof o?o():o).map(Q5).filter(F6):null,a.pipeDefs=o?()=>("function"==typeof o?o():o).map($1).filter(F6):null,a})}function Q5(e){return Y2(e)||Z1(e)}function F6(e){return null!==e}function k3(e){return h4(()=>({type:e.type,bootstrap:e.bootstrap||K2,declarations:e.declarations||K2,imports:e.imports||K2,exports:e.exports||K2,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function e6(e,t){if(null==e)return Z4;const n={};for(const r in e)if(e.hasOwnProperty(r)){let a=e[r],o=a;Array.isArray(a)&&(o=a[1],a=a[0]),n[a]=r,t&&(t[a]=o)}return n}const q1=G1;function Y2(e){return e[ee]||null}function Z1(e){return e[$5]||null}function $1(e){return e[K5]||null}function _3(e){return Array.isArray(e)&&"object"==typeof e[1]}function p4(e){return Array.isArray(e)&&!0===e[1]}function cr(e){return 0!=(8&e.flags)}function S8(e){return 2==(2&e.flags)}function b8(e){return 1==(1&e.flags)}function m4(e){return null!==e.template}function hV(e){return 0!=(256&e[2])}function a6(e,t){return e.hasOwnProperty(X3)?e[X3]:null}class mV{constructor(t,n,r){this.previousValue=t,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function we(){return so}function so(e){return e.type.prototype.ngOnChanges&&(e.setInput=vV),gV}function gV(){const e=lo(this),t=e?.current;if(t){const n=e.previous;if(n===Z4)e.previous=t;else for(let r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function vV(e,t,n,r){const a=lo(e)||function yV(e,t){return e[co]=t}(e,{previous:Z4,current:null}),o=a.current||(a.current={}),s=a.previous,l=this.declaredInputs[n],f=s[l];o[l]=new mV(f&&f.currentValue,t,s===Z4),e[r]=t}we.ngInherit=!0;const co="__ngSimpleChanges__";function lo(e){return e[co]||null}function E1(e){for(;Array.isArray(e);)e=e[0];return e}function z8(e,t){return E1(t[e])}function t4(e,t){return E1(t[e.index])}function hr(e,t){return e.data[t]}function T3(e,t){const n=t[e];return _3(n)?n:n[0]}function uo(e){return 4==(4&e[2])}function w8(e){return 64==(64&e[2])}function _e(e,t){return null==t?null:e[t]}function Co(e){e[18]=0}function dr(e,t){e[5]+=t;let n=e,r=e[3];for(;null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}const H2={lFrame:Lo(null),bindingsEnabled:!0};function ho(){return H2.bindingsEnabled}function j(){return H2.lFrame.lView}function q2(){return H2.lFrame.tView}function xe(e){return H2.lFrame.contextLView=e,e[8]}function De(e){return H2.lFrame.contextLView=null,e}function F1(){let e=po();for(;null!==e&&64===e.type;)e=e.parent;return e}function po(){return H2.lFrame.currentTNode}function N4(e,t){const n=H2.lFrame;n.currentTNode=e,n.isParent=t}function pr(){return H2.lFrame.isParent}function mr(){H2.lFrame.isParent=!1}function v3(){const e=H2.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function j6(){return H2.lFrame.bindingIndex++}function re(e){const t=H2.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function kV(e,t){const n=H2.lFrame;n.bindingIndex=n.bindingRootIndex=e,gr(t)}function gr(e){H2.lFrame.currentDirectiveIndex=e}function vo(){return H2.lFrame.currentQueryIndex}function yr(e){H2.lFrame.currentQueryIndex=e}function AV(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function yo(e,t,n){if(n&Y.SkipSelf){let a=t,o=e;for(;!(a=a.parent,null!==a||n&Y.Host||(a=AV(o),null===a||(o=o[15],10&a.type))););if(null===a)return!1;t=a,e=o}const r=H2.lFrame=Mo();return r.currentTNode=t,r.lView=e,!0}function Mr(e){const t=Mo(),n=e[1];H2.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function Mo(){const e=H2.lFrame,t=null===e?null:e.child;return null===t?Lo(e):t}function Lo(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function Vo(){const e=H2.lFrame;return H2.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const Ho=Vo;function Lr(){const e=Vo();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function y3(){return H2.lFrame.selectedIndex}function Ee(e){H2.lFrame.selectedIndex=e}function S1(){const e=H2.lFrame;return hr(e.tView,e.selectedIndex)}function Z5(){H2.lFrame.currentNamespace="svg"}function x8(){!function OV(){H2.lFrame.currentNamespace=null}()}function D8(e,t){for(let n=t.directiveStart,r=t.directiveEnd;n<r;n++){const o=e.data[n].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:l,ngAfterViewInit:f,ngAfterViewChecked:p,ngOnDestroy:y}=o;s&&(e.contentHooks||(e.contentHooks=[])).push(-n,s),l&&((e.contentHooks||(e.contentHooks=[])).push(n,l),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,l)),f&&(e.viewHooks||(e.viewHooks=[])).push(-n,f),p&&((e.viewHooks||(e.viewHooks=[])).push(n,p),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,p)),null!=y&&(e.destroyHooks||(e.destroyHooks=[])).push(n,y)}}function E8(e,t,n){So(e,t,3,n)}function N8(e,t,n,r){(3&e[2])===n&&So(e,t,n,r)}function Vr(e,t){let n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function So(e,t,n,r){const o=r??-1,s=t.length-1;let l=0;for(let f=void 0!==r?65535&e[18]:0;f<s;f++)if("number"==typeof t[f+1]){if(l=t[f],null!=r&&l>=r)break}else t[f]<0&&(e[18]+=65536),(l<o||-1==o)&&(WV(e,n,t,f),e[18]=(4294901760&e[18])+f+2),f++}function WV(e,t,n,r){const a=n[r]<0,o=n[r+1],l=e[a?-n[r]:n[r]];if(a){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{o.call(l)}finally{}}}else try{o.call(l)}finally{}}class et{constructor(t,n,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}}function k8(e,t,n){let r=0;for(;r<n.length;){const a=n[r];if("number"==typeof a){if(0!==a)break;r++;const o=n[r++],s=n[r++],l=n[r++];e.setAttribute(t,s,l,o)}else{const o=a,s=n[++r];zo(o)?e.setProperty(t,o,s):e.setAttribute(t,o,s),r++}}return r}function bo(e){return 3===e||4===e||6===e}function zo(e){return 64===e.charCodeAt(0)}function T8(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let r=0;r<t.length;r++){const a=t[r];"number"==typeof a?n=a:0===n||wo(e,n,a,null,-1===n||2===n?t[++r]:null)}}return e}function wo(e,t,n,r,a){let o=0,s=e.length;if(-1===t)s=-1;else for(;o<e.length;){const l=e[o++];if("number"==typeof l){if(l===t){s=-1;break}if(l>t){s=o-1;break}}}for(;o<e.length;){const l=e[o];if("number"==typeof l)break;if(l===n){if(null===r)return void(null!==a&&(e[o+1]=a));if(r===e[o+1])return void(e[o+2]=a)}o++,null!==r&&o++,null!==a&&o++}-1!==s&&(e.splice(s,0,t),o=s+1),e.splice(o++,0,n),null!==r&&e.splice(o++,0,r),null!==a&&e.splice(o++,0,a)}function _o(e){return-1!==e}function U6(e){return 32767&e}function G6(e,t){let n=function $V(e){return e>>16}(e),r=t;for(;n>0;)r=r[15],n--;return r}let Sr=!0;function A8(e){const t=Sr;return Sr=e,t}let KV=0;const k4={};function nt(e,t){const n=zr(e,t);if(-1!==n)return n;const r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,br(r.data,e),br(t,null),br(r.blueprint,null));const a=P8(e,t),o=e.injectorIndex;if(_o(a)){const s=U6(a),l=G6(a,t),f=l[1].data;for(let p=0;p<8;p++)t[o+p]=l[s+p]|f[s+p]}return t[o+8]=a,o}function br(e,t){e.push(0,0,0,0,0,0,0,0,t)}function zr(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function P8(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,r=null,a=t;for(;null!==a;){if(r=Io(a),null===r)return-1;if(n++,a=a[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function I8(e,t,n){!function QV(e,t,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(E4)&&(r=n[E4]),null==r&&(r=n[E4]=KV++);const a=255&r;t.data[e+(a>>5)]|=1<<a}(e,t,n)}function Eo(e,t,n){if(n&Y.Optional)return e;be()}function No(e,t,n,r){if(n&Y.Optional&&void 0===r&&(r=null),0==(n&(Y.Self|Y.Host))){const a=e[9],o=a1(void 0);try{return a?a.get(t,r,n&Y.Optional):w3(t,r,n&Y.Optional)}finally{a1(o)}}return Eo(r,0,n)}function ko(e,t,n,r=Y.Default,a){if(null!==e){if(1024&t[2]){const s=function eH(e,t,n,r,a){let o=e,s=t;for(;null!==o&&null!==s&&1024&s[2]&&!(256&s[2]);){const l=To(o,s,n,r|Y.Self,k4);if(l!==k4)return l;let f=o.parent;if(!f){const p=s[21];if(p){const y=p.get(n,k4,r);if(y!==k4)return y}f=Io(s),s=s[15]}o=f}return a}(e,t,n,r,k4);if(s!==k4)return s}const o=To(e,t,n,r,k4);if(o!==k4)return o}return No(t,n,r,a)}function To(e,t,n,r,a){const o=function XV(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(E4)?e[E4]:void 0;return"number"==typeof t?t>=0?255&t:ZV:t}(n);if("function"==typeof o){if(!yo(t,e,r))return r&Y.Host?Eo(a,0,r):No(t,n,r,a);try{const s=o(r);if(null!=s||r&Y.Optional)return s;be()}finally{Ho()}}else if("number"==typeof o){let s=null,l=zr(e,t),f=-1,p=r&Y.Host?t[16][6]:null;for((-1===l||r&Y.SkipSelf)&&(f=-1===l?P8(e,t):t[l+8],-1!==f&&Po(r,!1)?(s=t[1],l=U6(f),t=G6(f,t)):l=-1);-1!==l;){const y=t[1];if(Ao(o,l,y.data)){const V=JV(l,t,n,s,r,p);if(V!==k4)return V}f=t[l+8],-1!==f&&Po(r,t[1].data[l+8]===p)&&Ao(o,l,t)?(s=y,l=U6(f),t=G6(f,t)):l=-1}}return a}function JV(e,t,n,r,a,o){const s=t[1],l=s.data[e+8],y=F8(l,s,n,null==r?S8(l)&&Sr:r!=s&&0!=(3&l.type),a&Y.Host&&o===l);return null!==y?rt(t,s,y,l):k4}function F8(e,t,n,r,a){const o=e.providerIndexes,s=t.data,l=1048575&o,f=e.directiveStart,y=o>>20,b=a?l+y:e.directiveEnd;for(let w=r?l:l+y;w<b;w++){const x=s[w];if(w<f&&n===x||w>=f&&x.type===n)return w}if(a){const w=s[f];if(w&&m4(w)&&w.type===n)return f}return null}function rt(e,t,n,r){let a=e[n];const o=t.data;if(function jV(e){return e instanceof et}(a)){const s=a;s.resolving&&function P6(e,t){const n=t?`. Dependency path: ${t.join(" > ")} > ${e}`:"";throw new q(-200,`Circular dependency in DI detected for ${e}${n}`)}(function O2(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():p2(e)}(o[n]));const l=A8(s.canSeeViewProviders);s.resolving=!0;const f=s.injectImpl?a1(s.injectImpl):null;yo(e,r,Y.Default);try{a=e[n]=s.factory(void 0,o,e,r),t.firstCreatePass&&n>=r.directiveStart&&function BV(e,t,n){const{ngOnChanges:r,ngOnInit:a,ngDoCheck:o}=t.type.prototype;if(r){const s=so(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s)}a&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,a),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,o[n],t)}finally{null!==f&&a1(f),A8(l),s.resolving=!1,Ho()}}return a}function Ao(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function Po(e,t){return!(e&Y.Self||e&Y.Host&&t)}class q6{constructor(t,n){this._tNode=t,this._lView=n}get(t,n,r){return ko(this._tNode,this._lView,t,r,n)}}function ZV(){return new q6(F1(),j())}function O8(e){return h4(()=>{const t=e.prototype.constructor,n=t[X3]||wr(t),r=Object.prototype;let a=Object.getPrototypeOf(e.prototype).constructor;for(;a&&a!==r;){const o=a[X3]||wr(a);if(o&&o!==n)return o;a=Object.getPrototypeOf(a)}return o=>new o})}function wr(e){return X4(e)?()=>{const t=wr(e2(e));return t&&t()}:a6(e)}function Io(e){const t=e[1],n=t.type;return 2===n?t.declTNode:1===n?e[6]:null}const K6="__parameters__";function Y6(e,t,n){return h4(()=>{const r=function xr(e){return function(...n){if(e){const r=e(...n);for(const a in r)this[a]=r[a]}}}(t);function a(...o){if(this instanceof a)return r.apply(this,o),this;const s=new a(...o);return l.annotation=s,l;function l(f,p,y){const V=f.hasOwnProperty(K6)?f[K6]:Object.defineProperty(f,K6,{value:[]})[K6];for(;V.length<=y;)V.push(null);return(V[y]=V[y]||[]).push(s),f}}return n&&(a.prototype=Object.create(n.prototype)),a.prototype.ngMetadataName=e,a.annotationCls=a,a})}class N2{constructor(t,n){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=z({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function A3(e,t){void 0===t&&(t=e);for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),A3(r,t)):t!==e&&t.push(r)}return t}function ae(e,t){e.forEach(n=>Array.isArray(n)?ae(n,t):t(n))}function Oo(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function R8(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function ot(e,t){const n=[];for(let r=0;r<e;r++)n.push(t);return n}function P3(e,t,n){let r=J6(e,t);return r>=0?e[1|r]=n:(r=~r,function aH(e,t,n,r){let a=e.length;if(a==t)e.push(n,r);else if(1===a)e.push(r,e[0]),e[0]=n;else{for(a--,e.push(e[a-1],e[a]);a>t;)e[a]=e[a-2],a--;e[t]=n,e[t+1]=r}}(e,r,t,n)),r}function Er(e,t){const n=J6(e,t);if(n>=0)return e[1|n]}function J6(e,t){return function Wo(e,t,n){let r=0,a=e.length>>n;for(;a!==r;){const o=r+(a-r>>1),s=e[o<<n];if(t===s)return o<<n;s>t?a=o:r=o+1}return~(a<<n)}(e,t,1)}const st={},kr="__NG_DI_FLAG__",W8="ngTempTokenPath",fH=/\n/gm,jo="__source";let ct;function X6(e){const t=ct;return ct=e,t}function dH(e,t=Y.Default){if(void 0===ct)throw new q(-203,!1);return null===ct?w3(e,void 0,t):ct.get(e,t&Y.Optional?null:void 0,t)}function V2(e,t=Y.Default){return(function m1(){return w1}()||dH)(e2(e),t)}function Tr(e,t=Y.Default){return"number"!=typeof t&&(t=0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)),V2(e,t)}function Ar(e){const t=[];for(let n=0;n<e.length;n++){const r=e2(e[n]);if(Array.isArray(r)){if(0===r.length)throw new q(900,!1);let a,o=Y.Default;for(let s=0;s<r.length;s++){const l=r[s],f=pH(l);"number"==typeof f?-1===f?a=l.token:o|=f:a=l}t.push(V2(a,o))}else t.push(V2(r))}return t}function lt(e,t){return e[kr]=t,e.prototype[kr]=t,e}function pH(e){return e[kr]}const j8=lt(Y6("Optional"),8),U8=lt(Y6("SkipSelf"),4);let Ir,$8,K8;function e5(e){return function Fr(){if(void 0===$8&&($8=null,B2.trustedTypes))try{$8=B2.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return $8}()?.createHTML(e)||e}function Zo(e){return function Or(){if(void 0===K8&&(K8=null,B2.trustedTypes))try{K8=B2.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return K8}()?.createHTML(e)||e}class i6{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class DH extends i6{getTypeName(){return"HTML"}}class EH extends i6{getTypeName(){return"Style"}}class NH extends i6{getTypeName(){return"Script"}}class kH extends i6{getTypeName(){return"URL"}}class TH extends i6{getTypeName(){return"ResourceURL"}}function I3(e){return e instanceof i6?e.changingThisBreaksApplicationSecurity:e}function T4(e,t){const n=function AH(e){return e instanceof i6&&e.getTypeName()||null}(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===t}class BH{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const n=(new window.DOMParser).parseFromString(e5(t),"text/html").body;return null===n?this.inertDocumentHelper.getInertBodyElement(t):(n.removeChild(n.firstChild),n)}catch{return null}}}class WH{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n);const r=this.inertDocument.createElement("body");n.appendChild(r)}}getInertBodyElement(t){const n=this.inertDocument.createElement("template");if("content"in n)return n.innerHTML=e5(t),n;const r=this.inertDocument.createElement("body");return r.innerHTML=e5(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(r),r}stripCustomNsAttrs(t){const n=t.attributes;for(let a=n.length-1;0<a;a--){const s=n.item(a).name;("xmlns:ns1"===s||0===s.indexOf("ns1:"))&&t.removeAttribute(s)}let r=t.firstChild;for(;r;)r.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(r),r=r.nextSibling}}const UH=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,GH=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function ft(e){return(e=String(e)).match(UH)||e.match(GH)?e:"unsafe:"+e}function A4(e){const t={};for(const n of e.split(","))t[n]=!0;return t}function ht(...e){const t={};for(const n of e)for(const r in n)n.hasOwnProperty(r)&&(t[r]=!0);return t}const as=A4("area,br,col,hr,img,wbr"),is=A4("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),os=A4("rp,rt"),Rr=ht(as,ht(is,A4("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ht(os,A4("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ht(os,is)),Br=A4("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Wr=A4("srcset"),ss=ht(Br,Wr,A4("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),A4("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),qH=A4("script,style,template");class $H{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let n=t.firstChild,r=!0;for(;n;)if(n.nodeType===Node.ELEMENT_NODE?r=this.startElement(n):n.nodeType===Node.TEXT_NODE?this.chars(n.nodeValue):this.sanitizedSomething=!0,r&&n.firstChild)n=n.firstChild;else for(;n;){n.nodeType===Node.ELEMENT_NODE&&this.endElement(n);let a=this.checkClobberedElement(n,n.nextSibling);if(a){n=a;break}n=this.checkClobberedElement(n,n.parentNode)}return this.buf.join("")}startElement(t){const n=t.nodeName.toLowerCase();if(!Rr.hasOwnProperty(n))return this.sanitizedSomething=!0,!qH.hasOwnProperty(n);this.buf.push("<"),this.buf.push(n);const r=t.attributes;for(let a=0;a<r.length;a++){const o=r.item(a),s=o.name,l=s.toLowerCase();if(!ss.hasOwnProperty(l)){this.sanitizedSomething=!0;continue}let f=o.value;Br[l]&&(f=ft(f)),Wr[l]&&(e=f,f=(e=String(e)).split(",").map(t=>ft(t.trim())).join(", ")),this.buf.push(" ",s,'="',cs(f),'"')}var e;return this.buf.push(">"),!0}endElement(t){const n=t.nodeName.toLowerCase();Rr.hasOwnProperty(n)&&!as.hasOwnProperty(n)&&(this.buf.push("</"),this.buf.push(n),this.buf.push(">"))}chars(t){this.buf.push(cs(t))}checkClobberedElement(t,n){if(n&&(t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return n}}const KH=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,QH=/([^\#-~ |!])/g;function cs(e){return e.replace(/&/g,"&amp;").replace(KH,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(QH,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Q8;function ls(e,t){let n=null;try{Q8=Q8||function ns(e){const t=new WH(e);return function jH(){try{return!!(new window.DOMParser).parseFromString(e5(""),"text/html")}catch{return!1}}()?new BH(t):t}(e);let r=t?String(t):"";n=Q8.getInertBodyElement(r);let a=5,o=r;do{if(0===a)throw new Error("Failed to sanitize html because the input is unstable");a--,r=o,o=n.innerHTML,n=Q8.getInertBodyElement(r)}while(r!==o);return e5((new $H).sanitizeChildren(jr(n)||n))}finally{if(n){const r=jr(n)||n;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function jr(e){return"content"in e&&function YH(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var h1=(()=>((h1=h1||{})[h1.NONE=0]="NONE",h1[h1.HTML=1]="HTML",h1[h1.STYLE=2]="STYLE",h1[h1.SCRIPT=3]="SCRIPT",h1[h1.URL=4]="URL",h1[h1.RESOURCE_URL=5]="RESOURCE_URL",h1))();function Y8(e){const t=function dt(){const e=j();return e&&e[12]}();return t?Zo(t.sanitize(h1.HTML,e)||""):T4(e,"HTML")?Zo(I3(e)):ls(function Xo(){return void 0!==Ir?Ir:typeof document<"u"?document:void 0}(),p2(e))}const fs=new N2("ENVIRONMENT_INITIALIZER"),hs=new N2("INJECTOR",-1),ds=new N2("INJECTOR_DEF_TYPES");class ps{get(t,n=st){if(n===st){const r=new Error(`NullInjectorError: No provider for ${r1(t)}!`);throw r.name="NullInjectorError",r}return n}}function rS(...e){return{\u0275providers:ms(0,e)}}function ms(e,...t){const n=[],r=new Set;let a;return ae(t,o=>{const s=o;Ur(s,n,[],r)&&(a||(a=[]),a.push(s))}),void 0!==a&&gs(a,n),n}function gs(e,t){for(let n=0;n<e.length;n++){const{providers:a}=e[n];ae(a,o=>{t.push(o)})}}function Ur(e,t,n,r){if(!(e=e2(e)))return!1;let a=null,o=f2(e);const s=!o&&Y2(e);if(o||s){if(s&&!s.standalone)return!1;a=e}else{const f=e.ngModule;if(o=f2(f),!o)return!1;a=f}const l=r.has(a);if(s){if(l)return!1;if(r.add(a),s.dependencies){const f="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const p of f)Ur(p,t,n,r)}}else{if(!o)return!1;{if(null!=o.imports&&!l){let p;r.add(a);try{ae(o.imports,y=>{Ur(y,t,n,r)&&(p||(p=[]),p.push(y))})}finally{}void 0!==p&&gs(p,t)}if(!l){const p=a6(a)||(()=>new a);t.push({provide:a,useFactory:p,deps:K2},{provide:ds,useValue:a,multi:!0},{provide:fs,useValue:()=>V2(a),multi:!0})}const f=o.providers;null==f||l||ae(f,y=>{t.push(y)})}}return a!==e&&void 0!==e.providers}const aS=X2({provide:String,useValue:X2});function Gr(e){return null!==e&&"object"==typeof e&&aS in e}function o6(e){return"function"==typeof e}const qr=new N2("Set Injector scope."),J8={},oS={};let $r;function X8(){return void 0===$r&&($r=new ps),$r}class t5{}class Ms extends t5{constructor(t,n,r,a){super(),this.parent=n,this.source=r,this.scopes=a,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Qr(t,s=>this.processProvider(s)),this.records.set(hs,n5(void 0,this)),a.has("environment")&&this.records.set(t5,n5(void 0,this));const o=this.records.get(qr);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(ds.multi,K2,Y.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();for(const t of this._onDestroyHooks)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(t){this._onDestroyHooks.push(t)}runInContext(t){this.assertNotDestroyed();const n=X6(this),r=a1(void 0);try{return t()}finally{X6(n),a1(r)}}get(t,n=st,r=Y.Default){this.assertNotDestroyed();const a=X6(this),o=a1(void 0);try{if(!(r&Y.SkipSelf)){let l=this.records.get(t);if(void 0===l){const f=function CS(e){return"function"==typeof e||"object"==typeof e&&e instanceof N2}(t)&&A(t);l=f&&this.injectableDefInScope(f)?n5(Kr(t),J8):null,this.records.set(t,l)}if(null!=l)return this.hydrate(t,l)}return(r&Y.Self?X8():this.parent).get(t,n=r&Y.Optional&&n===st?null:n)}catch(s){if("NullInjectorError"===s.name){if((s[W8]=s[W8]||[]).unshift(r1(t)),a)throw s;return function mH(e,t,n,r){const a=e[W8];throw t[jo]&&a.unshift(t[jo]),e.message=function gH(e,t,n,r=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let a=r1(t);if(Array.isArray(t))a=t.map(r1).join(" -> ");else if("object"==typeof t){let o=[];for(let s in t)if(t.hasOwnProperty(s)){let l=t[s];o.push(s+":"+("string"==typeof l?JSON.stringify(l):r1(l)))}a=`{${o.join(", ")}}`}return`${n}${r?"("+r+")":""}[${a}]: ${e.replace(fH,"\n  ")}`}("\n"+e.message,a,n,r),e.ngTokenPath=a,e[W8]=null,e}(s,t,"R3InjectorError",this.source)}throw s}finally{a1(o),X6(a)}}resolveInjectorInitializers(){const t=X6(this),n=a1(void 0);try{const r=this.get(fs.multi,K2,Y.Self);for(const a of r)a()}finally{X6(t),a1(n)}}toString(){const t=[],n=this.records;for(const r of n.keys())t.push(r1(r));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new q(205,!1)}processProvider(t){let n=o6(t=e2(t))?t:e2(t&&t.provide);const r=function cS(e){return Gr(e)?n5(void 0,e.useValue):n5(function Ls(e,t,n){let r;if(o6(e)){const a=e2(e);return a6(a)||Kr(a)}if(Gr(e))r=()=>e2(e.useValue);else if(function ys(e){return!(!e||!e.useFactory)}(e))r=()=>e.useFactory(...Ar(e.deps||[]));else if(function vs(e){return!(!e||!e.useExisting)}(e))r=()=>V2(e2(e.useExisting));else{const a=e2(e&&(e.useClass||e.provide));if(!function lS(e){return!!e.deps}(e))return a6(a)||Kr(a);r=()=>new a(...Ar(e.deps))}return r}(e),J8)}(t);if(o6(t)||!0!==t.multi)this.records.get(n);else{let a=this.records.get(n);a||(a=n5(void 0,J8,!0),a.factory=()=>Ar(a.multi),this.records.set(n,a)),n=t,a.multi.push(t)}this.records.set(n,r)}hydrate(t,n){return n.value===J8&&(n.value=oS,n.value=n.factory()),"object"==typeof n.value&&n.value&&function uS(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(t){if(!t.providedIn)return!1;const n=e2(t.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}}function Kr(e){const t=A(e),n=null!==t?t.factory:a6(e);if(null!==n)return n;if(e instanceof N2)throw new q(204,!1);if(e instanceof Function)return function sS(e){const t=e.length;if(t>0)throw ot(t,"?"),new q(204,!1);const n=function K(e){const t=e&&(e[m2]||e[o1]);if(t){const n=function u2(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),t}return null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new q(204,!1)}function n5(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function fS(e){return!!e.\u0275providers}function Qr(e,t){for(const n of e)Array.isArray(n)?Qr(n,t):fS(n)?Qr(n.\u0275providers,t):t(n)}class Vs{}class pS{resolveComponentFactory(t){throw function dS(e){const t=Error(`No component factory found for ${r1(e)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=e,t}(t)}}let pt=(()=>{class e{}return e.NULL=new pS,e})();function mS(){return r5(F1(),j())}function r5(e,t){return new P4(t4(e,t))}let P4=(()=>{class e{constructor(n){this.nativeElement=n}}return e.__NG_ELEMENT_ID__=mS,e})();function gS(e){return e instanceof P4?e.nativeElement:e}class mt{}let Z8=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>function vS(){const e=j(),n=T3(F1().index,e);return(_3(n)?n:e)[11]}(),e})(),yS=(()=>{class e{}return e.\u0275prov=z({token:e,providedIn:"root",factory:()=>null}),e})();class Yr{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const MS=new Yr("14.1.2"),Jr={};function na(e){return e.ngOriginalError}class a5{constructor(){this._console=console}handleError(t){const n=this._findOriginalError(t);this._console.error("ERROR",t),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(t){let n=t&&na(t);for(;n&&na(n);)n=na(n);return n||null}}const ra=new Map;let NS=0;const ia="__ngContext__";function c3(e,t){_3(t)?(e[ia]=t[20],function TS(e){ra.set(e[20],e)}(t)):e[ia]=t}function gt(e){const t=e[ia];return"number"==typeof t?function xs(e){return ra.get(e)||null}(t):t||null}function oa(e){const t=gt(e);return t?_3(t)?t:t.lView:null}const jS=(()=>(typeof requestAnimationFrame<"u"&&requestAnimationFrame||setTimeout).bind(B2))();var x3=(()=>((x3=x3||{})[x3.Important=1]="Important",x3[x3.DashCase=2]="DashCase",x3))();function ca(e,t){return undefined(e,t)}function vt(e){const t=e[3];return p4(t)?t[3]:t}function la(e){return Is(e[13])}function ua(e){return Is(e[4])}function Is(e){for(;null!==e&&!p4(e);)e=e[4];return e}function o5(e,t,n,r,a){if(null!=r){let o,s=!1;p4(r)?o=r:_3(r)&&(s=!0,r=r[0]);const l=E1(r);0===e&&null!==n?null==a?js(t,n,l):s6(t,n,l,a||null,!0):1===e&&null!==n?s6(t,n,l,a||null,!0):2===e?function Ys(e,t,n){const r=en(e,t);r&&function sb(e,t,n,r){e.removeChild(t,n,r)}(e,r,t,n)}(t,l,s):3===e&&t.destroyNode(l),null!=o&&function ub(e,t,n,r,a){const o=n[7];o!==E1(n)&&o5(t,e,r,o,a);for(let l=10;l<n.length;l++){const f=n[l];yt(f[1],f,e,t,r,o)}}(t,e,o,n,a)}}function fa(e,t,n){return e.createElement(t,n)}function Os(e,t){const n=e[9],r=n.indexOf(t),a=t[3];512&t[2]&&(t[2]&=-513,dr(a,-1)),n.splice(r,1)}function ha(e,t){if(e.length<=10)return;const n=10+t,r=e[n];if(r){const a=r[17];null!==a&&a!==e&&Os(a,r),t>0&&(e[n-1][4]=r[4]);const o=R8(e,10+t);!function ZS(e,t){yt(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const s=o[19];null!==s&&s.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-65}return r}function Rs(e,t){if(!(128&t[2])){const n=t[11];n.destroyNode&&yt(e,t,n,3,null,null),function nb(e){let t=e[13];if(!t)return da(e[1],e);for(;t;){let n=null;if(_3(t))n=t[13];else{const r=t[10];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)_3(t)&&da(t[1],t),t=t[3];null===t&&(t=e),_3(t)&&da(t[1],t),n=t&&t[4]}t=n}}(t)}}function da(e,t){if(!(128&t[2])){t[2]&=-65,t[2]|=128,function ob(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let r=0;r<n.length;r+=2){const a=t[n[r]];if(!(a instanceof et)){const o=n[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const l=a[o[s]],f=o[s+1];try{f.call(l)}finally{}}else try{o.call(a)}finally{}}}}(e,t),function ib(e,t){const n=e.cleanup,r=t[7];let a=-1;if(null!==n)for(let o=0;o<n.length-1;o+=2)if("string"==typeof n[o]){const s=n[o+1],l="function"==typeof s?s(t):E1(t[s]),f=r[a=n[o+2]],p=n[o+3];"boolean"==typeof p?l.removeEventListener(n[o],f,p):p>=0?r[a=p]():r[a=-p].unsubscribe(),o+=2}else{const s=r[a=n[o+1]];n[o].call(s)}if(null!==r){for(let o=a+1;o<r.length;o++)(0,r[o])();t[7]=null}}(e,t),1===t[1].type&&t[11].destroy();const n=t[17];if(null!==n&&p4(t[3])){n!==t[3]&&Os(n,t);const r=t[19];null!==r&&r.detachView(e)}!function AS(e){ra.delete(e[20])}(t)}}function Bs(e,t,n){return function Ws(e,t,n){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){const a=e.data[r.directiveStart].encapsulation;if(a===r3.None||a===r3.Emulated)return null}return t4(r,n)}(e,t.parent,n)}function s6(e,t,n,r,a){e.insertBefore(t,n,r,a)}function js(e,t,n){e.appendChild(t,n)}function Us(e,t,n,r,a){null!==r?s6(e,t,n,r,a):js(e,t,n)}function en(e,t){return e.parentNode(t)}function Gs(e,t,n){return $s(e,t,n)}let $s=function qs(e,t,n){return 40&e.type?t4(e,n):null};function tn(e,t,n,r){const a=Bs(e,r,t),o=t[11],l=Gs(r.parent||t[6],r,t);if(null!=a)if(Array.isArray(n))for(let f=0;f<n.length;f++)Us(o,a,n[f],l,!1);else Us(o,a,n,l,!1)}function nn(e,t){if(null!==t){const n=t.type;if(3&n)return t4(t,e);if(4&n)return ma(-1,e[t.index]);if(8&n){const r=t.child;if(null!==r)return nn(e,r);{const a=e[t.index];return p4(a)?ma(-1,a):E1(a)}}if(32&n)return ca(t,e)()||E1(e[t.index]);{const r=Qs(e,t);return null!==r?Array.isArray(r)?r[0]:nn(vt(e[16]),r):nn(e,t.next)}}return null}function Qs(e,t){return null!==t?e[16][6].projection[t.projection]:null}function ma(e,t){const n=10+e+1;if(n<t.length){const r=t[n],a=r[1].firstChild;if(null!==a)return nn(r,a)}return t[7]}function ga(e,t,n,r,a,o,s){for(;null!=n;){const l=r[n.index],f=n.type;if(s&&0===t&&(l&&c3(E1(l),r),n.flags|=4),64!=(64&n.flags))if(8&f)ga(e,t,n.child,r,a,o,!1),o5(t,e,a,l,o);else if(32&f){const p=ca(n,r);let y;for(;y=p();)o5(t,e,a,y,o);o5(t,e,a,l,o)}else 16&f?Js(e,t,r,n,a,o):o5(t,e,a,l,o);n=s?n.projectionNext:n.next}}function yt(e,t,n,r,a,o){ga(n,r,e.firstChild,t,a,o,!1)}function Js(e,t,n,r,a,o){const s=n[16],f=s[6].projection[r.projection];if(Array.isArray(f))for(let p=0;p<f.length;p++)o5(t,e,a,f[p],o);else ga(e,t,f,s[3],a,o,!0)}function Xs(e,t,n){e.setAttribute(t,"style",n)}function va(e,t,n){""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n)}function Zs(e,t,n){let r=e.length;for(;;){const a=e.indexOf(t,n);if(-1===a)return a;if(0===a||e.charCodeAt(a-1)<=32){const o=t.length;if(a+o===r||e.charCodeAt(a+o)<=32)return a}n=a+1}}const ec="ng-template";function fb(e,t,n){let r=0;for(;r<e.length;){let a=e[r++];if(n&&"class"===a){if(a=e[r],-1!==Zs(a.toLowerCase(),t,0))return!0}else if(1===a){for(;r<e.length&&"string"==typeof(a=e[r++]);)if(a.toLowerCase()===t)return!0;return!1}}return!1}function tc(e){return 4===e.type&&e.value!==ec}function hb(e,t,n){return t===(4!==e.type||n?e.value:ec)}function db(e,t,n){let r=4;const a=e.attrs||[],o=function gb(e){for(let t=0;t<e.length;t++)if(bo(e[t]))return t;return e.length}(a);let s=!1;for(let l=0;l<t.length;l++){const f=t[l];if("number"!=typeof f){if(!s)if(4&r){if(r=2|1&r,""!==f&&!hb(e,f,n)||""===f&&1===t.length){if(g4(r))return!1;s=!0}}else{const p=8&r?f:t[++l];if(8&r&&null!==e.attrs){if(!fb(e.attrs,p,n)){if(g4(r))return!1;s=!0}continue}const V=pb(8&r?"class":f,a,tc(e),n);if(-1===V){if(g4(r))return!1;s=!0;continue}if(""!==p){let b;b=V>o?"":a[V+1].toLowerCase();const w=8&r?b:null;if(w&&-1!==Zs(w,p,0)||2&r&&p!==b){if(g4(r))return!1;s=!0}}}}else{if(!s&&!g4(r)&&!g4(f))return!1;if(s&&g4(f))continue;s=!1,r=f|1&r}}return g4(r)||s}function g4(e){return 0==(1&e)}function pb(e,t,n,r){if(null===t)return-1;let a=0;if(r||!n){let o=!1;for(;a<t.length;){const s=t[a];if(s===e)return a;if(3===s||6===s)o=!0;else{if(1===s||2===s){let l=t[++a];for(;"string"==typeof l;)l=t[++a];continue}if(4===s)break;if(0===s){a+=4;continue}}a+=o?1:2}return-1}return function vb(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function nc(e,t,n=!1){for(let r=0;r<t.length;r++)if(db(e,t[r],n))return!0;return!1}function yb(e,t){e:for(let n=0;n<t.length;n++){const r=t[n];if(e.length===r.length){for(let a=0;a<e.length;a++)if(e[a]!==r[a])continue e;return!0}}return!1}function rc(e,t){return e?":not("+t.trim()+")":t}function Mb(e){let t=e[0],n=1,r=2,a="",o=!1;for(;n<e.length;){let s=e[n];if("string"==typeof s)if(2&r){const l=e[++n];a+="["+s+(l.length>0?'="'+l+'"':"")+"]"}else 8&r?a+="."+s:4&r&&(a+=" "+s);else""!==a&&!g4(s)&&(t+=rc(o,a),a=""),r=s,o=o||!g4(r);n++}return""!==a&&(t+=rc(o,a)),t}const z2={};function J(e){ac(q2(),j(),y3()+e,!1)}function ac(e,t,n,r){if(!r)if(3==(3&t[2])){const o=e.preOrderCheckHooks;null!==o&&E8(t,o,n)}else{const o=e.preOrderHooks;null!==o&&N8(t,o,0,n)}Ee(n)}function cc(e,t=null,n=null,r){const a=lc(e,t,n,r);return a.resolveInjectorInitializers(),a}function lc(e,t=null,n=null,r,a=new Set){const o=[n||K2,rS(e)];return r=r||("object"==typeof e?void 0:r1(e)),new Ms(o,t||X8(),r||null,a)}let v4=(()=>{class e{static create(n,r){if(Array.isArray(n))return cc({name:""},r,n,"");{const a=n.name??"";return cc({name:a},n.parent,n.providers,a)}}}return e.THROW_IF_NOT_FOUND=st,e.NULL=new ps,e.\u0275prov=z({token:e,providedIn:"any",factory:()=>V2(hs)}),e.__NG_ELEMENT_ID__=-1,e})();function c2(e,t=Y.Default){const n=j();return null===n?V2(e,t):ko(F1(),n,e2(e),t)}function an(e,t){return e<<17|t<<2}function y4(e){return e>>17&32767}function Ha(e){return 2|e}function oe(e){return(131068&e)>>2}function Sa(e,t){return-131069&e|t<<2}function ba(e){return 1|e}function zc(e,t){const n=e.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const a=n[r],o=n[r+1];if(-1!==o){const s=e.data[o];yr(a),s.contentQueries(2,t[o],o)}}}function cn(e,t,n,r,a,o,s,l,f,p,y){const V=t.blueprint.slice();return V[0]=a,V[2]=76|r,(null!==y||e&&1024&e[2])&&(V[2]|=1024),Co(V),V[3]=V[15]=e,V[8]=n,V[10]=s||e&&e[10],V[11]=l||e&&e[11],V[12]=f||e&&e[12]||null,V[9]=p||e&&e[9]||null,V[6]=o,V[20]=function kS(){return NS++}(),V[21]=y,V[16]=2==t.type?e[16]:V,V}function c5(e,t,n,r,a){let o=e.data[t];if(null===o)o=function Ta(e,t,n,r,a){const o=po(),s=pr(),f=e.data[t]=function az(e,t,n,r,a,o){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:a,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,n,t,r,a);return null===e.firstChild&&(e.firstChild=f),null!==o&&(s?null==o.child&&null!==f.parent&&(o.child=f):null===o.next&&(o.next=f)),f}(e,t,n,r,a),function NV(){return H2.lFrame.inI18n}()&&(o.flags|=64);else if(64&o.type){o.type=n,o.value=r,o.attrs=a;const s=function X5(){const e=H2.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return N4(o,!0),o}function l5(e,t,n,r){if(0===n)return-1;const a=t.length;for(let o=0;o<n;o++)t.push(r),e.blueprint.push(r),e.data.push(null);return a}function ln(e,t,n){Mr(t);try{const r=e.viewQuery;null!==r&&ja(1,r,n);const a=e.template;null!==a&&wc(e,t,a,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&zc(e,t),e.staticViewQueries&&ja(2,e.viewQuery,n);const o=e.components;null!==o&&function ez(e,t){for(let n=0;n<t.length;n++)Mz(e,t[n])}(t,o)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,Lr()}}function Mt(e,t,n,r){const a=t[2];if(128!=(128&a)){Mr(t);try{Co(t),function mo(e){return H2.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&wc(e,t,n,2,r);const s=3==(3&a);if(s){const p=e.preOrderCheckHooks;null!==p&&E8(t,p,null)}else{const p=e.preOrderHooks;null!==p&&N8(t,p,0,null),Vr(t,0)}if(function vz(e){for(let t=la(e);null!==t;t=ua(t)){if(!t[2])continue;const n=t[9];for(let r=0;r<n.length;r++){const a=n[r],o=a[3];0==(512&a[2])&&dr(o,1),a[2]|=512}}}(t),function gz(e){for(let t=la(e);null!==t;t=ua(t))for(let n=10;n<t.length;n++){const r=t[n],a=r[1];w8(r)&&Mt(a,r,a.template,r[8])}}(t),null!==e.contentQueries&&zc(e,t),s){const p=e.contentCheckHooks;null!==p&&E8(t,p)}else{const p=e.contentHooks;null!==p&&N8(t,p,1),Vr(t,1)}!function Xb(e,t){const n=e.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const a=n[r];if(a<0)Ee(~a);else{const o=a,s=n[++r],l=n[++r];kV(s,o),l(2,t[o])}}}finally{Ee(-1)}}(e,t);const l=e.components;null!==l&&function Zb(e,t){for(let n=0;n<t.length;n++)yz(e,t[n])}(t,l);const f=e.viewQuery;if(null!==f&&ja(2,f,r),s){const p=e.viewCheckHooks;null!==p&&E8(t,p)}else{const p=e.viewHooks;null!==p&&N8(t,p,2),Vr(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),t[2]&=-41,512&t[2]&&(t[2]&=-513,dr(t[3],-1))}finally{Lr()}}}function tz(e,t,n,r){const a=t[10],s=uo(t);try{!s&&a.begin&&a.begin(),s&&ln(e,t,r),Mt(e,t,n,r)}finally{!s&&a.end&&a.end()}}function wc(e,t,n,r,a){const o=y3(),s=2&r;try{Ee(-1),s&&t.length>22&&ac(e,t,22,!1),n(r,a)}finally{Ee(o)}}function _c(e,t,n){if(cr(t)){const a=t.directiveEnd;for(let o=t.directiveStart;o<a;o++){const s=e.data[o];s.contentQueries&&s.contentQueries(1,n[o],o)}}}function Aa(e,t,n){!ho()||(function lz(e,t,n,r){const a=n.directiveStart,o=n.directiveEnd;e.firstCreatePass||nt(n,t),c3(r,t);const s=n.initialInputs;for(let l=a;l<o;l++){const f=e.data[l],p=m4(f);p&&dz(t,n,f);const y=rt(t,e,l,n);c3(y,t),null!==s&&pz(0,l-a,y,f,0,s),p&&(T3(n.index,t)[8]=y)}}(e,t,n,t4(n,t)),128==(128&n.flags)&&function uz(e,t,n){const r=n.directiveStart,a=n.directiveEnd,o=n.index,s=function TV(){return H2.lFrame.currentDirectiveIndex}();try{Ee(o);for(let l=r;l<a;l++){const f=e.data[l],p=t[l];gr(l),(null!==f.hostBindings||0!==f.hostVars||null!==f.hostAttrs)&&Ac(f,p)}}finally{Ee(-1),gr(s)}}(e,t,n))}function Pa(e,t,n=t4){const r=t.localNames;if(null!==r){let a=t.index+1;for(let o=0;o<r.length;o+=2){const s=r[o+1],l=-1===s?n(t,e):e[s];e[a++]=l}}}function xc(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Ia(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Ia(e,t,n,r,a,o,s,l,f,p){const y=22+r,V=y+a,b=function nz(e,t){const n=[];for(let r=0;r<t;r++)n.push(r<e?null:z2);return n}(y,V),w="function"==typeof p?p():p;return b[1]={type:e,blueprint:b,template:n,queries:null,viewQuery:l,declTNode:t,data:b.slice().fill(null,y),bindingStartIndex:y,expandoStartIndex:V,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:f,consts:w,incompleteFirstPass:!1}}function Dc(e,t,n,r){const a=Wc(t);null===n?a.push(r):(a.push(n),e.firstCreatePass&&jc(e).push(r,a.length-1))}function Ec(e,t,n){for(let r in e)if(e.hasOwnProperty(r)){const a=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,a):n[r]=[t,a]}return n}function Nc(e,t){const r=t.directiveEnd,a=e.data,o=t.attrs,s=[];let l=null,f=null;for(let p=t.directiveStart;p<r;p++){const y=a[p],V=y.inputs,b=null===o||tc(t)?null:mz(V,o);s.push(b),l=Ec(V,p,l),f=Ec(y.outputs,p,f)}null!==l&&(l.hasOwnProperty("class")&&(t.flags|=16),l.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=s,t.inputs=l,t.outputs=f}function F3(e,t,n,r,a,o,s,l){const f=t4(t,n);let y,p=t.inputs;!l&&null!=p&&(y=p[r])?(Ua(e,n,y,r,a),S8(t)&&kc(n,t.index)):3&t.type&&(r=function iz(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),a=null!=s?s(a,t.value||"",r):a,o.setProperty(f,r,a))}function kc(e,t){const n=T3(t,e);16&n[2]||(n[2]|=32)}function Fa(e,t,n,r){let a=!1;if(ho()){const o=function Cz(e,t,n){const r=e.directiveRegistry;let a=null;if(r)for(let o=0;o<r.length;o++){const s=r[o];nc(n,s.selectors,!1)&&(a||(a=[]),I8(nt(n,t),e,s.type),m4(s)?(Pc(e,n),a.unshift(s)):a.push(s))}return a}(e,t,n),s=null===r?null:{"":-1};if(null!==o){a=!0,Ic(n,e.data.length,o.length);for(let y=0;y<o.length;y++){const V=o[y];V.providersResolver&&V.providersResolver(V)}let l=!1,f=!1,p=l5(e,t,o.length,null);for(let y=0;y<o.length;y++){const V=o[y];n.mergedAttrs=T8(n.mergedAttrs,V.hostAttrs),Fc(e,n,t,p,V),hz(p,V,s),null!==V.contentQueries&&(n.flags|=8),(null!==V.hostBindings||null!==V.hostAttrs||0!==V.hostVars)&&(n.flags|=128);const b=V.type.prototype;!l&&(b.ngOnChanges||b.ngOnInit||b.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),l=!0),!f&&(b.ngOnChanges||b.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),f=!0),p++}Nc(e,n)}s&&function fz(e,t,n){if(t){const r=e.localNames=[];for(let a=0;a<t.length;a+=2){const o=n[t[a+1]];if(null==o)throw new q(-301,!1);r.push(t[a],o)}}}(n,r,s)}return n.mergedAttrs=T8(n.mergedAttrs,n.attrs),a}function Tc(e,t,n,r,a,o){const s=o.hostBindings;if(s){let l=e.hostBindingOpCodes;null===l&&(l=e.hostBindingOpCodes=[]);const f=~t.index;(function cz(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(l)!=f&&l.push(f),l.push(r,a,s)}}function Ac(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Pc(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function hz(e,t,n){if(n){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;m4(t)&&(n[""]=e)}}function Ic(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function Fc(e,t,n,r,a){e.data[r]=a;const o=a.factory||(a.factory=a6(a.type)),s=new et(o,m4(a),c2);e.blueprint[r]=s,n[r]=s,Tc(e,t,0,r,l5(e,n,a.hostVars,z2),a)}function dz(e,t,n){const r=t4(t,e),a=xc(n),o=e[10],s=un(e,cn(e,a,null,n.onPush?32:16,r,t,o,o.createRenderer(r,n),null,null,null));e[t.index]=s}function I4(e,t,n,r,a,o){const s=t4(e,t);!function Oa(e,t,n,r,a,o,s){if(null==o)e.removeAttribute(t,a,n);else{const l=null==s?p2(o):s(o,r||"",a);e.setAttribute(t,a,l,n)}}(t[11],s,o,e.value,n,r,a)}function pz(e,t,n,r,a,o){const s=o[t];if(null!==s){const l=r.setInput;for(let f=0;f<s.length;){const p=s[f++],y=s[f++],V=s[f++];null!==l?r.setInput(n,V,p,y):n[y]=V}}}function mz(e,t){let n=null,r=0;for(;r<t.length;){const a=t[r];if(0!==a)if(5!==a){if("number"==typeof a)break;e.hasOwnProperty(a)&&(null===n&&(n=[]),n.push(a,e[a],t[r+1])),r+=2}else r+=2;else r+=4}return n}function Oc(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function yz(e,t){const n=T3(t,e);if(w8(n)){const r=n[1];48&n[2]?Mt(r,n,r.template,n[8]):n[5]>0&&Ra(n)}}function Ra(e){for(let r=la(e);null!==r;r=ua(r))for(let a=10;a<r.length;a++){const o=r[a];if(w8(o))if(512&o[2]){const s=o[1];Mt(s,o,s.template,o[8])}else o[5]>0&&Ra(o)}const n=e[1].components;if(null!==n)for(let r=0;r<n.length;r++){const a=T3(n[r],e);w8(a)&&a[5]>0&&Ra(a)}}function Mz(e,t){const n=T3(t,e),r=n[1];(function Lz(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(r,n),ln(r,n,n[8])}function un(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function Ba(e){for(;e;){e[2]|=32;const t=vt(e);if(hV(e)&&!t)return e;e=t}return null}function Bc(e){!function Rc(e){for(let t=0;t<e.components.length;t++){const n=e.components[t],r=oa(n);if(null!==r){const a=r[1];tz(a,r,a.template,n)}}}(e[8])}function ja(e,t,n){yr(0),t(e,n)}const Hz=(()=>Promise.resolve(null))();function Wc(e){return e[7]||(e[7]=[])}function jc(e){return e.cleanup||(e.cleanup=[])}function Gc(e,t){const n=e[9],r=n?n.get(a5,null):null;r&&r.handleError(t)}function Ua(e,t,n,r,a){for(let o=0;o<n.length;){const s=n[o++],l=n[o++],f=t[s],p=e.data[s];null!==p.setInput?p.setInput(f,a,r,l):f[l]=a}}function Cn(e,t,n){let r=n?e.styles:null,a=n?e.classes:null,o=0;if(null!==t)for(let s=0;s<t.length;s++){const l=t[s];"number"==typeof l?o=l:1==o?a=J4(a,l):2==o&&(r=J4(r,l+": "+t[++s]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=a:e.classesWithoutHost=a}function fn(e,t,n,r,a=!1){for(;null!==n;){const o=t[n.index];if(null!==o&&r.push(E1(o)),p4(o))for(let l=10;l<o.length;l++){const f=o[l],p=f[1].firstChild;null!==p&&fn(f[1],f,p,r)}const s=n.type;if(8&s)fn(e,t,n.child,r);else if(32&s){const l=ca(n,t);let f;for(;f=l();)r.push(f)}else if(16&s){const l=Qs(t,n);if(Array.isArray(l))r.push(...l);else{const f=vt(t[16]);fn(f[1],f,l,r,!0)}}n=a?n.projectionNext:n.next}return r}class Lt{constructor(t,n){this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,n=t[1];return fn(n,t,n.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(p4(t)){const n=t[8],r=n?n.indexOf(this):-1;r>-1&&(ha(t,r),R8(n,r))}this._attachedToViewContainer=!1}Rs(this._lView[1],this._lView)}onDestroy(t){Dc(this._lView[1],this._lView,null,t)}markForCheck(){Ba(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){!function Wa(e,t,n){const r=t[10];r.begin&&r.begin();try{Mt(e,t,e.template,n)}catch(a){throw Gc(t,a),a}finally{r.end&&r.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new q(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function tb(e,t){yt(e,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new q(902,!1);this._appRef=t}}class Sz extends Lt{constructor(t){super(t),this._view=t}detectChanges(){Bc(this._view)}checkNoChanges(){}get context(){return null}}class Ga extends pt{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const n=Y2(t);return new Vt(n,this.ngModule)}}function qc(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}class zz{constructor(t,n){this.injector=t,this.parentInjector=n}get(t,n,r){const a=this.injector.get(t,Jr,r);return a!==Jr||n===Jr?a:this.parentInjector.get(t,n,r)}}class Vt extends Vs{constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=function Lb(e){return e.map(Mb).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return qc(this.componentDef.inputs)}get outputs(){return qc(this.componentDef.outputs)}create(t,n,r,a){let o=(a=a||this.ngModule)instanceof t5?a:a?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const s=o?new zz(t,o):t,l=s.get(mt,null);if(null===l)throw new q(407,!1);const f=s.get(yS,null),p=l.createRenderer(null,this.componentDef),y=this.componentDef.selectors[0][0]||"div",V=r?function rz(e,t,n){return e.selectRootElement(t,n===r3.ShadowDom)}(p,r,this.componentDef.encapsulation):fa(l.createRenderer(null,this.componentDef),y,function bz(e){const t=e.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(y)),b=this.componentDef.onPush?288:272,w=function Ez(e,t){return{components:[],scheduler:e||jS,clean:Hz,playerHandler:t||null,flags:0}}(),x=Ia(0,null,null,1,0,null,null,null,null,null),D=cn(null,x,w,b,null,null,l,p,f,s,null);let T,F;Mr(D);try{const U=function xz(e,t,n,r,a,o){const s=n[1];n[22]=e;const f=c5(s,22,2,"#host",null),p=f.mergedAttrs=t.hostAttrs;null!==p&&(Cn(f,p,!0),null!==e&&(k8(a,e,p),null!==f.classes&&va(a,e,f.classes),null!==f.styles&&Xs(a,e,f.styles)));const y=r.createRenderer(e,t),V=cn(n,xc(t),null,t.onPush?32:16,n[22],f,r,y,o||null,null,null);return s.firstCreatePass&&(I8(nt(f,n),s,t.type),Pc(s,f),Ic(f,n.length,1)),un(n,V),n[22]=V}(V,this.componentDef,D,l,p);if(V)if(r)k8(p,V,["ng-version",MS.full]);else{const{attrs:k,classes:G}=function Vb(e){const t=[],n=[];let r=1,a=2;for(;r<e.length;){let o=e[r];if("string"==typeof o)2===a?""!==o&&t.push(o,e[++r]):8===a&&n.push(o);else{if(!g4(a))break;a=o}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]);k&&k8(p,V,k),G&&G.length>0&&va(p,V,G.join(" "))}if(F=hr(x,22),void 0!==n){const k=F.projection=[];for(let G=0;G<this.ngContentSelectors.length;G++){const l2=n[G];k.push(null!=l2?Array.from(l2):null)}}T=function Dz(e,t,n,r,a){const o=n[1],s=function sz(e,t,n){const r=F1();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Fc(e,r,t,l5(e,t,1,null),n),Nc(e,r));const a=rt(t,e,r.directiveStart,r);c3(a,t);const o=t4(r,t);return o&&c3(o,t),a}(o,n,t);if(r.components.push(s),e[8]=s,null!==a)for(const f of a)f(s,t);if(t.contentQueries){const f=F1();t.contentQueries(1,s,f.directiveStart)}const l=F1();return!o.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Ee(l.index),Tc(n[1],l,0,l.directiveStart,l.directiveEnd,t),Ac(t,s)),s}(U,this.componentDef,D,w,[Nz]),ln(x,D,null)}finally{Lr()}return new _z(this.componentType,T,r5(F,D),D,F)}}class _z extends class hS{}{constructor(t,n,r,a,o){super(),this.location=r,this._rootLView=a,this._tNode=o,this.instance=n,this.hostView=this.changeDetectorRef=new Sz(a),this.componentType=t}setInput(t,n){const r=this._tNode.inputs;let a;if(null!==r&&(a=r[t])){const o=this._rootLView;Ua(o[1],o,a,t,n),kc(o,this._tNode.index)}}get injector(){return new q6(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function Nz(){const e=F1();D8(j()[1],e)}function Ht(e){let t=function $c(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0;const r=[e];for(;t;){let a;if(m4(e))a=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new q(903,!1);a=t.\u0275dir}if(a){if(n){r.push(a);const s=e;s.inputs=qa(e.inputs),s.declaredInputs=qa(e.declaredInputs),s.outputs=qa(e.outputs);const l=a.hostBindings;l&&Pz(e,l);const f=a.viewQuery,p=a.contentQueries;if(f&&Tz(e,f),p&&Az(e,p),k6(e.inputs,a.inputs),k6(e.declaredInputs,a.declaredInputs),k6(e.outputs,a.outputs),m4(a)&&a.data.animation){const y=e.data;y.animation=(y.animation||[]).concat(a.data.animation)}}const o=a.features;if(o)for(let s=0;s<o.length;s++){const l=o[s];l&&l.ngInherit&&l(e),l===Ht&&(n=!1)}}t=Object.getPrototypeOf(t)}!function kz(e){let t=0,n=null;for(let r=e.length-1;r>=0;r--){const a=e[r];a.hostVars=t+=a.hostVars,a.hostAttrs=T8(a.hostAttrs,n=T8(n,a.hostAttrs))}}(r)}function qa(e){return e===Z4?{}:e===K2?[]:e}function Tz(e,t){const n=e.viewQuery;e.viewQuery=n?(r,a)=>{t(r,a),n(r,a)}:t}function Az(e,t){const n=e.contentQueries;e.contentQueries=n?(r,a,o)=>{t(r,a,o),n(r,a,o)}:t}function Pz(e,t){const n=e.hostBindings;e.hostBindings=n?(r,a)=>{t(r,a),n(r,a)}:t}let hn=null;function c6(){if(!hn){const e=B2.Symbol;if(e&&e.iterator)hn=e.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<t.length;++n){const r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(hn=r)}}}return hn}function St(e){return!!$a(e)&&(Array.isArray(e)||!(e instanceof Map)&&c6()in e)}function $a(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function F4(e,t,n){return e[t]=n}function l3(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function l6(e,t,n,r){const a=l3(e,t,n);return l3(e,t+1,r)||a}function Ka(e,t,n,r){const a=j();return l3(a,j6(),t)&&(q2(),I4(S1(),a,e,t,n,r)),Ka}function C5(e,t,n,r){return l3(e,j6(),n)?t+p2(n)+r:z2}function T2(e,t,n,r,a,o,s,l){const f=j(),p=q2(),y=e+22,V=p.firstCreatePass?function Gz(e,t,n,r,a,o,s,l,f){const p=t.consts,y=c5(t,e,4,s||null,_e(p,l));Fa(t,n,y,_e(p,f)),D8(t,y);const V=y.tViews=Ia(2,y,r,a,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,p);return null!==t.queries&&(t.queries.template(t,y),V.queries=t.queries.embeddedTView(y)),y}(y,p,f,t,n,r,a,o,s):p.data[y];N4(V,!1);const b=f[11].createComment("");tn(p,f,b,V),c3(b,f),un(f,f[y]=Oc(b,f,b,V)),b8(V)&&Aa(p,f,V),null!=s&&Pa(f,V,l)}function Qa(e){return function W6(e,t){return e[t]}(function EV(){return H2.lFrame.contextLView}(),22+e)}function X(e,t,n){const r=j();return l3(r,j6(),t)&&F3(q2(),S1(),r,e,t,r[11],n,!1),X}function Ya(e,t,n,r,a){const s=a?"class":"style";Ua(e,n,t.inputs[s],s,r)}function t2(e,t,n,r){const a=j(),o=q2(),s=22+e,l=a[11],f=a[s]=fa(l,t,function RV(){return H2.lFrame.currentNamespace}()),p=o.firstCreatePass?function $z(e,t,n,r,a,o,s){const l=t.consts,p=c5(t,e,2,a,_e(l,o));return Fa(t,n,p,_e(l,s)),null!==p.attrs&&Cn(p,p.attrs,!1),null!==p.mergedAttrs&&Cn(p,p.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,p),p}(s,o,a,0,t,n,r):o.data[s];N4(p,!0);const y=p.mergedAttrs;null!==y&&k8(l,f,y);const V=p.classes;null!==V&&va(l,f,V);const b=p.styles;return null!==b&&Xs(l,f,b),64!=(64&p.flags)&&tn(o,a,f,p),0===function zV(){return H2.lFrame.elementDepthCount}()&&c3(f,a),function wV(){H2.lFrame.elementDepthCount++}(),b8(p)&&(Aa(o,a,p),_c(o,p,a)),null!==r&&Pa(a,p),t2}function s2(){let e=F1();pr()?mr():(e=e.parent,N4(e,!1));const t=e;!function _V(){H2.lFrame.elementDepthCount--}();const n=q2();return n.firstCreatePass&&(D8(n,e),cr(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function GV(e){return 0!=(16&e.flags)}(t)&&Ya(n,t,j(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function qV(e){return 0!=(32&e.flags)}(t)&&Ya(n,t,j(),t.stylesWithoutHost,!1),s2}function M1(e,t,n,r){return t2(e,t,n,r),s2(),M1}function O3(e,t,n){const r=j(),a=q2(),o=e+22,s=a.firstCreatePass?function Kz(e,t,n,r,a){const o=t.consts,s=_e(o,r),l=c5(t,e,8,"ng-container",s);return null!==s&&Cn(l,s,!0),Fa(t,n,l,_e(o,a)),null!==t.queries&&t.queries.elementStart(t,l),l}(o,a,r,t,n):a.data[o];N4(s,!0);const l=r[o]=r[11].createComment("");return tn(a,r,l,s),c3(l,r),b8(s)&&(Aa(a,r,s),_c(a,s,r)),null!=n&&Pa(r,s),O3}function R3(){let e=F1();const t=q2();return pr()?mr():(e=e.parent,N4(e,!1)),t.firstCreatePass&&(D8(t,e),cr(e)&&t.queries.elementEnd(e)),R3}function pn(e,t,n){return O3(e,t,n),R3(),pn}function u6(){return j()}function Ja(e){return!!e&&"function"==typeof e.then}const Qz=function rl(e){return!!e&&"function"==typeof e.subscribe};function R1(e,t,n,r){const a=j(),o=q2(),s=F1();return function il(e,t,n,r,a,o,s,l){const f=b8(r),y=e.firstCreatePass&&jc(e),V=t[8],b=Wc(t);let w=!0;if(3&r.type||l){const T=t4(r,t),F=l?l(T):T,U=b.length,k=l?l2=>l(E1(l2[r.index])):r.index;let G=null;if(!l&&f&&(G=function Yz(e,t,n,r){const a=e.cleanup;if(null!=a)for(let o=0;o<a.length-1;o+=2){const s=a[o];if(s===n&&a[o+1]===r){const l=t[7],f=a[o+2];return l.length>f?l[f]:null}"string"==typeof s&&(o+=2)}return null}(e,t,a,r.index)),null!==G)(G.__ngLastListenerFn__||G).__ngNextListenerFn__=o,G.__ngLastListenerFn__=o,w=!1;else{o=sl(r,t,V,o,!1);const l2=n.listen(F,a,o);b.push(o,l2),y&&y.push(a,k,U,U+1)}}else o=sl(r,t,V,o,!1);const x=r.outputs;let D;if(w&&null!==x&&(D=x[a])){const T=D.length;if(T)for(let F=0;F<T;F+=2){const S2=t[D[F]][D[F+1]].subscribe(o),i1=b.length;b.push(o,S2),y&&y.push(a,r.index,i1,-(i1+1))}}}(o,a,a[11],s,e,t,0,r),R1}function ol(e,t,n,r){try{return!1!==n(r)}catch(a){return Gc(e,a),!1}}function sl(e,t,n,r,a){return function o(s){if(s===Function)return r;Ba(2&e.flags?T3(e.index,t):t);let f=ol(t,0,r,s),p=o.__ngNextListenerFn__;for(;p;)f=ol(t,0,p,s)&&f,p=p.__ngNextListenerFn__;return a&&!1===f&&(s.preventDefault(),s.returnValue=!1),f}}function W2(e=1){return function PV(e){return(H2.lFrame.contextLView=function IV(e,t){for(;e>0;)t=t[15],e--;return t}(e,H2.lFrame.contextLView))[8]}(e)}function Jz(e,t){let n=null;const r=function mb(e){const t=e.attrs;if(null!=t){const n=t.indexOf(5);if(0==(1&n))return t[n+1]}return null}(e);for(let a=0;a<t.length;a++){const o=t[a];if("*"!==o){if(null===r?nc(e,o,!0):yb(r,o))return a}else n=a}return n}function Xa(e){const t=j()[16][6];if(!t.projection){const r=t.projection=ot(e?e.length:1,null),a=r.slice();let o=t.child;for(;null!==o;){const s=e?Jz(o,e):0;null!==s&&(a[s]?a[s].projectionNext=o:r[s]=o,a[s]=o),o=o.next}}}function mn(e,t=0,n){const r=j(),a=q2(),o=c5(a,22+e,16,null,n||null);null===o.projection&&(o.projection=t),mr(),64!=(64&o.flags)&&function lb(e,t,n){Js(t[11],0,t,n,Bs(e,n,t),Gs(n.parent||t[6],n,t))}(a,r,o)}function gl(e,t,n,r,a){const o=e[n+1],s=null===t;let l=r?y4(o):oe(o),f=!1;for(;0!==l&&(!1===f||s);){const y=e[l+1];ew(e[l],t)&&(f=!0,e[l+1]=r?ba(y):Ha(y)),l=r?y4(y):oe(y)}f&&(e[n+1]=r?Ha(o):ba(o))}function ew(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&J6(e,t)>=0}const B1={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function vl(e){return e.substring(B1.key,B1.keyEnd)}function yl(e,t){const n=B1.textEnd;return n===t?-1:(t=B1.keyEnd=function aw(e,t,n){for(;t<n&&e.charCodeAt(t)>32;)t++;return t}(e,B1.key=t,n),y5(e,t,n))}function y5(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function M5(e,t){return function M4(e,t,n,r){const a=j(),o=q2(),s=re(2);o.firstUpdatePass&&zl(o,e,s,r),t!==z2&&l3(a,s,t)&&_l(o,o.data[y3()],a,a[11],e,a[s+1]=function pw(e,t){return null==e||("string"==typeof t?e+=t:"object"==typeof e&&(e=r1(I3(e)))),e}(t,n),r,s)}(e,t,null,!0),M5}function R4(e,t){for(let n=function nw(e){return function Ll(e){B1.key=0,B1.keyEnd=0,B1.value=0,B1.valueEnd=0,B1.textEnd=e.length}(e),yl(e,y5(e,0,B1.textEnd))}(t);n>=0;n=yl(t,n))P3(e,vl(t),!0)}function bl(e,t){return t>=e.expandoStartIndex}function zl(e,t,n,r){const a=e.data;if(null===a[n+1]){const o=a[y3()],s=bl(e,n);Dl(o,r)&&null===t&&!s&&(t=!1),t=function lw(e,t,n,r){const a=function vr(e){const t=H2.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let o=r?t.residualClasses:t.residualStyles;if(null===a)0===(r?t.classBindings:t.styleBindings)&&(n=zt(n=ei(null,e,t,n,r),t.attrs,r),o=null);else{const s=t.directiveStylingLast;if(-1===s||e[s]!==a)if(n=ei(a,e,t,n,r),null===o){let f=function uw(e,t,n){const r=n?t.classBindings:t.styleBindings;if(0!==oe(r))return e[y4(r)]}(e,t,r);void 0!==f&&Array.isArray(f)&&(f=ei(null,e,t,f[1],r),f=zt(f,t.attrs,r),function Cw(e,t,n,r){e[y4(n?t.classBindings:t.styleBindings)]=r}(e,t,r,f))}else o=function fw(e,t,n){let r;const a=t.directiveEnd;for(let o=1+t.directiveStylingLast;o<a;o++)r=zt(r,e[o].hostAttrs,n);return zt(r,t.attrs,n)}(e,t,r)}return void 0!==o&&(r?t.residualClasses=o:t.residualStyles=o),n}(a,o,t,r),function Xz(e,t,n,r,a,o){let s=o?t.classBindings:t.styleBindings,l=y4(s),f=oe(s);e[r]=n;let y,p=!1;if(Array.isArray(n)){const V=n;y=V[1],(null===y||J6(V,y)>0)&&(p=!0)}else y=n;if(a)if(0!==f){const b=y4(e[l+1]);e[r+1]=an(b,l),0!==b&&(e[b+1]=Sa(e[b+1],r)),e[l+1]=function Wb(e,t){return 131071&e|t<<17}(e[l+1],r)}else e[r+1]=an(l,0),0!==l&&(e[l+1]=Sa(e[l+1],r)),l=r;else e[r+1]=an(f,0),0===l?l=r:e[f+1]=Sa(e[f+1],r),f=r;p&&(e[r+1]=Ha(e[r+1])),gl(e,y,r,!0),gl(e,y,r,!1),function Zz(e,t,n,r,a){const o=a?e.residualClasses:e.residualStyles;null!=o&&"string"==typeof t&&J6(o,t)>=0&&(n[r+1]=ba(n[r+1]))}(t,y,e,r,o),s=an(l,f),o?t.classBindings=s:t.styleBindings=s}(a,o,t,n,s,r)}}function ei(e,t,n,r,a){let o=null;const s=n.directiveEnd;let l=n.directiveStylingLast;for(-1===l?l=n.directiveStart:l++;l<s&&(o=t[l],r=zt(r,o.hostAttrs,a),o!==e);)l++;return null!==e&&(n.directiveStylingLast=l),r}function zt(e,t,n){const r=n?1:2;let a=-1;if(null!==t)for(let o=0;o<t.length;o++){const s=t[o];"number"==typeof s?a=s:a===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),P3(e,s,!!n||t[++o]))}return void 0===e?null:e}function _l(e,t,n,r,a,o,s,l){if(!(3&t.type))return;const f=e.data,p=f[l+1];gn(function vc(e){return 1==(1&e)}(p)?xl(f,t,n,a,oe(p),s):void 0)||(gn(o)||function gc(e){return 2==(2&e)}(p)&&(o=xl(f,null,n,a,l,s)),function Cb(e,t,n,r,a){if(t)a?e.addClass(n,r):e.removeClass(n,r);else{let o=-1===r.indexOf("-")?void 0:x3.DashCase;null==a?e.removeStyle(n,r,o):("string"==typeof a&&a.endsWith("!important")&&(a=a.slice(0,-10),o|=x3.Important),e.setStyle(n,r,a,o))}}(r,s,z8(y3(),n),a,o))}function xl(e,t,n,r,a,o){const s=null===t;let l;for(;a>0;){const f=e[a],p=Array.isArray(f),y=p?f[1]:f,V=null===y;let b=n[a+1];b===z2&&(b=V?K2:void 0);let w=V?Er(b,r):y===r?b:void 0;if(p&&!gn(w)&&(w=Er(f,r)),gn(w)&&(l=w,s))return l;const x=e[a+1];a=s?y4(x):oe(x)}if(null!==t){let f=o?t.residualClasses:t.residualStyles;null!=f&&(l=Er(f,r))}return l}function gn(e){return void 0!==e}function Dl(e,t){return 0!=(e.flags&(t?16:32))}function x2(e,t=""){const n=j(),r=q2(),a=e+22,o=r.firstCreatePass?c5(r,a,1,t,null):r.data[a],s=n[a]=function Ca(e,t){return e.createText(t)}(n[11],t);tn(r,n,s,o),N4(o,!1)}function Ae(e){return ce("",e,""),Ae}function ce(e,t,n){const r=j(),a=C5(r,e,t,n);return a!==z2&&function se(e,t,n){const r=z8(t,e);!function Fs(e,t,n){e.setValue(t,n)}(e[11],r,n)}(r,y3(),a),ce}function L5(e,t,n){!function L4(e,t,n,r){const a=q2(),o=re(2);a.firstUpdatePass&&zl(a,null,o,r);const s=j();if(n!==z2&&l3(s,o,n)){const l=a.data[y3()];if(Dl(l,r)&&!bl(a,o)){let f=r?l.classesWithoutHost:l.stylesWithoutHost;null!==f&&(n=J4(f,n||"")),Ya(a,l,s,n,r)}else!function dw(e,t,n,r,a,o,s,l){a===z2&&(a=K2);let f=0,p=0,y=0<a.length?a[0]:null,V=0<o.length?o[0]:null;for(;null!==y||null!==V;){const b=f<a.length?a[f+1]:void 0,w=p<o.length?o[p+1]:void 0;let D,x=null;y===V?(f+=2,p+=2,b!==w&&(x=V,D=w)):null===V||null!==y&&y<V?(f+=2,x=y):(p+=2,x=V,D=w),null!==x&&_l(e,t,n,r,x,D,s,l),y=f<a.length?a[f]:null,V=p<o.length?o[p]:null}}(a,l,s,s[11],s[o+1],s[o+1]=function hw(e,t,n){if(null==n||""===n)return K2;const r=[],a=I3(n);if(Array.isArray(a))for(let o=0;o<a.length;o++)e(r,a[o],!0);else if("object"==typeof a)for(const o in a)a.hasOwnProperty(o)&&e(r,o,a[o]);else"string"==typeof a&&t(r,a);return r}(e,t,n),r,o)}}(P3,R4,C5(j(),e,t,n),!0)}function ti(e,t,n){const r=j();return l3(r,j6(),t)&&F3(q2(),S1(),r,e,t,r[11],n,!0),ti}const H5="en-US";let Jl=H5;class b5{}class Hu extends b5{constructor(t,n){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Ga(this);const r=function i3(e,t){const n=e[Ze]||null;if(!n&&!0===t)throw new Error(`Type ${r1(e)} does not have '\u0275mod' property.`);return n}(t);this._bootstrapComponents=function ie(e){return e instanceof Function?e():e}(r.bootstrap),this._r3Injector=lc(t,n,[{provide:b5,useValue:this},{provide:pt,useValue:this.componentFactoryResolver}],r1(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class ci extends class T_{}{constructor(t){super(),this.moduleType=t}create(t){return new Hu(this.moduleType,t)}}function B3(e,t,n,r){return function Au(e,t,n,r,a,o){const s=t+n;return l3(e,s,a)?F4(e,s+1,o?r.call(o,a):r(a)):Et(e,s+1)}(j(),v3(),e,t,n,r)}function Nu(e,t,n,r,a){return function Pu(e,t,n,r,a,o,s){const l=t+n;return l6(e,l,a,o)?F4(e,l+2,s?r.call(s,a,o):r(a,o)):Et(e,l+2)}(j(),v3(),e,t,n,r,a)}function ku(e,t,n,r,a,o){return function Iu(e,t,n,r,a,o,s,l){const f=t+n;return function dn(e,t,n,r,a){const o=l6(e,t,n,r);return l3(e,t+2,a)||o}(e,f,a,o,s)?F4(e,f+3,l?r.call(l,a,o,s):r(a,o,s)):Et(e,f+3)}(j(),v3(),e,t,n,r,a,o)}function Tu(e,t,n,r,a,o,s){return function Fu(e,t,n,r,a,o,s,l,f){const p=t+n;return function n4(e,t,n,r,a,o){const s=l6(e,t,n,r);return l6(e,t+2,a,o)||s}(e,p,a,o,s,l)?F4(e,p+4,f?r.call(f,a,o,s,l):r(a,o,s,l)):Et(e,p+4)}(j(),v3(),e,t,n,r,a,o,s)}function Et(e,t){const n=e[t];return n===z2?void 0:n}function ui(e){return t=>{setTimeout(e,void 0,t)}}const W3=class ix extends e1{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,n,r){let a=t,o=n||(()=>null),s=r;if(t&&"object"==typeof t){const f=t;a=f.next?.bind(f),o=f.error?.bind(f),s=f.complete?.bind(f)}this.__isAsync&&(o=ui(o),a&&(a=ui(a)),s&&(s=ui(s)));const l=super.subscribe({next:a,error:o,complete:s});return t instanceof Q&&t.add(l),l}};function ox(){return this._results[c6()]()}class Ci{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=c6(),r=Ci.prototype;r[n]||(r[n]=ox)}get changes(){return this._changes||(this._changes=new W3)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,n){return this._results.reduce(t,n)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,n){const r=this;r.dirty=!1;const a=A3(t);(this._changesDetected=!function nH(e,t,n){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){let a=e[r],o=t[r];if(n&&(a=n(a),o=n(o)),o!==a)return!1}return!0}(r._results,a,n))&&(r._results=a,r.length=a.length,r.last=a[this.length-1],r.first=a[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let r4=(()=>{class e{}return e.__NG_ELEMENT_ID__=lx,e})();const sx=r4,cx=class extends sx{constructor(t,n,r){super(),this._declarationLView=t,this._declarationTContainer=n,this.elementRef=r}createEmbeddedView(t,n){const r=this._declarationTContainer.tViews,a=cn(this._declarationLView,r,t,16,null,r.declTNode,null,null,null,null,n||null);a[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(a[19]=s.createEmbeddedView(r)),ln(r,a,t),new Lt(a)}};function lx(){return Vn(F1(),j())}function Vn(e,t){return 4&e.type?new cx(t,e,r5(e,t)):null}let B4=(()=>{class e{}return e.__NG_ELEMENT_ID__=ux,e})();function ux(){return Wu(F1(),j())}const Cx=B4,Ru=class extends Cx{constructor(t,n,r){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=r}get element(){return r5(this._hostTNode,this._hostLView)}get injector(){return new q6(this._hostTNode,this._hostLView)}get parentInjector(){const t=P8(this._hostTNode,this._hostLView);if(_o(t)){const n=G6(t,this._hostLView),r=U6(t);return new q6(n[1].data[r+8],n)}return new q6(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const n=Bu(this._lContainer);return null!==n&&n[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,n,r){let a,o;"number"==typeof r?a=r:null!=r&&(a=r.index,o=r.injector);const s=t.createEmbeddedView(n||{},o);return this.insert(s,a),s}createComponent(t,n,r,a,o){const s=t&&!function it(e){return"function"==typeof e}(t);let l;if(s)l=n;else{const V=n||{};l=V.index,r=V.injector,a=V.projectableNodes,o=V.environmentInjector||V.ngModuleRef}const f=s?t:new Vt(Y2(t)),p=r||this.parentInjector;if(!o&&null==f.ngModule){const b=(s?p:this.parentInjector).get(t5,null);b&&(o=b)}const y=f.create(p,a,void 0,o);return this.insert(y.hostView,l),y}insert(t,n){const r=t._lView,a=r[1];if(function bV(e){return p4(e[3])}(r)){const y=this.indexOf(t);if(-1!==y)this.detach(y);else{const V=r[3],b=new Ru(V,V[6],V[3]);b.detach(b.indexOf(t))}}const o=this._adjustIndex(n),s=this._lContainer;!function rb(e,t,n,r){const a=10+r,o=n.length;r>0&&(n[a-1][4]=t),r<o-10?(t[4]=n[a],Oo(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;const s=t[17];null!==s&&n!==s&&function ab(e,t){const n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(s,t);const l=t[19];null!==l&&l.insertView(e),t[2]|=64}(a,r,s,o);const l=ma(o,s),f=r[11],p=en(f,s[7]);return null!==p&&function eb(e,t,n,r,a,o){r[0]=a,r[6]=t,yt(e,r,n,1,a,o)}(a,s[6],f,r,p,l),t.attachToViewContainerRef(),Oo(fi(s),o,t),t}move(t,n){return this.insert(t,n)}indexOf(t){const n=Bu(this._lContainer);return null!==n?n.indexOf(t):-1}remove(t){const n=this._adjustIndex(t,-1),r=ha(this._lContainer,n);r&&(R8(fi(this._lContainer),n),Rs(r[1],r))}detach(t){const n=this._adjustIndex(t,-1),r=ha(this._lContainer,n);return r&&null!=R8(fi(this._lContainer),n)?new Lt(r):null}_adjustIndex(t,n=0){return t??this.length+n}};function Bu(e){return e[8]}function fi(e){return e[8]||(e[8]=[])}function Wu(e,t){let n;const r=t[e.index];if(p4(r))n=r;else{let a;if(8&e.type)a=E1(r);else{const o=t[11];a=o.createComment("");const s=t4(e,t);s6(o,en(o,s),a,function cb(e,t){return e.nextSibling(t)}(o,s),!1)}t[e.index]=n=Oc(r,t,a,e),un(t,n)}return new Ru(n,e,t)}class hi{constructor(t){this.queryList=t,this.matches=null}clone(){return new hi(this.queryList)}setDirty(){this.queryList.setDirty()}}class di{constructor(t=[]){this.queries=t}createEmbeddedView(t){const n=t.queries;if(null!==n){const r=null!==t.contentQueries?t.contentQueries[0]:n.length,a=[];for(let o=0;o<r;o++){const s=n.getByIndex(o);a.push(this.queries[s.indexInDeclarationView].clone())}return new di(a)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let n=0;n<this.queries.length;n++)null!==$u(t,n).matches&&this.queries[n].setDirty()}}class ju{constructor(t,n,r=null){this.predicate=t,this.flags=n,this.read=r}}class pi{constructor(t=[]){this.queries=t}elementStart(t,n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,n)}elementEnd(t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(t)}embeddedTView(t){let n=null;for(let r=0;r<this.length;r++){const a=null!==n?n.length:0,o=this.getByIndex(r).embeddedTView(t,a);o&&(o.indexInDeclarationView=r,null!==n?n.push(o):n=[o])}return null!==n?new pi(n):null}template(t,n){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,n)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class mi{constructor(t,n=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(t,n){this.isApplyingToNode(n)&&this.matchTNode(t,n)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,n){this.elementStart(t,n)}embeddedTView(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new mi(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==n;)r=r.parent;return n===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,n){const r=this.metadata.predicate;if(Array.isArray(r))for(let a=0;a<r.length;a++){const o=r[a];this.matchTNodeWithReadOption(t,n,dx(n,o)),this.matchTNodeWithReadOption(t,n,F8(n,t,o,!1,!1))}else r===r4?4&n.type&&this.matchTNodeWithReadOption(t,n,-1):this.matchTNodeWithReadOption(t,n,F8(n,t,r,!1,!1))}matchTNodeWithReadOption(t,n,r){if(null!==r){const a=this.metadata.read;if(null!==a)if(a===P4||a===B4||a===r4&&4&n.type)this.addMatch(n.index,-2);else{const o=F8(n,t,a,!1,!1);null!==o&&this.addMatch(n.index,o)}else this.addMatch(n.index,r)}}addMatch(t,n){null===this.matches?this.matches=[t,n]:this.matches.push(t,n)}}function dx(e,t){const n=e.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function mx(e,t,n,r){return-1===n?function px(e,t){return 11&e.type?r5(e,t):4&e.type?Vn(e,t):null}(t,e):-2===n?function gx(e,t,n){return n===P4?r5(t,e):n===r4?Vn(t,e):n===B4?Wu(t,e):void 0}(e,t,r):rt(e,e[1],n,t)}function Uu(e,t,n,r){const a=t[19].queries[r];if(null===a.matches){const o=e.data,s=n.matches,l=[];for(let f=0;f<s.length;f+=2){const p=s[f];l.push(p<0?null:mx(t,o[p],s[f+1],n.metadata.read))}a.matches=l}return a.matches}function gi(e,t,n,r){const a=e.queries.getByIndex(n),o=a.matches;if(null!==o){const s=Uu(e,t,a,n);for(let l=0;l<o.length;l+=2){const f=o[l];if(f>0)r.push(s[l/2]);else{const p=o[l+1],y=t[-f];for(let V=10;V<y.length;V++){const b=y[V];b[17]===b[3]&&gi(b[1],b,p,r)}if(null!==y[9]){const V=y[9];for(let b=0;b<V.length;b++){const w=V[b];gi(w[1],w,p,r)}}}}}return r}function Hn(e){const t=j(),n=q2(),r=vo();yr(r+1);const a=$u(n,r);if(e.dirty&&uo(t)===(2==(2&a.metadata.flags))){if(null===a.matches)e.reset([]);else{const o=a.crossesNgTemplate?gi(n,t,r,[]):Uu(n,t,a,r);e.reset(o,gS),e.notifyOnChanges()}return!0}return!1}function Sn(e,t,n){const r=q2();r.firstCreatePass&&(function qu(e,t,n){null===e.queries&&(e.queries=new pi),e.queries.track(new mi(t,n))}(r,new ju(e,t,n),-1),2==(2&t)&&(r.staticViewQueries=!0)),function Gu(e,t,n){const r=new Ci(4==(4&n));Dc(e,t,r,r.destroy),null===t[19]&&(t[19]=new di),t[19].queries.push(new hi(r))}(r,j(),t)}function bn(){return function yx(e,t){return e[19].queries[t].queryList}(j(),vo())}function $u(e,t){return e.queries.getByIndex(t)}function Ku(e,t){return Vn(e,t)}function wn(...e){}const hC=new N2("Application Initializer");let _n=(()=>{class e{constructor(n){this.appInits=n,this.resolve=wn,this.reject=wn,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,a)=>{this.resolve=r,this.reject=a})}runInitializers(){if(this.initialized)return;const n=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let a=0;a<this.appInits.length;a++){const o=this.appInits[a]();if(Ja(o))n.push(o);else if(Qz(o)){const s=new Promise((l,f)=>{o.subscribe({complete:l,error:f})});n.push(s)}}Promise.all(n).then(()=>{r()}).catch(a=>{this.reject(a)}),0===n.length&&r(),this.initialized=!0}}return e.\u0275fac=function(n){return new(n||e)(V2(hC,8))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const At=new N2("AppId",{providedIn:"root",factory:function dC(){return`${Vi()}${Vi()}${Vi()}`}});function Vi(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const pC=new N2("Platform Initializer"),mC=new N2("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Rx=new N2("appBootstrapListener"),gC=new N2("AnimationModuleType"),le=new N2("LocaleId",{providedIn:"root",factory:()=>Tr(le,Y.Optional|Y.SkipSelf)||function Bx(){return typeof $localize<"u"&&$localize.locale||H5}()}),qx=(()=>Promise.resolve(0))();function Hi(e){typeof Zone>"u"?qx.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class N1{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new W3(!1),this.onMicrotaskEmpty=new W3(!1),this.onStable=new W3(!1),this.onError=new W3(!1),typeof Zone>"u")throw new q(908,!1);Zone.assertZonePatched();const a=this;if(a._nesting=0,a._outer=a._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const o=Zone.AsyncStackTaggingZoneSpec;a._inner=a._inner.fork(new o("Angular"))}Zone.TaskTrackingZoneSpec&&(a._inner=a._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(a._inner=a._inner.fork(Zone.longStackTraceZoneSpec)),a.shouldCoalesceEventChangeDetection=!r&&n,a.shouldCoalesceRunChangeDetection=r,a.lastRequestAnimationFrameId=-1,a.nativeRequestAnimationFrame=function $x(){let e=B2.requestAnimationFrame,t=B2.cancelAnimationFrame;if(typeof Zone<"u"&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function Yx(e){const t=()=>{!function Qx(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(B2,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,bi(e),e.isCheckStableRunning=!0,Si(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),bi(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,a,o,s,l)=>{try{return MC(e),n.invokeTask(a,o,s,l)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||e.shouldCoalesceRunChangeDetection)&&t(),LC(e)}},onInvoke:(n,r,a,o,s,l,f)=>{try{return MC(e),n.invoke(a,o,s,l,f)}finally{e.shouldCoalesceRunChangeDetection&&t(),LC(e)}},onHasTask:(n,r,a,o)=>{n.hasTask(a,o),r===a&&("microTask"==o.change?(e._hasPendingMicrotasks=o.microTask,bi(e),Si(e)):"macroTask"==o.change&&(e.hasPendingMacrotasks=o.macroTask))},onHandleError:(n,r,a,o)=>(n.handleError(a,o),e.runOutsideAngular(()=>e.onError.emit(o)),!1)})}(a)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!N1.isInAngularZone())throw new q(909,!1)}static assertNotInAngularZone(){if(N1.isInAngularZone())throw new q(909,!1)}run(t,n,r){return this._inner.run(t,n,r)}runTask(t,n,r,a){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+a,t,Kx,wn,wn);try{return o.runTask(s,n,r)}finally{o.cancelTask(s)}}runGuarded(t,n,r){return this._inner.runGuarded(t,n,r)}runOutsideAngular(t){return this._outer.run(t)}}const Kx={};function Si(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function bi(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function MC(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function LC(e){e._nesting--,Si(e)}class Jx{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new W3,this.onMicrotaskEmpty=new W3,this.onStable=new W3,this.onError=new W3}run(t,n,r){return t.apply(n,r)}runGuarded(t,n,r){return t.apply(n,r)}runOutsideAngular(t){return t()}runTask(t,n,r,a){return t.apply(n,r)}}const VC=new N2(""),xn=new N2("");let _i,zi=(()=>{class e{constructor(n,r,a){this._ngZone=n,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,_i||(function Xx(e){_i=e}(a),a.addToWindow(r)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{N1.assertNotInAngularZone(),Hi(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Hi(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(n)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,a){let o=-1;r&&r>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),n(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:n,timeoutId:o,updateCb:a})}whenStable(n,r,a){if(a&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,a),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,r,a){return[]}}return e.\u0275fac=function(n){return new(n||e)(V2(N1),V2(wi),V2(xn))},e.\u0275prov=z({token:e,factory:e.\u0275fac}),e})(),wi=(()=>{class e{constructor(){this._applications=new Map}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return _i?.findTestabilityInTree(this,n,r)??null}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})(),Pe=null;const HC=new N2("AllowMultipleToken"),xi=new N2("PlatformDestroyListeners");function bC(e,t,n=[]){const r=`Platform: ${t}`,a=new N2(r);return(o=[])=>{let s=Di();if(!s||s.injector.get(HC,!1)){const l=[...n,...o,{provide:a,useValue:!0}];e?e(l):function tD(e){if(Pe&&!Pe.get(HC,!1))throw new q(400,!1);Pe=e;const t=e.get(wC);(function SC(e){const t=e.get(pC,null);t&&t.forEach(n=>n())})(e)}(function zC(e=[],t){return v4.create({name:t,providers:[{provide:qr,useValue:"platform"},{provide:xi,useValue:new Set([()=>Pe=null])},...e]})}(l,r))}return function rD(e){const t=Di();if(!t)throw new q(401,!1);return t}()}}function Di(){return Pe?.get(wC)??null}let wC=(()=>{class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,r){const a=function aD(e,t){let n;return n="noop"===e?new Jx:("zone.js"===e?void 0:e)||new N1(t),n}(r?.ngZone,function _C(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!e||!e.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!e||!e.ngZoneRunCoalescing)||!1}}(r)),o=[{provide:N1,useValue:a}];return a.run(()=>{const s=v4.create({providers:o,parent:this.injector,name:n.moduleType.name}),l=n.create(s),f=l.injector.get(a5,null);if(!f)throw new q(402,!1);return a.runOutsideAngular(()=>{const p=a.onError.subscribe({next:y=>{f.handleError(y)}});l.onDestroy(()=>{Dn(this._modules,l),p.unsubscribe()})}),function xC(e,t,n){try{const r=n();return Ja(r)?r.catch(a=>{throw t.runOutsideAngular(()=>e.handleError(a)),a}):r}catch(r){throw t.runOutsideAngular(()=>e.handleError(r)),r}}(f,a,()=>{const p=l.injector.get(_n);return p.runInitializers(),p.donePromise.then(()=>(function Xl(e){M(e,"Expected localeId to be defined"),"string"==typeof e&&(Jl=e.toLowerCase().replace(/_/g,"-"))}(l.injector.get(le,H5)||H5),this._moduleDoBootstrap(l),l))})})}bootstrapModule(n,r=[]){const a=DC({},r);return function Zx(e,t,n){const r=new ci(n);return Promise.resolve(r)}(0,0,n).then(o=>this.bootstrapModuleFactory(o,a))}_moduleDoBootstrap(n){const r=n.injector.get(Pt);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(a=>r.bootstrap(a));else{if(!n.instance.ngDoBootstrap)throw new q(403,!1);n.instance.ngDoBootstrap(r)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new q(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const n=this._injector.get(xi,null);n&&(n.forEach(r=>r()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(n){return new(n||e)(V2(v4))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})();function DC(e,t){return Array.isArray(t)?t.reduce(DC,e):{...e,...t}}let Pt=(()=>{class e{constructor(n,r,a){this._zone=n,this._injector=r,this._exceptionHandler=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new E2(l=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{l.next(this._stable),l.complete()})}),s=new E2(l=>{let f;this._zone.runOutsideAngular(()=>{f=this._zone.onStable.subscribe(()=>{N1.assertNotInAngularZone(),Hi(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,l.next(!0))})})});const p=this._zone.onUnstable.subscribe(()=>{N1.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{l.next(!1)}))});return()=>{f.unsubscribe(),p.unsubscribe()}});this.isStable=Xe(o,s.pipe(function tr(e={}){const{connector:t=(()=>new e1),resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:a=!0}=e;return o=>{let s,l,f,p=0,y=!1,V=!1;const b=()=>{l?.unsubscribe(),l=void 0},w=()=>{b(),s=f=void 0,y=V=!1},x=()=>{const D=s;w(),D?.unsubscribe()};return s1((D,T)=>{p++,!V&&!y&&b();const F=f=f??t();T.add(()=>{p--,0===p&&!V&&!y&&(l=U5(x,a))}),F.subscribe(T),!s&&p>0&&(s=new $e({next:U=>F.next(U),error:U=>{V=!0,b(),l=U5(w,n,U),F.error(U)},complete:()=>{y=!0,b(),l=U5(w,r),F.complete()}}),z3(D).subscribe(s))})(o)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,r){const a=n instanceof Vs;if(!this._injector.get(_n).done)throw!a&&function Tt(e){const t=Y2(e)||Z1(e)||$1(e);return null!==t&&t.standalone}(n),new q(405,false);let s;s=a?n:this._injector.get(pt).resolveComponentFactory(n),this.componentTypes.push(s.componentType);const l=function eD(e){return e.isBoundToModule}(s)?void 0:this._injector.get(b5),p=s.create(v4.NULL,[],r||s.selector,l),y=p.location.nativeElement,V=p.injector.get(VC,null);return V?.registerApplication(y),p.onDestroy(()=>{this.detachView(p.hostView),Dn(this.components,p),V?.unregisterApplication(y)}),this._loadComponent(p),p}tick(){if(this._runningTick)throw new q(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;Dn(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(Rx,[]).concat(this._bootstrapListeners).forEach(a=>a(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>Dn(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new q(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return e.\u0275fac=function(n){return new(n||e)(V2(N1),V2(t5),V2(a5))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Dn(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}let NC=!0;class IC{constructor(){}supports(t){return St(t)}create(t){return new pD(t)}}const dD=(e,t)=>t;class pD{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||dD}forEachItem(t){let n;for(n=this._itHead;null!==n;n=n._next)t(n)}forEachOperation(t){let n=this._itHead,r=this._removalsHead,a=0,o=null;for(;n||r;){const s=!r||n&&n.currentIndex<OC(r,a,o)?n:r,l=OC(s,a,o),f=s.currentIndex;if(s===r)a--,r=r._nextRemoved;else if(n=n._next,null==s.previousIndex)a++;else{o||(o=[]);const p=l-a,y=f-a;if(p!=y){for(let b=0;b<p;b++){const w=b<o.length?o[b]:o[b]=0,x=w+b;y<=x&&x<p&&(o[b]=w+1)}o[s.previousIndex]=y-p}}l!==f&&t(s,l,f)}}forEachPreviousItem(t){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachMovedItem(t){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}forEachIdentityChange(t){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)t(n)}diff(t){if(null==t&&(t=[]),!St(t))throw new q(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let a,o,s,n=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let l=0;l<this.length;l++)o=t[l],s=this._trackByFn(l,o),null!==n&&Object.is(n.trackById,s)?(r&&(n=this._verifyReinsertion(n,o,s,l)),Object.is(n.item,o)||this._addIdentityChange(n,o)):(n=this._mismatch(n,o,s,l),r=!0),n=n._next}else a=0,function Bz(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[c6()]();let r;for(;!(r=n.next()).done;)t(r.value)}}(t,l=>{s=this._trackByFn(a,l),null!==n&&Object.is(n.trackById,s)?(r&&(n=this._verifyReinsertion(n,l,s,a)),Object.is(n.item,l)||this._addIdentityChange(n,l)):(n=this._mismatch(n,l,s,a),r=!0),n=n._next,a++}),this.length=a;return this._truncate(n),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,n,r,a){let o;return null===t?o=this._itTail:(o=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._reinsertAfter(t,o,a)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(r,a))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._moveAfter(t,o,a)):t=this._addAfter(new mD(n,r),o,a),t}_verifyReinsertion(t,n,r,a){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==o?t=this._reinsertAfter(o,t._prev,a):t.currentIndex!=a&&(t.currentIndex=a,this._addToMoves(t,a)),t}_truncate(t){for(;null!==t;){const n=t._next;this._addToRemovals(this._unlink(t)),t=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,n,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const a=t._prevRemoved,o=t._nextRemoved;return null===a?this._removalsHead=o:a._nextRemoved=o,null===o?this._removalsTail=a:o._prevRemoved=a,this._insertAfter(t,n,r),this._addToMoves(t,r),t}_moveAfter(t,n,r){return this._unlink(t),this._insertAfter(t,n,r),this._addToMoves(t,r),t}_addAfter(t,n,r){return this._insertAfter(t,n,r),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,n,r){const a=null===n?this._itHead:n._next;return t._next=a,t._prev=n,null===a?this._itTail=t:a._prev=t,null===n?this._itHead=t:n._next=t,null===this._linkedRecords&&(this._linkedRecords=new FC),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const n=t._prev,r=t._next;return null===n?this._itHead=r:n._next=r,null===r?this._itTail=n:r._prev=n,t}_addToMoves(t,n){return t.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new FC),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,n){return t.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class mD{constructor(t,n){this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class gD{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,n){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===n||n<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){const n=t._prevDup,r=t._nextDup;return null===n?this._head=r:n._nextDup=r,null===r?this._tail=n:r._prevDup=n,null===this._head}}class FC{constructor(){this.map=new Map}put(t){const n=t.trackById;let r=this.map.get(n);r||(r=new gD,this.map.set(n,r)),r.add(t)}get(t,n){const a=this.map.get(t);return a?a.get(t,n):null}remove(t){const n=t.trackById;return this.map.get(n).remove(t)&&this.map.delete(n),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function OC(e,t,n){const r=e.previousIndex;if(null===r)return r;let a=0;return n&&r<n.length&&(a=n[r]),r+t+a}class RC{constructor(){}supports(t){return t instanceof Map||$a(t)}create(){return new vD}}class vD{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let n;for(n=this._mapHead;null!==n;n=n._next)t(n)}forEachPreviousItem(t){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)t(n)}forEachChangedItem(t){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}diff(t){if(t){if(!(t instanceof Map||$a(t)))throw new q(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,a)=>{if(n&&n.key===a)this._maybeAddToChanges(n,r),this._appendAfter=n,n=n._next;else{const o=this._getOrCreateRecordForKey(a,r);n=this._insertBeforeOrAppend(n,o)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,n){if(t){const r=t._prev;return n._next=t,n._prev=r,t._prev=n,r&&(r._next=n),t===this._mapHead&&(this._mapHead=n),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(t,n){if(this._records.has(t)){const a=this._records.get(t);this._maybeAddToChanges(a,n);const o=a._prev,s=a._next;return o&&(o._next=s),s&&(s._prev=o),a._next=null,a._prev=null,a}const r=new yD(t);return this._records.set(t,r),r.currentValue=n,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,n){Object.is(n,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=n,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,n){t instanceof Map?t.forEach(n):Object.keys(t).forEach(r=>n(t[r],r))}}class yD{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function BC(){return new kn([new IC])}let kn=(()=>{class e{constructor(n){this.factories=n}static create(n,r){if(null!=r){const a=r.factories.slice();n=n.concat(a)}return new e(n)}static extend(n){return{provide:e,useFactory:r=>e.create(n,r||BC()),deps:[[e,new U8,new j8]]}}find(n){const r=this.factories.find(a=>a.supports(n));if(null!=r)return r;throw new q(901,!1)}}return e.\u0275prov=z({token:e,providedIn:"root",factory:BC}),e})();function WC(){return new It([new RC])}let It=(()=>{class e{constructor(n){this.factories=n}static create(n,r){if(r){const a=r.factories.slice();n=n.concat(a)}return new e(n)}static extend(n){return{provide:e,useFactory:r=>e.create(n,r||WC()),deps:[[e,new U8,new j8]]}}find(n){const r=this.factories.find(a=>a.supports(n));if(r)return r;throw new q(901,!1)}}return e.\u0275prov=z({token:e,providedIn:"root",factory:WC}),e})();const VD=bC(null,"core",[]);let HD=(()=>{class e{constructor(n){}}return e.\u0275fac=function(n){return new(n||e)(V2(Pt))},e.\u0275mod=k3({type:e}),e.\u0275inj=E({}),e})(),Tn=null;function Ft(){return Tn}const H3=new N2("DocumentToken");let h6=(()=>{class e{constructor(n,r,a,o){this._iterableDiffers=n,this._keyValueDiffers=r,this._ngEl=a,this._renderer=o,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(n){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof n?n.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(n){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof n?n.split(/\s+/):n,this._rawClass&&(St(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const n=this._iterableDiffer.diff(this._rawClass);n&&this._applyIterableChanges(n)}else if(this._keyValueDiffer){const n=this._keyValueDiffer.diff(this._rawClass);n&&this._applyKeyValueChanges(n)}}_applyKeyValueChanges(n){n.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),n.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),n.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(n){n.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${r1(r.item)}`);this._toggleClass(r.item,!0)}),n.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(n){n&&(Array.isArray(n)||n instanceof Set?n.forEach(r=>this._toggleClass(r,!0)):Object.keys(n).forEach(r=>this._toggleClass(r,!!n[r])))}_removeClasses(n){n&&(Array.isArray(n)||n instanceof Set?n.forEach(r=>this._toggleClass(r,!1)):Object.keys(n).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(n,r){(n=n.trim())&&n.split(/\s+/g).forEach(a=>{r?this._renderer.addClass(this._ngEl.nativeElement,a):this._renderer.removeClass(this._ngEl.nativeElement,a)})}}return e.\u0275fac=function(n){return new(n||e)(c2(kn),c2(It),c2(P4),c2(Z8))},e.\u0275dir=q1({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),e})();class hE{constructor(t,n,r,a){this.$implicit=t,this.ngForOf=n,this.index=r,this.count=a}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Bt=(()=>{class e{constructor(n,r,a){this._viewContainer=n,this._template=r,this._differs=a,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const r=this._viewContainer;n.forEachOperation((a,o,s)=>{if(null==a.previousIndex)r.createEmbeddedView(this._template,new hE(a.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)r.remove(null===o?void 0:o);else if(null!==o){const l=r.get(o);r.move(l,s),ef(l,a)}});for(let a=0,o=r.length;a<o;a++){const l=r.get(a).context;l.index=a,l.count=o,l.ngForOf=this._ngForOf}n.forEachIdentityChange(a=>{ef(r.get(a.currentIndex),a)})}static ngTemplateContextGuard(n,r){return!0}}return e.\u0275fac=function(n){return new(n||e)(c2(B4),c2(r4),c2(kn))},e.\u0275dir=q1({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),e})();function ef(e,t){e.context.$implicit=t.item}let Wt=(()=>{class e{constructor(n,r){this._viewContainer=n,this._context=new pE,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){tf("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){tf("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,r){return!0}}return e.\u0275fac=function(n){return new(n||e)(c2(B4),c2(r4))},e.\u0275dir=q1({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),e})();class pE{constructor(){this.$implicit=null,this.ngIf=null}}function tf(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${r1(t)}'.`)}class Ui{constructor(t,n){this._viewContainerRef=t,this._templateRef=n,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let Un=(()=>{class e{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(n){this._ngSwitch=n,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(n){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(n)}_matchCase(n){const r=n==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||r,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),r}_updateDefaultCases(n){if(this._defaultViews&&n!==this._defaultUsed){this._defaultUsed=n;for(let r=0;r<this._defaultViews.length;r++)this._defaultViews[r].enforceState(n)}}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=q1({type:e,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),e})(),nf=(()=>{class e{constructor(n,r,a){this.ngSwitch=a,a._addCase(),this._view=new Ui(n,r)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return e.\u0275fac=function(n){return new(n||e)(c2(B4),c2(r4),c2(Un,9))},e.\u0275dir=q1({type:e,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),e})(),af=(()=>{class e{constructor(n,r,a){this._ngEl=n,this._differs=r,this._renderer=a,this._ngStyle=null,this._differ=null}set ngStyle(n){this._ngStyle=n,!this._differ&&n&&(this._differ=this._differs.find(n).create())}ngDoCheck(){if(this._differ){const n=this._differ.diff(this._ngStyle);n&&this._applyChanges(n)}}_setStyle(n,r){const[a,o]=n.split("."),s=-1===a.indexOf("-")?void 0:x3.DashCase;null!=r?this._renderer.setStyle(this._ngEl.nativeElement,a,o?`${r}${o}`:r,s):this._renderer.removeStyle(this._ngEl.nativeElement,a,s)}_applyChanges(n){n.forEachRemovedItem(r=>this._setStyle(r.key,null)),n.forEachAddedItem(r=>this._setStyle(r.key,r.currentValue)),n.forEachChangedItem(r=>this._setStyle(r.key,r.currentValue))}}return e.\u0275fac=function(n){return new(n||e)(c2(P4),c2(It),c2(Z8))},e.\u0275dir=q1({type:e,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),e})(),of=(()=>{class e{constructor(n){this._viewContainerRef=n,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(n){if(n.ngTemplateOutlet||n.ngTemplateOutletInjector){const r=this._viewContainerRef;if(this._viewRef&&r.remove(r.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:a,ngTemplateOutletContext:o,ngTemplateOutletInjector:s}=this;this._viewRef=r.createEmbeddedView(a,o,s?{injector:s}:void 0)}else this._viewRef=null}else this._viewRef&&n.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return e.\u0275fac=function(n){return new(n||e)(c2(B4))},e.\u0275dir=q1({type:e,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[we]}),e})(),jt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=k3({type:e}),e.\u0275inj=E({}),e})();class $i extends class UE extends class zD{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function bD(e){Tn||(Tn=e)}(new $i)}onAndCancel(t,n,r){return t.addEventListener(n,r,!1),()=>{t.removeEventListener(n,r,!1)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,n){return(n=n||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return"window"===n?window:"document"===n?t:"body"===n?t.body:null}getBaseHref(t){const n=function GE(){return Ut=Ut||document.querySelector("base"),Ut?Ut.getAttribute("href"):null}();return null==n?null:function qE(e){Gn=Gn||document.createElement("a"),Gn.setAttribute("href",e);const t=Gn.pathname;return"/"===t.charAt(0)?t:`/${t}`}(n)}resetBaseElement(){Ut=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function CE(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const r=n.indexOf("="),[a,o]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(a.trim()===t)return decodeURIComponent(o)}return null}(document.cookie,t)}}let Gn,Ut=null;const uf=new N2("TRANSITION_ID"),KE=[{provide:hC,useFactory:function $E(e,t,n){return()=>{n.get(_n).donePromise.then(()=>{const r=Ft(),a=t.querySelectorAll(`style[ng-transition="${e}"]`);for(let o=0;o<a.length;o++)r.remove(a[o])})}},deps:[uf,H3,v4],multi:!0}];let YE=(()=>{class e{build(){return new XMLHttpRequest}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac}),e})();const qn=new N2("EventManagerPlugins");let $n=(()=>{class e{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(a=>a.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,r,a){return this._findPluginFor(r).addEventListener(n,r,a)}addGlobalEventListener(n,r,a){return this._findPluginFor(r).addGlobalEventListener(n,r,a)}getZone(){return this._zone}_findPluginFor(n){const r=this._eventNameToPlugin.get(n);if(r)return r;const a=this._plugins;for(let o=0;o<a.length;o++){const s=a[o];if(s.supports(n))return this._eventNameToPlugin.set(n,s),s}throw new Error(`No event manager plugin found for event ${n}`)}}return e.\u0275fac=function(n){return new(n||e)(V2(qn),V2(N1))},e.\u0275prov=z({token:e,factory:e.\u0275fac}),e})();class Cf{constructor(t){this._doc=t}addGlobalEventListener(t,n,r){const a=Ft().getGlobalEventTarget(this._doc,t);if(!a)throw new Error(`Unsupported event target ${a} for event ${n}`);return this.addEventListener(a,n,r)}}let ff=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(n){const r=new Set;n.forEach(a=>{this._stylesSet.has(a)||(this._stylesSet.add(a),r.add(a))}),this.onStylesAdded(r)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac}),e})(),Gt=(()=>{class e extends ff{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,r,a){n.forEach(o=>{const s=this._doc.createElement("style");s.textContent=o,a.push(r.appendChild(s))})}addHost(n){const r=[];this._addStylesToHost(this._stylesSet,n,r),this._hostNodes.set(n,r)}removeHost(n){const r=this._hostNodes.get(n);r&&r.forEach(hf),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((r,a)=>{this._addStylesToHost(n,a,r)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(hf))}}return e.\u0275fac=function(n){return new(n||e)(V2(H3))},e.\u0275prov=z({token:e,factory:e.\u0275fac}),e})();function hf(e){Ft().remove(e)}const Ki={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Qi=/%COMP%/g;function Kn(e,t,n){for(let r=0;r<t.length;r++){let a=t[r];Array.isArray(a)?Kn(e,a,n):(a=a.replace(Qi,e),n.push(a))}return n}function mf(e){return t=>{if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}let Qn=(()=>{class e{constructor(n,r,a){this.eventManager=n,this.sharedStylesHost=r,this.appId=a,this.rendererByCompId=new Map,this.defaultRenderer=new Yi(n)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;switch(r.encapsulation){case r3.Emulated:{let a=this.rendererByCompId.get(r.id);return a||(a=new nN(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,a)),a.applyToHost(n),a}case 1:case r3.ShadowDom:return new rN(this.eventManager,this.sharedStylesHost,n,r);default:if(!this.rendererByCompId.has(r.id)){const a=Kn(r.id,r.styles,[]);this.sharedStylesHost.addStyles(a),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(n){return new(n||e)(V2($n),V2(Gt),V2(At))},e.\u0275prov=z({token:e,factory:e.\u0275fac}),e})();class Yi{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,n){return n?document.createElementNS(Ki[n]||n,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,n){(vf(t)?t.content:t).appendChild(n)}insertBefore(t,n,r){t&&(vf(t)?t.content:t).insertBefore(n,r)}removeChild(t,n){t&&t.removeChild(n)}selectRootElement(t,n){let r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error(`The selector "${t}" did not match any elements`);return n||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,r,a){if(a){n=a+":"+n;const o=Ki[a];o?t.setAttributeNS(o,n,r):t.setAttribute(n,r)}else t.setAttribute(n,r)}removeAttribute(t,n,r){if(r){const a=Ki[r];a?t.removeAttributeNS(a,n):t.removeAttribute(`${r}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,r,a){a&(x3.DashCase|x3.Important)?t.style.setProperty(n,r,a&x3.Important?"important":""):t.style[n]=r}removeStyle(t,n,r){r&x3.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,r){t[n]=r}setValue(t,n){t.nodeValue=n}listen(t,n,r){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,n,mf(r)):this.eventManager.addEventListener(t,n,mf(r))}}function vf(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class nN extends Yi{constructor(t,n,r,a){super(t),this.component=r;const o=Kn(a+"-"+r.id,r.styles,[]);n.addStyles(o),this.contentAttr=function ZE(e){return"_ngcontent-%COMP%".replace(Qi,e)}(a+"-"+r.id),this.hostAttr=function eN(e){return"_nghost-%COMP%".replace(Qi,e)}(a+"-"+r.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,n){const r=super.createElement(t,n);return super.setAttribute(r,this.contentAttr,""),r}}class rN extends Yi{constructor(t,n,r,a){super(t),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=Kn(a.id,a.styles,[]);for(let s=0;s<o.length;s++){const l=document.createElement("style");l.textContent=o[s],this.shadowRoot.appendChild(l)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,r){return super.insertBefore(this.nodeOrShadowRoot(t),n,r)}removeChild(t,n){return super.removeChild(this.nodeOrShadowRoot(t),n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let aN=(()=>{class e extends Cf{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,a){return n.addEventListener(r,a,!1),()=>this.removeEventListener(n,r,a)}removeEventListener(n,r,a){return n.removeEventListener(r,a)}}return e.\u0275fac=function(n){return new(n||e)(V2(H3))},e.\u0275prov=z({token:e,factory:e.\u0275fac}),e})();const yf=["alt","control","meta","shift"],oN={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Mf={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},sN={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let cN=(()=>{class e extends Cf{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,r,a){const o=e.parseEventName(r),s=e.eventCallback(o.fullKey,a,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ft().onAndCancel(n,o.domEventName,s))}static parseEventName(n){const r=n.toLowerCase().split("."),a=r.shift();if(0===r.length||"keydown"!==a&&"keyup"!==a)return null;const o=e._normalizeKey(r.pop());let s="";if(yf.forEach(f=>{const p=r.indexOf(f);p>-1&&(r.splice(p,1),s+=f+".")}),s+=o,0!=r.length||0===o.length)return null;const l={};return l.domEventName=a,l.fullKey=s,l}static getEventFullKey(n){let r="",a=function lN(e){let t=e.key;if(null==t){if(t=e.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&Mf.hasOwnProperty(t)&&(t=Mf[t]))}return oN[t]||t}(n);return a=a.toLowerCase()," "===a?a="space":"."===a&&(a="dot"),yf.forEach(o=>{o!=a&&(0,sN[o])(n)&&(r+=o+".")}),r+=a,r}static eventCallback(n,r,a){return o=>{e.getEventFullKey(o)===n&&a.runGuarded(()=>r(o))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return e.\u0275fac=function(n){return new(n||e)(V2(H3))},e.\u0275prov=z({token:e,factory:e.\u0275fac}),e})();const hN=bC(VD,"browser",[{provide:mC,useValue:"browser"},{provide:pC,useValue:function uN(){$i.makeCurrent()},multi:!0},{provide:H3,useFactory:function fN(){return function wH(e){Ir=e}(document),document},deps:[]}]),Vf=new N2(""),Hf=[{provide:xn,useClass:class QE{addToWindow(t){B2.getAngularTestability=(r,a=!0)=>{const o=t.findTestabilityInTree(r,a);if(null==o)throw new Error("Could not find testability for element.");return o},B2.getAllAngularTestabilities=()=>t.getAllTestabilities(),B2.getAllAngularRootElements=()=>t.getAllRootElements(),B2.frameworkStabilizers||(B2.frameworkStabilizers=[]),B2.frameworkStabilizers.push(r=>{const a=B2.getAllAngularTestabilities();let o=a.length,s=!1;const l=function(f){s=s||f,o--,0==o&&r(s)};a.forEach(function(f){f.whenStable(l)})})}findTestabilityInTree(t,n,r){return null==n?null:t.getTestability(n)??(r?Ft().isShadowRoot(n)?this.findTestabilityInTree(t,n.host,!0):this.findTestabilityInTree(t,n.parentElement,!0):null)}},deps:[]},{provide:VC,useClass:zi,deps:[N1,wi,xn]},{provide:zi,useClass:zi,deps:[N1,wi,xn]}],Sf=[{provide:qr,useValue:"root"},{provide:a5,useFactory:function CN(){return new a5},deps:[]},{provide:qn,useClass:aN,multi:!0,deps:[H3,N1,mC]},{provide:qn,useClass:cN,multi:!0,deps:[H3]},{provide:Qn,useClass:Qn,deps:[$n,Gt,At]},{provide:mt,useExisting:Qn},{provide:ff,useExisting:Gt},{provide:Gt,useClass:Gt,deps:[H3]},{provide:$n,useClass:$n,deps:[qn,N1]},{provide:class jE{},useClass:YE,deps:[]},[]];let bf=(()=>{class e{constructor(n){}static withServerTransition(n){return{ngModule:e,providers:[{provide:At,useValue:n.appId},{provide:uf,useExisting:At},KE]}}}return e.\u0275fac=function(n){return new(n||e)(V2(Vf,12))},e.\u0275mod=k3({type:e}),e.\u0275inj=E({providers:[...Sf,...Hf],imports:[jt,HD]}),e})();typeof window<"u"&&window;let _f=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=z({token:e,factory:function(n){let r=null;return r=n?new(n||e):V2(xf),r},providedIn:"root"}),e})(),xf=(()=>{class e extends _f{constructor(n){super(),this._doc=n}sanitize(n,r){if(null==r)return null;switch(n){case h1.NONE:return r;case h1.HTML:return T4(r,"HTML")?I3(r):ls(this._doc,String(r)).toString();case h1.STYLE:return T4(r,"Style")?I3(r):r;case h1.SCRIPT:if(T4(r,"Script"))return I3(r);throw new Error("unsafe value used in a script context");case h1.URL:return T4(r,"URL")?I3(r):ft(String(r));case h1.RESOURCE_URL:if(T4(r,"ResourceURL"))return I3(r);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${n} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(n){return function PH(e){return new DH(e)}(n)}bypassSecurityTrustStyle(n){return function IH(e){return new EH(e)}(n)}bypassSecurityTrustScript(n){return function FH(e){return new NH(e)}(n)}bypassSecurityTrustUrl(n){return function OH(e){return new kH(e)}(n)}bypassSecurityTrustResourceUrl(n){return function RH(e){return new TH(e)}(n)}}return e.\u0275fac=function(n){return new(n||e)(V2(H3))},e.\u0275prov=z({token:e,factory:function(n){let r=null;return r=n?new n:function VN(e){return new xf(e.get(H3))}(V2(v4)),r},providedIn:"root"}),e})();class Df{}const fe="*";function SN(e,t){return{type:7,name:e,definitions:t,options:{}}}function Ef(e,t=null){return{type:4,styles:t,timings:e}}function Nf(e,t=null){return{type:2,steps:e,options:t}}function d6(e){return{type:6,styles:e,offset:null}}function bN(e,t,n){return{type:0,name:e,styles:t,options:n}}function kf(e,t,n=null){return{type:1,expr:e,animation:t,options:n}}function Tf(e){Promise.resolve(null).then(e)}class qt{constructor(t=0,n=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){Tf(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}}class Af{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let n=0,r=0,a=0;const o=this.players.length;0==o?Tf(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++n==o&&this._onFinish()}),s.onDestroy(()=>{++r==o&&this._onDestroy()}),s.onStart(()=>{++a==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,l)=>Math.max(s,l.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const n=t*this.totalTime;this.players.forEach(r=>{const a=r.totalTime?Math.min(1,n/r.totalTime):1;r.setPosition(a)})}getPosition(){const t=this.players.reduce((n,r)=>null===n||r.totalTime>n.totalTime?r:n,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const n="start"==t?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}}var jf={prefix:"fas",iconName:"arrow-left",icon:[448,512,[8592],"f060","M447.1 256C447.1 273.7 433.7 288 416 288H109.3l105.4 105.4c12.5 12.5 12.5 32.75 0 45.25C208.4 444.9 200.2 448 192 448s-16.38-3.125-22.62-9.375l-160-160c-12.5-12.5-12.5-32.75 0-45.25l160-160c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25L109.3 224H416C433.7 224 447.1 238.3 447.1 256z"]},qf={prefix:"fas",iconName:"arrow-right",icon:[448,512,[8594],"f061","M438.6 278.6l-160 160C272.4 444.9 264.2 448 256 448s-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L338.8 288H32C14.33 288 .0016 273.7 .0016 256S14.33 224 32 224h306.8l-105.4-105.4c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l160 160C451.1 245.9 451.1 266.1 438.6 278.6z"]},c7={prefix:"fas",iconName:"backward-step",icon:[320,512,["step-backward"],"f048","M31.1 64.03c-17.67 0-31.1 14.33-31.1 32v319.9c0 17.67 14.33 32 32 32C49.67 447.1 64 433.6 64 415.1V96.03C64 78.36 49.67 64.03 31.1 64.03zM267.5 71.41l-192 159.1C67.82 237.8 64 246.9 64 256c0 9.094 3.82 18.18 11.44 24.62l192 159.1c20.63 17.12 52.51 2.75 52.51-24.62v-319.9C319.1 68.66 288.1 54.28 267.5 71.41z"]},Rh={prefix:"fas",iconName:"brain",icon:[512,512,[129504],"f5dc","M184 0C214.9 0 240 25.07 240 56V456C240 486.9 214.9 512 184 512C155.1 512 131.3 490.1 128.3 461.9C123.1 463.3 117.6 464 112 464C76.65 464 48 435.3 48 400C48 392.6 49.27 385.4 51.59 378.8C21.43 367.4 0 338.2 0 304C0 272.1 18.71 244.5 45.77 231.7C37.15 220.8 32 206.1 32 192C32 161.3 53.59 135.7 82.41 129.4C80.84 123.9 80 118 80 112C80 82.06 100.6 56.92 128.3 49.93C131.3 21.86 155.1 0 184 0zM383.7 49.93C411.4 56.92 432 82.06 432 112C432 118 431.2 123.9 429.6 129.4C458.4 135.7 480 161.3 480 192C480 206.1 474.9 220.8 466.2 231.7C493.3 244.5 512 272.1 512 304C512 338.2 490.6 367.4 460.4 378.8C462.7 385.4 464 392.6 464 400C464 435.3 435.3 464 400 464C394.4 464 388.9 463.3 383.7 461.9C380.7 490.1 356.9 512 328 512C297.1 512 272 486.9 272 456V56C272 25.07 297.1 0 328 0C356.9 0 380.7 21.86 383.7 49.93z"]},Bh={prefix:"fas",iconName:"bug",icon:[512,512,[],"f188","M352 96V99.56C352 115.3 339.3 128 323.6 128H188.4C172.7 128 159.1 115.3 159.1 99.56V96C159.1 42.98 202.1 0 255.1 0C309 0 352 42.98 352 96zM41.37 105.4C53.87 92.88 74.13 92.88 86.63 105.4L150.6 169.4C151.3 170 151.9 170.7 152.5 171.4C166.8 164.1 182.9 160 199.1 160H312C329.1 160 345.2 164.1 359.5 171.4C360.1 170.7 360.7 170 361.4 169.4L425.4 105.4C437.9 92.88 458.1 92.88 470.6 105.4C483.1 117.9 483.1 138.1 470.6 150.6L406.6 214.6C405.1 215.3 405.3 215.9 404.6 216.5C410.7 228.5 414.6 241.9 415.7 256H480C497.7 256 512 270.3 512 288C512 305.7 497.7 320 480 320H416C416 344.6 410.5 367.8 400.6 388.6C402.7 389.9 404.8 391.5 406.6 393.4L470.6 457.4C483.1 469.9 483.1 490.1 470.6 502.6C458.1 515.1 437.9 515.1 425.4 502.6L362.3 439.6C337.8 461.4 306.5 475.8 272 479.2V240C272 231.2 264.8 224 255.1 224C247.2 224 239.1 231.2 239.1 240V479.2C205.5 475.8 174.2 461.4 149.7 439.6L86.63 502.6C74.13 515.1 53.87 515.1 41.37 502.6C28.88 490.1 28.88 469.9 41.37 457.4L105.4 393.4C107.2 391.5 109.3 389.9 111.4 388.6C101.5 367.8 96 344.6 96 320H32C14.33 320 0 305.7 0 288C0 270.3 14.33 256 32 256H96.3C97.38 241.9 101.3 228.5 107.4 216.5C106.7 215.9 106 215.3 105.4 214.6L41.37 150.6C28.88 138.1 28.88 117.9 41.37 105.4H41.37z"]},Zh={prefix:"fas",iconName:"caret-down",icon:[320,512,[],"f0d7","M310.6 246.6l-127.1 128C176.4 380.9 168.2 384 160 384s-16.38-3.125-22.63-9.375l-127.1-128C.2244 237.5-2.516 223.7 2.438 211.8S19.07 192 32 192h255.1c12.94 0 24.62 7.781 29.58 19.75S319.8 237.5 310.6 246.6z"]},ed={prefix:"fas",iconName:"caret-up",icon:[320,512,[],"f0d8","M9.39 265.4l127.1-128C143.6 131.1 151.8 128 160 128s16.38 3.125 22.63 9.375l127.1 128c9.156 9.156 11.9 22.91 6.943 34.88S300.9 320 287.1 320H32.01c-12.94 0-24.62-7.781-29.58-19.75S.2333 274.5 9.39 265.4z"]},d7={prefix:"fas",iconName:"circle-arrow-right",icon:[512,512,["arrow-circle-right"],"f0a9","M256 0C114.6 0 0 114.6 0 256c0 141.4 114.6 256 256 256s256-114.6 256-256C512 114.6 397.4 0 256 0zM406.6 278.6l-103.1 103.1c-12.5 12.5-32.75 12.5-45.25 0s-12.5-32.75 0-45.25L306.8 288H128C110.3 288 96 273.7 96 256s14.31-32 32-32h178.8l-49.38-49.38c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l103.1 103.1C414.6 241.3 416 251.1 416 256C416 260.9 414.6 270.7 406.6 278.6z"]},N7={prefix:"fas",iconName:"magnifying-glass",icon:[512,512,[128269,"search"],"f002","M500.3 443.7l-119.7-119.7c27.22-40.41 40.65-90.9 33.46-144.7C401.8 87.79 326.8 13.32 235.2 1.723C99.01-15.51-15.51 99.01 1.724 235.2c11.6 91.64 86.08 166.7 177.6 178.9c53.8 7.189 104.3-6.236 144.7-33.46l119.7 119.7c15.62 15.62 40.95 15.62 56.57 0C515.9 484.7 515.9 459.3 500.3 443.7zM79.1 208c0-70.58 57.42-128 128-128s128 57.42 128 128c0 70.58-57.42 128-128 128S79.1 278.6 79.1 208z"]},T7={prefix:"fas",iconName:"play",icon:[384,512,[9654],"f04b","M361 215C375.3 223.8 384 239.3 384 256C384 272.7 375.3 288.2 361 296.1L73.03 472.1C58.21 482 39.66 482.4 24.52 473.9C9.377 465.4 0 449.4 0 432V80C0 62.64 9.377 46.63 24.52 38.13C39.66 29.64 58.21 29.99 73.03 39.04L361 215z"]},ly={prefix:"fas",iconName:"star",icon:[576,512,[61446,11088],"f005","M381.2 150.3L524.9 171.5C536.8 173.2 546.8 181.6 550.6 193.1C554.4 204.7 551.3 217.3 542.7 225.9L438.5 328.1L463.1 474.7C465.1 486.7 460.2 498.9 450.2 506C440.3 513.1 427.2 514 416.5 508.3L288.1 439.8L159.8 508.3C149 514 135.9 513.1 126 506C116.1 498.9 111.1 486.7 113.2 474.7L137.8 328.1L33.58 225.9C24.97 217.3 21.91 204.7 25.69 193.1C29.46 181.6 39.43 173.2 51.42 171.5L195 150.3L259.4 17.97C264.7 6.954 275.9-.0391 288.1-.0391C300.4-.0391 311.6 6.954 316.9 17.97L381.2 150.3z"]},W62=C3(747);let Xt=(()=>{class e{constructor(){this.story=new W62.Story(storyContent),this.parts=[],this.story.BindExternalFunctionGeneral("format_stat_name",n=>n[0].maxItem.Key.itemName.toUpperCase(),!1),this.story.BindExternalFunctionGeneral("format_stat_box",n=>{let r=n[0];return`[s]${n[1].maxItem.Key.itemName.toLowerCase()}[|]${r}[/s]`},!1)}continue(){for(this.parts=[];this.story.canContinue;){let r=this.story.Continue();this.parts.push({kind:"paragraph",text:r??"",tags:this.story.currentTags??[]})}let n=this.story.currentChoices?.map(r=>{let a=this.story.state.VisitCountAtPathString(r.pathStringOnChoice)??0;return{text:r.text,index:r.index,visited:a>0}});this.parts.push({kind:"choice_list",choices:n??[]})}chooseChoice(n){this.story.ChooseChoiceIndex(n)}getParts(){return this.parts}createSave(){return this.story.state.ToJson()}loadSave(n){this.story.state.LoadJson(n)}getVariableWithName(n){return this.story.variablesState.GetVariableWithName(n).value}callSetter(n,r){this.story.EvaluateFunction(`set_${n}`,r,!1)}evaluateFunction(n,r,a){return this.story.EvaluateFunction(n,r,a)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac}),e})();const{isArray:U62}=Array;const $62=["addListener","removeListener"],K62=["addEventListener","removeEventListener"],Q62=["on","off"];function p6(e,t,n,r){if(k2(n)&&(r=n,n=void 0),r)return p6(e,t,n).pipe(function q62(e){return o2(t=>function G62(e,t){return U62(t)?e(...t):e(t)}(e,t))}(r));const[a,o]=function X62(e){return k2(e.addEventListener)&&k2(e.removeEventListener)}(e)?K62.map(s=>l=>e[s](t,l,n)):function Y62(e){return k2(e.addListener)&&k2(e.removeListener)}(e)?$62.map(CM(e,t)):function J62(e){return k2(e.on)&&k2(e.off)}(e)?Q62.map(CM(e,t)):[];if(!a&&B5(e))return N3(s=>p6(s,t,n))(z3(e));if(!a)throw new TypeError("Invalid event target");return new E2(s=>{const l=(...f)=>s.next(1<f.length?f:f[0]);return a(l),()=>o(l)})}function CM(e,t){return n=>r=>e[n](t,r)}function Fe(e,t){return s1((n,r)=>{let a=0;n.subscribe(c1(r,o=>e.call(t,o,a++)&&r.next(o)))})}function fM(e){return s1((t,n)=>{let r=!1;t.subscribe(c1(n,a=>{r=!0,n.next(a)},()=>{r||n.next(e),n.complete()}))})}const hM=B(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function Z62(e){return e<=0?()=>W5:s1((t,n)=>{let r=0;t.subscribe(c1(n,a=>{++r<=e&&(n.next(a),e<=r&&n.complete())}))})}function e52(e=t52){return s1((t,n)=>{let r=!1;t.subscribe(c1(n,a=>{r=!0,n.next(a)},()=>r?n.complete():n.error(e())))})}function t52(){return new hM}function Zt(e){return s1((t,n)=>{z3(e).subscribe(c1(n,()=>n.complete(),ye)),!n.closed&&t.subscribe(n)})}function a52(e,t){1&e&&M1(0,"h2",10),2&e&&X("innerHTML",W2().title.content,Y8)}function i52(e,t){1&e&&pn(0)}function o52(e,t){if(1&e&&(t2(0,"h2"),T2(1,i52,1,0,"ng-container",11),s2()),2&e){const n=W2();J(1),X("ngTemplateOutlet",n.title.content)("ngTemplateOutletContext",n.context)}}function s52(e,t){if(1&e&&M1(0,"p",10),2&e){const n=W2();M5("with-title",n.title),X("innerHTML",n.body.content,Y8)}}function c52(e,t){1&e&&pn(0)}function l52(e,t){if(1&e&&(t2(0,"p"),T2(1,c52,1,0,"ng-container",11),s2()),2&e){const n=W2();M5("with-title",n.title),J(1),X("ngTemplateOutlet",n.body.content)("ngTemplateOutletContext",n.context)}}const u52=[[["",8,"icon"]],[["",8,"btn"]]],C52=[".icon",".btn"],dM="[_nghost-%COMP%]{display:flex;flex-direction:column;flex-grow:1;overflow:hidden}",f52=["backdrop"],h52=["dialog"];function d52(e,t){if(1&e&&M1(0,"div",6),2&e){const n=W2(),r=Qa(3);X("dialogDragEnabled",!0)("dialogDragTarget",r)("dragConstraint",n.config.dragConstraint)}}function p52(e,t){if(1&e){const n=u6();t2(0,"div",7),R1("click",function(){return xe(n),De(W2().closeDialog())}),Z5(),t2(1,"svg",8),M1(2,"path",9),s2()()}}function h0(e){return function m52(e){return null==e}(e)?"":function g52(e){return"string"==typeof e}(e)?e:`${e}px`}const Y7=Symbol("Dialog Content Data");class d0{}class J7 extends d0{constructor(t={}){super(),this.beforeCloseGuards=[],this.mutate(t)}close(t){this.canClose(t).pipe(Fe(Boolean)).subscribe({next:()=>this.onClose(t)})}beforeClose(t){this.beforeCloseGuards.push(t)}resetDrag(t){this.onReset(t)}canClose(t){return Xe(...this.beforeCloseGuards.map(r=>r(t)).filter(r=>void 0!==r&&!0!==r).map(r=>"boolean"==typeof r?function j62(...e){return Se(e,E6(e))}(r):Se(r).pipe(Fe(a=>!a)))).pipe(fM(!0),function n52(e,t){const n=arguments.length>=2;return r=>r.pipe(e?Fe((a,o)=>e(a,o,r)):w6,Z62(1),n?fM(t):e52(()=>new hM))}())}mutate(t){Object.assign(this,t)}asDialogRef(){return this}}let m6=(()=>{class e{constructor(n){this.ref=n,this.title=this.ref.data[Y7].title,this.body=this.ref.data[Y7].body,this.context={$implicit:this.ref,data:this.ref.data}}}return e.\u0275fac=function(n){return new(n||e)(c2(d0))},e.\u0275cmp=G1({type:e,selectors:[["ngneat-dialog-base"]],ngContentSelectors:C52,decls:12,vars:6,consts:[[1,"dialog"],[1,"dialog-header"],[1,"dialog-icon"],[3,"ngSwitch"],[3,"innerHTML",4,"ngSwitchCase"],[4,"ngSwitchCase"],[1,"dialog-content",3,"ngSwitch"],[3,"with-title","innerHTML",4,"ngSwitchCase"],[3,"with-title",4,"ngSwitchCase"],[1,"dialog-footer"],[3,"innerHTML"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,r){1&n&&(Xa(u52),t2(0,"div",0)(1,"div",1)(2,"span",2),mn(3),s2(),O3(4,3),T2(5,a52,1,1,"h2",4),T2(6,o52,2,2,"h2",5),R3(),s2(),t2(7,"div",6),T2(8,s52,1,3,"p",7),T2(9,l52,2,4,"p",8),s2(),t2(10,"div",9),mn(11,1),s2()()),2&n&&(J(4),X("ngSwitch",null==r.title?null:r.title.type),J(1),X("ngSwitchCase","string"),J(1),X("ngSwitchCase","template"),J(1),X("ngSwitch",r.body.type),J(1),X("ngSwitchCase","string"),J(1),X("ngSwitchCase","template"))},dependencies:[Un,nf,of],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;overflow:hidden;flex-grow:1}.dialog[_ngcontent-%COMP%]{flex-grow:1;display:flex;align-items:center;flex-direction:column;justify-content:flex-start;overflow:hidden}.dialog-header[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:row;align-items:center;width:100%;margin:0;padding:18px 40px 10px 30px}.dialog-header[_ngcontent-%COMP%]   .dialog-icon[_ngcontent-%COMP%]    {display:flex}.dialog-header[_ngcontent-%COMP%]   .dialog-icon[_ngcontent-%COMP%]     .icon{width:24px;margin-right:10px}.dialog-header[_ngcontent-%COMP%]   .dialog-icon[_ngcontent-%COMP%]     .icon-success{fill:#72c140}.dialog-header[_ngcontent-%COMP%]   .dialog-icon[_ngcontent-%COMP%]     .icon-question{fill:#f0af41}.dialog-header[_ngcontent-%COMP%]   .dialog-icon[_ngcontent-%COMP%]     .icon-error{fill:#e74c3c}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;margin:0}.dialog-content[_ngcontent-%COMP%]{width:100%;flex-grow:1;overflow:auto;position:relative;display:flex;flex-direction:column;padding:0 30px 30px}.dialog-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.75;margin:5px 0}.dialog-content[_ngcontent-%COMP%]   .with-title[_ngcontent-%COMP%]{padding-left:35px}.dialog-footer[_ngcontent-%COMP%]    {display:flex;width:100%;justify-content:flex-end;padding:17px 30px 16px;border-top:1px solid #f1f2f5}.dialog-footer[_ngcontent-%COMP%]     .btn{margin-right:10px;padding:10px 18px;border:0;border-radius:4px;cursor:pointer}.dialog-footer[_ngcontent-%COMP%]     .btn:focus{outline:none}.dialog-footer[_ngcontent-%COMP%]     .btn:last-child{margin-right:0}.dialog-footer[_ngcontent-%COMP%]     .btn-success{background-color:#4091f7;color:#fff}.dialog-footer[_ngcontent-%COMP%]     .btn-error{background-color:#e74c3c;color:#fff}.dialog-footer[_ngcontent-%COMP%]     .btn-cancel{background-color:#fff;border:2px solid #4091f7;color:#4091f7}"],changeDetection:0}),e})(),pM=(()=>{class e extends m6{}return e.\u0275fac=function(){let t;return function(r){return(t||(t=O8(e)))(r||e)}}(),e.\u0275cmp=G1({type:e,selectors:[["ngneat-dialog-success"]],features:[Ht],decls:7,vars:0,consts:[["x","0px","y","0px","viewBox","0 0 496 496",1,"icon","icon-success"],["d","M248,0C111.033,0,0,111.033,0,248s111.033,248,248,248s248-111.033,248-248C495.841,111.099,384.901,0.159,248,0z      M248,480C119.87,480,16,376.13,16,248S119.87,16,248,16s232,103.87,232,232C479.859,376.072,376.072,479.859,248,480z"],["d","M370.344,158.344L208,320.688l-82.344-82.344c-3.178-3.07-8.242-2.982-11.312,0.196c-2.994,3.1-2.994,8.015,0,11.116     l88,88c3.124,3.123,8.188,3.123,11.312,0l168-168c3.07-3.178,2.982-8.242-0.196-11.312     C378.359,155.35,373.444,155.35,370.344,158.344z"],[1,"btn","btn-success","ngneat-dialog-primary-btn",3,"click"]],template:function(n,r){1&n&&(t2(0,"ngneat-dialog-base"),Z5(),t2(1,"svg",0)(2,"g"),M1(3,"path",1)(4,"path",2),s2()(),x8(),t2(5,"button",3),R1("click",function(){return r.ref.close()}),x2(6,"OK"),s2()())},dependencies:[m6],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;flex-grow:1;overflow:hidden}"],changeDetection:0}),e})(),mM=(()=>{class e extends m6{}return e.\u0275fac=function(){let t;return function(r){return(t||(t=O8(e)))(r||e)}}(),e.\u0275cmp=G1({type:e,selectors:[["ngneat-dialog-confirm"]],features:[Ht],decls:10,vars:0,consts:[["x","0px","y","0px","viewBox","0 0 512 512",1,"icon","icon-question"],["cx","256","cy","378.5","r","25"],["d","M256,0C114.516,0,0,114.497,0,256c0,141.484,114.497,256,256,256c141.484,0,256-114.497,256-256     C512,114.516,397.503,0,256,0z M256,472c-119.377,0-216-96.607-216-216c0-119.377,96.607-216,216-216     c119.377,0,216,96.607,216,216C472,375.377,375.393,472,256,472z"],["d","M256,128.5c-44.112,0-80,35.888-80,80c0,11.046,8.954,20,20,20s20-8.954,20-20c0-22.056,17.944-40,40-40     c22.056,0,40,17.944,40,40c0,22.056-17.944,40-40,40c-11.046,0-20,8.954-20,20v50c0,11.046,8.954,20,20,20     c11.046,0,20-8.954,20-20v-32.531c34.466-8.903,60-40.26,60-77.469C336,164.388,300.112,128.5,256,128.5z"],[1,"btn","btn-cancel","ngneat-dialog-secondary-btn",3,"click"],[1,"btn","btn-success","ngneat-dialog-primary-btn",3,"click"]],template:function(n,r){1&n&&(t2(0,"ngneat-dialog-base"),Z5(),t2(1,"svg",0)(2,"g"),M1(3,"circle",1)(4,"path",2)(5,"path",3),s2()(),x8(),t2(6,"button",4),R1("click",function(){return r.ref.close(!1)}),x2(7,"Cancel"),s2(),t2(8,"button",5),R1("click",function(){return r.ref.close(!0)}),x2(9,"OK"),s2()())},dependencies:[m6],styles:[dM],changeDetection:0}),e})(),gM=(()=>{class e extends m6{}return e.\u0275fac=function(){let t;return function(r){return(t||(t=O8(e)))(r||e)}}(),e.\u0275cmp=G1({type:e,selectors:[["ngneat-dialog-error"]],features:[Ht],decls:7,vars:0,consts:[["x","0px","y","0px","viewBox","0 0 512 512",1,"icon","icon-error"],["d","M256,0C114.508,0,0,114.497,0,256c0,141.493,114.497,256,256,256c141.492,0,256-114.497,256-256    C512,114.507,397.503,0,256,0z M256,472c-119.384,0-216-96.607-216-216c0-119.385,96.607-216,216-216    c119.384,0,216,96.607,216,216C472,375.385,375.393,472,256,472z"],["d","M343.586,315.302L284.284,256l59.302-59.302c7.81-7.81,7.811-20.473,0.001-28.284c-7.812-7.811-20.475-7.81-28.284,0    L256,227.716l-59.303-59.302c-7.809-7.811-20.474-7.811-28.284,0c-7.81,7.811-7.81,20.474,0.001,28.284L227.716,256    l-59.302,59.302c-7.811,7.811-7.812,20.474-0.001,28.284c7.813,7.812,20.476,7.809,28.284,0L256,284.284l59.303,59.302    c7.808,7.81,20.473,7.811,28.284,0C351.398,335.775,351.397,323.112,343.586,315.302z"],[1,"btn","btn-error","ngneat-dialog-primary-btn",3,"click"]],template:function(n,r){1&n&&(t2(0,"ngneat-dialog-base"),Z5(),t2(1,"svg",0)(2,"g"),M1(3,"path",1)(4,"path",2),s2()(),x8(),t2(5,"button",3),R1("click",function(){return r.ref.close()}),x2(6,"OK"),s2()())},dependencies:[m6],styles:[dM],changeDetection:0}),e})();const vM=new N2("A reference to the document. Useful for iframes that want appends to parent window",{providedIn:"root",factory:()=>Tr(H3)}),yM=new N2("Global dialog config token"),p0=new N2("Dialog config token",{providedIn:"root",factory:()=>({id:void 0,container:Tr(vM).body,backdrop:!0,closeButton:!0,enableClose:!0,draggable:!1,dragConstraint:"none",resizable:!1,size:"md",windowClass:void 0,width:void 0,height:void 0,minHeight:void 0,maxHeight:void 0,data:void 0,vcr:void 0,sizes:{sm:{minHeight:"200px",width:"400px"},md:{minHeight:"280px",width:"560px"},lg:{minHeight:"350px",width:"800px"},fullScreen:{height:"100%",width:"100%"}},success:{component:pM},confirm:{component:mM},error:{component:gM},onClose:void 0,onOpen:void 0})}),MM=new N2("Nodes inserted into the dialog");let LM=(()=>{class e{constructor(n,r,a){this.host=n,this.zone=r,this.renderer=a,this.dialogDragEnabled=!1,this.delta={x:0,y:0},this.offset={x:0,y:0},this.enabled=!0,this.destroy$=new e1}set dialogDragOffset(n){this.reset(n)}ngAfterViewInit(){!this.enabled||this.init()}ngOnChanges(){!this.enabled&&this.dialogDragEnabled&&this.dialogDragTarget&&(this.enabled=!0,this.handle?this.renderer.setStyle(this.handle,"cursor","move"):this.enabled&&this.init()),this.dialogDragEnabled||(this.enabled=!1,this.handle&&this.renderer.setStyle(this.handle,"cursor",""))}ngOnDestroy(){this.destroy$.next()}reset(n){const r={x:0,y:0};this.offset={...r,...n},this.delta={...r},this.translate()}setupEvents(){this.zone.runOutsideAngular(()=>{const n=p6(this.handle,"mousedown"),r=p6(document,"mousemove"),a=p6(document,"mouseup");n.pipe(Fe(()=>this.enabled),o2(s=>({startX:s.clientX,startY:s.clientY})),function r52(e,t){return s1((n,r)=>{let a=null,o=0,s=!1;const l=()=>s&&!a&&r.complete();n.subscribe(c1(r,f=>{a?.unsubscribe();let p=0;const y=o++;z3(e(f,y)).subscribe(a=c1(r,V=>r.next(t?t(f,V,y,p++):V),()=>{a=null,l()}))},()=>{s=!0,l()}))})}(({startX:s,startY:l})=>r.pipe(o2(f=>{f.preventDefault(),this.delta={x:f.clientX-s,y:f.clientY-l},"constrain"===this.dragConstraint&&this.checkConstraint()}),Zt(a))),Zt(this.destroy$)).subscribe(()=>{0===this.delta.x&&0===this.delta.y||this.translate()}),a.pipe(Fe(()=>this.enabled),Fe(()=>0!==this.delta.x||0!==this.delta.y),Zt(this.destroy$)).subscribe(()=>{"bounce"===this.dragConstraint&&(this.checkConstraint(),this.translate()),this.offset.x+=this.delta.x,this.offset.y+=this.delta.y,this.delta={x:0,y:0}})})}translate(){this.target&&this.zone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this.renderer.setStyle(this.target,"transform",`translate(${this.translateX}px, ${this.translateY}px)`)})})}get translateX(){return this.offset.x+this.delta.x}get translateY(){return this.offset.y+this.delta.y}init(){if(!this.dialogDragTarget)throw new Error("You need to specify the drag target");this.handle=this.dialogDragHandle instanceof Element?this.dialogDragHandle:"string"==typeof this.dialogDragHandle&&this.dialogDragHandle?document.querySelector(this.dialogDragHandle):this.host.nativeElement,this.handle&&this.enabled&&this.renderer.setStyle(this.handle,"cursor","move"),this.target=this.dialogDragTarget instanceof HTMLElement?this.dialogDragTarget:document.querySelector(this.dialogDragTarget),this.setupEvents(),this.translate()}checkConstraint(){const{width:r,height:a}=this.target.getBoundingClientRect(),{innerWidth:s,innerHeight:l}=window,f=this.translateY>0?this.translateY+a/2:this.translateY-a/2,p=l/2,y=this.translateX>0?this.translateX+r/2:this.translateX-r/2,V=s/2;-p>f&&(this.delta.y=a/2-p-this.offset.y),p<f&&(this.delta.y=p-a/2-this.offset.y),-V>y&&(this.delta.x=r/2-V-this.offset.x),V<y&&(this.delta.x=V-r/2-this.offset.x)}}return e.\u0275fac=function(n){return new(n||e)(c2(P4),c2(N1),c2(Z8))},e.\u0275dir=q1({type:e,selectors:[["","dialogDraggable",""]],inputs:{dialogDragHandle:"dialogDragHandle",dialogDragTarget:"dialogDragTarget",dialogDragEnabled:"dialogDragEnabled",dialogDragOffset:"dialogDragOffset",dragConstraint:"dragConstraint"},features:[we]}),e})(),v52=(()=>{class e{constructor(n,{nativeElement:r},a,o,s){this.document=n,this.dialogRef=a,this.config=o,this.nodes=s,this.size=this.config.sizes?.[this.config.size||"md"],this.styles={width:h0(this.config.width||this.size?.width),height:h0(this.config.height||this.size?.height),minHeight:h0(this.config.minHeight||this.size?.minHeight),maxHeight:h0(this.config.maxHeight||this.size?.maxHeight)},this.destroy$=new e1,r.id=this.config.id,this.nodes.forEach(l=>r.appendChild(l)),o.windowClass&&o.windowClass.split(/\s/).filter(f=>f).forEach(f=>r.classList.add(f))}ngOnInit(){const r=this.dialogElement.nativeElement,a=p6(this.config.backdrop?this.backdrop.nativeElement:this.document.body,"click",{capture:!0}).pipe(Fe(({target:o})=>!r.contains(o)));a.pipe(Zt(this.destroy$)).subscribe(this.dialogRef.backdropClick$),this.config.enableClose&&Xe(p6(this.document.body,"keyup").pipe(Fe(({key:o})=>"Escape"===o)),a).pipe(Zt(this.destroy$)).subscribe(()=>this.closeDialog()),this.nodes.forEach(o=>r.appendChild(o))}reset(n){this.config.draggable&&this.draggable.reset(n)}closeDialog(){this.dialogRef.close()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.dialogRef=null,this.nodes=null}}return e.\u0275fac=function(n){return new(n||e)(c2(H3),c2(P4),c2(J7),c2(p0),c2(MM))},e.\u0275cmp=G1({type:e,selectors:[["ngneat-dialog"]],viewQuery:function(n,r){if(1&n&&(Sn(f52,7),Sn(h52,7),Sn(LM,5)),2&n){let a;Hn(a=bn())&&(r.backdrop=a.first),Hn(a=bn())&&(r.dialogElement=a.first),Hn(a=bn())&&(r.draggable=a.first)}},decls:6,vars:8,consts:[[1,"ngneat-dialog-backdrop",3,"hidden"],["backdrop",""],[1,"ngneat-dialog-content",3,"ngStyle"],["dialog",""],["class","ngneat-drag-marker","dialogDraggable","",3,"dialogDragEnabled","dialogDragTarget","dragConstraint",4,"ngIf"],["class","ngneat-close-dialog",3,"click",4,"ngIf"],["dialogDraggable","",1,"ngneat-drag-marker",3,"dialogDragEnabled","dialogDragTarget","dragConstraint"],[1,"ngneat-close-dialog",3,"click"],["viewBox","0 0 329.26933 329","xmlns","http://www.w3.org/2000/svg"],["fill","currentColor","d","m194.800781 164.769531 128.210938-128.214843c8.34375-8.339844 8.34375-21.824219 0-30.164063-8.339844-8.339844-21.824219-8.339844-30.164063 0l-128.214844 128.214844-128.210937-128.214844c-8.34375-8.339844-21.824219-8.339844-30.164063 0-8.34375 8.339844-8.34375 21.824219 0 30.164063l128.210938 128.214843-128.210938 128.214844c-8.34375 8.339844-8.34375 21.824219 0 30.164063 4.15625 4.160156 9.621094 6.25 15.082032 6.25 5.460937 0 10.921875-2.089844 15.082031-6.25l128.210937-128.214844 128.214844 128.214844c4.160156 4.160156 9.621094 6.25 15.082032 6.25 5.460937 0 10.921874-2.089844 15.082031-6.25 8.34375-8.339844 8.34375-21.824219 0-30.164063zm0 0"]],template:function(n,r){1&n&&(t2(0,"div",0,1)(2,"div",2,3),T2(4,d52,1,3,"div",4),T2(5,p52,3,0,"div",5),s2()()),2&n&&(M5("ngneat-dialog-backdrop-visible",r.config.backdrop),X("hidden",!r.config.backdrop),J(2),M5("ngneat-dialog-resizable",r.config.resizable),X("ngStyle",r.styles),J(2),X("ngIf",r.config.draggable),J(1),X("ngIf",r.config.closeButton))},dependencies:[af,Wt,LM],styles:[".ngneat-dialog-content{display:flex;flex-direction:column;overflow:hidden;position:relative;-webkit-animation:dialog-open .4s cubic-bezier(.25,.8,.25,1);animation:dialog-open .4s cubic-bezier(.25,.8,.25,1);border-radius:4px;box-sizing:border-box;box-shadow:0 11px 15px -7px #0003,0 24px 38px 3px #00000024,0 9px 46px 8px #0000001f;background:#fff;color:#000000de;width:auto;max-width:100%;height:auto;max-height:100%}@-webkit-keyframes dialog-open{0%{transform:translate(50px)}to{transform:none}}@keyframes dialog-open{0%{transform:translate(50px)}to{transform:none}}.ngneat-dialog-content.ngneat-dialog-resizable{resize:both}.ngneat-dialog-backdrop{position:fixed;display:flex;align-items:center;justify-content:center;top:0;left:0;bottom:0;right:0;height:100%;width:100%;padding:30px;z-index:1050;background:rgba(0,0,0,.32);-webkit-animation:dialog-open-backdrop .3s;animation:dialog-open-backdrop .3s}@-webkit-keyframes dialog-open-backdrop{0%{opacity:0}to{opacity:1}}@keyframes dialog-open-backdrop{0%{opacity:0}to{opacity:1}}.ngneat-drag-marker{position:absolute;left:0;top:0;cursor:move;width:100%;height:10px;z-index:1051}.ngneat-close-dialog{display:flex;align-items:center;justify-content:center;position:absolute;top:10px;cursor:pointer;right:10px;width:24px;height:24px;color:#5f6368;transition:color .2s ease-in-out;z-index:1051}.ngneat-close-dialog svg{width:12px;height:12px}.ngneat-close-dialog:hover{color:#5d9ff1}body.ngneat-dialog-hidden{overflow:hidden}\n"],encapsulation:2}),e})();const VM="ngneat-dialog-hidden";let HM=(()=>{class e{constructor(n,r,a,o,s,l){this.appRef=n,this.componentFactoryResolver=r,this.injector=a,this.document=o,this.defaultConfig=s,this.globalConfig=l,this.dialogs=[],this.dialogFactory=this.componentFactoryResolver.resolveComponentFactory(v52)}closeAll(){this.dialogs.forEach(n=>n.close())}success(n,r={}){const a=this.mergeConfigWithContent(this.applyDefaultSize(r),n);return this.open(a.success.component,a)}confirm(n,r={}){const a=this.mergeConfigWithContent(this.applyDefaultSize(r),n);return this.open(a.confirm.component,a)}error(n,r={}){const a=this.mergeConfigWithContent(this.applyDefaultSize(r),n);return this.open(a.error.component,a)}open(n,r={}){const a=this.mergeConfig(r);a.onOpen?.();const o=new J7({id:a.id,data:a.data,backdropClick$:new e1}),s={config:a,dialogRef:o};return this.throwIfIDAlreadyExists(a.id),this.dialogs.push(o),1===this.dialogs.length&&this.document.body.classList.add(VM),n instanceof r4?this.openTemplate(n,s):"function"==typeof n?this.openComponent(n,s):this.throwMustBeAComponentOrATemplateRef(n)}openTemplate(n,{config:r,dialogRef:a}){const o={$implicit:a,config:r},s=r.vcr?.createEmbeddedView(n,o)||n.createEmbeddedView(o);return this.attach({dialogRef:a,config:r,ref:n,view:s,attachToApp:!r.vcr})}openComponent(n,{config:r,dialogRef:a}){const s=this.componentFactoryResolver.resolveComponentFactory(n).create(v4.create({providers:[{provide:d0,useValue:a},{provide:p0,useValue:r}],parent:r.vcr?.injector||this.injector}));return this.attach({dialogRef:a,config:r,ref:s,view:s.hostView,attachToApp:!0})}attach({dialogRef:n,config:r,ref:a,view:o,attachToApp:s}){const l=this.createDialog(r,n,o),f=r.container instanceof P4?r.container.nativeElement:r.container,p={after:new e1};return n.mutate({id:r.id,data:r.data,ref:a,onClose:b=>{this.globalConfig.onClose?.(),this.dialogs=this.dialogs.filter(({id:w})=>n.id!==w),f.removeChild(l.location.nativeElement),this.appRef.detachView(l.hostView),this.appRef.detachView(o),l.destroy(),o.destroy(),n.backdropClick$.complete(),n.mutate({ref:null,onClose:null,afterClosed$:null,backdropClick$:null,beforeCloseGuards:null,onReset:null}),p.after.next(b),p.after.complete(),0===this.dialogs.length&&this.document.body.classList.remove(VM)},afterClosed$:p.after.asObservable(),onReset:b=>{l.instance.reset(b)}}),f.appendChild(l.location.nativeElement),this.appRef.attachView(l.hostView),s&&this.appRef.attachView(o),n.asDialogRef()}createDialog(n,r,a){return this.dialogFactory.create(v4.create({providers:[{provide:J7,useValue:r},{provide:p0,useValue:n},{provide:MM,useValue:a.rootNodes}],parent:this.injector}))}mergeConfig(n){return{...this.defaultConfig,id:`dialog-${Math.random().toString(36).substring(7)}`,...this.globalConfig,...this.cleanConfig(n),sizes:{...this.defaultConfig.sizes,...this.globalConfig?.sizes,...n?.sizes}}}mergeConfigWithContent(n,r){const{data:a,...o}=this.mergeConfig(n);return{...o,data:{...a,[Y7]:this.isTemplateOrString(r)?{title:null,body:{type:this.getTypeOfContent(r),content:r}}:Object.entries(r).reduce((s,[l,f])=>(s[l]={type:this.getTypeOfContent(f),content:f},s),{})}}}cleanConfig(n){return Object.entries(n).reduce((r,[a,o])=>(null!=o&&(r[a]=o),r),{})}isTemplateOrString(n){return n instanceof r4||"string"==typeof n}getTypeOfContent(n){return n instanceof r4?"template":"string"}throwMustBeAComponentOrATemplateRef(n){throw new TypeError(`Dialog must receive a Component or a TemplateRef, but this has been passed instead: ${n}`)}throwIfIDAlreadyExists(n){if(this.dialogs.find(r=>r.id===n))throw new Error(`Please, ID must be unique, but there is already a dialog created with this ID: ${n}`)}applyDefaultSize(n){return{...n,size:n.size||"sm"}}}return e.\u0275fac=function(n){return new(n||e)(V2(Pt),V2(pt),V2(v4),V2(vM),V2(p0),V2(yM))},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),M52=(()=>{class e{static forRoot(n={}){return{ngModule:e,providers:[{provide:yM,useValue:n}]}}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=k3({type:e}),e.\u0275inj=E({imports:[[jt]]}),e})();function L52(e,t){if(1&e&&(t2(0,"p"),x2(1),s2()),2&e){const n=t.$implicit;J(1),ce(" ",n," ")}}const e8=function(e){return{selected:e}};let SM=(()=>{class e{constructor(n,r){this.storyService=n,this.ref=r}get title(){return this.ref.data.title}get paragraphs(){return this.ref.data.paragraphs}get statValue(){return this.ref.data.variable?this.storyService.getVariableWithName(this.ref.data.variable):-1}}return e.\u0275fac=function(n){return new(n||e)(c2(Xt),c2(d0))},e.\u0275cmp=G1({type:e,selectors:[["ng-component"]],decls:19,vars:17,consts:[[1,"explanation"],[3,"ngClass"],[4,"ngFor","ngForOf"]],template:function(n,r){1&n&&(t2(0,"div")(1,"h1"),x2(2),s2(),t2(3,"p",0)(4,"span",1),x2(5,"1 - Ignorant"),s2(),x2(6," | "),t2(7,"span",1),x2(8,"2 - Unfamiliar"),s2(),x2(9," | "),t2(10,"span",1),x2(11,"3 - Novice"),s2(),x2(12," | "),t2(13,"span",1),x2(14,"4 - Beginner"),s2(),x2(15," | "),t2(16,"span",1),x2(17,"5 - Average"),s2()(),T2(18,L52,2,1,"p",2),s2()),2&n&&(J(2),Ae(r.title),J(2),X("ngClass",B3(7,e8,1==r.statValue)),J(3),X("ngClass",B3(9,e8,2==r.statValue)),J(3),X("ngClass",B3(11,e8,3==r.statValue)),J(3),X("ngClass",B3(13,e8,4==r.statValue)),J(3),X("ngClass",B3(15,e8,5==r.statValue)),J(2),X("ngForOf",r.paragraphs))},dependencies:[h6,Bt],styles:["p[_ngcontent-%COMP%]{font-size:18px}.explanation[_ngcontent-%COMP%]{font-size:16px;color:#999}.explanation[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{color:var(--accent1);font-weight:700}"],changeDetection:0}),e})();function bM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function n2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bM(Object(n),!0).forEach(function(r){S52(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function m0(e){return(m0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function zM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S52(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X7(e,t){return function w52(e){if(Array.isArray(e))return e}(e)||function x52(e,t){var n=null==e?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var s,l,r=[],a=!0,o=!1;try{for(n=n.call(e);!(a=(s=n.next()).done)&&(r.push(s.value),!t||r.length!==t);a=!0);}catch(f){o=!0,l=f}finally{try{!a&&null!=n.return&&n.return()}finally{if(o)throw l}}return r}}(e,t)||wM(e,t)||function E52(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v0(e){return function z52(e){if(Array.isArray(e))return Z7(e)}(e)||function _52(e){if(typeof Symbol<"u"&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||wM(e)||function D52(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wM(e,t){if(e){if("string"==typeof e)return Z7(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z7(e,t)}}function Z7(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _M=function(){},e9={},xM={},DM=null,EM={mark:_M,measure:_M};try{typeof window<"u"&&(e9=window),typeof document<"u"&&(xM=document),typeof MutationObserver<"u"&&(DM=MutationObserver),typeof performance<"u"&&(EM=performance)}catch{}var NM=(e9.navigator||{}).userAgent,kM=void 0===NM?"":NM,Oe=e9,v1=xM,TM=DM,y0=EM,he=!!v1.documentElement&&!!v1.head&&"function"==typeof v1.addEventListener&&"function"==typeof v1.createElement,AM=~kM.indexOf("MSIE")||~kM.indexOf("Trident/"),de="___FONT_AWESOME___",IM="svg-inline--fa",g6="data-fa-i2svg",n9="data-fa-pseudo-element",r9="data-prefix",a9="data-icon",FM="fontawesome-i2svg",A52=["HTML","HEAD","STYLE","SCRIPT"],OM=function(){try{return!0}catch{return!1}}(),i9={fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit",fa:"solid"},M0={solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"},RM={fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},P52={"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},I52=/fa[srltdbk]?[\-\ ]/,BM="fa-layers-text",F52=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Kit)?.*/i,O52={900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},WM=[1,2,3,4,5,6,7,8,9,10],R52=WM.concat([11,12,13,14,15,16,17,18,19,20]),B52=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],W52=[].concat(v0(Object.keys(M0)),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul","duotone-group","swap-opacity","primary","secondary"]).concat(WM.map(function(e){return"".concat(e,"x")})).concat(R52.map(function(e){return"w-".concat(e)})),jM=Oe.FontAwesomeConfig||{};v1&&"function"==typeof v1.querySelector&&[["data-family-prefix","familyPrefix"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(e){var t=X7(e,2),r=t[1],a=function U52(e){return""===e||"false"!==e&&("true"===e||e)}(function j52(e){var t=v1.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t[0]));null!=a&&(jM[r]=a)});var n8=n2(n2({},{familyPrefix:"fa",styleDefault:"solid",replacementClass:IM,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0}),jM);n8.autoReplaceSvg||(n8.observeMutations=!1);var h2={};Object.keys(n8).forEach(function(e){Object.defineProperty(h2,e,{enumerable:!0,set:function(n){n8[e]=n,L0.forEach(function(r){return r(h2)})},get:function(){return n8[e]}})}),Oe.FontAwesomeConfig=h2;var L0=[],W4={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function r8(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function _5(e){for(var t=[],n=(e||[]).length>>>0;n--;)t[n]=e[n];return t}function o9(e){return e.classList?_5(e.classList):(e.getAttribute("class")||"").split(" ").filter(function(t){return t})}function UM(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function V0(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,": ").concat(e[n].trim(),";")},"")}function s9(e){return e.size!==W4.size||e.x!==W4.x||e.y!==W4.y||e.rotate!==W4.rotate||e.flipX||e.flipY}function GM(){var e="fa",t=IM,n=h2.familyPrefix,r=h2.replacementClass,a=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0);\n          animation-delay: var(--fa-animation-delay, 0);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0);\n          animation-delay: var(--fa-animation-delay, 0);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0);\n          animation-delay: var(--fa-animation-delay, 0);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0);\n          animation-delay: var(--fa-animation-delay, 0);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0);\n          animation-delay: var(--fa-animation-delay, 0);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0);\n          animation-delay: var(--fa-animation-delay, 0);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0);\n          animation-delay: var(--fa-animation-delay, 0);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    transition-delay: 0s;\n    transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';if(n!==e||r!==t){var o=new RegExp("\\.".concat(e,"\\-"),"g"),s=new RegExp("\\--".concat(e,"\\-"),"g"),l=new RegExp("\\.".concat(t),"g");a=a.replace(o,".".concat(n,"-")).replace(s,"--".concat(n,"-")).replace(l,".".concat(r))}return a}var qM=!1;function c9(){h2.autoAddCss&&!qM&&(function K52(e){if(e&&he){var t=v1.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=v1.head.childNodes,r=null,a=n.length-1;a>-1;a--){var o=n[a],s=(o.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(s)>-1&&(r=o)}v1.head.insertBefore(t,r)}}(GM()),qM=!0)}var et2={mixout:function(){return{dom:{css:GM,insertCss:c9}}},hooks:function(){return{beforeDOMElementCreation:function(){c9()},beforeI2svg:function(){c9()}}}},pe=Oe||{};pe[de]||(pe[de]={}),pe[de].styles||(pe[de].styles={}),pe[de].hooks||(pe[de].hooks={}),pe[de].shims||(pe[de].shims=[]);var b4=pe[de],$M=[],H0=!1;function nt2(e){!he||(H0?setTimeout(e,0):$M.push(e))}function a8(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,a=e.children,o=void 0===a?[]:a;return"string"==typeof e?UM(e):"<".concat(t," ").concat(function Y52(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,'="').concat(UM(e[n]),'" ')},"").trim()}(r),">").concat(o.map(a8).join(""),"</").concat(t,">")}function KM(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}he&&((H0=(v1.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(v1.readyState))||v1.addEventListener("DOMContentLoaded",function e(){v1.removeEventListener("DOMContentLoaded",e),H0=1,$M.map(function(t){return t()})}));var l9=function(t,n,r,a){var f,p,y,o=Object.keys(t),s=o.length,l=void 0!==a?function(t,n){return function(r,a,o,s){return t.call(n,r,a,o,s)}}(n,a):n;for(void 0===r?(f=1,y=t[o[0]]):(f=0,y=r);f<s;f++)y=l(y,t[p=o[f]],p,t);return y};function u9(e){var t=function at2(e){for(var t=[],n=0,r=e.length;n<r;){var a=e.charCodeAt(n++);if(a>=55296&&a<=56319&&n<r){var o=e.charCodeAt(n++);56320==(64512&o)?t.push(((1023&a)<<10)+(1023&o)+65536):(t.push(a),n--)}else t.push(a)}return t}(e);return 1===t.length?t[0].toString(16):null}function QM(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return r.icon?t[r.iconName]=r.icon:t[n]=r,t},{})}function C9(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,a=void 0!==r&&r,o=QM(t);"function"!=typeof b4.hooks.addPack||a?b4.styles[e]=n2(n2({},b4.styles[e]||{}),o):b4.hooks.addPack(e,QM(t)),"fas"===e&&C9("fa",t)}var i8=b4.styles,ot2=b4.shims,st2=Object.values(RM),f9=null,YM={},JM={},XM={},ZM={},eL={},ct2=Object.keys(i9);function ut2(e,t){var n=t.split("-"),r=n[0],a=n.slice(1).join("-");return r!==e||""===a||function lt2(e){return~W52.indexOf(e)}(a)?null:a}var tL=function(){var t=function(o){return l9(i8,function(s,l,f){return s[f]=l9(l,o,{}),s},{})};YM=t(function(a,o,s){return o[3]&&(a[o[3]]=s),o[2]&&o[2].filter(function(f){return"number"==typeof f}).forEach(function(f){a[f.toString(16)]=s}),a}),JM=t(function(a,o,s){return a[s]=s,o[2]&&o[2].filter(function(f){return"string"==typeof f}).forEach(function(f){a[f]=s}),a}),eL=t(function(a,o,s){var l=o[2];return a[s]=s,l.forEach(function(f){a[f]=s}),a});var n="far"in i8||h2.autoFetchSvg,r=l9(ot2,function(a,o){var s=o[0],l=o[1],f=o[2];return"far"===l&&!n&&(l="fas"),"string"==typeof s&&(a.names[s]={prefix:l,iconName:f}),"number"==typeof s&&(a.unicodes[s.toString(16)]={prefix:l,iconName:f}),a},{names:{},unicodes:{}});XM=r.names,ZM=r.unicodes,f9=S0(h2.styleDefault)};function h9(e,t){return(YM[e]||{})[t]}function x5(e,t){return(eL[e]||{})[t]}function nL(e){return XM[e]||{prefix:null,iconName:null}}function Be(){return f9}function S0(e){return M0[e]||M0[i9[e]]||(e in b4.styles?e:null)||null}function b0(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.skipLookups,r=void 0!==n&&n,a=null,o=e.reduce(function(s,l){var f=ut2(h2.familyPrefix,l);if(i8[l]?(l=st2.includes(l)?P52[l]:l,a=l,s.prefix=l):ct2.indexOf(l)>-1?(a=l,s.prefix=S0(l)):f?s.iconName=f:l!==h2.replacementClass&&s.rest.push(l),!r&&s.prefix&&s.iconName){var p="fa"===a?nL(s.iconName):{},y=x5(s.prefix,s.iconName);p.prefix&&(a=null),s.iconName=p.iconName||y||s.iconName,s.prefix=p.prefix||s.prefix,"far"===s.prefix&&!i8.far&&i8.fas&&!h2.autoFetchSvg&&(s.prefix="fas")}return s},{prefix:null,iconName:null,rest:[]});return("fa"===o.prefix||"fa"===a)&&(o.prefix=Be()||"fas"),o}(function $52(e){L0.push(e)})(function(e){f9=S0(e.styleDefault)}),tL();var ht2=function(){function e(){(function V52(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.definitions={}}return function H52(e,t,n){t&&zM(e.prototype,t),n&&zM(e,n),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"add",value:function(){for(var n=this,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];var s=a.reduce(this._pullDefinitions,{});Object.keys(s).forEach(function(l){n.definitions[l]=n2(n2({},n.definitions[l]||{}),s[l]),C9(l,s[l]);var f=RM[l];f&&C9(f,s[l]),tL()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(n,r){var a=r.prefix&&r.iconName&&r.icon?{0:r}:r;return Object.keys(a).map(function(o){var s=a[o],l=s.prefix,f=s.iconName,p=s.icon,y=p[2];n[l]||(n[l]={}),y.length>0&&y.forEach(function(V){"string"==typeof V&&(n[l][V]=p)}),n[l][f]=p}),n}}]),e}(),rL=[],D5={},E5={},dt2=Object.keys(E5);function p9(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var o=D5[e]||[];return o.forEach(function(s){t=s.apply(null,[t].concat(r))}),t}function y6(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=D5[e]||[];a.forEach(function(o){o.apply(null,n)})}function me(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);return E5[e]?E5[e].apply(null,t):void 0}function m9(e){"fa"===e.prefix&&(e.prefix="fas");var t=e.iconName,n=e.prefix||Be();if(t)return t=x5(n,t)||t,KM(aL.definitions,n,t)||KM(b4.styles,n,t)}var aL=new ht2,gt2={i2svg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return he?(y6("beforeI2svg",t),me("pseudoElements2svg",t),me("i2svg",t)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.autoReplaceSvgRoot;!1===h2.autoReplaceSvg&&(h2.autoReplaceSvg=!0),h2.observeMutations=!0,nt2(function(){yt2({autoReplaceSvgRoot:n}),y6("watch",t)})}},j3={noAuto:function(){h2.autoReplaceSvg=!1,h2.observeMutations=!1,y6("noAuto")},config:h2,dom:gt2,parse:{icon:function(t){if(null===t)return null;if("object"===m0(t)&&t.prefix&&t.iconName)return{prefix:t.prefix,iconName:x5(t.prefix,t.iconName)||t.iconName};if(Array.isArray(t)&&2===t.length){var n=0===t[1].indexOf("fa-")?t[1].slice(3):t[1],r=S0(t[0]);return{prefix:r,iconName:x5(r,n)||n}}if("string"==typeof t&&(t.indexOf("".concat(h2.familyPrefix,"-"))>-1||t.match(I52))){var a=b0(t.split(" "),{skipLookups:!0});return{prefix:a.prefix||Be(),iconName:x5(a.prefix,a.iconName)||a.iconName}}if("string"==typeof t){var o=Be();return{prefix:o,iconName:x5(o,t)||t}}}},library:aL,findIconDefinition:m9,toHtml:a8},yt2=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.autoReplaceSvgRoot,r=void 0===n?v1:n;(Object.keys(b4.styles).length>0||h2.autoFetchSvg)&&he&&h2.autoReplaceSvg&&j3.dom.i2svg({node:r})};function z0(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(function(r){return a8(r)})}}),Object.defineProperty(e,"node",{get:function(){if(he){var r=v1.createElement("div");return r.innerHTML=e.html,r.children}}}),e}function g9(e){var t=e.icons,n=t.main,r=t.mask,a=e.prefix,o=e.iconName,s=e.transform,l=e.symbol,f=e.title,p=e.maskId,y=e.titleId,V=e.extra,b=e.watchable,w=void 0!==b&&b,x=r.found?r:n,D=x.width,T=x.height,F="fak"===a,U=[h2.replacementClass,o?"".concat(h2.familyPrefix,"-").concat(o):""].filter(function(A1){return-1===V.classes.indexOf(A1)}).filter(function(A1){return""!==A1||!!A1}).concat(V.classes).join(" "),k={children:[],attributes:n2(n2({},V.attributes),{},{"data-prefix":a,"data-icon":o,class:U,role:V.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(D," ").concat(T)})},G=F&&!~V.classes.indexOf("fa-fw")?{width:"".concat(D/T*16*.0625,"em")}:{};w&&(k.attributes[g6]=""),f&&(k.children.push({tag:"title",attributes:{id:k.attributes["aria-labelledby"]||"title-".concat(y||r8())},children:[f]}),delete k.attributes.title);var l2=n2(n2({},k),{},{prefix:a,iconName:o,main:n,mask:r,maskId:p,transform:s,symbol:l,styles:n2(n2({},G),V.styles)}),S2=r.found&&n.found?me("generateAbstractMask",l2)||{children:[],attributes:{}}:me("generateAbstractIcon",l2)||{children:[],attributes:{}},j1=S2.attributes;return l2.children=S2.children,l2.attributes=j1,l?function Lt2(e){var n=e.iconName,r=e.children,a=e.attributes,o=e.symbol,s=!0===o?"".concat(e.prefix,"-").concat(h2.familyPrefix,"-").concat(n):o;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:n2(n2({},a),{},{id:s}),children:r}]}]}(l2):function Mt2(e){var t=e.children,n=e.main,r=e.mask,a=e.attributes,o=e.styles,s=e.transform;if(s9(s)&&n.found&&!r.found){var p={x:n.width/n.height/2,y:.5};a.style=V0(n2(n2({},o),{},{"transform-origin":"".concat(p.x+s.x/16,"em ").concat(p.y+s.y/16,"em")}))}return[{tag:"svg",attributes:a,children:t}]}(l2)}function iL(e){var t=e.content,n=e.width,r=e.height,a=e.transform,o=e.title,s=e.extra,l=e.watchable,f=void 0!==l&&l,p=n2(n2(n2({},s.attributes),o?{title:o}:{}),{},{class:s.classes.join(" ")});f&&(p[g6]="");var y=n2({},s.styles);s9(a)&&(y.transform=function X52(e){var t=e.transform,n=e.width,a=e.height,o=void 0===a?16:a,s=e.startCentered,l=void 0!==s&&s,f="";return f+=l&&AM?"translate(".concat(t.x/16-(void 0===n?16:n)/2,"em, ").concat(t.y/16-o/2,"em) "):l?"translate(calc(-50% + ".concat(t.x/16,"em), calc(-50% + ").concat(t.y/16,"em)) "):"translate(".concat(t.x/16,"em, ").concat(t.y/16,"em) "),(f+="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "))+"rotate(".concat(t.rotate,"deg) ")}({transform:a,startCentered:!0,width:n,height:r}),y["-webkit-transform"]=y.transform);var V=V0(y);V.length>0&&(p.style=V);var b=[];return b.push({tag:"span",attributes:p,children:[t]}),o&&b.push({tag:"span",attributes:{class:"sr-only"},children:[o]}),b}function Vt2(e){var t=e.content,n=e.title,r=e.extra,a=n2(n2(n2({},r.attributes),n?{title:n}:{}),{},{class:r.classes.join(" ")}),o=V0(r.styles);o.length>0&&(a.style=o);var s=[];return s.push({tag:"span",attributes:a,children:[t]}),n&&s.push({tag:"span",attributes:{class:"sr-only"},children:[n]}),s}var v9=b4.styles;function y9(e){var t=e[0],n=e[1],o=X7(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(o)?{tag:"g",attributes:{class:"".concat(h2.familyPrefix,"-").concat("duotone-group")},children:[{tag:"path",attributes:{class:"".concat(h2.familyPrefix,"-").concat("secondary"),fill:"currentColor",d:o[0]}},{tag:"path",attributes:{class:"".concat(h2.familyPrefix,"-").concat("primary"),fill:"currentColor",d:o[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:o}}}}var Ht2={found:!1,width:512,height:512};function M9(e,t){var n=t;return"fa"===t&&null!==h2.styleDefault&&(t=Be()),new Promise(function(r,a){if(me("missingIconAbstract"),"fa"===n){var s=nL(e)||{};e=s.iconName||e,t=s.prefix||t}if(e&&t&&v9[t]&&v9[t][e])return r(y9(v9[t][e]));(function St2(e,t){!OM&&!h2.showMissingIcons&&e&&console.error('Icon with name "'.concat(e,'" and prefix "').concat(t,'" is missing.'))})(e,t),r(n2(n2({},Ht2),{},{icon:h2.showMissingIcons&&e&&me("missingIconAbstract")||{}}))})}var oL=function(){},L9=h2.measurePerformance&&y0&&y0.mark&&y0.measure?y0:{mark:oL,measure:oL},o8='FA "6.1.2"',V9_begin=function(t){return L9.mark("".concat(o8," ").concat(t," begins")),function(){return function(t){L9.mark("".concat(o8," ").concat(t," ends")),L9.measure("".concat(o8," ").concat(t),"".concat(o8," ").concat(t," begins"),"".concat(o8," ").concat(t," ends"))}(t)}},w0=function(){};function cL(e){return"string"==typeof(e.getAttribute?e.getAttribute(g6):null)}function xt2(e){return v1.createElementNS("http://www.w3.org/2000/svg",e)}function Dt2(e){return v1.createElement(e)}function lL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.ceFn,r=void 0===n?"svg"===e.tag?xt2:Dt2:n;if("string"==typeof e)return v1.createTextNode(e);var a=r(e.tag);Object.keys(e.attributes||[]).forEach(function(s){a.setAttribute(s,e.attributes[s])});var o=e.children||[];return o.forEach(function(s){a.appendChild(lL(s,{ceFn:r}))}),a}var _0={replace:function(t){var n=t[0];if(n.parentNode)if(t[1].forEach(function(a){n.parentNode.insertBefore(lL(a),n)}),null===n.getAttribute(g6)&&h2.keepOriginalSource){var r=v1.createComment(function Et2(e){var t=" ".concat(e.outerHTML," ");return"".concat(t,"Font Awesome fontawesome.com ")}(n));n.parentNode.replaceChild(r,n)}else n.remove()},nest:function(t){var n=t[0],r=t[1];if(~o9(n).indexOf(h2.replacementClass))return _0.replace(t);var a=new RegExp("".concat(h2.familyPrefix,"-.*"));if(delete r[0].attributes.id,r[0].attributes.class){var o=r[0].attributes.class.split(" ").reduce(function(l,f){return f===h2.replacementClass||f.match(a)?l.toSvg.push(f):l.toNode.push(f),l},{toNode:[],toSvg:[]});r[0].attributes.class=o.toSvg.join(" "),0===o.toNode.length?n.removeAttribute("class"):n.setAttribute("class",o.toNode.join(" "))}var s=r.map(function(l){return a8(l)}).join("\n");n.setAttribute(g6,""),n.innerHTML=s}};function uL(e){e()}function CL(e,t){var n="function"==typeof t?t:w0;if(0===e.length)n();else{var r=uL;"async"===h2.mutateApproach&&(r=Oe.requestAnimationFrame||uL),r(function(){var a=function _t2(){return!0===h2.autoReplaceSvg?_0.replace:_0[h2.autoReplaceSvg]||_0.replace}(),o=V9_begin("mutate");e.map(a),o(),n()})}}var H9=!1;function fL(){H9=!0}function S9(){H9=!1}var x0=null;function hL(e){if(TM&&h2.observeMutations){var t=e.treeCallback,n=void 0===t?w0:t,r=e.nodeCallback,a=void 0===r?w0:r,o=e.pseudoElementsCallback,s=void 0===o?w0:o,l=e.observeMutationsRoot,f=void 0===l?v1:l;x0=new TM(function(p){if(!H9){var y=Be();_5(p).forEach(function(V){if("childList"===V.type&&V.addedNodes.length>0&&!cL(V.addedNodes[0])&&(h2.searchPseudoElements&&s(V.target),n(V.target)),"attributes"===V.type&&V.target.parentNode&&h2.searchPseudoElements&&s(V.target.parentNode),"attributes"===V.type&&cL(V.target)&&~B52.indexOf(V.attributeName))if("class"===V.attributeName&&function zt2(e){var t=e.getAttribute?e.getAttribute(r9):null,n=e.getAttribute?e.getAttribute(a9):null;return t&&n}(V.target)){var b=b0(o9(V.target)),x=b.iconName;V.target.setAttribute(r9,b.prefix||y),x&&V.target.setAttribute(a9,x)}else(function wt2(e){return e&&e.classList&&e.classList.contains&&e.classList.contains(h2.replacementClass)})(V.target)&&a(V.target)})}}),he&&x0.observe(f,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function kt2(e){var t=e.getAttribute("style"),n=[];return t&&(n=t.split(";").reduce(function(r,a){var o=a.split(":"),s=o[0],l=o.slice(1);return s&&l.length>0&&(r[s]=l.join(":").trim()),r},{})),n}function Tt2(e){var t=e.getAttribute("data-prefix"),n=e.getAttribute("data-icon"),r=void 0!==e.innerText?e.innerText.trim():"",a=b0(o9(e));return a.prefix||(a.prefix=Be()),t&&n&&(a.prefix=t,a.iconName=n),a.iconName&&a.prefix||(a.prefix&&r.length>0&&(a.iconName=function Ct2(e,t){return(JM[e]||{})[t]}(a.prefix,e.innerText)||h9(a.prefix,u9(e.innerText))),!a.iconName&&h2.autoFetchSvg&&e.firstChild&&e.firstChild.nodeType===Node.TEXT_NODE&&(a.iconName=e.firstChild.data)),a}function At2(e){var t=_5(e.attributes).reduce(function(a,o){return"class"!==a.name&&"style"!==a.name&&(a[o.name]=o.value),a},{}),n=e.getAttribute("title"),r=e.getAttribute("data-fa-title-id");return h2.autoA11y&&(n?t["aria-labelledby"]="".concat(h2.replacementClass,"-title-").concat(r||r8()):(t["aria-hidden"]="true",t.focusable="false")),t}function dL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},n=Tt2(e),r=n.iconName,a=n.prefix,o=n.rest,s=At2(e),l=p9("parseNodeAttributes",{},e),f=t.styleParser?kt2(e):[];return n2({iconName:r,title:e.getAttribute("title"),titleId:e.getAttribute("data-fa-title-id"),prefix:a,transform:W4,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:o,styles:f,attributes:s}},l)}var It2=b4.styles;function pL(e){var t="nest"===h2.autoReplaceSvg?dL(e,{styleParser:!1}):dL(e);return~t.extra.classes.indexOf(BM)?me("generateLayersText",e,t):me("generateSvgReplacementMutation",e,t)}function mL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!he)return Promise.resolve();var n=v1.documentElement.classList,r=function(V){return n.add("".concat(FM,"-").concat(V))},a=function(V){return n.remove("".concat(FM,"-").concat(V))},o=Object.keys(h2.autoFetchSvg?i9:It2);o.includes("fa")||o.push("fa");var s=[".".concat(BM,":not([").concat(g6,"])")].concat(o.map(function(y){return".".concat(y,":not([").concat(g6,"])")})).join(", ");if(0===s.length)return Promise.resolve();var l=[];try{l=_5(e.querySelectorAll(s))}catch{}if(!(l.length>0))return Promise.resolve();r("pending"),a("complete");var f=V9_begin("onTree"),p=l.reduce(function(y,V){try{var b=pL(V);b&&y.push(b)}catch(w){OM||"MissingIcon"===w.name&&console.error(w)}return y},[]);return new Promise(function(y,V){Promise.all(p).then(function(b){CL(b,function(){r("active"),r("complete"),a("pending"),"function"==typeof t&&t(),f(),y()})}).catch(function(b){f(),V(b)})})}function Ft2(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;pL(e).then(function(n){n&&CL([n],t)})}var Rt2=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.transform,a=void 0===r?W4:r,o=n.symbol,s=void 0!==o&&o,l=n.mask,f=void 0===l?null:l,p=n.maskId,y=void 0===p?null:p,V=n.title,b=void 0===V?null:V,w=n.titleId,x=void 0===w?null:w,D=n.classes,T=void 0===D?[]:D,F=n.attributes,U=void 0===F?{}:F,k=n.styles,G=void 0===k?{}:k;if(t){var l2=t.prefix,S2=t.iconName,i1=t.icon;return z0(n2({type:"icon"},t),function(){return y6("beforeDOMElementCreation",{iconDefinition:t,params:n}),h2.autoA11y&&(b?U["aria-labelledby"]="".concat(h2.replacementClass,"-title-").concat(x||r8()):(U["aria-hidden"]="true",U.focusable="false")),g9({icons:{main:y9(i1),mask:f?y9(f.icon):{found:!1,width:null,height:null,icon:{}}},prefix:l2,iconName:S2,transform:n2(n2({},W4),a),symbol:s,title:b,maskId:y,titleId:x,extra:{attributes:U,styles:G,classes:T}})})}},Bt2={mixout:function(){return{icon:(e=Rt2,function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:m9(t||{}),a=n.mask;return a&&(a=(a||{}).icon?a:m9(a||{})),e(r,n2(n2({},n),{},{mask:a}))})};var e},hooks:function(){return{mutationObserverCallbacks:function(n){return n.treeCallback=mL,n.nodeCallback=Ft2,n}}},provides:function(t){t.i2svg=function(n){var r=n.node,o=n.callback;return mL(void 0===r?v1:r,void 0===o?function(){}:o)},t.generateSvgReplacementMutation=function(n,r){var a=r.iconName,o=r.title,s=r.titleId,l=r.prefix,f=r.transform,p=r.symbol,y=r.mask,V=r.maskId,b=r.extra;return new Promise(function(w,x){Promise.all([M9(a,l),y.iconName?M9(y.iconName,y.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(D){var T=X7(D,2);w([n,g9({icons:{main:T[0],mask:T[1]},prefix:l,iconName:a,transform:f,symbol:p,maskId:V,title:o,titleId:s,extra:b,watchable:!0})])}).catch(x)})},t.generateAbstractIcon=function(n){var p,r=n.children,a=n.attributes,o=n.main,s=n.transform,f=V0(n.styles);return f.length>0&&(a.style=f),s9(s)&&(p=me("generateAbstractTransformGrouping",{main:o,transform:s,containerWidth:o.width,iconWidth:o.width})),r.push(p||o.icon),{children:r,attributes:a}}}},Wt2={mixout:function(){return{layer:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.classes,o=void 0===a?[]:a;return z0({type:"layer"},function(){y6("beforeDOMElementCreation",{assembler:n,params:r});var s=[];return n(function(l){Array.isArray(l)?l.map(function(f){s=s.concat(f.abstract)}):s=s.concat(l.abstract)}),[{tag:"span",attributes:{class:["".concat(h2.familyPrefix,"-layers")].concat(v0(o)).join(" ")},children:s}]})}}}},jt2={mixout:function(){return{counter:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.title,o=void 0===a?null:a,s=r.classes,l=void 0===s?[]:s,f=r.attributes,p=void 0===f?{}:f,y=r.styles,V=void 0===y?{}:y;return z0({type:"counter",content:n},function(){return y6("beforeDOMElementCreation",{content:n,params:r}),Vt2({content:n.toString(),title:o,extra:{attributes:p,styles:V,classes:["".concat(h2.familyPrefix,"-layers-counter")].concat(v0(l))}})})}}}},Ut2={mixout:function(){return{text:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.transform,o=void 0===a?W4:a,s=r.title,l=void 0===s?null:s,f=r.classes,p=void 0===f?[]:f,y=r.attributes,V=void 0===y?{}:y,b=r.styles,w=void 0===b?{}:b;return z0({type:"text",content:n},function(){return y6("beforeDOMElementCreation",{content:n,params:r}),iL({content:n,transform:n2(n2({},W4),o),title:l,extra:{attributes:V,styles:w,classes:["".concat(h2.familyPrefix,"-layers-text")].concat(v0(p))}})})}}},provides:function(t){t.generateLayersText=function(n,r){var a=r.title,o=r.transform,s=r.extra,l=null,f=null;if(AM){var p=parseInt(getComputedStyle(n).fontSize,10),y=n.getBoundingClientRect();l=y.width/p,f=y.height/p}return h2.autoA11y&&!a&&(s.attributes["aria-hidden"]="true"),Promise.resolve([n,iL({content:n.innerHTML,width:l,height:f,transform:o,title:a,extra:s,watchable:!0})])}}},Gt2=new RegExp('"',"ug"),gL=[1105920,1112319];function vL(e,t){var n="".concat("data-fa-pseudo-element-pending").concat(t.replace(":","-"));return new Promise(function(r,a){if(null!==e.getAttribute(n))return r();var s=_5(e.children).filter(function(S2){return S2.getAttribute(n9)===t})[0],l=Oe.getComputedStyle(e,t),f=l.getPropertyValue("font-family").match(F52),p=l.getPropertyValue("font-weight"),y=l.getPropertyValue("content");if(s&&!f)return e.removeChild(s),r();if(f&&"none"!==y&&""!==y){var V=l.getPropertyValue("content"),b=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(f[2])?M0[f[2].toLowerCase()]:O52[p],w=function qt2(e){var t=e.replace(Gt2,""),n=function it2(e,t){var a,n=e.length,r=e.charCodeAt(t);return r>=55296&&r<=56319&&n>t+1&&(a=e.charCodeAt(t+1))>=56320&&a<=57343?1024*(r-55296)+a-56320+65536:r}(t,0),r=n>=gL[0]&&n<=gL[1],a=2===t.length&&t[0]===t[1];return{value:u9(a?t[0]:t),isSecondary:r||a}}(V),x=w.value,D=w.isSecondary,T=f[0].startsWith("FontAwesome"),F=h9(b,x),U=F;if(T){var k=function ft2(e){var t=ZM[e],n=h9("fas",e);return t||(n?{prefix:"fas",iconName:n}:null)||{prefix:null,iconName:null}}(x);k.iconName&&k.prefix&&(F=k.iconName,b=k.prefix)}if(!F||D||s&&s.getAttribute(r9)===b&&s.getAttribute(a9)===U)r();else{e.setAttribute(n,U),s&&e.removeChild(s);var G=function Pt2(){return{iconName:null,title:null,titleId:null,prefix:null,transform:W4,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),l2=G.extra;l2.attributes[n9]=t,M9(F,b).then(function(S2){var i1=g9(n2(n2({},G),{},{icons:{main:S2,mask:{prefix:null,iconName:null,rest:[]}},prefix:b,iconName:U,extra:l2,watchable:!0})),j1=v1.createElement("svg");"::before"===t?e.insertBefore(j1,e.firstChild):e.appendChild(j1),j1.outerHTML=i1.map(function(A1){return a8(A1)}).join("\n"),e.removeAttribute(n),r()}).catch(a)}}else r()})}function $t2(e){return Promise.all([vL(e,"::before"),vL(e,"::after")])}function Kt2(e){return!(e.parentNode===document.head||~A52.indexOf(e.tagName.toUpperCase())||e.getAttribute(n9)||e.parentNode&&"svg"===e.parentNode.tagName)}function yL(e){if(he)return new Promise(function(t,n){var r=_5(e.querySelectorAll("*")).filter(Kt2).map($t2),a=V9_begin("searchPseudoElements");fL(),Promise.all(r).then(function(){a(),S9(),t()}).catch(function(){a(),S9(),n()})})}var ML=!1,LL=function(t){return t.toLowerCase().split(" ").reduce(function(r,a){var o=a.toLowerCase().split("-"),s=o[0],l=o.slice(1).join("-");if(s&&"h"===l)return r.flipX=!0,r;if(s&&"v"===l)return r.flipY=!0,r;if(l=parseFloat(l),isNaN(l))return r;switch(s){case"grow":r.size=r.size+l;break;case"shrink":r.size=r.size-l;break;case"left":r.x=r.x-l;break;case"right":r.x=r.x+l;break;case"up":r.y=r.y-l;break;case"down":r.y=r.y+l;break;case"rotate":r.rotate=r.rotate+l}return r},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},b9={x:0,y:0,width:"100%",height:"100%"};function VL(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}!function pt2(e,t){var n=t.mixoutsTo;rL=e,D5={},Object.keys(E5).forEach(function(r){-1===dt2.indexOf(r)&&delete E5[r]}),rL.forEach(function(r){var a=r.mixout?r.mixout():{};if(Object.keys(a).forEach(function(s){"function"==typeof a[s]&&(n[s]=a[s]),"object"===m0(a[s])&&Object.keys(a[s]).forEach(function(l){n[s]||(n[s]={}),n[s][l]=a[s][l]})}),r.hooks){var o=r.hooks();Object.keys(o).forEach(function(s){D5[s]||(D5[s]=[]),D5[s].push(o[s])})}r.provides&&r.provides(E5)})}([et2,Bt2,Wt2,jt2,Ut2,{hooks:function(){return{mutationObserverCallbacks:function(n){return n.pseudoElementsCallback=yL,n}}},provides:function(t){t.pseudoElements2svg=function(n){var r=n.node;h2.searchPseudoElements&&yL(void 0===r?v1:r)}}},{mixout:function(){return{dom:{unwatch:function(){fL(),ML=!0}}}},hooks:function(){return{bootstrap:function(){hL(p9("mutationObserverCallbacks",{}))},noAuto:function(){!function Nt2(){!x0||x0.disconnect()}()},watch:function(n){var r=n.observeMutationsRoot;ML?S9():hL(p9("mutationObserverCallbacks",{observeMutationsRoot:r}))}}}},{mixout:function(){return{parse:{transform:function(n){return LL(n)}}}},hooks:function(){return{parseNodeAttributes:function(n,r){var a=r.getAttribute("data-fa-transform");return a&&(n.transform=LL(a)),n}}},provides:function(t){t.generateAbstractTransformGrouping=function(n){var r=n.main,a=n.transform,s=n.iconWidth,l={transform:"translate(".concat(n.containerWidth/2," 256)")},f="translate(".concat(32*a.x,", ").concat(32*a.y,") "),p="scale(".concat(a.size/16*(a.flipX?-1:1),", ").concat(a.size/16*(a.flipY?-1:1),") "),y="rotate(".concat(a.rotate," 0 0)"),w={outer:l,inner:{transform:"".concat(f," ").concat(p," ").concat(y)},path:{transform:"translate(".concat(s/2*-1," -256)")}};return{tag:"g",attributes:n2({},w.outer),children:[{tag:"g",attributes:n2({},w.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:n2(n2({},r.icon.attributes),w.path)}]}]}}}},{hooks:function(){return{parseNodeAttributes:function(n,r){var a=r.getAttribute("data-fa-mask"),o=a?b0(a.split(" ").map(function(s){return s.trim()})):{prefix:null,iconName:null,rest:[]};return o.prefix||(o.prefix=Be()),n.mask=o,n.maskId=r.getAttribute("data-fa-mask-id"),n}}},provides:function(t){t.generateAbstractMask=function(n){var e,r=n.children,a=n.attributes,o=n.main,s=n.mask,l=n.maskId,y=o.icon,b=s.icon,w=function J52(e){var t=e.transform,r=e.iconWidth,a={transform:"translate(".concat(e.containerWidth/2," 256)")},o="translate(".concat(32*t.x,", ").concat(32*t.y,") "),s="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),l="rotate(".concat(t.rotate," 0 0)");return{outer:a,inner:{transform:"".concat(o," ").concat(s," ").concat(l)},path:{transform:"translate(".concat(r/2*-1," -256)")}}}({transform:n.transform,containerWidth:s.width,iconWidth:o.width}),x={tag:"rect",attributes:n2(n2({},b9),{},{fill:"white"})},D=y.children?{children:y.children.map(VL)}:{},T={tag:"g",attributes:n2({},w.inner),children:[VL(n2({tag:y.tag,attributes:n2(n2({},y.attributes),w.path)},D))]},F={tag:"g",attributes:n2({},w.outer),children:[T]},U="mask-".concat(l||r8()),k="clip-".concat(l||r8()),G={tag:"mask",attributes:n2(n2({},b9),{},{id:U,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[x,F]},l2={tag:"defs",children:[{tag:"clipPath",attributes:{id:k},children:(e=b,"g"===e.tag?e.children:[e])},G]};return r.push(l2,{tag:"rect",attributes:n2({fill:"currentColor","clip-path":"url(#".concat(k,")"),mask:"url(#".concat(U,")")},b9)}),{children:r,attributes:a}}}},{provides:function(t){var n=!1;Oe.matchMedia&&(n=Oe.matchMedia("(prefers-reduced-motion: reduce)").matches),t.missingIconAbstract=function(){var r=[],a={fill:"currentColor"},o={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};r.push({tag:"path",attributes:n2(n2({},a),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var s=n2(n2({},o),{},{attributeName:"opacity"}),l={tag:"circle",attributes:n2(n2({},a),{},{cx:"256",cy:"364",r:"28"}),children:[]};return n||l.children.push({tag:"animate",attributes:n2(n2({},o),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:n2(n2({},s),{},{values:"1;0;1;1;0;1;"})}),r.push(l),r.push({tag:"path",attributes:n2(n2({},a),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:n?[]:[{tag:"animate",attributes:n2(n2({},s),{},{values:"1;0;0;0;0;1;"})}]}),n||r.push({tag:"path",attributes:n2(n2({},a),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:n2(n2({},s),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:r}}}},{hooks:function(){return{parseNodeAttributes:function(n,r){var a=r.getAttribute("data-fa-symbol");return n.symbol=null!==a&&(""===a||a),n}}}}],{mixoutsTo:j3});var r82=j3.parse,a82=j3.icon;const i82=["*"],c82=e=>{const t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-inverse":e.inverse,"fa-layers-counter":e.counter,"fa-flip-horizontal":"horizontal"===e.flip||"both"===e.flip,"fa-flip-vertical":"vertical"===e.flip||"both"===e.flip,[`fa-${e.size}`]:null!==e.size,[`fa-rotate-${e.rotate}`]:null!==e.rotate,[`fa-pull-${e.pull}`]:null!==e.pull,[`fa-stack-${e.stackItemSize}`]:null!=e.stackItemSize};return Object.keys(t).map(n=>t[n]?n:null).filter(n=>n)};let C82=(()=>{class e{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),f82=(()=>{class e{constructor(){this.definitions={}}addIcons(...n){for(const r of n){r.prefix in this.definitions||(this.definitions[r.prefix]={}),this.definitions[r.prefix][r.iconName]=r;for(const a of r.icon[2])"string"==typeof a&&(this.definitions[r.prefix][a]=r)}}addIconPacks(...n){for(const r of n){const a=Object.keys(r).map(o=>r[o]);this.addIcons(...a)}}getIconDefinition(n,r){return n in this.definitions&&r in this.definitions[n]?this.definitions[n][r]:null}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),h82=(()=>{class e{constructor(){this.stackItemSize="1x"}ngOnChanges(n){if("size"in n)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=q1({type:e,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[we]}),e})(),d82=(()=>{class e{constructor(n,r){this.renderer=n,this.elementRef=r}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(n){"size"in n&&(null!=n.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${n.size.currentValue}`),null!=n.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${n.size.previousValue}`))}}return e.\u0275fac=function(n){return new(n||e)(c2(Z8),c2(P4))},e.\u0275cmp=G1({type:e,selectors:[["fa-stack"]],inputs:{size:"size"},features:[we],ngContentSelectors:i82,decls:1,vars:0,template:function(n,r){1&n&&(Xa(),mn(0))},encapsulation:2}),e})(),z9=(()=>{class e{constructor(n,r,a,o,s){this.sanitizer=n,this.config=r,this.iconLibrary=a,this.stackItem=o,this.classes=[],null!=s&&null==o&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(n){if(null==this.icon&&null==this.config.fallbackIcon)return(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})();let r=null;if(r=this.icon??this.config.fallbackIcon,n){const a=this.findIconDefinition(r);if(null!=a){const o=this.buildParams();this.renderIcon(a,o)}}}render(){this.ngOnChanges({})}findIconDefinition(n){const r=((e,t)=>(e=>void 0!==e.prefix&&void 0!==e.iconName)(e)?e:Array.isArray(e)&&2===e.length?{prefix:e[0],iconName:e[1]}:"string"==typeof e?{prefix:t,iconName:e}:void 0)(n,this.config.defaultPrefix);return"icon"in r?r:this.iconLibrary.getIconDefinition(r.prefix,r.iconName)??((e=>{throw new Error(`Could not find icon with iconName=${e.iconName} and prefix=${e.prefix} in the icon library.`)})(r),null)}buildParams(){const n={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},r="string"==typeof this.transform?r82.transform(this.transform):this.transform;return{title:this.title,transform:r,classes:[...c82(n),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(n,r){const a=a82(n,r);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(a.html.join("\n"))}}return e.\u0275fac=function(n){return new(n||e)(c2(_f),c2(C82),c2(f82),c2(h82,8),c2(d82,8))},e.\u0275cmp=G1({type:e,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(n,r){2&n&&(ti("innerHTML",r.renderedIconHTML,Y8),Ka("title",r.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[we],decls:0,vars:0,template:function(n,r){},encapsulation:2}),e})(),w9=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=k3({type:e}),e.\u0275inj=E({}),e})();const HL=function(e){return{disabled:e}};let p82=(()=>{class e{constructor(){this.value=0,this.faCaretUp=ed,this.faCaretDown=Zh,this.initial=0,this.min=0,this.max=null,this.disableIncrease=!1,this._disableIncrease=!1,this._disableDecrease=!0,this.onchange=new W3}ngOnInit(){this.value=Math.max(this.initial,this.min),this.disableOrEnable()}isDisabledIncrease(){return 1==this._disableIncrease||1==this.disableIncrease}disableOrEnable(){this.max&&(this._disableIncrease=this.value>=this.max),this._disableDecrease=this.value<=this.min}increase(){this.isDisabledIncrease()||(this.value=this.max?Math.min(this.max,this.value+1):this.value+1,this.onchange.emit(this.value),this.disableOrEnable())}decrease(){this._disableDecrease||(this.value=Math.max(this.min,this.value-1),this.onchange.emit(this.value),this.disableOrEnable())}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=G1({type:e,selectors:[["app-stat-control"]],inputs:{initial:"initial",min:"min",max:"max",disableIncrease:"disableIncrease"},outputs:{onchange:"onchange"},decls:7,vars:9,consts:[["id","control"],[1,"arrow","arrow-up",3,"ngClass","click"],[1,"fa-lg",3,"icon"],[1,"value"],[1,"arrow","arrow-down",3,"ngClass","click"]],template:function(n,r){1&n&&(t2(0,"div",0)(1,"div",1),R1("click",function(){return r.increase()}),M1(2,"fa-icon",2),s2(),t2(3,"div",3),x2(4),s2(),t2(5,"div",4),R1("click",function(){return r.decrease()}),M1(6,"fa-icon",2),s2()()),2&n&&(J(1),X("ngClass",B3(5,HL,r.isDisabledIncrease())),J(1),X("icon",r.faCaretUp),J(2),Ae(r.value),J(1),X("ngClass",B3(7,HL,r._disableDecrease)),J(1),X("icon",r.faCaretDown))},dependencies:[h6,z9],styles:["#control[_ngcontent-%COMP%]{font-size:28px;display:flex;flex-direction:row;justify-items:center;align-content:center}#control[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{width:40px;height:38px;display:flex;justify-content:center;align-items:center;cursor:pointer;transition:opacity .2s}#control[_ngcontent-%COMP%]   .arrow.disabled[_ngcontent-%COMP%]{opacity:.5;cursor:normal}#control[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-weight:700;max-width:13px}"]}),e})();function m82(e,t){1&e&&(t2(0,"span"),x2(1," starting "),s2())}function g82(e,t){if(1&e&&(t2(0,"div",9),x2(1," Remaining points: "),t2(2,"span",4),x2(3),s2()()),2&e){const n=W2();J(3),Ae(n.remainingStats)}}function v82(e,t){if(1&e){const n=u6();t2(0,"div",12)(1,"div",13),R1("click",function(){const o=xe(n).$implicit;return De(W2(2).clickStatBox(o))}),t2(2,"span",14),x2(3),s2()(),t2(4,"app-stat-control",15),R1("onchange",function(a){const s=xe(n).$implicit;return De(W2(2).onStatChange(a,s))}),s2()()}if(2&e){const n=t.$implicit,r=W2(2);J(1),L5("stat-box ",n.name.toLowerCase(),""),J(2),Ae(n.name),J(1),X("initial",r.getInitial(n))("min",r.minStats)("max",r.maxStats)("disableIncrease",r.disableIncrease)}}const y82=function(e,t,n){return[e,t,n]};function M82(e,t){if(1&e&&(t2(0,"div",10),T2(1,v82,5,8,"div",11),s2()),2&e){const n=t.$implicit,r=W2();J(1),X("ngForOf",ku(1,y82,r.stats[0+3*n],r.stats[1+3*n],r.stats[2+3*n]))}}const L82=function(e){return{recent:e}},V82=function(e){return{"with-margin":e}},H82=function(){return[0,1,2]};let SL=(()=>{class e{constructor(n,r){this.dialog=n,this.storyService=r,this.recent=!0,this.maxStats=10,this.minStats=0,this.totalToDistribute=null,this.stats=[{name:"STRENGHT",variable:"player_Strenght",description:["Power and muscles. Fight, break, win.","Recommended for: MMA Fighters, Bodybuilders, Firefighters.","Strenght is how healthy and how strong you are. It also dictates how well you use your body, from fighting, to running, to jumping. You can use it to carry heavy loads, break doors, or break people.","At low levels you will struggle to go up a single set of stairs. At high levels you might find yourself out of touch with the common people, going for violence as a solution even when something else would be more apropriate."]},{name:"CONTROL",variable:"player_Control",description:["Keep the facade up. Don't let anyone know what you are thinking.","Recommended for: Control Freaks, Emotionless People, Surgeons.","Control is your ability to keep yourself together under duress, and to keep the facade up in front of others. It let's you stay calm and collected in front of danger allowing you take control of any situation.","At low levels you will be unable to hide your feelings and might even act impulsively. At high levels you might become obsessed with controlling every single detail of every single move you make."]},{name:"SLEIGHT",variable:"player_Sleight",description:["The art of quick-wit and pickpocketing. How fast are you with your hands? How nimble are you with your body?","Recommended for: Thieves, Gymnasts, Comedians.","Sleight is your ability to move fast, and move unseen. You can use it to steal things that are in plain sight, or to dodge a punch that would otherwise drop you.","At low levels you will be fumbling with your keys every single time. At high levels you might become a kleptomaniac, incapable of letting an oportunity pass."]},{name:"PERCEPTION",variable:"player_Perception",description:["Your five senses, working together to parse the world.","Recommended for: People with Eyes, People with Hands, People with Tongues.","Perception is your ability to... perceive... the world around you, be it through touch, smell, vision, or any other physical sense. You can use it to notice details and oportunities for action.","At low levels you will miss even the most obvious of hints. At higher levels you may find yourself paralized by all the details your senses provide."]},{name:"INTUITION",variable:"player_Intuition",description:['Your sixth sense, or rather all of your experiences combined into a bundle of "feelings".',"Recommended for: Sensitive people, Arcane Explorers, Teachers.","Intuition is that nagging feeling telling you something is not quite right. It's that first step from your conscious mind in identifying danger.","At low levels you will be uncapable of having any insights, you will experience everything with the naivete of a newborn. At high levels on the other hand, it might be hard to decipher what is real and what is just a feeling."]},{name:"KNOWLEDGE",variable:"player_Knowledge",description:["How much information you have at your disposal. Your memory of facts.","Recommended for: College Students, Journalists, Astrounauts.","Knowledge is all the learning you've done in your life, plus memory. Whenever you need an advice or an escape route, or even just the digits of PI, Knowledge can have the answer.","At low levels you will struggle even with basic facts of reality, you might not understand how a computer work or how to open a door. At high levels you may find yourself and getting lost in the many interesting subjects that exist."]},{name:"CONFIDENCE",variable:"player_Confidence",description:["You belief in yourself and your abilities. How firm your handshake is.","Recommended for: Politicians, Performers, Professionals.","Confidence is how easy you carry yourself into unknown situations. Being confident means you believe you can solve any problem that comes your way.","At low levels you won't be able to order food without sweating buckets. But at high levels you might find yourself too confident, with an over-inflated ego."]},{name:"MANIPULATION",variable:"player_Manipulation",description:["Your ability to play the social game. Move the pieces and let it fall down, just as planned.","Recommended for: Reality Show Contestants, High Level Executives, Abusive Partners.","Manipulation is your ability to read the currents in social situations and direct them torwards your desired goal. Manipulation can also help you notice when others are trying to manipulate you.","At low levels you will be perpetually chasing shadows. You always miss the double meanings. At high levels you will find yourself extremely paranoid, seeing plots everywhere."]},{name:"CHARISMA",variable:"player_Charisma",description:["Your ability to act. Your ability to lie. Your ability to detect lies.","Recommended for: Salespeople, Single People, Unemployed People.","Charisma is your ability to convince people you are harmless and fun. If you are charismatic you can get free drinks, gifts from your friends, or even a free get out of jail card.","At low levels you will as charming as a rock, and you will be unable to detect even the most obvious sarcasm. At high levels you will see the world through the lens of a stage. Life will be a big play."]}],this.remainingStats=null,this.statValues={},this.disableIncrease=!1}ngOnInit(){this.remainingStats=this.totalToDistribute}clickStatBox(n){this.dialog.open(SM,{data:{title:n.name,paragraphs:n.description,variable:n.variable}})}checkTotal(){let n=0;for(let r in this.statValues)n+=this.statValues[r]-this.minStats;this.totalToDistribute&&(this.remainingStats=this.totalToDistribute-n),this.disableIncrease=0==this.remainingStats}getInitial(n){return this.storyService.getVariableWithName(n.variable)}onStatChange(n,r){this.statValues[r.name]=n,this.storyService.callSetter(r.variable,[n]),this.checkTotal()}}return e.\u0275fac=function(n){return new(n||e)(c2(HM),c2(Xt))},e.\u0275cmp=G1({type:e,selectors:[["app-character-stats"]],inputs:{recent:"recent",maxStats:"maxStats",minStats:"minStats",totalToDistribute:"totalToDistribute"},decls:12,vars:10,consts:[["id","character-stats",3,"ngClass"],[1,"content"],[1,"choose"],[4,"ngIf"],[1,"special"],[1,"tip",3,"ngClass"],["class","remaining",4,"ngIf"],[1,"stat-grid"],["class","stat-row",4,"ngFor","ngForOf"],[1,"remaining"],[1,"stat-row"],["class","stat-container",4,"ngFor","ngForOf"],[1,"stat-container"],[3,"click"],[1,"name-bg"],[3,"initial","min","max","disableIncrease","onchange"]],template:function(n,r){1&n&&(t2(0,"div",0)(1,"div",1)(2,"div",2),x2(3," Choose your "),T2(4,m82,2,0,"span",3),t2(5,"span",4),x2(6,"Stats"),s2()(),t2(7,"div",5),x2(8," Click on the stats to read their descriptions "),s2(),T2(9,g82,4,1,"div",6),t2(10,"div",7),T2(11,M82,2,5,"div",8),s2()()()),2&n&&(X("ngClass",B3(5,L82,r.recent)),J(4),X("ngIf",r.remainingStats),J(3),X("ngClass",B3(7,V82,null==r.remainingStats)),J(2),X("ngIf",null!=r.remainingStats),J(2),X("ngForOf",function Eu(e,t,n){const r=v3()+e,a=j();return a[r]===z2?F4(a,r,n?t.call(n):t()):function bt(e,t){return e[t]}(a,r)}(9,H82)))},dependencies:[h6,Bt,Wt,p82],styles:["#character-stats[_ngcontent-%COMP%]{background-color:#000;width:100%;box-sizing:border-box;opacity:.5}#character-stats.recent[_ngcontent-%COMP%]{opacity:1}#character-stats[_ngcontent-%COMP%] > .content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;min-height:531px}#character-stats[_ngcontent-%COMP%]   .choose[_ngcontent-%COMP%]{font-size:24px}#character-stats[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%]{color:var(--accent2)}#character-stats[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:14px;margin-top:10px;margin-bottom:0;color:#ccc}#character-stats[_ngcontent-%COMP%]   .tip.with-margin[_ngcontent-%COMP%]{margin-bottom:20px}#character-stats[_ngcontent-%COMP%]   .remaining[_ngcontent-%COMP%]{font-size:21px;margin-top:10px;margin-bottom:10px}#character-stats[_ngcontent-%COMP%]   .stat-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%}#character-stats[_ngcontent-%COMP%]   .stat-grid[_ngcontent-%COMP%] > .stat-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;justify-content:space-around}#character-stats[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-end}#character-stats[_ngcontent-%COMP%]   .stat-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}#character-stats[_ngcontent-%COMP%]   .stat-box[_ngcontent-%COMP%]{height:130px;width:93px;overflow:hidden;min-width:28%;font-size:11px;background-size:cover;border:1px solid black;box-sizing:border-box;display:flex;align-items:flex-end;border-radius:5px;cursor:pointer}#character-stats[_ngcontent-%COMP%]   .stat-box[_ngcontent-%COMP%]   .name-bg[_ngcontent-%COMP%]{width:100%;height:14px;line-height:14px;border-top:1px solid black;background-color:#fff;display:flex;justify-content:center;align-items:center;font-weight:600;color:#000}#character-stats[_ngcontent-%COMP%]   .stat-box.physical[_ngcontent-%COMP%]{background-color:#c0416d}#character-stats[_ngcontent-%COMP%]   .stat-box.mental[_ngcontent-%COMP%]{background-color:#4086bf}#character-stats[_ngcontent-%COMP%]   .stat-box.social[_ngcontent-%COMP%]{background-color:#40bfab}#character-stats[_ngcontent-%COMP%]   .stat-box.strenght[_ngcontent-%COMP%]{background-image:url(/assets/images/strenght.png)}#character-stats[_ngcontent-%COMP%]   .stat-box.control[_ngcontent-%COMP%]{background-image:url(/assets/images/control.png)}#character-stats[_ngcontent-%COMP%]   .stat-box.sleight[_ngcontent-%COMP%]{background-image:url(/assets/images/sleight.png)}#character-stats[_ngcontent-%COMP%]   .stat-box.perception[_ngcontent-%COMP%]{background-image:url(/assets/images/perception.png)}#character-stats[_ngcontent-%COMP%]   .stat-box.intuition[_ngcontent-%COMP%]{background-image:url(/assets/images/intuition.png)}#character-stats[_ngcontent-%COMP%]   .stat-box.knowledge[_ngcontent-%COMP%]{background-image:url(/assets/images/knowledge.png)}#character-stats[_ngcontent-%COMP%]   .stat-box.confidence[_ngcontent-%COMP%]{background-image:url(/assets/images/confidence.png)}#character-stats[_ngcontent-%COMP%]   .stat-box.manipulation[_ngcontent-%COMP%]{background-image:url(/assets/images/manipulation.png)}#character-stats[_ngcontent-%COMP%]   .stat-box.charisma[_ngcontent-%COMP%]{background-image:url(/assets/images/charisma.png)}#character-stats[_ngcontent-%COMP%]   .stat-control[_ngcontent-%COMP%]{height:130px;width:46px;align-items:flex-start!important}"]}),e})();function S82(e,t){1&e&&(t2(0,"div",13),x2(1,"Use the arrows to pick another"),s2())}function b82(e,t){if(1&e){const n=u6();t2(0,"div",14),R1("click",function(){return xe(n),De(W2().moveBackwards())}),M1(1,"fa-icon",15),s2()}if(2&e){const n=W2();J(1),X("icon",n.faArrowLeft)}}function z82(e,t){if(1&e){const n=u6();t2(0,"div",16),R1("click",function(){return xe(n),De(W2().moveForwards())}),M1(1,"fa-icon",15),s2()}if(2&e){const n=W2();J(1),X("icon",n.faArrowRight)}}function w82(e,t){if(1&e&&(t2(0,"p"),x2(1),s2()),2&e){const n=t.$implicit;J(1),ce(" ",n," ")}}const _82=function(e){return{recent:e}};let x82=(()=>{class e{constructor(n){this.storyService=n,this.faArrowRight=qf,this.faArrowLeft=jf,this.faPlay=T7,this.recent=!0,this.markings=[{name:"VILITARIS",imageClass:"marking-vilitaris",description:["Powerful bodies build powerful minds, their motto and lifestyle. Mages who are looking for control in all things, internal and external, choose this Marking.","Bonus: +1 to PHYSICAL stats.","Flaw: CONTROL has to be your highest stat at all times."]},{name:"BELLIO",imageClass:"marking-bellio",description:["There is something fundamentaly broken with the world and you will fix it. Rebels and activists, and those with drive and passion choose this Marking.","Bonus +1 to MENTAL stats.","Flaw: N\xe3o pensei"]},{name:"NIAVIT",imageClass:"marking-niavit",description:["What\u2019s the point of having magic if you can\u2019t have fun? Sex, drugs and alcohol are a lot more fun when there are no consequences. Those who seek hedonism choose this Marking.","Bonus +1 to SOCIAL challenges.","Flaw: N\xe3o pensei"]}],this.currentIndex=0}ngOnInit(){let n=this.storyService.getVariableWithName("player_Marking1"),r=this.storyService.getVariableWithName("player_Marking2"),a=this.storyService.getVariableWithName("player_Marking3");console.log(n,r,a),n>=r&&n>=a?this.currentIndex=0:r>=n&&r>=a?this.currentIndex=1:a>=n&&a>=r&&(this.currentIndex=2)}observe(n,r){console.log("observe",n)}moveBackwards(){this.currentIndex-=1,this.setStoryValue()}moveForwards(){this.currentIndex+=1,this.setStoryValue()}setStoryValue(){this.currentIndex%3==0&&(this.storyService.callSetter("player_Marking1",[4]),this.storyService.callSetter("player_Marking2",[0]),this.storyService.callSetter("player_Marking3",[0])),this.currentIndex%3==1&&(this.storyService.callSetter("player_Marking1",[0]),this.storyService.callSetter("player_Marking2",[4]),this.storyService.callSetter("player_Marking3",[0])),this.currentIndex%3==2&&(this.storyService.callSetter("player_Marking1",[0]),this.storyService.callSetter("player_Marking2",[0]),this.storyService.callSetter("player_Marking3",[4]))}getCurrentMarking(){return this.markings[this.currentIndex%3]}}return e.\u0275fac=function(n){return new(n||e)(c2(Xt))},e.\u0275cmp=G1({type:e,selectors:[["app-character-marking"]],inputs:{recent:"recent"},decls:17,vars:11,consts:[["id","character-marking",3,"ngClass"],[1,"content"],[1,"given"],[1,"not-special"],[1,"special"],["class","tip",4,"ngIf"],[1,"marking-container"],[1,"name-box"],["class","arrow arrow-left",3,"click",4,"ngIf"],[1,"marking-name"],["class","arrow arrow-right",3,"click",4,"ngIf"],[1,"description"],[4,"ngFor","ngForOf"],[1,"tip"],[1,"arrow","arrow-left",3,"click"],[1,"fa-lg",3,"icon"],[1,"arrow","arrow-right",3,"click"]],template:function(n,r){1&n&&(t2(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),x2(4,"You've been given a\xa0"),s2(),t2(5,"span",4),x2(6,"Marking"),s2()(),T2(7,S82,2,0,"div",5),t2(8,"div",6),M1(9,"div"),s2(),t2(10,"div",7),T2(11,b82,2,1,"div",8),t2(12,"div",9),x2(13),s2(),T2(14,z82,2,1,"div",10),s2(),t2(15,"div",11),T2(16,w82,2,1,"p",12),s2()()()),2&n&&(X("ngClass",B3(9,_82,r.recent)),J(7),X("ngIf",r.recent),J(2),L5("marking ",r.getCurrentMarking().imageClass,""),J(2),X("ngIf",r.recent),J(2),Ae(r.getCurrentMarking().name),J(1),X("ngIf",r.recent),J(2),X("ngForOf",r.getCurrentMarking().description))},dependencies:[h6,Bt,Wt,z9],styles:["#character-marking[_ngcontent-%COMP%]{background-color:#000;width:100%;box-sizing:border-box;opacity:.5}#character-marking.recent[_ngcontent-%COMP%]{opacity:1}#character-marking[_ngcontent-%COMP%] > .content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}#character-marking.recent[_ngcontent-%COMP%] > .content[_ngcontent-%COMP%]{min-height:551px}#character-marking[_ngcontent-%COMP%]   .given[_ngcontent-%COMP%]{font-size:24px}#character-marking[_ngcontent-%COMP%]   .special[_ngcontent-%COMP%]{color:var(--accent2)}#character-marking[_ngcontent-%COMP%]   .not-special[_ngcontent-%COMP%]{font-size:22px}#character-marking[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:14px;margin-top:10px;margin-bottom:0;color:#ccc}#character-marking[_ngcontent-%COMP%]   .marking-container[_ngcontent-%COMP%]{width:271px;height:224px;display:flex;justify-content:center;align-items:center;margin-top:10px;margin-bottom:10px}#character-marking[_ngcontent-%COMP%]   .marking[_ngcontent-%COMP%]{background-size:contain;background-position:50% 50%;background-repeat:no-repeat}#character-marking[_ngcontent-%COMP%]   .marking-vilitaris[_ngcontent-%COMP%]{background-image:url(/assets/images/marking1.png);width:240px;height:230px}#character-marking[_ngcontent-%COMP%]   .marking-vilitaris--Union[_ngcontent-%COMP%]{background-position:0 0}#character-marking[_ngcontent-%COMP%]   .marking-bellio[_ngcontent-%COMP%]{background-image:url(/assets/images/marking2.png);width:224px;height:235px}#character-marking[_ngcontent-%COMP%]   .marking-bellio--Marking-Bellio[_ngcontent-%COMP%]{background-position:0 0}#character-marking[_ngcontent-%COMP%]   .marking-niavit[_ngcontent-%COMP%]{background-image:url(/assets/images/marking3.png);width:271px;height:211px}#character-marking[_ngcontent-%COMP%]   .marking-niavit--Niavit-Markig[_ngcontent-%COMP%]{background-position:0 0}#character-marking[_ngcontent-%COMP%]   .name-box[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:stretch;margin-bottom:0;color:var(--accent2);width:100%}#character-marking[_ngcontent-%COMP%]   .name-box[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{flex:1}#character-marking[_ngcontent-%COMP%]   .name-box[_ngcontent-%COMP%]   .marking-name[_ngcontent-%COMP%]{font-size:40px;text-align:center;font-weight:700;font-family:Quattrocento,Georgia,Times New Roman,Times,serif}#character-marking[_ngcontent-%COMP%]   .name-box[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{font-size:24px;cursor:pointer;flex:0;min-width:40px;min-height:40px;text-align:center;line-height:40px}#character-marking[_ngcontent-%COMP%]   .arrow-left[_ngcontent-%COMP%]{text-align:left}#character-marking[_ngcontent-%COMP%]   .arrow-right[_ngcontent-%COMP%]{text-align:right}#character-marking[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:15px;text-align:center}#character-marking[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-weight:700;color:#fff;font-family:sans-serif;transition:color .6s;text-decoration:none;cursor:pointer;display:block;opacity:1}#character-marking[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   fa-icon[_ngcontent-%COMP%]{margin-right:2.5px}#character-marking[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, #character-marking[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active{color:#999;transition:color .1s}#character-marking[_ngcontent-%COMP%]   p.choice.continue[_ngcontent-%COMP%]{width:100%;display:flex;line-height:1.7em}#character-marking[_ngcontent-%COMP%]   p.choice.continue[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{flex-shrink:0;width:100%;background-color:var(--accent1);padding-top:10px;padding-bottom:10px;padding-left:35px;box-sizing:border-box}#character-marking[_ngcontent-%COMP%]   p.choice.continue[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#c37fd1}#character-marking[_ngcontent-%COMP%]   p.choice.continue[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   fa-icon[_ngcontent-%COMP%]{font-size:13px;vertical-align:middle}"]}),e})();function D82(e,t){if(1&e&&(t2(0,"span"),x2(1),s2()),2&e){const n=W2(3).$implicit;L5("voice ",n.voice.toLowerCase(),""),J(1),Ae(n.voice)}}function E82(e,t){1&e&&(t2(0,"span"),x2(1,"YOU"),s2()),2&e&&L5("voice ",W2(3).$implicit.voice.toLowerCase(),"")}function N82(e,t){if(1&e&&(O3(0),T2(1,D82,2,4,"span",10),T2(2,E82,2,3,"span",10),R3()),2&e){const n=W2(2).$implicit;J(1),X("ngIf","player"!=n.voice),J(1),X("ngIf","player"==n.voice)}}function k82(e,t){1&e&&(t2(0,"span",14),x2(1,":Success]"),s2())}function T82(e,t){1&e&&(t2(0,"span",15),x2(1,":Failure]"),s2())}function A82(e,t){if(1&e&&(O3(0),t2(1,"span",11),x2(2),s2(),T2(3,k82,2,0,"span",12),T2(4,T82,2,0,"span",13),R3()),2&e){const n=W2(2).$implicit;J(2),ce("[",n.difficulty,""),J(1),X("ngIf",!0===n.success),J(1),X("ngIf",!1===n.success)}}function P82(e,t){1&e&&(O3(0),t2(1,"span",14),x2(2,"]"),s2(),R3())}function I82(e,t){1&e&&(O3(0),x2(1," - "),R3())}const F82=function(e,t){return{old:e,recent:t}};function O82(e,t){if(1&e&&(t2(0,"p",9),T2(1,N82,3,2,"ng-container",8),T2(2,A82,5,3,"ng-container",8),T2(3,P82,3,0,"ng-container",8),T2(4,I82,2,0,"ng-container",8),x2(5),s2()),2&e){const n=W2().$implicit;X("ngClass",Nu(6,F82,!n.recent,n.recent)),J(1),X("ngIf",n.voice),J(1),X("ngIf",n.difficulty),J(1),X("ngIf",null==n.success&&n.difficulty),J(1),X("ngIf",n.voice),J(1),ce(" ",n.text," ")}}function R82(e,t){if(1&e){const n=u6();t2(0,"p",19)(1,"a",20),R1("click",function(){xe(n);const a=W2(3).$implicit;return De(W2().chooseChoice(a.index))}),x2(2," CONTINUE\xa0"),M1(3,"fa-icon",3),s2()()}if(2&e){const n=W2(4);J(3),X("icon",n.faPlay)}}function B82(e,t){if(1&e&&(O3(0),T2(1,R82,4,1,"p",18),R3()),2&e){const n=W2(2).$implicit;J(1),X("ngIf","choice"==n.kind)}}function W82(e,t){1&e&&M1(0,"fa-icon",3),2&e&&X("icon",W2(4).faCircleArrowRight)}function j82(e,t){1&e&&M1(0,"fa-icon",3),2&e&&X("icon",W2(4).faMagnifyingGlass)}function U82(e,t){if(1&e&&(t2(0,"span"),x2(1),s2()),2&e){const n=W2(3).$implicit;L5("stat-box ",n.box[0],""),J(1),ce(" ",n.box[1]," ")}}const G82=function(e){return{visited:e}};function q82(e,t){if(1&e){const n=u6();t2(0,"p",21)(1,"a",20),R1("click",function(){xe(n);const a=W2(2).$implicit;return De(W2().chooseChoice(a.index))}),T2(2,W82,1,1,"fa-icon",22),T2(3,j82,1,1,"fa-icon",22),T2(4,U82,2,4,"span",10),t2(5,"span",23),x2(6),s2()()()}if(2&e){const n=W2(2).$implicit,r=W2();X("ngClass",B3(5,G82,n.visited)),J(2),X("ngIf",r.choiceIsAdvance(n)),J(1),X("ngIf",r.choiceIsExplore(n)),J(1),X("ngIf",n.box),J(2),ce(" ",n.text," ")}}function $82(e,t){if(1&e&&(O3(0),T2(1,B82,2,1,"ng-container",16),T2(2,q82,7,7,"ng-template",null,17,Ku),R3()),2&e){const n=Qa(3),r=W2().$implicit,a=W2();J(1),X("ngIf",a.choiceIsContinue(r))("ngIfElse",n)}}function K82(e,t){if(1&e&&(O3(0),M1(1,"app-character-marking",24),R3()),2&e){const n=W2().$implicit;J(1),X("recent",n.recent)}}function Q82(e,t){if(1&e&&(O3(0),M1(1,"app-character-stats",25),R3()),2&e){const n=W2().$implicit;J(1),X("recent",n.recent)("minStats",1)("maxStats",5)("totalToDistribute",15)}}function Y82(e,t){1&e&&(O3(0),M1(1,"hr"),R3())}function J82(e,t){if(1&e&&(T2(0,O82,6,9,"p",7),T2(1,$82,4,2,"ng-container",8),T2(2,K82,2,1,"ng-container",8),T2(3,Q82,2,4,"ng-container",8),T2(4,Y82,2,0,"ng-container",8)),2&e){const n=t.$implicit;X("ngIf","paragraph"==n.kind),J(1),X("ngIf","choice"==n.kind&&!n.hidden),J(1),X("ngIf","marking_menu"==n.kind),J(1),X("ngIf","stats_menu"==n.kind),J(1),X("ngIf","divider"==n.kind)}}const X82=function(e){return{closed:e}};var ge=(()=>{return(e=ge||(ge={}))[e.Explore=0]="Explore",e[e.Advance=1]="Advance",e[e.Continue=2]="Continue",ge;var e})();let Z82=(()=>{class e{constructor(n,r){this.storyService=n,this.dialog=r,this.parts=[],this.controlsClosed=!0,this.faPlay=T7,this.faBackwardStep=c7,this.faCircleArrowRight=d7,this.faMagnifyingGlass=N7,this.faBug=Bh,this.faStar=ly,this.faBrain=Rh,this.onTrainOfThought=new W3,this.onStatCheckStart=new W3,this.onStatCheckResult=new W3,this.statBoxRgx=/(?:\[s\])((.)*)(?:\[\|\])((.)*)(?:\[\/s\])/g,this.saveList=[]}choiceIsContinue(n){return-1!=n.choice_kinds.indexOf(ge.Continue)}choiceIsAdvance(n){return-1!=n.choice_kinds.indexOf(ge.Advance)}choiceIsExplore(n){return-1!=n.choice_kinds.indexOf(ge.Explore)}ngOnInit(){this.queryStorySystem()}queryStorySystem(){this.storyService.continue(),this.parts.forEach(o=>{"paragraph"==o.kind||"marking_menu"==o.kind||"stats_menu"==o.kind||"divider"==o.kind?o.recent=!1:"choice"==o.kind&&(o.hidden=!0)});let r=0,a=0;for(let o of this.storyService.getParts().map(s=>this.convertParts(s)).flat()){if(0==a&&(a=1,"paragraph"==o.kind)){let s="player"==o.voice?.toLowerCase();s&&"player"!=o.voice&&(console.warn("voice type at ",o),o.voice="player"),s&&(o.recent=!1)}"paragraph"==o.kind&&o.statCheck&&(this.onStatCheckStart.emit(),r+=800,window.setTimeout(()=>{this.onStatCheckResult.emit(o.success??void 0)},r)),r>0?window.setTimeout(()=>{this.parts.push(o),this.scrollToLatest()},r):this.parts.push(o)}}getTagValue(n,r){for(let a of r)if(-1!=a.indexOf(`${n}`))return-1==a.indexOf(":")?a:a.split(":")[1];return null}getChoiceKinds(n){let r=[];return-1!=n.indexOf("[>]")&&r.push(ge.Advance),-1!=n.indexOf("[e]")&&r.push(ge.Explore),-1!=n.indexOf("CONTINUE >>>")&&r.push(ge.Continue),r}getBox(n){let r=this.statBoxRgx.exec(n);return r?[r[1],r[3]]:null}filterChoiceText(n){return n.replace("[>]","").replace("[e]","").replace(this.statBoxRgx,"")}convertParts(n){if("paragraph"==n.kind){let r=this.getTagValue("command",n.tags),a=this.getTagValue("divider",n.tags);if(r){if("[[marking_menu]]"==n.text.trim())return[{kind:"marking_menu",hidden:!1,recent:!0}];if("[[stats_menu]]"==n.text.trim())return[{kind:"stats_menu",hidden:!1,recent:!0}];throw new Error("Unrecognized command |"+n.text+"|")}if(a)return[{kind:"divider",hidden:!1,recent:!0}];{let o=this.getTagValue("voice",n.tags);if(o){let w=this.storyService.evaluateFunction("npc_name_str",[o.trim()],!0),x=this.storyService.evaluateFunction("npc_name_str",[o],!0),D=this.storyService.evaluateFunction("npc_lastname_str",[o.trim()],!0),T=this.storyService.evaluateFunction("npc_lastname_str",[o],!0);w.returned&&(o=w.returned,D.returned&&(o+=" "+D.returned,(!T||!T.returned||T.returned!=D.returned)&&console.warn("Failed sanity check for the last name ",n,D,T)),(!x||!x.returned||x.returned!=w.returned)&&console.warn("Failed sanity check for first name ",n,w,x))}let s=this.getTagValue("difficulty",n.tags),l=this.getTagValue("trainOfThoughtStart",n.tags),f=this.getTagValue("trainOfThoughtEnd",n.tags);l&&this.onTrainOfThought.next(!0),f&&this.onTrainOfThought.next(!1);let p=null;if(s){let w=n.text.split("|");if(2!=w.length)throw console.log(n),new Error('unexpected split length "'+n.text+'"');p=w[0],n.text=w[1]}let y=this.getTagValue("success",n.tags),V=this.getTagValue("failure",n.tags),b=this.getTagValue("statCheck",n.tags);return[{kind:"paragraph",text:n.text,voice:o,recent:!0,difficulty:p,success:!!y||!V&&null,statCheck:!!b}]}}if("choice_list"==n.kind){let r=[];for(let a of n.choices){let o=this.getChoiceKinds(a.text),s=this.getBox(a.text);r.push({kind:"choice",text:this.filterChoiceText(a.text),index:a.index,choice_kinds:o,visited:a.visited,hidden:!1,box:s})}return r}throw new Error("unreachable!")}chooseChoice(n){this.saveList.push(this.storyService.createSave()),this.storyService.chooseChoice(n),this.queryStorySystem(),this.scrollToLatest()}scrollToLatest(){window.setTimeout(()=>{let n=Array.from(document.querySelectorAll(".recent"));for(let r of n){window.scrollTo({top:window.scrollY+r.getBoundingClientRect().top-20,behavior:"smooth"});break}},0)}undo(){let n=this.saveList.pop();if(!n)return;this.storyService.loadSave(n);let r=!1,a=!1,o=null;for(let l=this.parts.length-1;l>=0;l-=1){let f=this.parts[l];if("paragraph"!=f.kind&&"marking_menu"!=f.kind&&"stats_menu"!=f.kind&&"divider"!=f.kind||r){if("choice"==f.kind&&a)f.hidden=!1,r||(o=l,r=!0);else if(("paragraph"==f.kind||"marking_menu"==f.kind||"stats_menu"==f.kind||"divider"==f.kind)&&r){o&&this.parts.splice(o+1,this.parts.length-o);break}}else a=!0}a=!1;let s=[];for(let l=this.parts.length-1;l>=0;l-=1){let f=this.parts[l];if(("paragraph"==f.kind||"marking_menu"==f.kind||"stats_menu"==f.kind||"divider"==f.kind)&&(s.push(f),a=!0),"choice"==f.kind&&a){window.setTimeout(()=>{for(let p of s)p.recent=!0},0);break}}this.queryStorySystem()}invertControlWindow(){this.controlsClosed=!this.controlsClosed}showStats(){let n=this.storyService.getVariableWithName("player_Strenght"),r=this.storyService.getVariableWithName("player_Control"),a=this.storyService.getVariableWithName("player_Sleight"),o=this.storyService.getVariableWithName("player_Perception"),s=this.storyService.getVariableWithName("player_Intuition"),l=this.storyService.getVariableWithName("player_Knowledge"),f=this.storyService.getVariableWithName("player_Confidence"),p=this.storyService.getVariableWithName("player_Manipulation"),y=this.storyService.getVariableWithName("player_Charisma");this.dialog.open(SM,{data:{title:"STATS",paragraphs:["Strenght: "+n,"Control: "+r,"Sleight: "+a,"Perception: "+o,"Intuition: "+s,"Knowledge: "+l,"Confidence: "+f,"Manipulation: "+p,"Charisma: "+y],variable:null}})}showCheatStatScreen(){this.dialog.open(SL)}}return e.\u0275fac=function(n){return new(n||e)(c2(Xt),c2(HM))},e.\u0275cmp=G1({type:e,selectors:[["app-story-viewer"]],outputs:{onTrainOfThought:"onTrainOfThought",onStatCheckStart:"onStatCheckStart",onStatCheckResult:"onStatCheckResult"},decls:12,vars:7,consts:[["story",""],["id","controls",3,"ngClass"],["id","btn1",1,"btn",3,"click"],[3,"icon"],["id","btn3",1,"btn",3,"click"],["id","open-btn",3,"click"],["ngFor","",3,"ngForOf"],["class","paragraph",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"paragraph",3,"ngClass"],[3,"class",4,"ngIf"],[1,"difficulty"],["class","success",4,"ngIf"],["class","failure",4,"ngIf"],[1,"success"],[1,"failure"],[4,"ngIf","ngIfElse"],["normalChoice",""],["class","choice continue",4,"ngIf"],[1,"choice","continue"],[3,"click"],[1,"choice",3,"ngClass"],[3,"icon",4,"ngIf"],[1,"choice-text"],[3,"recent"],[3,"recent","minStats","maxStats","totalToDistribute"]],template:function(n,r){1&n&&(t2(0,"div",null,0)(2,"h2"),x2(3,"Children of the Moon"),s2(),t2(4,"div",1)(5,"div",2),R1("click",function(){return r.undo()}),M1(6,"fa-icon",3),s2(),t2(7,"div",4),R1("click",function(){return r.showCheatStatScreen()}),M1(8,"fa-icon",3),s2(),t2(9,"div",5),R1("click",function(){return r.invertControlWindow()}),M1(10,"fa-icon",3),s2()(),T2(11,J82,5,5,"ng-template",6),s2()),2&n&&(J(4),X("ngClass",B3(5,X82,r.controlsClosed)),J(2),X("icon",r.faBackwardStep),J(2),X("icon",r.faBrain),J(2),X("icon",r.faBug),J(1),X("ngForOf",r.parts))},dependencies:[h6,Bt,Wt,z9,x82,SL],styles:["p[_ngcontent-%COMP%]{font-size:13pt;color:#fff;line-height:1.7em;font-weight:lighter;transition:opacity 0s}h2[_ngcontent-%COMP%]{text-align:center;font-family:Quattrocento,Georgia,Times New Roman,Times,serif;margin:0 0 10px;padding:0;font-size:30pt}#controls[_ngcontent-%COMP%]{position:fixed;top:0;left:0;background-color:#ffffff80;width:100%;border-bottom:4px solid #333;z-index:20;transition:top .2s;display:flex;align-items:center;justify-content:space-around;flex:row;height:60px}#controls.closed[_ngcontent-%COMP%]{top:-60px}#controls[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{left:5px;top:5px;z-index:10;display:flex;justify-content:center;align-items:center;font-size:36px;border-radius:10px;box-sizing:border-box;width:50px;height:50px;background-color:var(--accent1);border:2px solid rgba(0,0,0,.2);cursor:pointer}#controls[_ngcontent-%COMP%]   #open-btn[_ngcontent-%COMP%]{position:absolute;right:0;bottom:-40px;width:40px;height:40px;background-color:#333;border-bottom-left-radius:20px;border-bottom-right-radius:20px;display:flex;justify-content:center;align-items:center}#btn1[_ngcontent-%COMP%]:active{background-color:#3c5fd3}p.paragraph[_ngcontent-%COMP%]   .voice[_ngcontent-%COMP%]{font-weight:700;text-transform:uppercase}p.paragraph[_ngcontent-%COMP%]   .voice.strenght[_ngcontent-%COMP%]{color:var(--strenght)}p.paragraph[_ngcontent-%COMP%]   .voice.control[_ngcontent-%COMP%]{color:var(--control)}p.paragraph[_ngcontent-%COMP%]   .voice.sleight[_ngcontent-%COMP%]{color:var(--sleight)}p.paragraph[_ngcontent-%COMP%]   .voice.perception[_ngcontent-%COMP%]{color:var(--perception)}p.paragraph[_ngcontent-%COMP%]   .voice.intuition[_ngcontent-%COMP%]{color:var(--intuition)}p.paragraph[_ngcontent-%COMP%]   .voice.knowledge[_ngcontent-%COMP%]{color:var(--knowledge)}p.paragraph[_ngcontent-%COMP%]   .voice.confidence[_ngcontent-%COMP%]{color:var(--confidence)}p.paragraph[_ngcontent-%COMP%]   .voice.manipulation[_ngcontent-%COMP%]{color:var(--manipulation)}p.paragraph[_ngcontent-%COMP%]   .voice.charisma[_ngcontent-%COMP%]{color:var(--charisma)}p.old[_ngcontent-%COMP%]{opacity:.5!important}a[_ngcontent-%COMP%]{font-weight:700;color:#fff;font-family:sans-serif;transition:color .6s;text-decoration:none;cursor:pointer;display:block;opacity:1}a[_ngcontent-%COMP%]   fa-icon[_ngcontent-%COMP%]{margin-right:2.5px}a[_ngcontent-%COMP%]:hover, a[_ngcontent-%COMP%]:active{color:#999;transition:color .1s}p.visited[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#999}p.choice.continue[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{width:100%;background-color:#639;padding-top:10px;padding-bottom:10px;padding-left:35px;box-sizing:border-box}p.choice.continue[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#c37fd1}p.choice.continue[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   fa-icon[_ngcontent-%COMP%]{font-size:13px;vertical-align:middle}p.choice[_ngcontent-%COMP%]   .stat-box[_ngcontent-%COMP%]{border-radius:2px;color:#000;padding:0 4px;min-width:120px;max-height:20px;line-height:20px;display:inline-block;text-align:center;font-size:13px;margin-left:2.5px;margin-right:2.5px}p.choice[_ngcontent-%COMP%]   .choice-text[_ngcontent-%COMP%]{margin-left:2.5px}.stat-box.strenght[_ngcontent-%COMP%]{background-color:var(--strenght)}.stat-box.control[_ngcontent-%COMP%]{background-color:var(--control)}.stat-box.sleight[_ngcontent-%COMP%]{background-color:var(--sleight)}.stat-box.perception[_ngcontent-%COMP%]{background-color:var(--perception)}.stat-box.intuition[_ngcontent-%COMP%]{background-color:var(--intuition)}.stat-box.knowledge[_ngcontent-%COMP%]{background-color:var(--knowledge)}.stat-box.confidence[_ngcontent-%COMP%]{background-color:var(--confidence)}.stat-box.manipulation[_ngcontent-%COMP%]{background-color:var(--manipulation)}.stat-box.charisma[_ngcontent-%COMP%]{background-color:var(--charisma)}"],data:{animation:[SN("inOutAnimation",[bN("in",d6({opacity:1})),kf(":enter",[d6({opacity:"0"}),Ef(".0s ease-out",d6({opacity:"0.5"}))]),kf(":leave",[d6({opacity:"1"}),Ef(".0s ease-out",d6({opacity:"0"}))])])]}}),e})();const en2=function(e,t,n,r){return{"during-tot":e,"stat-checking":t,failure:n,success:r}};let tn2=(()=>{class e{constructor(){this.title="cotm-front",this.trainOfThoughtStatus=!1,this.startedStatCheck=!1,this.hasStatResult=null}onTrainOfThought(n){this.trainOfThoughtStatus=!!n}onStatCheckStart(){this.startedStatCheck=!0,this.hasStatResult=null}onStatCheckResult(n){console.log(n),this.startedStatCheck=!1,this.hasStatResult=n,window.setTimeout(()=>{this.hasStatResult=null},800)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=G1({type:e,selectors:[["app-root"]],decls:3,vars:6,consts:[["id","app",3,"ngClass"],[1,"content"],[3,"onTrainOfThought","onStatCheckStart","onStatCheckResult"]],template:function(n,r){1&n&&(t2(0,"div",0)(1,"div",1)(2,"app-story-viewer",2),R1("onTrainOfThought",function(o){return r.onTrainOfThought(o)})("onStatCheckStart",function(){return r.onStatCheckStart()})("onStatCheckResult",function(o){return r.onStatCheckResult(o)}),s2()()()),2&n&&X("ngClass",Tu(1,en2,r.trainOfThoughtStatus,r.startedStatCheck,!1===r.hasStatResult,!0===r.hasStatResult))},dependencies:[h6,Z82],styles:["#app[_ngcontent-%COMP%]{transition:background-color .3s;transition-timing-function:ease-in-out}#app.during-tot[_ngcontent-%COMP%], #app.stat-checking[_ngcontent-%COMP%]{background-color:#777}#app.success[_ngcontent-%COMP%]{background-color:var(--success)}#app.failure[_ngcontent-%COMP%]{background-color:var(--failure)}#app[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{max-width:min(600px,82%);width:100%;max-height:100%;margin-left:auto;margin-right:auto;display:block;padding:4em 20px 20px;background-color:#000;position:relative}"]}),e})(),bL=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=k3({type:e}),e.\u0275inj=E({providers:[Xt],imports:[jt]}),e})();function zL(e){return new q(3e3,!1)}function Pn2(){return typeof window<"u"&&typeof window.document<"u"}function _9(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function We(e){switch(e.length){case 0:return new qt;case 1:return e[0];default:return new Af(e)}}function wL(e,t,n,r,a=new Map,o=new Map){const s=[],l=[];let f=-1,p=null;if(r.forEach(y=>{const V=y.get("offset"),b=V==f,w=b&&p||new Map;y.forEach((x,D)=>{let T=D,F=x;if("offset"!==D)switch(T=t.normalizePropertyName(T,s),F){case"!":F=a.get(D);break;case fe:F=o.get(D);break;default:F=t.normalizeStyleValue(D,T,F,s)}w.set(T,F)}),b||l.push(w),p=w,f=V}),s.length)throw function Sn2(e){return new q(3502,!1)}();return l}function x9(e,t,n,r){switch(t){case"start":e.onStart(()=>r(n&&D9(n,"start",e)));break;case"done":e.onDone(()=>r(n&&D9(n,"done",e)));break;case"destroy":e.onDestroy(()=>r(n&&D9(n,"destroy",e)))}}function D9(e,t,n){const o=E9(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,n.totalTime??e.totalTime,!!n.disabled),s=e._data;return null!=s&&(o._data=s),o}function E9(e,t,n,r,a="",o=0,s){return{element:e,triggerName:t,fromState:n,toState:r,phaseName:a,totalTime:o,disabled:!!s}}function U3(e,t,n){let r=e.get(t);return r||e.set(t,r=n),r}function _L(e){const t=e.indexOf(":");return[e.substring(1,t),e.slice(t+1)]}let N9=(e,t)=>!1,xL=(e,t,n)=>[],DL=null;function k9(e){const t=e.parentNode||e.host;return t===DL?null:t}(_9()||typeof Element<"u")&&(Pn2()?(DL=(()=>document.documentElement)(),N9=(e,t)=>{for(;t;){if(t===e)return!0;t=k9(t)}return!1}):N9=(e,t)=>e.contains(t),xL=(e,t,n)=>{if(n)return Array.from(e.querySelectorAll(t));const r=e.querySelector(t);return r?[r]:[]});let M6=null,EL=!1;const NL=N9,kL=xL;let TL=(()=>{class e{validateStyleProperty(n){return function Fn2(e){M6||(M6=function On2(){return typeof document<"u"?document.body:null}()||{},EL=!!M6.style&&"WebkitAppearance"in M6.style);let t=!0;return M6.style&&!function In2(e){return"ebkit"==e.substring(1,6)}(e)&&(t=e in M6.style,!t&&EL&&(t="Webkit"+e.charAt(0).toUpperCase()+e.slice(1)in M6.style)),t}(n)}matchesElement(n,r){return!1}containsElement(n,r){return NL(n,r)}getParentElement(n){return k9(n)}query(n,r,a){return kL(n,r,a)}computeStyle(n,r,a){return a||""}animate(n,r,a,o,s,l=[],f){return new qt(a,o)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=z({token:e,factory:e.\u0275fac}),e})(),T9=(()=>{class e{}return e.NOOP=new TL,e})();const A9="ng-enter",D0="ng-leave",E0="ng-trigger",N0=".ng-trigger",PL="ng-animating",P9=".ng-animating";function je(e){if("number"==typeof e)return e;const t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:I9(parseFloat(t[1]),t[2])}function I9(e,t){return"s"===t?1e3*e:e}function k0(e,t,n){return e.hasOwnProperty("duration")?e:function Wn2(e,t,n){let a,o=0,s="";if("string"==typeof e){const l=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===l)return t.push(zL()),{duration:0,delay:0,easing:""};a=I9(parseFloat(l[1]),l[2]);const f=l[3];null!=f&&(o=I9(parseFloat(f),l[4]));const p=l[5];p&&(s=p)}else a=e;if(!n){let l=!1,f=t.length;a<0&&(t.push(function nn2(){return new q(3100,!1)}()),l=!0),o<0&&(t.push(function rn2(){return new q(3101,!1)}()),l=!0),l&&t.splice(f,0,zL())}return{duration:a,delay:o,easing:s}}(e,t,n)}function s8(e,t={}){return Object.keys(e).forEach(n=>{t[n]=e[n]}),t}function IL(e){const t=new Map;return Object.keys(e).forEach(n=>{t.set(n,e[n])}),t}function Ue(e,t=new Map,n){if(n)for(let[r,a]of n)t.set(r,a);for(let[r,a]of e)t.set(r,a);return t}function OL(e,t,n){return n?t+":"+n+";":""}function RL(e){let t="";for(let n=0;n<e.style.length;n++){const r=e.style.item(n);t+=OL(0,r,e.style.getPropertyValue(r))}for(const n in e.style)e.style.hasOwnProperty(n)&&!n.startsWith("_")&&(t+=OL(0,qn2(n),e.style[n]));e.setAttribute("style",t)}function j4(e,t,n){e.style&&(t.forEach((r,a)=>{const o=O9(a);n&&!n.has(a)&&n.set(a,e.style[o]),e.style[o]=r}),_9()&&RL(e))}function L6(e,t){e.style&&(t.forEach((n,r)=>{const a=O9(r);e.style[a]=""}),_9()&&RL(e))}function c8(e){return Array.isArray(e)?1==e.length?e[0]:Nf(e):e}const F9=new RegExp("{{\\s*(.+?)\\s*}}","g");function BL(e){let t=[];if("string"==typeof e){let n;for(;n=F9.exec(e);)t.push(n[1]);F9.lastIndex=0}return t}function T0(e,t,n){const r=e.toString(),a=r.replace(F9,(o,s)=>{let l=t[s];return null==l&&(n.push(function in2(e){return new q(3003,!1)}()),l=""),l.toString()});return a==r?e:a}function A0(e){const t=[];let n=e.next();for(;!n.done;)t.push(n.value),n=e.next();return t}const Gn2=/-+([a-z0-9])/g;function O9(e){return e.replace(Gn2,(...t)=>t[1].toUpperCase())}function qn2(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function G3(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw function on2(e){return new q(3004,!1)}()}}function WL(e,t){return window.getComputedStyle(e)[t]}function Xn2(e,t){const n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(r=>function Zn2(e,t,n){if(":"==e[0]){const f=function e02(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(n,r)=>parseFloat(r)>parseFloat(n);case":decrement":return(n,r)=>parseFloat(r)<parseFloat(n);default:return t.push(function Mn2(e){return new q(3016,!1)}()),"* => *"}}(e,n);if("function"==typeof f)return void t.push(f);e=f}const r=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push(function yn2(e){return new q(3015,!1)}()),t;const a=r[1],o=r[2],s=r[3];t.push(jL(a,s));"<"==o[0]&&!("*"==a&&"*"==s)&&t.push(jL(s,a))}(r,n,t)):n.push(e),n}const O0=new Set(["true","1"]),R0=new Set(["false","0"]);function jL(e,t){const n=O0.has(e)||R0.has(e),r=O0.has(t)||R0.has(t);return(a,o)=>{let s="*"==e||e==a,l="*"==t||t==o;return!s&&n&&"boolean"==typeof a&&(s=a?O0.has(e):R0.has(e)),!l&&r&&"boolean"==typeof o&&(l=o?O0.has(t):R0.has(t)),s&&l}}const t02=new RegExp("s*:selfs*,?","g");function R9(e,t,n,r){return new n02(e).build(t,n,r)}class n02{constructor(t){this._driver=t}build(t,n,r){const a=new i02(n);return this._resetContextStyleTimingState(a),G3(this,c8(t),a)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,n){let r=n.queryCount=0,a=n.depCount=0;const o=[],s=[];return"@"==t.name.charAt(0)&&n.errors.push(function cn2(){return new q(3006,!1)}()),t.definitions.forEach(l=>{if(this._resetContextStyleTimingState(n),0==l.type){const f=l,p=f.name;p.toString().split(/\s*,\s*/).forEach(y=>{f.name=y,o.push(this.visitState(f,n))}),f.name=p}else if(1==l.type){const f=this.visitTransition(l,n);r+=f.queryCount,a+=f.depCount,s.push(f)}else n.errors.push(function ln2(){return new q(3007,!1)}())}),{type:7,name:t.name,states:o,transitions:s,queryCount:r,depCount:a,options:null}}visitState(t,n){const r=this.visitStyle(t.styles,n),a=t.options&&t.options.params||null;if(r.containsDynamicStyles){const o=new Set,s=a||{};r.styles.forEach(l=>{l instanceof Map&&l.forEach(f=>{BL(f).forEach(p=>{s.hasOwnProperty(p)||o.add(p)})})}),o.size&&(A0(o.values()),n.errors.push(function un2(e,t){return new q(3008,!1)}()))}return{type:0,name:t.name,style:r,options:a?{params:a}:null}}visitTransition(t,n){n.queryCount=0,n.depCount=0;const r=G3(this,c8(t.animation),n);return{type:1,matchers:Xn2(t.expr,n.errors),animation:r,queryCount:n.queryCount,depCount:n.depCount,options:V6(t.options)}}visitSequence(t,n){return{type:2,steps:t.steps.map(r=>G3(this,r,n)),options:V6(t.options)}}visitGroup(t,n){const r=n.currentTime;let a=0;const o=t.steps.map(s=>{n.currentTime=r;const l=G3(this,s,n);return a=Math.max(a,n.currentTime),l});return n.currentTime=a,{type:3,steps:o,options:V6(t.options)}}visitAnimate(t,n){const r=function s02(e,t){if(e.hasOwnProperty("duration"))return e;if("number"==typeof e)return B9(k0(e,t).duration,0,"");const n=e;if(n.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=B9(0,0,"");return o.dynamic=!0,o.strValue=n,o}const a=k0(n,t);return B9(a.duration,a.delay,a.easing)}(t.timings,n.errors);n.currentAnimateTimings=r;let a,o=t.styles?t.styles:d6({});if(5==o.type)a=this.visitKeyframes(o,n);else{let s=t.styles,l=!1;if(!s){l=!0;const p={};r.easing&&(p.easing=r.easing),s=d6(p)}n.currentTime+=r.duration+r.delay;const f=this.visitStyle(s,n);f.isEmptyStep=l,a=f}return n.currentAnimateTimings=null,{type:4,timings:r,style:a,options:null}}visitStyle(t,n){const r=this._makeStyleAst(t,n);return this._validateStyleAst(r,n),r}_makeStyleAst(t,n){const r=[],a=Array.isArray(t.styles)?t.styles:[t.styles];for(let l of a)"string"==typeof l?l===fe?r.push(l):n.errors.push(new q(3002,!1)):r.push(IL(l));let o=!1,s=null;return r.forEach(l=>{if(l instanceof Map&&(l.has("easing")&&(s=l.get("easing"),l.delete("easing")),!o))for(let f of l.values())if(f.toString().indexOf("{{")>=0){o=!0;break}}),{type:6,styles:r,easing:s,offset:t.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(t,n){const r=n.currentAnimateTimings;let a=n.currentTime,o=n.currentTime;r&&o>0&&(o-=r.duration+r.delay),t.styles.forEach(s=>{"string"!=typeof s&&s.forEach((l,f)=>{const p=n.collectedStyles.get(n.currentQuerySelector),y=p.get(f);let V=!0;y&&(o!=a&&o>=y.startTime&&a<=y.endTime&&(n.errors.push(function fn2(e,t,n,r,a){return new q(3010,!1)}()),V=!1),o=y.startTime),V&&p.set(f,{startTime:o,endTime:a}),n.options&&function Un2(e,t,n){const r=t.params||{},a=BL(e);a.length&&a.forEach(o=>{r.hasOwnProperty(o)||n.push(function an2(e){return new q(3001,!1)}())})}(l,n.options,n.errors)})})}visitKeyframes(t,n){const r={type:5,styles:[],options:null};if(!n.currentAnimateTimings)return n.errors.push(function hn2(){return new q(3011,!1)}()),r;let o=0;const s=[];let l=!1,f=!1,p=0;const y=t.steps.map(F=>{const U=this._makeStyleAst(F,n);let k=null!=U.offset?U.offset:function o02(e){if("string"==typeof e)return null;let t=null;if(Array.isArray(e))e.forEach(n=>{if(n instanceof Map&&n.has("offset")){const r=n;t=parseFloat(r.get("offset")),r.delete("offset")}});else if(e instanceof Map&&e.has("offset")){const n=e;t=parseFloat(n.get("offset")),n.delete("offset")}return t}(U.styles),G=0;return null!=k&&(o++,G=U.offset=k),f=f||G<0||G>1,l=l||G<p,p=G,s.push(G),U});f&&n.errors.push(function dn2(){return new q(3012,!1)}()),l&&n.errors.push(function pn2(){return new q(3200,!1)}());const V=t.steps.length;let b=0;o>0&&o<V?n.errors.push(function mn2(){return new q(3202,!1)}()):0==o&&(b=1/(V-1));const w=V-1,x=n.currentTime,D=n.currentAnimateTimings,T=D.duration;return y.forEach((F,U)=>{const k=b>0?U==w?1:b*U:s[U],G=k*T;n.currentTime=x+D.delay+G,D.duration=G,this._validateStyleAst(F,n),F.offset=k,r.styles.push(F)}),r}visitReference(t,n){return{type:8,animation:G3(this,c8(t.animation),n),options:V6(t.options)}}visitAnimateChild(t,n){return n.depCount++,{type:9,options:V6(t.options)}}visitAnimateRef(t,n){return{type:10,animation:this.visitReference(t.animation,n),options:V6(t.options)}}visitQuery(t,n){const r=n.currentQuerySelector,a=t.options||{};n.queryCount++,n.currentQuery=t;const[o,s]=function r02(e){const t=!!e.split(/\s*,\s*/).find(n=>":self"==n);return t&&(e=e.replace(t02,"")),e=e.replace(/@\*/g,N0).replace(/@\w+/g,n=>N0+"-"+n.slice(1)).replace(/:animating/g,P9),[e,t]}(t.selector);n.currentQuerySelector=r.length?r+" "+o:o,U3(n.collectedStyles,n.currentQuerySelector,new Map);const l=G3(this,c8(t.animation),n);return n.currentQuery=null,n.currentQuerySelector=r,{type:11,selector:o,limit:a.limit||0,optional:!!a.optional,includeSelf:s,animation:l,originalSelector:t.selector,options:V6(t.options)}}visitStagger(t,n){n.currentQuery||n.errors.push(function gn2(){return new q(3013,!1)}());const r="full"===t.timings?{duration:0,delay:0,easing:"full"}:k0(t.timings,n.errors,!0);return{type:12,animation:G3(this,c8(t.animation),n),timings:r,options:null}}}class i02{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function V6(e){return e?(e=s8(e)).params&&(e.params=function a02(e){return e?s8(e):null}(e.params)):e={},e}function B9(e,t,n){return{duration:e,delay:t,easing:n}}function W9(e,t,n,r,a,o,s=null,l=!1){return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:a,delay:o,totalTime:a+o,easing:s,subTimeline:l}}class B0{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,n){let r=this._map.get(t);r||this._map.set(t,r=[]),r.push(...n)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const u02=new RegExp(":enter","g"),f02=new RegExp(":leave","g");function j9(e,t,n,r,a,o=new Map,s=new Map,l,f,p=[]){return(new h02).buildKeyframes(e,t,n,r,a,o,s,l,f,p)}class h02{buildKeyframes(t,n,r,a,o,s,l,f,p,y=[]){p=p||new B0;const V=new U9(t,n,p,a,o,y,[]);V.options=f;const b=f.delay?je(f.delay):0;V.currentTimeline.delayNextStep(b),V.currentTimeline.setStyles([s],null,V.errors,f),G3(this,r,V);const w=V.timelines.filter(x=>x.containsAnimation());if(w.length&&l.size){let x;for(let D=w.length-1;D>=0;D--){const T=w[D];if(T.element===n){x=T;break}}x&&!x.allowOnlyTimelineStyles()&&x.setStyles([l],null,V.errors,f)}return w.length?w.map(x=>x.buildKeyframes()):[W9(n,[],[],[],0,b,"",!1)]}visitTrigger(t,n){}visitState(t,n){}visitTransition(t,n){}visitAnimateChild(t,n){const r=n.subInstructions.get(n.element);if(r){const a=n.createSubContext(t.options),o=n.currentTimeline.currentTime,s=this._visitSubInstructions(r,a,a.options);o!=s&&n.transformIntoNewTimeline(s)}n.previousNode=t}visitAnimateRef(t,n){const r=n.createSubContext(t.options);r.transformIntoNewTimeline(),this.visitReference(t.animation,r),n.transformIntoNewTimeline(r.currentTimeline.currentTime),n.previousNode=t}_visitSubInstructions(t,n,r){let o=n.currentTimeline.currentTime;const s=null!=r.duration?je(r.duration):null,l=null!=r.delay?je(r.delay):null;return 0!==s&&t.forEach(f=>{const p=n.appendInstructionToTimeline(f,s,l);o=Math.max(o,p.duration+p.delay)}),o}visitReference(t,n){n.updateOptions(t.options,!0),G3(this,t.animation,n),n.previousNode=t}visitSequence(t,n){const r=n.subContextCount;let a=n;const o=t.options;if(o&&(o.params||o.delay)&&(a=n.createSubContext(o),a.transformIntoNewTimeline(),null!=o.delay)){6==a.previousNode.type&&(a.currentTimeline.snapshotCurrentStyles(),a.previousNode=W0);const s=je(o.delay);a.delayNextStep(s)}t.steps.length&&(t.steps.forEach(s=>G3(this,s,a)),a.currentTimeline.applyStylesToKeyframe(),a.subContextCount>r&&a.transformIntoNewTimeline()),n.previousNode=t}visitGroup(t,n){const r=[];let a=n.currentTimeline.currentTime;const o=t.options&&t.options.delay?je(t.options.delay):0;t.steps.forEach(s=>{const l=n.createSubContext(t.options);o&&l.delayNextStep(o),G3(this,s,l),a=Math.max(a,l.currentTimeline.currentTime),r.push(l.currentTimeline)}),r.forEach(s=>n.currentTimeline.mergeTimelineCollectedStyles(s)),n.transformIntoNewTimeline(a),n.previousNode=t}_visitTiming(t,n){if(t.dynamic){const r=t.strValue;return k0(n.params?T0(r,n.params,n.errors):r,n.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,n){const r=n.currentAnimateTimings=this._visitTiming(t.timings,n),a=n.currentTimeline;r.delay&&(n.incrementTime(r.delay),a.snapshotCurrentStyles());const o=t.style;5==o.type?this.visitKeyframes(o,n):(n.incrementTime(r.duration),this.visitStyle(o,n),a.applyStylesToKeyframe()),n.currentAnimateTimings=null,n.previousNode=t}visitStyle(t,n){const r=n.currentTimeline,a=n.currentAnimateTimings;!a&&r.hasCurrentStyleProperties()&&r.forwardFrame();const o=a&&a.easing||t.easing;t.isEmptyStep?r.applyEmptyStep(o):r.setStyles(t.styles,o,n.errors,n.options),n.previousNode=t}visitKeyframes(t,n){const r=n.currentAnimateTimings,a=n.currentTimeline.duration,o=r.duration,l=n.createSubContext().currentTimeline;l.easing=r.easing,t.styles.forEach(f=>{l.forwardTime((f.offset||0)*o),l.setStyles(f.styles,f.easing,n.errors,n.options),l.applyStylesToKeyframe()}),n.currentTimeline.mergeTimelineCollectedStyles(l),n.transformIntoNewTimeline(a+o),n.previousNode=t}visitQuery(t,n){const r=n.currentTimeline.currentTime,a=t.options||{},o=a.delay?je(a.delay):0;o&&(6===n.previousNode.type||0==r&&n.currentTimeline.hasCurrentStyleProperties())&&(n.currentTimeline.snapshotCurrentStyles(),n.previousNode=W0);let s=r;const l=n.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!a.optional,n.errors);n.currentQueryTotal=l.length;let f=null;l.forEach((p,y)=>{n.currentQueryIndex=y;const V=n.createSubContext(t.options,p);o&&V.delayNextStep(o),p===n.element&&(f=V.currentTimeline),G3(this,t.animation,V),V.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,V.currentTimeline.currentTime)}),n.currentQueryIndex=0,n.currentQueryTotal=0,n.transformIntoNewTimeline(s),f&&(n.currentTimeline.mergeTimelineCollectedStyles(f),n.currentTimeline.snapshotCurrentStyles()),n.previousNode=t}visitStagger(t,n){const r=n.parentContext,a=n.currentTimeline,o=t.timings,s=Math.abs(o.duration),l=s*(n.currentQueryTotal-1);let f=s*n.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":f=l-f;break;case"full":f=r.currentStaggerTime}const y=n.currentTimeline;f&&y.delayNextStep(f);const V=y.currentTime;G3(this,t.animation,n),n.previousNode=t,r.currentStaggerTime=a.currentTime-V+(a.startTime-r.currentTimeline.startTime)}}const W0={};class U9{constructor(t,n,r,a,o,s,l,f){this._driver=t,this.element=n,this.subInstructions=r,this._enterClassName=a,this._leaveClassName=o,this.errors=s,this.timelines=l,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=W0,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=f||new j0(this._driver,n,0),l.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,n){if(!t)return;const r=t;let a=this.options;null!=r.duration&&(a.duration=je(r.duration)),null!=r.delay&&(a.delay=je(r.delay));const o=r.params;if(o){let s=a.params;s||(s=this.options.params={}),Object.keys(o).forEach(l=>{(!n||!s.hasOwnProperty(l))&&(s[l]=T0(o[l],s,this.errors))})}}_copyOptions(){const t={};if(this.options){const n=this.options.params;if(n){const r=t.params={};Object.keys(n).forEach(a=>{r[a]=n[a]})}}return t}createSubContext(t=null,n,r){const a=n||this.element,o=new U9(this._driver,a,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(a,r||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(t),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(t){return this.previousNode=W0,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,n,r){const a={duration:n??t.duration,delay:this.currentTimeline.currentTime+(r??0)+t.delay,easing:""},o=new d02(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,a,t.stretchStartingKeyframe);return this.timelines.push(o),a}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,n,r,a,o,s){let l=[];if(a&&l.push(this.element),t.length>0){t=(t=t.replace(u02,"."+this._enterClassName)).replace(f02,"."+this._leaveClassName);let p=this._driver.query(this.element,t,1!=r);0!==r&&(p=r<0?p.slice(p.length+r,p.length):p.slice(0,r)),l.push(...p)}return!o&&0==l.length&&s.push(function vn2(e){return new q(3014,!1)}()),l}}class j0{constructor(t,n,r,a){this._driver=t,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=a,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const n=1===this._keyframes.size&&this._pendingStyles.size;this.duration||n?(this.forwardTime(this.currentTime+t),n&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,n){return this.applyStylesToKeyframe(),new j0(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,n){this._localTimelineStyles.set(t,n),this._globalTimelineStyles.set(t,n),this._styleSummary.set(t,{time:this.currentTime,value:n})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[n,r]of this._globalTimelineStyles)this._backFill.set(n,r||fe),this._currentKeyframe.set(n,fe);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,n,r,a){n&&this._previousKeyframe.set("easing",n);const o=a&&a.params||{},s=function p02(e,t){const n=new Map;let r;return e.forEach(a=>{if("*"===a){r=r||t.keys();for(let o of r)n.set(o,fe)}else Ue(a,n)}),n}(t,this._globalTimelineStyles);for(let[l,f]of s){const p=T0(f,o,r);this._pendingStyles.set(l,p),this._localTimelineStyles.has(l)||this._backFill.set(l,this._globalTimelineStyles.get(l)??fe),this._updateStyle(l,p)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,n)=>{this._currentKeyframe.set(n,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,n)=>{this._currentKeyframe.has(n)||this._currentKeyframe.set(n,t)}))}snapshotCurrentStyles(){for(let[t,n]of this._localTimelineStyles)this._pendingStyles.set(t,n),this._updateStyle(t,n)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let n in this._currentKeyframe)t.push(n);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((n,r)=>{const a=this._styleSummary.get(r);(!a||n.time>a.time)&&this._updateStyle(r,n.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration;let a=[];this._keyframes.forEach((l,f)=>{const p=Ue(l,new Map,this._backFill);p.forEach((y,V)=>{"!"===y?t.add(V):y===fe&&n.add(V)}),r||p.set("offset",f/this.duration),a.push(p)});const o=t.size?A0(t.values()):[],s=n.size?A0(n.values()):[];if(r){const l=a[0],f=new Map(l);l.set("offset",0),f.set("offset",1),a=[l,f]}return W9(this.element,a,o,s,this.duration,this.startTime,this.easing,!1)}}class d02 extends j0{constructor(t,n,r,a,o,s,l=!1){super(t,n,s.delay),this.keyframes=r,this.preStyleProps=a,this.postStyleProps=o,this._stretchStartingKeyframe=l,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:n,duration:r,easing:a}=this.timings;if(this._stretchStartingKeyframe&&n){const o=[],s=r+n,l=n/s,f=Ue(t[0]);f.set("offset",0),o.push(f);const p=Ue(t[0]);p.set("offset",qL(l)),o.push(p);const y=t.length-1;for(let V=1;V<=y;V++){let b=Ue(t[V]);const w=b.get("offset");b.set("offset",qL((n+w*r)/s)),o.push(b)}r=s,n=0,a="",t=o}return W9(this.element,t,this.preStyleProps,this.postStyleProps,r,n,a,!0)}}function qL(e,t=3){const n=Math.pow(10,t-1);return Math.round(e*n)/n}class G9{}const m02=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class g02 extends G9{normalizePropertyName(t,n){return O9(t)}normalizeStyleValue(t,n,r,a){let o="";const s=r.toString().trim();if(m02.has(n)&&0!==r&&"0"!==r)if("number"==typeof r)o="px";else{const l=r.match(/^[+-]?[\d\.]+([a-z]*)$/);l&&0==l[1].length&&a.push(function sn2(e,t){return new q(3005,!1)}())}return s+o}}function $L(e,t,n,r,a,o,s,l,f,p,y,V,b){return{type:0,element:e,triggerName:t,isRemovalTransition:a,fromState:n,fromStyles:o,toState:r,toStyles:s,timelines:l,queriedElements:f,preStyleProps:p,postStyleProps:y,totalTime:V,errors:b}}const q9={};class KL{constructor(t,n,r){this._triggerName=t,this.ast=n,this._stateStyles=r}match(t,n,r,a){return function v02(e,t,n,r,a){return e.some(o=>o(t,n,r,a))}(this.ast.matchers,t,n,r,a)}buildStyles(t,n,r){let a=this._stateStyles.get("*");return void 0!==t&&(a=this._stateStyles.get(t?.toString())||a),a?a.buildStyles(n,r):new Map}build(t,n,r,a,o,s,l,f,p,y){const V=[],b=this.ast.options&&this.ast.options.params||q9,x=this.buildStyles(r,l&&l.params||q9,V),D=f&&f.params||q9,T=this.buildStyles(a,D,V),F=new Set,U=new Map,k=new Map,G="void"===a,l2={params:y02(D,b),delay:this.ast.options?.delay},S2=y?[]:j9(t,n,this.ast.animation,o,s,x,T,l2,p,V);let i1=0;if(S2.forEach(A1=>{i1=Math.max(A1.duration+A1.delay,i1)}),V.length)return $L(n,this._triggerName,r,a,G,x,T,[],[],U,k,i1,V);S2.forEach(A1=>{const q3=A1.element,k5=U3(U,q3,new Set);A1.preStyleProps.forEach(z4=>k5.add(z4));const ve=U3(k,q3,new Set);A1.postStyleProps.forEach(z4=>ve.add(z4)),q3!==n&&F.add(q3)});const j1=A0(F.values());return $L(n,this._triggerName,r,a,G,x,T,S2,j1,U,k,i1)}}function y02(e,t){const n=s8(t);for(const r in e)e.hasOwnProperty(r)&&null!=e[r]&&(n[r]=e[r]);return n}class M02{constructor(t,n,r){this.styles=t,this.defaultParams=n,this.normalizer=r}buildStyles(t,n){const r=new Map,a=s8(this.defaultParams);return Object.keys(t).forEach(o=>{const s=t[o];null!==s&&(a[o]=s)}),this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((s,l)=>{s&&(s=T0(s,a,n));const f=this.normalizer.normalizePropertyName(l,n);s=this.normalizer.normalizeStyleValue(l,f,s,n),r.set(f,s)})}),r}}class V02{constructor(t,n,r){this.name=t,this.ast=n,this._normalizer=r,this.transitionFactories=[],this.states=new Map,n.states.forEach(a=>{this.states.set(a.name,new M02(a.style,a.options&&a.options.params||{},r))}),QL(this.states,"true","1"),QL(this.states,"false","0"),n.transitions.forEach(a=>{this.transitionFactories.push(new KL(t,a,this.states))}),this.fallbackTransition=function H02(e,t,n){return new KL(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(s,l)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,n,r,a){return this.transitionFactories.find(s=>s.match(t,n,r,a))||null}matchStyles(t,n,r){return this.fallbackTransition.buildStyles(t,n,r)}}function QL(e,t,n){e.has(t)?e.has(n)||e.set(n,e.get(t)):e.has(n)&&e.set(t,e.get(n))}const S02=new B0;class b02{constructor(t,n,r){this.bodyNode=t,this._driver=n,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,n){const r=[],o=R9(this._driver,n,r,[]);if(r.length)throw function bn2(e){return new q(3503,!1)}();this._animations.set(t,o)}_buildPlayer(t,n,r){const a=t.element,o=wL(0,this._normalizer,0,t.keyframes,n,r);return this._driver.animate(a,o,t.duration,t.delay,t.easing,[],!0)}create(t,n,r={}){const a=[],o=this._animations.get(t);let s;const l=new Map;if(o?(s=j9(this._driver,n,o,A9,D0,new Map,new Map,r,S02,a),s.forEach(y=>{const V=U3(l,y.element,new Map);y.postStyleProps.forEach(b=>V.set(b,null))})):(a.push(function zn2(){return new q(3300,!1)}()),s=[]),a.length)throw function wn2(e){return new q(3504,!1)}();l.forEach((y,V)=>{y.forEach((b,w)=>{y.set(w,this._driver.computeStyle(V,w,fe))})});const p=We(s.map(y=>{const V=l.get(y.element);return this._buildPlayer(y,new Map,V)}));return this._playersById.set(t,p),p.onDestroy(()=>this.destroy(t)),this.players.push(p),p}destroy(t){const n=this._getPlayer(t);n.destroy(),this._playersById.delete(t);const r=this.players.indexOf(n);r>=0&&this.players.splice(r,1)}_getPlayer(t){const n=this._playersById.get(t);if(!n)throw function _n2(e){return new q(3301,!1)}();return n}listen(t,n,r,a){const o=E9(n,"","","");return x9(this._getPlayer(t),r,o,a),()=>{}}command(t,n,r,a){if("register"==r)return void this.register(t,a[0]);if("create"==r)return void this.create(t,n,a[0]||{});const o=this._getPlayer(t);switch(r){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(a[0]));break;case"destroy":this.destroy(t)}}}const YL="ng-animate-queued",$9="ng-animate-disabled",D02=[],JL={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},E02={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},o4="__ng_removed";class K9{constructor(t,n=""){this.namespaceId=n;const r=t&&t.hasOwnProperty("value");if(this.value=function A02(e){return e??null}(r?t.value:t),r){const o=s8(t);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const n=t.params;if(n){const r=this.options.params;Object.keys(n).forEach(a=>{null==r[a]&&(r[a]=n[a])})}}}const l8="void",Q9=new K9(l8);class N02{constructor(t,n,r){this.id=t,this.hostElement=n,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,s4(n,this._hostClassName)}listen(t,n,r,a){if(!this._triggers.has(n))throw function xn2(e,t){return new q(3302,!1)}();if(null==r||0==r.length)throw function Dn2(e){return new q(3303,!1)}();if(!function P02(e){return"start"==e||"done"==e}(r))throw function En2(e,t){return new q(3400,!1)}();const o=U3(this._elementListeners,t,[]),s={name:n,phase:r,callback:a};o.push(s);const l=U3(this._engine.statesByElement,t,new Map);return l.has(n)||(s4(t,E0),s4(t,E0+"-"+n),l.set(n,Q9)),()=>{this._engine.afterFlush(()=>{const f=o.indexOf(s);f>=0&&o.splice(f,1),this._triggers.has(n)||l.delete(n)})}}register(t,n){return!this._triggers.has(t)&&(this._triggers.set(t,n),!0)}_getTrigger(t){const n=this._triggers.get(t);if(!n)throw function Nn2(e){return new q(3401,!1)}();return n}trigger(t,n,r,a=!0){const o=this._getTrigger(n),s=new Y9(this.id,n,t);let l=this._engine.statesByElement.get(t);l||(s4(t,E0),s4(t,E0+"-"+n),this._engine.statesByElement.set(t,l=new Map));let f=l.get(n);const p=new K9(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&f&&p.absorbOptions(f.options),l.set(n,p),f||(f=Q9),p.value!==l8&&f.value===p.value){if(!function O02(e,t){const n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(let a=0;a<n.length;a++){const o=n[a];if(!t.hasOwnProperty(o)||e[o]!==t[o])return!1}return!0}(f.params,p.params)){const D=[],T=o.matchStyles(f.value,f.params,D),F=o.matchStyles(p.value,p.params,D);D.length?this._engine.reportError(D):this._engine.afterFlush(()=>{L6(t,T),j4(t,F)})}return}const b=U3(this._engine.playersByElement,t,[]);b.forEach(D=>{D.namespaceId==this.id&&D.triggerName==n&&D.queued&&D.destroy()});let w=o.matchTransition(f.value,p.value,t,p.params),x=!1;if(!w){if(!a)return;w=o.fallbackTransition,x=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:n,transition:w,fromState:f,toState:p,player:s,isFallbackTransition:x}),x||(s4(t,YL),s.onStart(()=>{N5(t,YL)})),s.onDone(()=>{let D=this.players.indexOf(s);D>=0&&this.players.splice(D,1);const T=this._engine.playersByElement.get(t);if(T){let F=T.indexOf(s);F>=0&&T.splice(F,1)}}),this.players.push(s),b.push(s),s}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(n=>n.delete(t)),this._elementListeners.forEach((n,r)=>{this._elementListeners.set(r,n.filter(a=>a.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const n=this._engine.playersByElement.get(t);n&&(n.forEach(r=>r.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,n){const r=this._engine.driver.query(t,N0,!0);r.forEach(a=>{if(a[o4])return;const o=this._engine.fetchNamespacesByElement(a);o.size?o.forEach(s=>s.triggerLeaveAnimation(a,n,!1,!0)):this.clearElementCache(a)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(a=>this.clearElementCache(a)))}triggerLeaveAnimation(t,n,r,a){const o=this._engine.statesByElement.get(t),s=new Map;if(o){const l=[];if(o.forEach((f,p)=>{if(s.set(p,f.value),this._triggers.has(p)){const y=this.trigger(t,p,l8,a);y&&l.push(y)}}),l.length)return this._engine.markElementAsRemoved(this.id,t,!0,n,s),r&&We(l).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const n=this._elementListeners.get(t),r=this._engine.statesByElement.get(t);if(n&&r){const a=new Set;n.forEach(o=>{const s=o.name;if(a.has(s))return;a.add(s);const f=this._triggers.get(s).fallbackTransition,p=r.get(s)||Q9,y=new K9(l8),V=new Y9(this.id,s,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:s,transition:f,fromState:p,toState:y,player:V,isFallbackTransition:!0})})}}removeNode(t,n){const r=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,n),this.triggerLeaveAnimation(t,n,!0))return;let a=!1;if(r.totalAnimations){const o=r.players.length?r.playersByQueriedElement.get(t):[];if(o&&o.length)a=!0;else{let s=t;for(;s=s.parentNode;)if(r.statesByElement.get(s)){a=!0;break}}}if(this.prepareLeaveAnimationListeners(t),a)r.markElementAsRemoved(this.id,t,!1,n);else{const o=t[o4];(!o||o===JL)&&(r.afterFlush(()=>this.clearElementCache(t)),r.destroyInnerAnimations(t),r._onRemovalComplete(t,n))}}insertNode(t,n){s4(t,this._hostClassName)}drainQueuedTransitions(t){const n=[];return this._queue.forEach(r=>{const a=r.player;if(a.destroyed)return;const o=r.element,s=this._elementListeners.get(o);s&&s.forEach(l=>{if(l.name==r.triggerName){const f=E9(o,r.triggerName,r.fromState.value,r.toState.value);f._data=t,x9(r.player,l.phase,f,l.callback)}}),a.markedForDestroy?this._engine.afterFlush(()=>{a.destroy()}):n.push(r)}),this._queue=[],n.sort((r,a)=>{const o=r.transition.ast.depCount,s=a.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(r.element,a.element)?1:-1})}destroy(t){this.players.forEach(n=>n.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let n=!1;return this._elementListeners.has(t)&&(n=!0),n=!!this._queue.find(r=>r.element===t)||n,n}}class k02{constructor(t,n,r){this.bodyNode=t,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(a,o)=>{}}_onRemovalComplete(t,n){this.onRemovalComplete(t,n)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(n=>{n.players.forEach(r=>{r.queued&&t.push(r)})}),t}createNamespace(t,n){const r=new N02(t,n,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,n)?this._balanceNamespaceList(r,n):(this.newHostElements.set(n,r),this.collectEnterElement(n)),this._namespaceLookup[t]=r}_balanceNamespaceList(t,n){const r=this._namespaceList,a=this.namespacesByHostElement;if(r.length-1>=0){let s=!1,l=this.driver.getParentElement(n);for(;l;){const f=a.get(l);if(f){const p=r.indexOf(f);r.splice(p+1,0,t),s=!0;break}l=this.driver.getParentElement(l)}s||r.unshift(t)}else r.push(t);return a.set(n,t),t}register(t,n){let r=this._namespaceLookup[t];return r||(r=this.createNamespace(t,n)),r}registerTrigger(t,n,r){let a=this._namespaceLookup[t];a&&a.register(n,r)&&this.totalAnimations++}destroy(t,n){if(!t)return;const r=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[t];const a=this._namespaceList.indexOf(r);a>=0&&this._namespaceList.splice(a,1)}),this.afterFlushAnimationsDone(()=>r.destroy(n))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const n=new Set,r=this.statesByElement.get(t);if(r)for(let a of r.values())if(a.namespaceId){const o=this._fetchNamespace(a.namespaceId);o&&n.add(o)}return n}trigger(t,n,r,a){if(U0(n)){const o=this._fetchNamespace(t);if(o)return o.trigger(n,r,a),!0}return!1}insertNode(t,n,r,a){if(!U0(n))return;const o=n[o4];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(n);s>=0&&this.collectedLeaveElements.splice(s,1)}if(t){const s=this._fetchNamespace(t);s&&s.insertNode(n,r)}a&&this.collectEnterElement(n)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,n){n?this.disabledNodes.has(t)||(this.disabledNodes.add(t),s4(t,$9)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),N5(t,$9))}removeNode(t,n,r,a){if(U0(n)){const o=t?this._fetchNamespace(t):null;if(o?o.removeNode(n,a):this.markElementAsRemoved(t,n,!1,a),r){const s=this.namespacesByHostElement.get(n);s&&s.id!==t&&s.removeNode(n,a)}}else this._onRemovalComplete(n,a)}markElementAsRemoved(t,n,r,a,o){this.collectedLeaveElements.push(n),n[o4]={namespaceId:t,setForRemoval:a,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:o}}listen(t,n,r,a,o){return U0(n)?this._fetchNamespace(t).listen(n,r,a,o):()=>{}}_buildInstruction(t,n,r,a,o){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,r,a,t.fromState.options,t.toState.options,n,o)}destroyInnerAnimations(t){let n=this.driver.query(t,N0,!0);n.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(n=this.driver.query(t,P9,!0),n.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(t){const n=this.playersByElement.get(t);n&&n.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(t){const n=this.playersByQueriedElement.get(t);n&&n.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return We(this.players).onDone(()=>t());t()})}processLeaveNode(t){const n=t[o4];if(n&&n.setForRemoval){if(t[o4]=JL,n.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,n.setForRemoval)}t.classList?.contains($9)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,a)=>this._balanceNamespaceList(r,a)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)s4(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{n=this._flushAnimations(r,t)}finally{for(let a=0;a<r.length;a++)r[a]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],n.length?We(n).onDone(()=>{r.forEach(a=>a())}):r.forEach(a=>a())}}reportError(t){throw function kn2(e){return new q(3402,!1)}()}_flushAnimations(t,n){const r=new B0,a=[],o=new Map,s=[],l=new Map,f=new Map,p=new Map,y=new Set;this.disabledNodes.forEach(r2=>{y.add(r2);const d2=this.driver.query(r2,".ng-animate-queued",!0);for(let L2=0;L2<d2.length;L2++)y.add(d2[L2])});const V=this.bodyNode,b=Array.from(this.statesByElement.keys()),w=eV(b,this.collectedEnterElements),x=new Map;let D=0;w.forEach((r2,d2)=>{const L2=A9+D++;x.set(d2,L2),r2.forEach(Q2=>s4(Q2,L2))});const T=[],F=new Set,U=new Set;for(let r2=0;r2<this.collectedLeaveElements.length;r2++){const d2=this.collectedLeaveElements[r2],L2=d2[o4];L2&&L2.setForRemoval&&(T.push(d2),F.add(d2),L2.hasAnimation?this.driver.query(d2,".ng-star-inserted",!0).forEach(Q2=>F.add(Q2)):U.add(d2))}const k=new Map,G=eV(b,Array.from(F));G.forEach((r2,d2)=>{const L2=D0+D++;k.set(d2,L2),r2.forEach(Q2=>s4(Q2,L2))}),t.push(()=>{w.forEach((r2,d2)=>{const L2=x.get(d2);r2.forEach(Q2=>N5(Q2,L2))}),G.forEach((r2,d2)=>{const L2=k.get(d2);r2.forEach(Q2=>N5(Q2,L2))}),T.forEach(r2=>{this.processLeaveNode(r2)})});const l2=[],S2=[];for(let r2=this._namespaceList.length-1;r2>=0;r2--)this._namespaceList[r2].drainQueuedTransitions(n).forEach(L2=>{const Q2=L2.player,Q1=L2.element;if(l2.push(Q2),this.collectedEnterElements.length){const u3=Q1[o4];if(u3&&u3.setForMove){if(u3.previousTriggersValues&&u3.previousTriggersValues.has(L2.triggerName)){const H6=u3.previousTriggersValues.get(L2.triggerName),c4=this.statesByElement.get(L2.element);if(c4&&c4.has(L2.triggerName)){const $0=c4.get(L2.triggerName);$0.value=H6,c4.set(L2.triggerName,$0)}}return void Q2.destroy()}}const U4=!V||!this.driver.containsElement(V,Q1),$3=k.get(Q1),Ge=x.get(Q1),V1=this._buildInstruction(L2,r,Ge,$3,U4);if(V1.errors&&V1.errors.length)return void S2.push(V1);if(U4)return Q2.onStart(()=>L6(Q1,V1.fromStyles)),Q2.onDestroy(()=>j4(Q1,V1.toStyles)),void a.push(Q2);if(L2.isFallbackTransition)return Q2.onStart(()=>L6(Q1,V1.fromStyles)),Q2.onDestroy(()=>j4(Q1,V1.toStyles)),void a.push(Q2);const lV=[];V1.timelines.forEach(u3=>{u3.stretchStartingKeyframe=!0,this.disabledNodes.has(u3.element)||lV.push(u3)}),V1.timelines=lV,r.append(Q1,V1.timelines),s.push({instruction:V1,player:Q2,element:Q1}),V1.queriedElements.forEach(u3=>U3(l,u3,[]).push(Q2)),V1.preStyleProps.forEach((u3,H6)=>{if(u3.size){let c4=f.get(H6);c4||f.set(H6,c4=new Set),u3.forEach(($0,Z9)=>c4.add(Z9))}}),V1.postStyleProps.forEach((u3,H6)=>{let c4=p.get(H6);c4||p.set(H6,c4=new Set),u3.forEach(($0,Z9)=>c4.add(Z9))})});if(S2.length){const r2=[];S2.forEach(d2=>{r2.push(function Tn2(e,t){return new q(3505,!1)}())}),l2.forEach(d2=>d2.destroy()),this.reportError(r2)}const i1=new Map,j1=new Map;s.forEach(r2=>{const d2=r2.element;r.has(d2)&&(j1.set(d2,d2),this._beforeAnimationBuild(r2.player.namespaceId,r2.instruction,i1))}),a.forEach(r2=>{const d2=r2.element;this._getPreviousPlayers(d2,!1,r2.namespaceId,r2.triggerName,null).forEach(Q2=>{U3(i1,d2,[]).push(Q2),Q2.destroy()})});const A1=T.filter(r2=>nV(r2,f,p)),q3=new Map;ZL(q3,this.driver,U,p,fe).forEach(r2=>{nV(r2,f,p)&&A1.push(r2)});const ve=new Map;w.forEach((r2,d2)=>{ZL(ve,this.driver,new Set(r2),f,"!")}),A1.forEach(r2=>{const d2=q3.get(r2),L2=ve.get(r2);q3.set(r2,new Map([...Array.from(d2?.entries()??[]),...Array.from(L2?.entries()??[])]))});const z4=[],T5=[],A5={};s.forEach(r2=>{const{element:d2,player:L2,instruction:Q2}=r2;if(r.has(d2)){if(y.has(d2))return L2.onDestroy(()=>j4(d2,Q2.toStyles)),L2.disabled=!0,L2.overrideTotalTime(Q2.totalTime),void a.push(L2);let Q1=A5;if(j1.size>1){let $3=d2;const Ge=[];for(;$3=$3.parentNode;){const V1=j1.get($3);if(V1){Q1=V1;break}Ge.push($3)}Ge.forEach(V1=>j1.set(V1,Q1))}const U4=this._buildAnimation(L2.namespaceId,Q2,i1,o,ve,q3);if(L2.setRealPlayer(U4),Q1===A5)z4.push(L2);else{const $3=this.playersByElement.get(Q1);$3&&$3.length&&(L2.parentPlayer=We($3)),a.push(L2)}}else L6(d2,Q2.fromStyles),L2.onDestroy(()=>j4(d2,Q2.toStyles)),T5.push(L2),y.has(d2)&&a.push(L2)}),T5.forEach(r2=>{const d2=o.get(r2.element);if(d2&&d2.length){const L2=We(d2);r2.setRealPlayer(L2)}}),a.forEach(r2=>{r2.parentPlayer?r2.syncPlayerEvents(r2.parentPlayer):r2.destroy()});for(let r2=0;r2<T.length;r2++){const d2=T[r2],L2=d2[o4];if(N5(d2,D0),L2&&L2.hasAnimation)continue;let Q2=[];if(l.size){let U4=l.get(d2);U4&&U4.length&&Q2.push(...U4);let $3=this.driver.query(d2,P9,!0);for(let Ge=0;Ge<$3.length;Ge++){let V1=l.get($3[Ge]);V1&&V1.length&&Q2.push(...V1)}}const Q1=Q2.filter(U4=>!U4.destroyed);Q1.length?I02(this,d2,Q1):this.processLeaveNode(d2)}return T.length=0,z4.forEach(r2=>{this.players.push(r2),r2.onDone(()=>{r2.destroy();const d2=this.players.indexOf(r2);this.players.splice(d2,1)}),r2.play()}),z4}elementContainsData(t,n){let r=!1;const a=n[o4];return a&&a.setForRemoval&&(r=!0),this.playersByElement.has(n)&&(r=!0),this.playersByQueriedElement.has(n)&&(r=!0),this.statesByElement.has(n)&&(r=!0),this._fetchNamespace(t).elementContainsData(n)||r}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,n,r,a,o){let s=[];if(n){const l=this.playersByQueriedElement.get(t);l&&(s=l)}else{const l=this.playersByElement.get(t);if(l){const f=!o||o==l8;l.forEach(p=>{p.queued||!f&&p.triggerName!=a||s.push(p)})}}return(r||a)&&(s=s.filter(l=>!(r&&r!=l.namespaceId||a&&a!=l.triggerName))),s}_beforeAnimationBuild(t,n,r){const o=n.element,s=n.isRemovalTransition?void 0:t,l=n.isRemovalTransition?void 0:n.triggerName;for(const f of n.timelines){const p=f.element,y=p!==o,V=U3(r,p,[]);this._getPreviousPlayers(p,y,s,l,n.toState).forEach(w=>{const x=w.getRealPlayer();x.beforeDestroy&&x.beforeDestroy(),w.destroy(),V.push(w)})}L6(o,n.fromStyles)}_buildAnimation(t,n,r,a,o,s){const l=n.triggerName,f=n.element,p=[],y=new Set,V=new Set,b=n.timelines.map(x=>{const D=x.element;y.add(D);const T=D[o4];if(T&&T.removedBeforeQueried)return new qt(x.duration,x.delay);const F=D!==f,U=function F02(e){const t=[];return tV(e,t),t}((r.get(D)||D02).map(i1=>i1.getRealPlayer())).filter(i1=>!!i1.element&&i1.element===D),k=o.get(D),G=s.get(D),l2=wL(0,this._normalizer,0,x.keyframes,k,G),S2=this._buildPlayer(x,l2,U);if(x.subTimeline&&a&&V.add(D),F){const i1=new Y9(t,l,D);i1.setRealPlayer(S2),p.push(i1)}return S2});p.forEach(x=>{U3(this.playersByQueriedElement,x.element,[]).push(x),x.onDone(()=>function T02(e,t,n){let r=e.get(t);if(r){if(r.length){const a=r.indexOf(n);r.splice(a,1)}0==r.length&&e.delete(t)}return r}(this.playersByQueriedElement,x.element,x))}),y.forEach(x=>s4(x,PL));const w=We(b);return w.onDestroy(()=>{y.forEach(x=>N5(x,PL)),j4(f,n.toStyles)}),V.forEach(x=>{U3(a,x,[]).push(w)}),w}_buildPlayer(t,n,r){return n.length>0?this.driver.animate(t.element,n,t.duration,t.delay,t.easing,r):new qt(t.duration,t.delay)}}class Y9{constructor(t,n,r){this.namespaceId=t,this.triggerName=n,this.element=r,this._player=new qt,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((n,r)=>{n.forEach(a=>x9(t,r,void 0,a))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const n=this._player;n.triggerCallback&&t.onStart(()=>n.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,n){U3(this._queuedCallbacks,t,[]).push(n)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const n=this._player;n.triggerCallback&&n.triggerCallback(t)}}function U0(e){return e&&1===e.nodeType}function XL(e,t){const n=e.style.display;return e.style.display=t??"none",n}function ZL(e,t,n,r,a){const o=[];n.forEach(f=>o.push(XL(f)));const s=[];r.forEach((f,p)=>{const y=new Map;f.forEach(V=>{const b=t.computeStyle(p,V,a);y.set(V,b),(!b||0==b.length)&&(p[o4]=E02,s.push(p))}),e.set(p,y)});let l=0;return n.forEach(f=>XL(f,o[l++])),s}function eV(e,t){const n=new Map;if(e.forEach(l=>n.set(l,[])),0==t.length)return n;const a=new Set(t),o=new Map;function s(l){if(!l)return 1;let f=o.get(l);if(f)return f;const p=l.parentNode;return f=n.has(p)?p:a.has(p)?1:s(p),o.set(l,f),f}return t.forEach(l=>{const f=s(l);1!==f&&n.get(f).push(l)}),n}function s4(e,t){e.classList?.add(t)}function N5(e,t){e.classList?.remove(t)}function I02(e,t,n){We(n).onDone(()=>e.processLeaveNode(t))}function tV(e,t){for(let n=0;n<e.length;n++){const r=e[n];r instanceof Af?tV(r.players,t):t.push(r)}}function nV(e,t,n){const r=n.get(e);if(!r)return!1;let a=t.get(e);return a?r.forEach(o=>a.add(o)):t.set(e,r),n.delete(e),!0}class G0{constructor(t,n,r){this.bodyNode=t,this._driver=n,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(a,o)=>{},this._transitionEngine=new k02(t,n,r),this._timelineEngine=new b02(t,n,r),this._transitionEngine.onRemovalComplete=(a,o)=>this.onRemovalComplete(a,o)}registerTrigger(t,n,r,a,o){const s=t+"-"+a;let l=this._triggerCache[s];if(!l){const f=[],y=R9(this._driver,o,f,[]);if(f.length)throw function Hn2(e,t){return new q(3404,!1)}();l=function L02(e,t,n){return new V02(e,t,n)}(a,y,this._normalizer),this._triggerCache[s]=l}this._transitionEngine.registerTrigger(n,a,l)}register(t,n){this._transitionEngine.register(t,n)}destroy(t,n){this._transitionEngine.destroy(t,n)}onInsert(t,n,r,a){this._transitionEngine.insertNode(t,n,r,a)}onRemove(t,n,r,a){this._transitionEngine.removeNode(t,n,a||!1,r)}disableAnimations(t,n){this._transitionEngine.markElementAsDisabled(t,n)}process(t,n,r,a){if("@"==r.charAt(0)){const[o,s]=_L(r);this._timelineEngine.command(o,n,s,a)}else this._transitionEngine.trigger(t,n,r,a)}listen(t,n,r,a,o){if("@"==r.charAt(0)){const[s,l]=_L(r);return this._timelineEngine.listen(s,n,l,o)}return this._transitionEngine.listen(t,n,r,a,o)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let B02=(()=>{class e{constructor(n,r,a){this._element=n,this._startStyles=r,this._endStyles=a,this._state=0;let o=e.initialStylesByElement.get(n);o||e.initialStylesByElement.set(n,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&j4(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(j4(this._element,this._initialStyles),this._endStyles&&(j4(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(L6(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(L6(this._element,this._endStyles),this._endStyles=null),j4(this._element,this._initialStyles),this._state=3)}}return e.initialStylesByElement=new WeakMap,e})();function J9(e){let t=null;return e.forEach((n,r)=>{(function W02(e){return"display"===e||"position"===e})(r)&&(t=t||new Map,t.set(r,n))}),t}class rV{constructor(t,n,r,a){this.element=t,this.keyframes=n,this.options=r,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const n=[];return t.forEach(r=>{n.push(Object.fromEntries(r))}),n}_triggerWebAnimation(t,n,r){return t.animate(this._convertKeyframesToObject(n),r)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,a)=>{"offset"!==a&&t.set(a,this._finished?r:WL(this.element,a))}),this.currentSnapshot=t}triggerCallback(t){const n="start"===t?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}}class j02{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,n){return!1}containsElement(t,n){return NL(t,n)}getParentElement(t){return k9(t)}query(t,n,r){return kL(t,n,r)}computeStyle(t,n,r){return window.getComputedStyle(t)[n]}animate(t,n,r,a,o,s=[]){const f={duration:r,delay:a,fill:0==a?"both":"forwards"};o&&(f.easing=o);const p=new Map,y=s.filter(w=>w instanceof rV);(function $n2(e,t){return 0===e||0===t})(r,a)&&y.forEach(w=>{w.currentSnapshot.forEach((x,D)=>p.set(D,x))});let V=function jn2(e){return e.length?e[0]instanceof Map?e:e.map(t=>IL(t)):[]}(n).map(w=>Ue(w));V=function Kn2(e,t,n){if(n.size&&t.length){let r=t[0],a=[];if(n.forEach((o,s)=>{r.has(s)||a.push(s),r.set(s,o)}),a.length)for(let o=1;o<t.length;o++){let s=t[o];a.forEach(l=>s.set(l,WL(e,l)))}}return t}(t,V,p);const b=function R02(e,t){let n=null,r=null;return Array.isArray(t)&&t.length?(n=J9(t[0]),t.length>1&&(r=J9(t[t.length-1]))):t instanceof Map&&(n=J9(t)),n||r?new B02(e,n,r):null}(t,V);return new rV(t,V,f,b)}}let U02=(()=>{class e extends Df{constructor(n,r){super(),this._nextAnimationId=0,this._renderer=n.createRenderer(r.body,{id:"0",encapsulation:r3.None,styles:[],data:{animation:[]}})}build(n){const r=this._nextAnimationId.toString();this._nextAnimationId++;const a=Array.isArray(n)?Nf(n):n;return aV(this._renderer,null,r,"register",[a]),new G02(r,this._renderer)}}return e.\u0275fac=function(n){return new(n||e)(V2(mt),V2(H3))},e.\u0275prov=z({token:e,factory:e.\u0275fac}),e})();class G02 extends class HN{}{constructor(t,n){super(),this._id=t,this._renderer=n}create(t,n){return new q02(this._id,t,n||{},this._renderer)}}class q02{constructor(t,n,r,a){this.id=t,this.element=n,this._renderer=a,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(t,n){return this._renderer.listen(this.element,`@@${this.id}:${t}`,n)}_command(t,...n){return aV(this._renderer,this.element,this.id,t,n)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function aV(e,t,n,r,a){return e.setProperty(t,`@@${n}:${r}`,a)}const iV="@.disabled";let $02=(()=>{class e{constructor(n,r,a){this.delegate=n,this.engine=r,this._zone=a,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(o,s)=>{const l=s?.parentNode(o);l&&s.removeChild(l,o)}}createRenderer(n,r){const o=this.delegate.createRenderer(n,r);if(!(n&&r&&r.data&&r.data.animation)){let y=this._rendererCache.get(o);return y||(y=new oV("",o,this.engine),this._rendererCache.set(o,y)),y}const s=r.id,l=r.id+"-"+this._currentId;this._currentId++,this.engine.register(l,n);const f=y=>{Array.isArray(y)?y.forEach(f):this.engine.registerTrigger(s,l,n,y.name,y)};return r.data.animation.forEach(f),new K02(this,l,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(n,r,a){n>=0&&n<this._microtaskId?this._zone.run(()=>r(a)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[s,l]=o;s(l)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,a]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return e.\u0275fac=function(n){return new(n||e)(V2(mt),V2(G0),V2(N1))},e.\u0275prov=z({token:e,factory:e.\u0275fac}),e})();class oV{constructor(t,n,r){this.namespaceId=t,this.delegate=n,this.engine=r,this.destroyNode=this.delegate.destroyNode?a=>n.destroyNode(a):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,n){return this.delegate.createElement(t,n)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,n){this.delegate.appendChild(t,n),this.engine.onInsert(this.namespaceId,n,t,!1)}insertBefore(t,n,r,a=!0){this.delegate.insertBefore(t,n,r),this.engine.onInsert(this.namespaceId,n,t,a)}removeChild(t,n,r){this.engine.onRemove(this.namespaceId,n,this.delegate,r)}selectRootElement(t,n){return this.delegate.selectRootElement(t,n)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,n,r,a){this.delegate.setAttribute(t,n,r,a)}removeAttribute(t,n,r){this.delegate.removeAttribute(t,n,r)}addClass(t,n){this.delegate.addClass(t,n)}removeClass(t,n){this.delegate.removeClass(t,n)}setStyle(t,n,r,a){this.delegate.setStyle(t,n,r,a)}removeStyle(t,n,r){this.delegate.removeStyle(t,n,r)}setProperty(t,n,r){"@"==n.charAt(0)&&n==iV?this.disableAnimations(t,!!r):this.delegate.setProperty(t,n,r)}setValue(t,n){this.delegate.setValue(t,n)}listen(t,n,r){return this.delegate.listen(t,n,r)}disableAnimations(t,n){this.engine.disableAnimations(t,n)}}class K02 extends oV{constructor(t,n,r,a){super(n,r,a),this.factory=t,this.namespaceId=n}setProperty(t,n,r){"@"==n.charAt(0)?"."==n.charAt(1)&&n==iV?this.disableAnimations(t,r=void 0===r||!!r):this.engine.process(this.namespaceId,t,n.slice(1),r):this.delegate.setProperty(t,n,r)}listen(t,n,r){if("@"==n.charAt(0)){const a=function Q02(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(t);let o=n.slice(1),s="";return"@"!=o.charAt(0)&&([o,s]=function Y02(e){const t=e.indexOf(".");return[e.substring(0,t),e.slice(t+1)]}(o)),this.engine.listen(this.namespaceId,a,o,s,l=>{this.factory.scheduleListenerCallback(l._data||-1,r,l)})}return this.delegate.listen(t,n,r)}}const sV=[{provide:Df,useClass:U02},{provide:G9,useFactory:function X02(){return new g02}},{provide:G0,useClass:(()=>{class e extends G0{constructor(n,r,a,o){super(n.body,r,a)}ngOnDestroy(){this.flush()}}return e.\u0275fac=function(n){return new(n||e)(V2(H3),V2(T9),V2(G9),V2(Pt))},e.\u0275prov=z({token:e,factory:e.\u0275fac}),e})()},{provide:mt,useFactory:function Z02(e,t,n){return new $02(e,t,n)},deps:[Qn,G0,N1]}],X9=[{provide:T9,useFactory:()=>new j02},{provide:gC,useValue:"BrowserAnimations"},...sV],cV=[{provide:T9,useClass:TL},{provide:gC,useValue:"NoopAnimations"},...sV];let er2=(()=>{class e{static withConfig(n){return{ngModule:e,providers:n.disableAnimations?cV:X9}}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=k3({type:e}),e.\u0275inj=E({providers:X9,imports:[bf]}),e})(),tr2=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=k3({type:e}),e.\u0275inj=E({imports:[jt,w9,bL]}),e})(),nr2=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=k3({type:e}),e.\u0275inj=E({imports:[jt,bL,w9,er2,tr2]}),e})(),rr2=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=k3({type:e,bootstrap:[tn2]}),e.\u0275inj=E({imports:[bf,nr2,w9,M52.forRoot({closeButton:!0,enableClose:!0,backdrop:!0,resizable:!1,draggable:!1,windowClass:"modal",minHeight:"100%"})]}),e})();(function oD(){NC=!1})(),hN().bootstrapModule(rr2).catch(e=>console.error(e))}},u8=>{u8(u8.s=881)}]);